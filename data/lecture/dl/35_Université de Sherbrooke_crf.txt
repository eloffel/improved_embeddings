conditional random    elds (crfs)
ift 725 - r  seaux neuronaux

math for my slides    conditional random    elds   .

math for my slides    conditional random    elds   .

math for my slides    conditional random    elds   .

september 20, 2012
hugo larochelle
hugo larochelle
conditional random    elds
d  epartement d   informatique
conditional random field
universit  e de sherbrooke
abstract
topics: sequential classi   cation
d  epartement d   informatique
september 20, 2012
    what if examples organized in a sequence 
universit  e de sherbrooke
...
...
hugo.larochelle@usherbrooke.ca
abstract

hugo larochelle
d  epartement d   informatique
d  epartement d   informatique
conditional random    elds
universit  e de sherbrooke
abstract
universit  e de sherbrooke
abstract
hugo.larochelle@usherbrooke.ca
hugo.larochelle@usherbrooke.ca
hugo.larochelle@usherbrooke.ca
hugo larochelle
september 20, 2012
september 20, 2012
d  epartement d   informatique
universit  e de sherbrooke

    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
abstract
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
math for my slides    conditional random    elds   .
math for my slides    conditional random    elds   .
math for my slides    conditional random    elds   .
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
math for my slides    conditional random    elds   .
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]

hugo.larochelle@usherbrooke.ca

math for my slides    conditional random    elds   .

math for my slides    conditional random    elds   .

september 20, 2012

abstract

abstract

.
.
.

.
.
.

.
.
.

2

math for my slides    conditional random    elds   .

hugo larochelle
september 20, 2012
hugo larochelle
hugo larochelle
conditional random    elds
d  epartement d   informatique
abstract
d  epartement d   informatique
d  epartement d   informatique
conditional random    elds
conditional random field
universit  e de sherbrooke
universit  e de sherbrooke
math for my slides    conditional random    elds   .
abstract
universit  e de sherbrooke
abstract
abstract
hugo.larochelle@usherbrooke.ca
hugo.larochelle@usherbrooke.ca
hugo.larochelle@usherbrooke.ca
math for my slides    conditional random    elds   .
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
math for my slides    conditional random    elds   .
topics: sequential classi   cation
hugo larochelle
d  epartement d   informatique
september 20, 2012
september 20, 2012
september 20, 2012
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
d  epartement d   informatique
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    what if examples organized in a sequence 
universit  e de sherbrooke
universit  e de sherbrooke
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    x(t 1) x(t) x(t+1)
...
...
hugo.larochelle@usherbrooke.ca
...
...
abstract
abstract
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
math for my slides    conditional random    elds   .
math for my slides    conditional random    elds   .
math for my slides    conditional random    elds   .
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    y(t) = [y(1), . . . , y(tt)]
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    y(t) = [y(1), . . . , y(tt)]
    x(t) = [x(1), . . . , x(tt)]
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
math for my slides    conditional random    elds   .
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    y(t) = [y(1), . . . , y(tt)]
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t 1) x(t) x(t+1)
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]
    x(t) = [x(1), . . . , x(tt)]

hugo.larochelle@usherbrooke.ca

math for my slides    conditional random    elds   .

math for my slides    conditional random    elds   .

september 20, 2012

abstract

abstract

.
.
.

.
.
.

.
.
.

2

k

    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    kt
math for my slides    conditional random    elds   .
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
notation
    x(t 1) x(t) x(t+1)
    x(t)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
topics: notation for inputs and targets
    (x, y)
    x(t 1) x(t) x(t+1)
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    training set                     is a set of input and target 
    {(x(t), y(t))}
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
1 , . . . , y(t)
    y(t) = [y(t)
]
sequences pairs:
kt
    y(t) = [y(t)
1 , . . . , y(t)
]
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
kt
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    inputs are 
    x(t) = [x(t)
1 , . . . , x(t)
kt
1 , . . . , x(t)
    x(t) = [x(t)
    targets are
    y(t) = [y(t)
1 , . . . , y(t)
    y(t) = [y(t)
    xk 1 xk xk+1
kt
]
kt
    x(t)
           is the length of the tth sequence 
    kt
    p(y1, . . . , yk|x1, . . . , xk)
1 , . . . , x(t)
    x(t) = [x(t)
    x(t) = [x(t)
kt
    x(t)
    n.b.: in the assignment code, the rows of the input matrix 
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
correspond to each 
    x(t)
    xk 1 xk xk+1
    p(y1, . . . , yk|x1, . . . , xk)

]
1 , . . . , y(t)
kt
]
1 , . . . , x(t)
kt

k

]

]

k

k

k

]

3

    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    x(t) = [x(t)
1 , . . . , x(t)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
math for my slides    conditional random    elds   .
]
    x(t) = [x(t)
1 , . . . , x(t)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
]
kt
kt
conditional random field
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    x(t 1) x(t) x(t+1)
    kt
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
    kt
1 , . . . , y(t)
    y(t) = [y(t)
1 , . . . , y(t)
    y(t) = [y(t)
    y(t) = [y(t)
1 , . . . , y(t)
]
]
    x(t)
topics: sequential classi   cation
]
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
kt
kt
    x(t)
kt
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
k
k
    for a given example          :
    x(t) = [x(t)
1 , . . . , x(t)
1 , . . . , x(t)
    x(t) = [x(t)
    x(t) = [x(t)
1 , . . . , x(t)
    (x, y)
]
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
]
]
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
kt
kt
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
kt
    (x, y)
...
    {(x(t), y(t))}
    kt
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    kt
    kt
1 , . . . , y(t)
    y(t) = [y(t)
1 , . . . , y(t)
    y(t) = [y(t)
    p(y|x) = p(y1, . . . , yk|x1, . . . , xk)
]
kt
    x(t)
kt
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
1 , . . . , y(t)
    y(t) = [y(t)
]
kt
    {(x(t), y(t))}
1 , . . . , x(t)
    x(t) = [x(t)
1 , . . . , x(t)
    x(t) = [x(t)
]
]
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
kt
kt
1 , . . . , x(t)
    x(t) = [x(t)
]
kt
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    kt
    kt
    xk 1 xk xk+1
    xk 1 xk xk+1
    p(y1, . . . , yk|x1, . . . , xk)
    xk 1 xk xk+1
    kt
    xk 1 xk xk+1
    x(t)
    x(t)
    p(y1, . . . , yk|x1, . . . , xk)
    p(y1, . . . , yk|x1, . . . , xk)
    p(y1, . . . , yk|x1, . . . , xk)
    x(t)
    p(y1, . . . , yk|x1, . . . , xk)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
   
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

.
.
.

.
.
.

.
.
.

...

k

k

]

k

k

k

k

4

p(y|x) = yk

p(yk|xk) =yk

    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    p(y1, . . . , yk|x1, . . . , xk)
    p(y1, . . . , yk|x1, . . . , xk)

linear chain crf

topics: lateral weights
    non-sequential classi   cation:

exp(a(l+1)(xk)yk )/z(xk)

exp(a(l+1)(xk)yk )/z(xk)

p(y|x) = yk
p(yk|xk) =yk
p(yk|xk) =yk
p(y|x) = yk
= exp xk
a(l+1)(xk)yk! / yk
z(xk)!
z(xk)!
a(l+1)(xk)yk! / yk
= exp xk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
k=1 z(xk)   
k=1 a(l+1)(xk)yk    /   qk
p(y|x) = exp  kxk=1
vyk,yk+1! /z(x)
k 1xk=1
vyk,yk+1! /z(x)
p(y|x) = exp  kxk=1
k 1xk=1

    sequential classi   cation with linear chain:

a(l+1)(xk)yk +

a(l+1)(xk)yk +

5

1

    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    p(y1, . . . , yk|x1, . . . , xk)
    p(y1, . . . , yk|x1, . . . , xk)

linear chain crf

   

   

topics: lateral weights
    non-sequential classi   cation:

   

exp(a(l+1)(xk)yk )/z(xk)

exp(a(l+1)(xk)yk )/z(xk)

p(y|x) = yk
p(yk|xk) =yk
p(yk|xk) =yk
p(y|x) = yk
= exp xk
a(l+1)(xk)yk! / yk
z(xk)!
z(xk)!
a(l+1)(xk)yk! / yk
= exp xk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
k=1 z(xk)   
k=1 a(l+1)(xk)yk    /   qk
p(y|x) = exp  kxk=1
vyk,yk+1! /z(x)
k 1xk=1
vyk,yk+1! /z(x)
p(y|x) = exp  kxk=1
k 1xk=1

{
(
x
    sequential classi   cation with linear chain:

(
l
+
1
)

)
}

a(l+1)(xk)yk +

a(l+1)(xk)yk +

is yk likely
given input ?

(
t
)

(
t
)

y

,

5

(
l

(
x

a

a

)

1

(

x

,

y
)

k
 
1

    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    p(y1, . . . , yk|x1, . . . , xk)
    p(y1, . . . , yk|x1, . . . , xk)

linear chain crf

   

   

x
a
k
 
1

topics: lateral weights
    non-sequential classi   cation:

   

   

exp(a(l+1)(xk)yk )/z(xk)

exp(a(l+1)(xk)yk )/z(xk)

p(y|x) = yk
p(yk|xk) =yk
p(yk|xk) =yk
p(y|x) = yk
= exp xk
a(l+1)(xk)yk! / yk
z(xk)!
z(xk)!
a(l+1)(xk)yk! / yk
= exp xk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
k=1 z(xk)   
k=1 a(l+1)(xk)yk    /   qk
p(y|x) = exp  kxk=1
vyk,yk+1! /z(x)
k 1xk=1
vyk,yk+1! /z(x)
p(y|x) = exp  kxk=1
k 1xk=1

{
(
(
l
x
    sequential classi   cation with linear chain:
+
1
)

{
(
x

(
l
+
1
)

k
 
1

)
}

)
}

a(l+1)(xk)yk +

a(l+1)(xk)yk +

is yk followed 
by yk+1 likely?

(
x

is yk likely
given input ?

   

(
t
)

(
t
)

y

(
t
)

(
t
)

y

a

)

,

,

5

a
1

(
l

(
l

x
(
k
x

(

x

,

y
)

x

k
 
k
1
+
)
1
a

   

   

    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    p(y1, . . . , yk|x1, . . . , xk)
    p(y1, . . . , yk|x1, . . . , xk)

linear chain crf

   

   

x
a
k
 
1

   

   

   

topics: lateral weights
    non-sequential classi   cation:

   

exp(a(l+1)(xk)yk )/z(xk)

exp(a(l+1)(xk)yk )/z(xk)

p(y|x) = yk
p(yk|xk) =yk
p(yk|xk) =yk
p(y|x) = yk
= exp xk
a(l+1)(xk)yk! / yk
z(xk)!
z(xk)!
a(l+1)(xk)yk! / yk
= exp xk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
k=1 z(xk)   
k=1 a(l+1)(xk)yk    /   qk
p(y|x) = exp  kxk=1
vyk,yk+1! /z(x)
k 1xk=1
vyk,yk+1! /z(x)
p(y|x) = exp  kxk=1
k 1xk=1

p
(
y
{
(
1
(
l
,
x
    sequential classi   cation with linear chain:
+
.
x
1
k
)

,
,
y
a(l+1)(xk)yk +
y
x
k
k
k
 
+
)
x
)
1
a(l+1)(xk)yk +
1
}
}
1
,

x
   
k
{
 
(
1
x

(
x
k
y
 
1
)

)
}
partition
function
5

(
l
+
1
)

a
(
l
+
1
)

(
x

is yk likely
given input ?

   

(
t
)

(
t
)

(
t
)

(
t
)

a
is yk followed 
(
l
by yk+1 likely?
+

a

a
1

(
l

.
(
l
.

   

   

)

,

|

y
(
t
)

(
t
)

.

.

,

.

x
(
k
x

x

,

y
)

   

   

   
{
(
x

(

x

k
 
k
1
+
)
1
a

   

...

   

   

   

exp(a(l+1)(xk)yk )/z(xk)

p(y|x) = yk
p(y|x) = yk
p(yk|xk) =yk
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
p(y|x) = yk
p(yk|xk) =yk
p(y|x) = yk
math for my slides    conditional random    elds   .
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
exp(a(l+1)(xk)yk )/z(xk)
linear chain crf
= exp xk
a(l+1)(xk)yk! / yk
= exp xk
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
a(l+1)(xk)yk! / yk
= exp xk
= exp xk
    x(t 1) x(t) x(t+1)
topics: lateral weights
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
    sequential classi   cation with linear chain:
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
    p(y|x) = exp   pk
k=1 z(xk)   
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
    p(y|x) = exp   pk
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    y(t) = [y(t)
1 , . . . , y(t)
k 1xk=1
...
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1)(xk)yk +
kt
...
...
a(l+1)(xk)yk +
kt
    y(t) = [y(t)
    x(t) = [x(t)
1 , . . . , x(t)
1 , . . . , x(t)
    x(t) = [x(t)
]
]
kt
kt
    x(t) = [x(t)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    kt
    kt
    kt
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

1 , . . . , y(t)
kt
1 , . . . , x(t)
kt

.
.
.

.
.
.

.
.
.

...

1

1

k

k

]

]

k

]

]

6

   

   

   

   

exp(a(l+1)(xk)yk )/z(xk)

= exp xk
p(y|x) = yk
p(y|x) = yk
p(yk|xk) =yk
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
p(y|x) = yk
p(yk|xk) =yk
p(y|x) = yk
math for my slides    conditional random    elds   .
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
exp(a(l+1)(xk)yk )/z(xk)
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
linear chain crf
= exp xk
a(l+1)(xk)yk! / yk
= exp xk
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
a(l+1)(xk)yk! / yk
= exp xk
= exp xk
    x(t 1) x(t) x(t+1)
p(y|x) = exp  kxk=1
topics: lateral weights
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
    sequential classi   cation with linear chain:
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
k=1 z(xk)   
k=1 z(xk)   
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    y(t) = [y(t)
1 , . . . , y(t)
k 1xk=1
...
    y(t) = [y(t)
1 , . . . , y(t)
    v w(l+1) b(l+1)
a(l+1)(xk)yk +
kt
...
...
a(l+1)(xk)yk +
kt
    y(t) = [y(t)
    x(t) = [x(t)
1 , . . . , x(t)
1 , . . . , x(t)
    x(t) = [x(t)
]
]
kt
kt
    x(t) = [x(t)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    kt
    kt
    kt
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

1 , . . . , y(t)
kt
1 , . . . , x(t)
kt

.
.
.

.
.
.

.
.
.

...

1

1

k

k

]

]

k

]

]

6

...

   

   

   

   

exp(a(l+1)(xk)yk )/z(xk)

= exp xk
a(l+1)(xk)yk! / yk
= exp xk
p(y|x) = yk
p(y|x) = yk
p(yk|xk) =yk
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
p(y|x) = yk
p(yk|xk) =yk
p(y|x) = yk
math for my slides    conditional random    elds   .
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
exp(a(l+1)(xk)yk )/z(xk)
    p(y|x) = exp   pk
    p(y|x) = exp   pk
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 a(l+1)(xk)yk    /   qk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
    p(y|x) = exp   pk
linear chain crf
= exp xk
a(l+1)(xk)yk! / yk
= exp xk
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
= exp xk
= exp xk
a(l+1)(xk)yk! / yk
    x(t 1) x(t) x(t+1)
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
topics: lateral weights
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
    sequential classi   cation with linear chain:
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
a(l+1)(xk)yk +
k=1 z(xk)   
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
k=1 z(xk)   
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
k=1 z(xk)   
    p(y|x) = exp   pk
k=1 a(l+1)(xk)yk    /   qk
    p(y|x) = exp   pk
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    y(t) = [y(t)
1 , . . . , y(t)
k 1xk=1
...
...
1 , . . . , y(t)
    y(t) = [y(t)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
a(l+1)(xk)yk +
kt
...
...
a(l+1)(xk)yk +
kt
    y(t) = [y(t)
    x(t) = [x(t)
1 , . . . , x(t)
1 , . . . , x(t)
    x(t) = [x(t)
]
]
kt
kt
    x(t) = [x(t)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    kt
    kt
    kt
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

1 , . . . , y(t)
kt
1 , . . . , x(t)
kt

.
.
.

.
.
.

.
.
.

]
1

...

1

1

k

k

]

]

k

]

6

linear chain crf

topics: context window
    could incorporate a context window to the prediction at 
each position
    e.g. context window of radius 1

    v w(l+1) b(l+1)
    v w(l+1) b(l+1)

p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
kxk=2
kxk=2
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +

vyk,yk+1+
vyk,yk+1+

a(l+1, 1)(xk 1)yk +
a(l+1, 1)(xk 1)yk +

k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1

a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)

7

linear chain crf

topics: context window
    could incorporate a context window to the prediction at 
each position
    e.g. context window of radius 1

    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)

a

a

   

(
l
+
1
)

p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
kxk=2
kxk=2
kxk=2
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

k
 
1

(
x

(
l
+
1
)

a

)

(
l
+
1
)

(
l
+
1
)

)

a

(
x

(
x

(
x

{
x

(

a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +

   

vyk,yk+1+
vyk,yk+1+
vyk,yk+1+
{
(
x

,

a(l+1, 1)(xk 1)yk +
a(l+1, 1)(xk 1)yk +
a(l+1, 1)(xk 1)yk +

y

(
t
)

(
t
)

,

(
t
)

a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)

(
t
)

y

(

x

,

y
)

}

)

)
}

k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1

is yk likely given input 

on the left ?

is yk likely given input 

on the right ?

7

   

   

   

   

math for my slides    conditional random    elds   .

    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
linear chain crf
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
topics: context window
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    sequential classi   cation with linear chain: 
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
k 1xk=1
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
k 1xk=1
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
vyk,yk+1+
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
...
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)
1 , . . . , y(t)
    y(t) = [y(t)
]
]
k 1xk=1
kxk=2
k 1xk=1
kxk=2
kt
kt
a(l+1, 1)(xk 1)yk +
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1, 1)(xk 1)yk +
]
kt
    x(t) = [x(t)
1 , . . . , x(t)
    x(t) = [x(t)
1 , . . . , x(t)
]
]
kt
kt
1 , . . . , x(t)
    x(t) = [x(t)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
kt
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
...
    kt
    kt
    kt
...
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

vyk,yk+1+

.
.
.

...

...

k

k

k

]

86

math for my slides    conditional random    elds   .

    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
linear chain crf
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
topics: context window
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    sequential classi   cation with linear chain: 
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
k 1xk=1
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
k 1xk=1
k 1xk=1
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
vyk,yk+1+
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
...
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)
1 , . . . , y(t)
    y(t) = [y(t)
]
]
k 1xk=1
k 1xk=1
kxk=2
kxk=2
k 1xk=1
kxk=2
kt
kt
a(l+1, 1)(xk 1)yk +
a(l+1, 1)(xk 1)yk +
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1, 1)(xk 1)yk +
]
kt
    x(t) = [x(t)
1 , . . . , x(t)
    x(t) = [x(t)
1 , . . . , x(t)
]
]
kt
kt
1 , . . . , x(t)
    x(t) = [x(t)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
kt
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
...
    kt
    kt
    kt
...
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

vyk,yk+1+
vyk,yk+1+

.
.
.

...

...

k

k

k

]

86

math for my slides    conditional random    elds   .

    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
linear chain crf
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
topics: context window
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    v w(l+1) b(l+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    sequential classi   cation with linear chain: 
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
k 1xk=1
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
k 1xk=1
k 1xk=1
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
vyk,yk+1+
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
...
...
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)
a(l+1,+1)(xk+1)yk! /z(x)
1 , . . . , y(t)
    y(t) = [y(t)
]
kxk=2
]
k 1xk=1
k 1xk=1
kxk=2
kxk=2
k 1xk=1
kxk=2
kt
kt
a(l+1, 1)(xk 1)yk +
a(l+1, 1)(xk 1)yk +
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1, 1)(xk 1)yk +
]
kt
    x(t) = [x(t)
1 , . . . , x(t)
    x(t) = [x(t)
1 , . . . , x(t)
]
]
kt
kt
1 , . . . , x(t)
    x(t) = [x(t)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
kt
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
...
    kt
    kt
    kt
...
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1

vyk,yk+1+
vyk,yk+1+

.
.
.

...

k

k

k

]

86

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 

linear chain crf

   

   

   

x
k
 
1

x
   
k

x
k
+
1

x
k
 
1

,

,

(

(

)

a

a

a

(
t
)

(
t
)

   

   

   

y
)

factors or
compatibility
functions

(
l
+
1
)

(
l
+
1
)

p(y|x) =

 f (yk, xk 1, xk, xk+1) =
{
x
(
x

(
1
x
k
 
1

z(x)yf

   
y
 f (y, x)
{
(
)
x
}

    a parametrization of the factor that is often used is:
x
k

topics: factor, suf   cient statistic
    crfs are often written in the standard form:

exp    a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk   
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)
1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)

(
l
(
+
x
1
k
)
 
1

)
}

(
l
+
1

y
)

x

(
t
)

(
t
)

suf   cient
statistics

y

,

,

c

9

     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 

x
k
+
1

(
x
k

(
l
+
1

a

a

)

)

     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 

 f (y, x)

1

z(x)yf

 f (y, x)

p(y|x) =

linear chain crf

1
topics: factor, suf   cient statistic
    with hidden units, the crf factors could be:

kxk=2
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
z(x)yf
    a(l+1,)
   

   a(l+1)(xk 1)a(l+1)(xk)a(l+1)(xk+1)
   {(x(t),y(t))}
   (x,y)

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
p(y|x) =
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 

    there is no simple form for the suf   cient statistics

k=1 1yk=c   
pk

c

k 1xk=1

10

     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 

 f (y, x)

unary factors

1

z(x)yf

 f (y, x)

p(y|x) =

linear chain crf

1
topics: factor, suf   cient statistic
    with hidden units, the crf factors could be:

kxk=2
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
z(x)yf
    a(l+1,)
   

   a(l+1)(xk 1)a(l+1)(xk)a(l+1)(xk+1)
   {(x(t),y(t))}
   (x,y)

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
p(y|x) =
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 

    there is no simple form for the suf   cient statistics

k=1 1yk=c   
pk

c

k 1xk=1

10

     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 

 f (y, x)

unary factors

1

z(x)yf

 f (y, x)

p(y|x) =

linear chain crf

1
topics: factor, suf   cient statistic
    with hidden units, the crf factors could be:

kxk=2
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
z(x)yf
    a(l+1,)
   

   a(l+1)(xk 1)a(l+1)(xk)a(l+1)(xk+1)
   {(x(t),y(t))}
   (x,y)

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
p(y|x) =
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 

    there is no simple form for the suf   cient statistics

k=1 1yk=c   
pk

pairwise factors

c

k 1xk=1

10

kxk=2

k 1xk=1

a(l+1, 1)(xk 1)yk +

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
topics: factor, suf   cient statistic
    a(l+1,)
    without hidden units, the crf factors can be written as:
   

exp    a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk   
linear chain crf
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
pk
z(x)yf
p(y|x) =
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
pk
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
pk
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
pk 1
     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 

 f (y, x)

1

c,i

c,i

c,i

11

c

   {(x(t),y(t))}
   (x,y)

kxk=2

k 1xk=1

a(l+1, 1)(xk 1)yk +

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
topics: factor, suf   cient statistic
    a(l+1,)
    without hidden units, the crf factors can be written as:
   

exp    a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk   
linear chain crf
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
pk
z(x)yf
p(y|x) =
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
pk
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
pk
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
pk 1
     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 

 f (y, x)

suf   cient
statistics

1

c,i

c,i

c,i

11

c

   {(x(t),y(t))}
   (x,y)

kxk=2

k 1xk=1

a(l+1, 1)(xk 1)yk +

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
topics: factor, suf   cient statistic
    a(l+1,)
    without hidden units, the crf factors can be written as:
   

kxk=2
exp    a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk   
linear chain crf
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
 f (yk, yk+1) = exp vyk,yk+1 
    a(l+1,)
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
   
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
pk
z(x)yf
p(y|x) =
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
pk
 f (yk, xk 1, xk, xk+1) =
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
pk
exp    a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk   
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
pk 1
 f (yk, yk+1) = exp vyk,yk+1 
     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 
     f (y, x) = exp (ps    f,st(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 

z(x)yf

1yk=c   

p(y|x) =

 f (y, x)

suf   cient
statistics

parameters

1

c,i

c,i

c,i

1

11

c

   {(x(t),y(t))}
   (x,y)

c

c,i

pk
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
pk
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
pk
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
linear chain crf
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1

topics: other variations on linear chain crf
    we could add lateral connections between labels that are at 2 
positions away

    we could add lateral connections for triplets 
of labels

     f (yk, yk+2)  f (yk, yk+1, yk+2)

     f (yk, yk+2)  f (yk, yk+1, yk+2)

c,i

c,i

c,i

c,i

    the idea is to add connections between things to model their 
dependency more directly

    the connectivity can even change between examples

12

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

2

2

13

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
p(y|x) =
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, yk+1) = exp vyk,yk+1 
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

k=1 1yk=c   
pk

2

2

13

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

2

2

13

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
p(y|x) =
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, yk+1) = exp vyk,yk+1 
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

k=1 1yk=c   
pk

2

2

13

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

2

2

13

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
p(y|x) =
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, yk+1) = exp vyk,yk+1 
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

k=1 1yk=c   
pk

2

2

13

c

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

2

2

13

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
p(y|x) =
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, yk+1) = exp vyk,yk+1 
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk) = exp   b(l+1)

k=1 1yk=c   
pk

2

2

13

c

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor

2

2

13

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
directed vs. undirected
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: undirected graphical model, directed graphical model
pk
pk
pk
     crf is an undirected graphical model
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

c,i
c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

2

2

14

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

a(l+1,+1)(xk+1)yk! /z(x)
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
k 1xk=1
kxk=2
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
a(l+1, 1)(xk 1)yk +
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
directed vs. undirected
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: undirected graphical model, directed graphical model
pk
pk
pk
     crf is an undirected graphical model
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
z(x)yf
    x1 x2 x3 x4 x5
c,i
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
1
p(y|x) =
 f (y, x)
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, yk+1) = exp vyk,yk+1 

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

2

2

14

c

c

c

c

c

c,i

c,i

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

a(l+1,+1)(xk+1)yk! /z(x)
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
k 1xk=1
kxk=2
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
a(l+1, 1)(xk 1)yk +
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
directed vs. undirected
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: undirected graphical model, directed graphical model
pk
pk
pk
     crf is an undirected graphical model
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
z(x)yf
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
1
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
p(y|x) =
 f (y, x)
    x1 x2 x3 x4 x5
z(x)yf
    x1 x2 x3 x4 x5
c,i
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
1
p(y|x) =
 f (y, x)
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, yk+1) = exp vyk,yk+1 
 f (yk, yk+1) = exp vyk,yk+1 

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 

c,i

c,i

c,i

c,i

c,i

c,i

2

2

14

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

    kt
a(l+1,+1)(xk+1)yk! /z(x)
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
k 1xk=1
kxk=2
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
a(l+1, 1)(xk 1)yk +
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
    x(t)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
pk 1
pk 1
pk 1
directed vs. undirected
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: undirected graphical model, directed graphical model
pk
pk
pk
     crf is an undirected graphical model
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
z(x)yf
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
1
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
p(y|x) =
 f (y, x)
    x1 x2 x3 x4 x5
z(x)yf
    x1 x2 x3 x4 x5
c,i
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
1
    (x,y)
p(y|x) =
 f (y, x)
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
   {(x(t),y(t))}
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, yk+1) = exp vyk,yk+1 
 f (yk, yk+1) = exp vyk,yk+1 

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 

only need to be non-negative
2

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

2

14

c

c

c

c

c

c,i

c,i

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

a(l+1,+1)(xk+1)yk! /z(x)
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
k 1xk=1
kxk=2
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
a(l+1, 1)(xk 1)yk +
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
directed vs. undirected
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: undirected graphical model, directed graphical model
pk
pk
pk
     id48 is a directed graphical model
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
z(x)yf
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
1
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
p(y|x) =
 f (y, x)
    x1 x2 x3 x4 x5
z(x)yf
    x1 x2 x3 x4 x5
c,i
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
1
p(y|x) =
 f (y, x)
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, yk+1) = exp vyk,yk+1 
 f (yk, yk+1) = exp vyk,yk+1 

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 

c,i

c,i

c,i

c,i

c,i

c,i

2

2

15

c

c

c

c

c,i

c,i
c,i

c,i
c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i
c,i

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

a(l+1,+1)(xk+1)yk! /z(x)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
pk
k 1xk=1
kxk=2
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
a(l+1, 1)(xk 1)yk +
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
pk 1
pk 1
directed vs. undirected
pk
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: undirected graphical model, directed graphical model
pk 1
pk
pk
pk
     id48 is a directed graphical model
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
z(x)yf
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
1
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
p(y|x) =
 f (y, x)
    x1 x2 x3 x4 x5
z(x)yf
    x1 x2 x3 x4 x5
c,i
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
1
p(y|x) =
 f (y, x)
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk 1, xk, xk+1) = exp a(l+1, 1)(xk 1)yk + a(l+1,0)(xk)yk + a(l+1,+1)(xk+1)yk 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
    x1 x2 x3 x4 x5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
 f (yk, xk 1) = exp   a(l+1, 1)(xk 1)yk   
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
    y1 y2 y3 y4 y5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 f (yk, xk) = exp   a(l+1,0)(xk)yk   
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
    = p(yk|yk 1) = p(xk|yk)
    y1 y2 y3 y4 y5
 f (yk, xk+1) = exp   a(l+1,+1)(xk+1)yk   
 f (yk, yk+1) = exp vyk,yk+1 
    = p(yk+1|yk) = p(xk|yk)
 f (yk, yk+1) = exp vyk,yk+1 
    p(y|x) = exp   pk

     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 

k=1 a(l+1,0)(xk)yk +pk 1

c,i
c,i

c,i

c,i

c,i

c,i

c,i

2

2

15

     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1

k=1 1yk=c 1yk+1=c0   

id136

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    = p(yk|yk 1) = p(xk|yk)

topics: computing p(y|x) 
    for brevity, let   s assume this notation:
    p(y|x) = exp   pk
k=1 a(l+1,0)(xk)yk +pk 1

k=1 vyk,yk+1 +pk

k=2 a(l+1, 1)(xk 1)yk +pk 1

2

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1

k=1 ap(yk, yk+1)    /z(x)
    p(y|x) = exp   pk
k=1 au(yk) +pk 1
    then we have:
    ap(yk, yk+1) = 11   k<k vyk,yk+1
exp   pk
k=1 ap(y0k, y0k+1)   
k=1 au(y0k) +pk 1
    pz(x) =py01py02       py0k
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
where
exp   pk
    pz(x) =py01py02       py0k
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

16

k=1 ap(y0k, y0k+1)   

     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1

k=1 1yk=c 1yk+1=c0   

id136

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    = p(yk|yk 1) = p(xk|yk)

topics: computing p(y|x) 
    for brevity, let   s assume this notation:
    p(y|x) = exp   pk
k=1 a(l+1,0)(xk)yk +pk 1

k=1 vyk,yk+1 +pk

k=2 a(l+1, 1)(xk 1)yk +pk 1

2

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1

k=1 ap(yk, yk+1)    /z(x)
    p(y|x) = exp   pk
k=1 au(yk) +pk 1
    then we have:
    ap(yk, yk+1) = 11   k<k vyk,yk+1
exp   pk
k=1 ap(y0k, y0k+1)   
k=1 au(y0k) +pk 1
    pz(x) =py01py02       py0k
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
where
exp   pk
    pz(x) =py01py02       py0k
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

hard to compute

16

k=1 ap(y0k, y0k+1)   

exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1

id136

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

exp(au(y0k))

topics: computing p(y|x) 
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01

. . .

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y02) + ap(y02, y03))

exp(au(y01) + ap(y01, y02))1a1a . . .1a

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

exp(au(y0k))

     k(y0k 1) (=py0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
    z(x) (=py01
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

exp(au(y0k))

exp(au(y0k 1) + ap(y0k 1, y0k))

id136
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a

topics: computing p(y|x) 
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01
       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

exp(au(y02) + ap(y02, y03))

. . .

. . .

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y02) + ap(y02, y03))

exp(au(y01) + ap(y01, y02))1a1a . . .1a

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

. . .

exp(au(y0k))

exp(au(y0k))

exp(au(y0k))

exp(au(y0k 1) + ap(y0k 1, y0k))

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

     k(y0k 1) (=py0k
z(x) = xy0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
    z(x) (=py01
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
0@xy0k 1
id136
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a

topics: computing p(y|x) 
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01
       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y02) + ap(y02, y03))

exp(au(y02) + ap(y02, y03))

exp(au(y02) + ap(y02, y03))

. . .

. . .

3

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y01) + ap(y01, y02))1a1a . . .1a

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

. . .

exp(au(y0k))

exp(au(y0k))

exp(au(y0k))

exp(au(y02) + ap(y02, y03))

exp(au(y0k 1) + ap(y0k 1, y0k))

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

     k(y0k 1) (=py0k
z(x) = xy0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
    z(x) (=py01
0@xy02
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
0@xy0k 1
id136
z(x) = xy0k
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
0@xy0k 1
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a

topics: computing p(y|x) 
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01
       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y02) + ap(y02, y03))

exp(au(y02) + ap(y02, y03))

exp(au(y02) + ap(y02, y03))

. . .

. . .

3

3

       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y01) + ap(y01, y02))1a1a . . .1a

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

. . .

exp(au(y0k))

exp(au(y0k))

exp(au(y0k))

exp(au(y02) + ap(y02, y03))

exp(au(y0k 1) + ap(y0k 1, y0k))

     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y01)) 2(y01)

     k(y0k 1) (=py0k
z(x) = xy0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
    z(x) (=py01
0@xy02
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
0@xy0k 1
id136
z(x) = xy0k
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
0@xy0k 1
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
0@xy02
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a

topics: computing p(y|x) 
z(x) = xy0k
0@xy0k 1
0@xy02
0@xy01
       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y0k+1) + ap(y0k, y0k+1))    k+1(y0k+1)

exp(au(y02) + ap(y02, y03))

exp(au(y02) + ap(y02, y03))

exp(au(y02) + ap(y02, y03))

. . .

. . .

3

3

       1(y02)    2(y03)    k 1(y0k)
       k(y0k) =py0k+1

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y01) + ap(y01, y02))1a1a . . .1a

id136

nb. of classes
complexity in o(kc 2)

exp(au(y01) + ap(y01, y02)) y02

       k(y0k+1) (=py0k

topics: computing p(y|x) 
     algorithm goes as follows:
       1(y02) (=py01
    initialize, for all values of       : 
exp(au(y01) + ap(y01, y02)) y02
       1(y02) (=py01
       1(y02) (=py01
exp(au(y01) + ap(y01, y02)) y02
exp(au(y01) + ap(y01, y02)) y02
    for k = 2 to k-1, for all values of          :
       k(y0k+1) (=py0k
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
       1(y02) (=py01
       k(y0k+1) (=py0k
       k(y0k+1) (=py0k
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
    z(x) (=py0k
exp(au(y0k))    k 1(y0k)
       k(y0k+1) (=py0k
    z(x) (=py0k
exp(au(y0k))    k 1(y0k)
   
    z(x) (=py0k
       1(y02) (=py01
       1(y02) (=py01
exp(au(y0k))    k 1(y0k)
exp(au(y0k))    k 1(y0k)
    z(x) (=py0k
       k(y0k+1) (=py0k
       k(y0k+1) (=py0k
       k(1)    k 1(1)    k 1(2)    k 1(3)
       k(2)    k 1(1)    k 1(2)    k 1(3)
       1(y02) (=py01
       k(1)    k 1(1)    k 1(2)    k 1(3)
    z(x) (=py0k
    z(x) (=py0k
       k(y0k+1) (=py0k
    z(x) (=py0k

exp(au(y01) + ap(y01, y02)) y02
       k(1)    k 1(1)    k 1(2)    k 1(3)
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

exp(au(y01) + ap(y01, y02)) y02
       k(2)    k 1(1)    k 1(2)    k 1(3)

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

       k(2)    k 1(1)    k 1(2)    k 1(3)

       k(2)    k 1(1)    k 1(2)    k 1(3)

exp(au(y0k))    k 1(y0k)

exp(au(y0k))    k 1(y0k)

exp(au(y0k))    k 1(y0k)

exp(au(y01) + ap(y01, y02)) y02

 

-

       k(1)    k 1(1)    k 1(2)    k 1(3)

       k(2)    k 1(1)    k 1(2)    k 1(3)

exp(au(y01) + ap(y01, y02)) y02

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

exp(au(y0k))    k 1(y0k)

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y01) + ap(y01, y02)) y02

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

exp(au(y0k))    k 1(y0k)

    z(x) =py01py02       py0k

id136
k=1 ap(y0k, y0k+1)   

exp(au(y01))

k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
exp   pk
k=1 au(y0k) +pk 1
topics: computing p(y|x) 
z(x) = xy01
0@xy02
0@xy0k 1
0@xy0k

. . .

exp(au(y02) + ap(y01, y02))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

    z(x) =py01py02       py0k

   

k=1 ap(y0k, y0k+1)   

exp(au(y01))

exp(au(y01))

    ap(yk, yk+1) = 11   k<k vyk,yk+1

k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
id136
k=1 ap(y0k, y0k+1)   
exp   pk
exp   pk
k=1 au(y0k) +pk 1
k=1 au(y0k) +pk 1
    z(x) =py01py02       py0k
topics: computing p(y|x) 
z(x) = xy01
z(x) = xy01
0@xy02
0@xy02
0@xy0k 1
0@xy0k
0@xy0k 1
0@xy0k
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y02) + ap(y01, y02))

. . .

exp(au(y02) + ap(y01, y02))

. . .

z(x) = xy0k

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

    z(x) =py01py02       py0k

   

. . .

exp(au(y01))

exp(au(y01))

k=1 ap(y0k, y0k+1)   

    ap(yk, yk+1) = 11   k<k vyk,yk+1

exp(au(y02) + ap(y01, y02))
exp(au(y01))

k=1 ap(y0k, y0k+1)   
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
id136
z(x) = xy01
exp   pk
k=1 ap(y0k, y0k+1)   
exp   pk
k=1 au(y0k) +pk 1
k=1 au(y0k) +pk 1
    z(x) =py01py02       py0k
0@xy02
topics: computing p(y|x) 
z(x) = xy01
z(x) = xy01
0@xy02
0@xy02
0@xy0k 1
0@xy0k
0@xy0k 1
0@xy0k
0@xy0k 1
z(x) = xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k
0@xy0k 1
exp(au(y0k 1) + ap(y0k 1, y0k))
z(x) = xy0k

     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y02) + ap(y01, y02))

exp(au(y02) + ap(y01, y02))

. . .

. . .

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

    z(x) =py01py02       py0k

     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k

   

. . .

. . .

exp(au(y01))

exp(au(y01))

k=1 ap(y0k, y0k+1)   

    ap(yk, yk+1) = 11   k<k vyk,yk+1

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y02) + ap(y01, y02))
exp(au(y01))

0@xy02
k=1 ap(y0k, y0k+1)   
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
id136
z(x) = xy01
0@xy0k 1
exp   pk
k=1 ap(y0k, y0k+1)   
exp   pk
k=1 au(y0k) +pk 1
k=1 au(y0k) +pk 1
    z(x) =py01py02       py0k
0@xy02
topics: computing p(y|x) 
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
z(x) = xy01
z(x) = xy01
0@xy02
0@xy02
0@xy0k 1
0@xy0k
z(x) = xy0k
0@xy0k 1
0@xy0k 1
0@xy0k
0@xy0k 1
z(x) = xy0k
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy02
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k
0@xy0k 1
exp(au(y0k 1) + ap(y0k 1, y0k))
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
z(x) = xy0k

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))
exp(au(y02) + ap(y02, y03))

exp(au(y0k 1) + ap(y0k 1, y0k))
exp(au(y0k 1) + ap(y0k 2, y0k 1))

     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k
. . .

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y02) + ap(y01, y02))

exp(au(y02) + ap(y01, y02))

. . .

. . .

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

    z(x) =py01py02       py0k

     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k

   

. . .

. . .

exp(au(y01))

exp(au(y01))

k=1 ap(y0k, y0k+1)   

    ap(yk, yk+1) = 11   k<k vyk,yk+1

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y02) + ap(y01, y02))
exp(au(y01))

0@xy02
k=1 ap(y0k, y0k+1)   
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
id136
z(x) = xy01
0@xy0k 1
exp   pk
k=1 ap(y0k, y0k+1)   
exp   pk
k=1 au(y0k) +pk 1
k=1 au(y0k) +pk 1
    z(x) =py01py02       py0k
0@xy02
topics: computing p(y|x) 
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
z(x) = xy01
z(x) = xy01
0@xy02
0@xy02
0@xy0k 1
0@xy0k
z(x) = xy0k
0@xy0k 1
0@xy0k 1
0@xy0k
0@xy0k 1
z(x) = xy0k
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy02
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k
0@xy0k 1
exp(au(y0k 1) + ap(y0k 1, y0k))
0@xy01
exp(au(y01) + ap(y01, y02))1a1a . . .1a
z(x) = xy0k

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))
exp(au(y02) + ap(y02, y03))

exp(au(y0k 1) + ap(y0k 1, y0k))
exp(au(y0k 1) + ap(y0k 2, y0k 1))

     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) =py0k
. . .

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k)
exp(au(y0k))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y02) + ap(y01, y02))

exp(au(y02) + ap(y01, y02))

. . .

. . .

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a

     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) (=py0k

 
exp(au(y01)) 2(y01)

-

   

. . .

. . .
. . .

exp(au(y01))

exp(au(y01))

exp(au(y02) + ap(y01, y02))

exp(au(y02) + ap(y01, y02))

exp(au(y02) + ap(y01, y02))
exp(au(y02) + ap(y01, y02))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

nb. of classes
complexity in o(kc 2)

0@xy0k 1
exp   pk
k=1 ap(y0k, y0k+1)   
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1
0@xy02
z(x) = xy01
0@xy02
0@xy0k 1
0@xy0k 1
0@xy0k 1
0@xy0k 1
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
exp(au(y0k 1) + ap(y0k 2, y0k 1))
exp(au(y0k 1) + ap(y0k 2, y0k 1))
z(x) = xy01
exp(au(y0k 1) + ap(y0k 2, y0k 1))
0@xy02
id136
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy02
topics: computing p(y|x) 
0@xy0k 1
0@xy0k 1
     algorithm goes as follows:
0@xy0k 1
     k(y0k 1)  k 1(y0k 2)  2(y01)
. . .
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) (=py0k
0@xy0k
    initialize, for all values of         : 
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
0@xy0k 1
     k(y0k 1) (=py0k
     k(y0k 1) (=py0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
    for k = k-1 to 2, for all values of           :
     k(y0k 1) (=py0k
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
     k(y0k 1) (=py0k
     k(y0k 1) (=py0k
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
    z(x) (=py01
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
exp(au(y0k) + ap(y0k 1, y0k))1a1a . . .1a
0@xy0k
exp(au(y01)) 2(y01)
exp(au(y01)) 2(y01)
     k(y0k 1)  k 1(y0k 2)  2(y01)
    z(x) (=py01
    z(x) (=py01
     k(y0k 1) (=py0k
z(x) = xy0k
z(x) = xy0k
exp(au(y01)) 2(y01)
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
     k(y0k 1)  k 1(y0k 2)  2(y01)
z(x) = xy0k
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) (=py0k
z(x) = xy0k
     k(y0k 1) (=py0k
z(x) = xy0k
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
     k(y0k 1) (=py0k
exp(au(y0k))
0@xy0k 1
0@xy0k 1
     k(y0k 1)  k 1(y0k 2)  2(y01)
     k(y0k 1) (=py0k
0@xy0k 1
     k(1)  k+1(1)  k+1(2)  k+1(3)
     k(y0k 1) (=py0k
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
exp(au(y0k 1) + ap(y0k 1, y0k))
0@xy0k 1
     k(y0k 1) (=py0k
0@xy0k 1
    z(x) (=py01
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
exp(au(y01)) 2(y01)
exp(au(y0k 1) + ap(y0k 1, y0k))
exp(au(y0k 1) + ap(y0k 1, y0k))
     k(y0k 1) (=py0k
     k(2)  k+1(1)  k+1(2)  k+1(3)
     k(1)  k+1(1)  k+1(2)  k+1(3)
exp(au(y0k 1) + ap(y0k 1, y0k))
z(x) = xy0k
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1
    z(x) (=py01
exp(au(y0k))
    z(x) (=py01
exp(au(y01)) 2(y01)
. . .
exp(au(y01)) 2(y01)
     k(1)  k+1(1)  k+1(2)  k+1(3)
z(x) = xy0k
0@xy0k 1
0@xy02
    z(x) (=py01
0@xy02
z(x) = xy0k
. . .
exp(au(y01)) 2(y01)
z(x) = xy0k

exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1

exp(au(y0k))
exp(au(y0k) + ap(y0k 1, y0k)) y0k 1
exp(au(y0k) + ap(y0k 1, y0k))  k+1(y0k) y0k 1

exp(au(y01)) 2(y01)
exp(au(y0k))
exp(au(y0k))

exp(au(y0k 1) + ap(y0k 1, y0k))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

exp(au(y0k 1) + ap(y0k 2, y0k 1))

. . .
exp(au(y02) + ap(y02, y03))

exp(au(y0k))
exp(au(y02) + ap(y02, y03))

exp(au(y0k))

exp(au(y0k))

. . .

. . .

   

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

exp(au(y01) + ap(y01, y02)) y02
exp(au(y01) + ap(y01, y02)) y02
id136
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y0k))    k 1(y0k)
topics: forward/backward or belief propagation
exp(au(y0k))    k 1(y0k)
    computing both tables is often referred to as the forward/
       k(2)    k 1(1)    k 1(2)    k 1(3)
backward algorithm for crfs
exp(au(y01) + ap(y01, y02)) y02
       k(2)    k 1(1)    k 1(2)    k 1(3)
         is computed with a forward pass
         
         is computed with a backward pass
         
    it has other names

       1(y02) (=py01
       1(y02) (=py01
       k(y0k+1) (=py0k
       k(y0k+1) (=py0k
    z(x) (=py0k
    z(x) (=py0k
       1(y02) (=py01
       1(y02) (=py01
       k(y0k+1) (=py0k
       k(y0k+1) (=py0k
    z(x) (=py0k
    z(x) (=py0k

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y0k))    k 1(y0k)

    belief propagation
       k(2)    k 1(1)    k 1(2)    k 1(3)
    sum-product
       k(2)    k 1(1)    k 1(2)    k 1(3)
         gives the summation from the left
         
         gives the summation from the right
         

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

exp(au(y0k))    k 1(y0k)

exp(au(y01) + ap(y01, y02)) y02

21

exp(au(y0k))    k 1(y0k)

exp(au(y0k))    k 1(y0k)

exp(au(y0k))    k 1(y0k)
exp(au(y01) + ap(y01, y02)) y02

       k(y0k+1) (=py0k
    z(x) (=py0k
       1(y02) (=py01
       1(y02) (=py01
       k(y0k+1) (=py0k
       k(2)    k 1(1)    k 1(2)    k 1(3)
       k(y0k+1) (=py0k
topics: stable implementation of belief propagation
         
    z(x) (=py0k
    z(x) (=py0k
    for a stable implementation, should work in log space
    log  k(y0k 1) (= logpy0k
       k(2)    k 1(1)    k 1(2)    k 1(3)
    log    k(y0k+1) (= logpy0k
       k(2)    k 1(1)    k 1(2)    k 1(3)
         
    logpi exp(zi) = maxi(zi) + logpi exp(zi   maxi(zi))
         
    log  k(y0k 1) (= logpy0k
    log  k(y0k 1) (= logpy0k
    log    k(y0k+1) (= logpy0k
    log    k(y0k+1) (= logpy0k
    logpi exp(zi) = maxi(zi) + logpi exp(zi   maxi(zi))
    logpi exp(zi) = maxi(zi) + logpi exp(zi   maxi(zi))

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
id136
exp(au(y01) + ap(y01, y02)) y02
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp au(y0k) + ap(y0k 1, y0k) + log  k+1(y0k) 
exp au(y0k) + ap(y0k, y0k+1) + log    k 1(y0k) 
exp au(y0k) + ap(y0k 1, y0k) + log  k+1(y0k) 
exp au(y0k) + ap(y0k 1, y0k) + log  k+1(y0k) 
exp au(y0k) + ap(y0k, y0k+1) + log    k 1(y0k) 
exp au(y0k) + ap(y0k, y0k+1) + log    k 1(y0k) 

    log-sum-exp operations are more stable if computed like this:

(
t
)

(
t
)

y

{
x

}

   

)

(

,

numerically stable

   

22

exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1

       k(2)    k 1(1)    k 1(2)    k 1(3)

       1(y02) (=py01
       1(y02) (=py01
       k(y0k+1) (=py0k
       k(y0k+1) (=py0k
    z(x) (=py0k
    z(x) (=py0k
id136
exp au(y0k) + ap(y0k 1, y0k) + log  k+1(y0k) 
exp au(y0k) + ap(y0k 1, y0k) + log  k+1(y0k) 
exp au(y0k) + ap(y0k, y0k+1) + log    k 1(y0k) 
exp au(y0k) + ap(y0k, y0k+1) + log    k 1(y0k) 
topics: computing p(yk|x), p(yk, yk+1|x)
       k(2)    k 1(1)    k 1(2)    k 1(3)
       k(2)    k 1(1)    k 1(2)    k 1(3)
    the    /    tables can be used to compute marginals
         
         
p(yk|x) =
p(yk|x) =

    log  k(y0k 1) (= logpy0k
    log  k(y0k 1) (= logpy0k
    log    k(y0k+1) (= logpy0k
    log    k(y0k+1) (= logpy0k
    logpi exp(zi) = maxi(zi) + logpi exp(zi   maxi(zi))
    logpi exp(zi) = maxi(zi) + logpi exp(zi   maxi(zi))

exp(au(y0k))    k 1(y0k)
exp(au(y0k))    k 1(y0k)

exp(au(yk) + log    k 1(yk) + log  k+1(yk))
exp(au(yk) + log    k 1(yk) + log  k+1(yk))
exp(au(y0k) + log    k 1(y0k) + log  k+1(y0k))
exp(au(y0k) + log    k 1(y0k) + log  k+1(y0k))

py0k
py0k

p(yk, yk+1|x) =

exp    au(yk) + ap(yk, yk+1) + au(yk+1)
+ log    k 1(yk) + log  k+2(yk+1)    
exp    au(y0k) + ap(y0k, y0k+1) + au(y0k+1)
+ log    k 1(y0k) + log  k+2(y0k+1)    

py0kpy0k+1

23

py0k

   

id136
p(yk, yk+1|x) =
    yk p(yk|x)

topics: making a prediction (option 1)
    at each position k, pick label       with highest marginal 
id203
    this choice is the one that minimizes the sum of the classi   cation errors over the 

py0kpy0k+1

    yk p(yk|x)

whole sequence, assuming the crf is the true distribution

exp    au(yk) + ap(yk, yk+1) + au(yk+1)
+ log    k 1(yk) + log  k+2(yk+1)    
p(yk, yk+1|x) =
exp    au(y0k) + ap(y0k, y0k+1) + au(y0k+1)

24

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

1yk6=y   k! p(y|x)

min
y   

= min

. . . min

1yk6=y   k! p(y|x)
      xyk  xk
      xyk
1yk6=y   k xy1

e"xk
1yk6=y   k#
      xyk  xk
y    xy1
y   k xy1
y   k xk xy1
y   k xk xyk
y   k xk xyk
1y16=y   1 p(y1|x)! +        + min

p(yk|x)

1yk6=y   k

1yk6=y   k

y   1  xy1

. . . min

. . . min

. . . min

= min
y   1

= min
y   1

= min
y   1

= min
y   1

= min

= min
y   1

(1   p(y   1|x)) +        + min
y   k

= 1   max
y   1

p(y   1|x) +        + 1   max
y   k

      xyk 1xyk+1xyk
y   k  xyk

(1   p(y   k|x))
p(y   k|x)

p(y|x)

p(y|x)

1yk6=y   k p(yk|x)!

25

= 1   max
y   1

(1   p(y   1|x)) +        + min
y   k

p(y   1|x) +        + 1   max
y   k
topics: making a prediction (option 2)
     find most probable prediction:

    logpy0k
(1   p(y   k|x))
    a(1,0)(xk) = b(1) + w(1,0)xk
id136
    a(1, 1)(xk) = w(1, 1)xk
p(y   k|x)
    a(1,+1)(xk) = w(1,+1)xk
          1(y02) (= maxy01
        1 (y02) (= arg maxy01
          k(y0k+1) (= maxy0k
        k (y0k+1) (= arg maxy0k
    maxy    p(y|x) (= maxy0k
    forward pass: replace                              by                    and    ll the table
    backward pass: starting from the maximal value       at the last position,
    y   k (= arg maxy0k
    y   k (=       k(y   k+1)

follow the backward trace of the max operations to decode the maximizing 
sequence

    a viterbi decoding algorithm can be used for that

    logpy0k
    logpy0k

(  )
exp(  ) maxy0k
exp(  ) maxy0k
(  )

p(y|x)

arg max

y   

4

au(y01) + ap(y01, y02) y02

au(y01) + ap(y01, y02) y02
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1

au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
au(y0k) +       k 1(y0k)

au(y0k) +       k 1(y0k)

26

]

    x(t) = [x(t)
1 ,...,x(t)
kt
    logpy0k
    logpy0k
id136
exp(  ) maxy0k
(  )
exp(  ) maxy0k
(  )
    logpy0k
    logpy0k
(  )
exp(  ) maxy0k
    logpy0k
    logpy0k
    kt
(  )
exp(  ) maxy0k
    logpy0k
(  )
exp(  ) maxy0k
    a(1,0)(xk) = b(1) + w(1,0)xk
exp(  ) maxy0k
(  )
    a(1,0)(xk) = b(1) + w(1,0)xk
exp(  ) maxy0k
(  )
topics: making a prediction (option 2) 
    a(1,0)(xk) = b(1) + w(1,0)xk
    a(1,0)(xk) = b(1) + w(1,0)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1,0)(xk) = b(1) + w(1,0)xk
    a(1,0)(xk) = b(1) + w(1,0)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1,0)(xk) = b(1) + w(1,0)xk
     algorithm goes as follows:
    a(1, 1)(xk) = w(1, 1)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1,+1)(xk) = w(1,+1)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1,+1)(xk) = w(1,+1)xk
    x(t)
    initialize, for all values of       : 
exp(au(y01) + ap(y01, y02)) y02
    a(1,+1)(xk) = w(1,+1)xk
    a(1,+1)(xk) = w(1,+1)xk
    a(1,+1)(xk) = w(1,+1)xk
    a(1,+1)(xk) = w(1,+1)xk
          1(y02) (= maxy01
au(y01) + ap(y01, y02) y02
    a(1,+1)(xk) = w(1,+1)xk
          1(y02) (= maxy01
au(y01) + ap(y01, y02) y02
 
-
          1(y02) (= maxy01
au(y01) + ap(y01, y02) y02
          1(y02) (= maxy01
k
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
au(y01) + ap(y01, y02) y02
          1(y02) (= maxy01
exp(au(y01) + ap(y01, y02)) y02
au(y01) + ap(y01, y02) y02
          1(y02) (= maxy01
        1 (y02) (= arg maxy01
au(y01) + ap(y01, y02) y02
 
-
au(y01) + ap(y01, y02) y02
          1(y02) (= maxy01
        1 (y02) (= arg maxy01
au(y01) + ap(y01, y02) y02
au(y01) + ap(y01, y02) y02
        1 (y02) (= arg maxy01
        1 (y02) (= arg maxy01
au(y01) + ap(y01, y02) y02
        1 (y02) (= arg maxy01
    for k = 2 to k-1, for all values of          :
au(y01) + ap(y01, y02) y02
        1 (y02) (= arg maxy01
exp(au(y0k) + ap(y0k, y0k+1))    k 1(y0k) y0k+1
exp(au(y0k))    k 1(y0k)
        1 (y02) (= arg maxy01
au(y01) + ap(y01, y02) y02
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
          k(y0k+1) (= maxy0k
          k(y0k+1) (= maxy0k
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
          k(y0k+1) (= maxy0k
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
          k(y0k+1) (= maxy0k
          k(y0k+1) (= maxy0k
 
    (x,y)
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
          k(y0k+1) (= maxy0k
-
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
          k(y0k+1) (= maxy0k
        k (y0k+1) (= arg maxy0k
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
        k (y0k+1) (= arg maxy0k
        k (y0k+1) (= arg maxy0k
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
 
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
        k (y0k+1) (= arg maxy0k
-
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
        k (y0k+1) (= arg maxy0k
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
        k (y0k+1) (= arg maxy0k
        k (y0k+1) (= arg maxy0k
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1
     
       k(1)    k 1(1)    k 1(2)    k 1(3)
au(y0k)) + log       k 1(y0k)
    maxy    p(y|x) (= maxy0k
au(y0k) +       k 1(y0k)
    maxy    p(y|x) (= maxy0k
au(y0k)) + log       k 1(y0k)
au(y0k)) + log       k 1(y0k)
    maxy    p(y|x) (= maxy0k
    maxy    p(y|x) (= maxy0k
au(y0k)) + log       k 1(y0k)
au(y0k) +       k 1(y0k)
    maxy    p(y|x) (= maxy0k
    maxy    p(y|x) (= maxy0k
au(y0k) +       k 1(y0k)
    maxy    p(y|x) (= maxy0k
    y   k (= maxy0k
au(y0k)) + log       k 1(y0k)
au(y0k) +       k 1(y0k)
    y   k (= maxy0k
    y   k (= maxy0k
au(y0k)) + log       k 1(y0k)
au(y0k)) + log       k 1(y0k)
    y   k (= maxy0k
    {(x(t),y(t))}
    y   k (= maxy0k
au(y0k)) + log       k 1(y0k)
au(y0k) +       k 1(y0k)
    y   k (= arg maxy0k
     
    y   k (= arg maxy0k
au(y0k) +       k 1(y0k)
backward decoding
    y   k (=       k(y   k+1)
    y   k (=       k(y   k+1)
    y   k (=       k(y   k+1)
    y   k (=       k(y   k+1)
    y   k (=       k(y   k+1)
    for k = k-1 to 1:
    y   k (=     k (y   k+1)
    y   k (=       k(y   k+1)

au(y01) + ap(y01, y02) y02
au(y0k) + ap(y0k, y0k+1) +       k 1(y0k) y0k+1

nb. of classes
complexity in o(kc 2)

       k(y0k+1) (=py0k

exp(au(y0k))    k 1(y0k)
       k(1)    k 1(1)    k 1(2)    k 1(3)

au(y01) + ap(y01, y02) y02

conclusion
    we have seen to de   ne a distribution over a whole target 
sequence and do id136 with this distribution
    next class, we will see how id136 is a subroutine required by stochastic 

id119 training

    similar to forward propagation being required by backward propagation

    we have focused on a simple type of crf, with a linear chain 
structure
    next class, we will discuss more general types of crfs, with possibly arbitrary 

structure

28

assignment 2
     you must implement a linear chain crf without 
hidden units (l=0):
    logpy0k
(  )
    lateral connections between adjacent class labels only
    radius of size 1 for the context window
    maxy    p(y|x) (= maxy0k
    a(1,0)(xk) = b(1) + w(1,0)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1,+1)(xk) = w(1,+1)xk

exp(  ) maxy0k

au(y0k)) + log    k 1(y0k)

    to predict the label, you can use either option 1 (prediction 
from marginals) or option 2 (viterbi)
    or try both and see which one works best!

29

