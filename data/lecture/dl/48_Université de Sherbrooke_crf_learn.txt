training crfs
ift 725 - r  seaux neuronaux

training crfs
linear chain crf

training crfs

training crfs
review
training crfs
hugo larochelle
d  epartement d   informatique
universit  e de sherbrooke
hugo.larochelle@usherbrooke.ca
d  epartement d   informatique
universit  e de sherbrooke
september 26, 2012

hugo larochelle

hugo.larochelle@usherbrooke.ca

hugo larochelle

hugo larochelle

d  epartement d   informatique
universit  e de sherbrooke

topics: reminder of notation 
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    then we have:
d  epartement d   informatique
    p(y|x) = exp   pk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
universit  e de sherbrooke
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
hugo.larochelle@usherbrooke.ca
where
exp   pk
    pz(x) =py01py02       py0k
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

k=1 ap(yk, yk+1)    /z(x)
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   

september 26, 2012
    two types of (log-)factors:

hugo.larochelle@usherbrooke.ca

september 26, 2012

abstract

abstract

september 26, 2012

k=1 ap(y0k, y0k+1)   

abstract

math for my slides    training crfs   .

    unary:

math for my slides    training crfs   .
abstract
math for my slides    training crfs   .

math for my slides    training crfs   .

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1

    pairwise:

2

training crfs
linear chain crf

training crfs

training crfs
review
training crfs
hugo larochelle
d  epartement d   informatique
universit  e de sherbrooke
hugo.larochelle@usherbrooke.ca
d  epartement d   informatique
universit  e de sherbrooke
september 26, 2012

hugo larochelle

hugo.larochelle@usherbrooke.ca

hugo larochelle

hugo larochelle

d  epartement d   informatique
universit  e de sherbrooke

topics: reminder of notation 
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    then we have:
d  epartement d   informatique
    p(y|x) = exp   pk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
universit  e de sherbrooke
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
hugo.larochelle@usherbrooke.ca
where
exp   pk
    pz(x) =py01py02       py0k
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

k=1 ap(yk, yk+1)    /z(x)
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   

september 26, 2012
    two types of (log-)factors:

hugo.larochelle@usherbrooke.ca

september 26, 2012

abstract

abstract

september 26, 2012

k=1 ap(y0k, y0k+1)   

math for my slides    training crfs   .

    unary:

math for my slides    training crfs   .

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1

are xk and yk compatible
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1

    pairwise:

abstract

math for my slides    training crfs   .
abstract
math for my slides    training crfs   .

2

training crfs
linear chain crf

training crfs

training crfs
review
training crfs
hugo larochelle
d  epartement d   informatique
universit  e de sherbrooke
hugo.larochelle@usherbrooke.ca
d  epartement d   informatique
universit  e de sherbrooke
september 26, 2012

hugo larochelle

hugo.larochelle@usherbrooke.ca

hugo larochelle

hugo larochelle

d  epartement d   informatique
universit  e de sherbrooke

topics: reminder of notation 
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    then we have:
d  epartement d   informatique
    p(y|x) = exp   pk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
universit  e de sherbrooke
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
hugo.larochelle@usherbrooke.ca
where
exp   pk
    pz(x) =py01py02       py0k
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

k=1 ap(yk, yk+1)    /z(x)
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   

september 26, 2012
    two types of (log-)factors:

hugo.larochelle@usherbrooke.ca

september 26, 2012

abstract

abstract

september 26, 2012

k=1 ap(y0k, y0k+1)   

math for my slides    training crfs   .

    unary:

math for my slides    training crfs   .

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1

are xk and yk compatible
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
are xk-1 and yk compatible
    ap(yk, yk+1) = 11   k<k vyk,yk+1

    pairwise:

abstract

math for my slides    training crfs   .
abstract
math for my slides    training crfs   .

2

training crfs
linear chain crf

training crfs

training crfs
review
training crfs
hugo larochelle
d  epartement d   informatique
universit  e de sherbrooke
hugo.larochelle@usherbrooke.ca
d  epartement d   informatique
universit  e de sherbrooke
september 26, 2012

hugo larochelle

hugo.larochelle@usherbrooke.ca

hugo larochelle

hugo larochelle

d  epartement d   informatique
universit  e de sherbrooke

topics: reminder of notation 
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    then we have:
d  epartement d   informatique
    p(y|x) = exp   pk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
universit  e de sherbrooke
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
hugo.larochelle@usherbrooke.ca
where
exp   pk
    pz(x) =py01py02       py0k
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

k=1 ap(yk, yk+1)    /z(x)
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   

september 26, 2012
    two types of (log-)factors:

hugo.larochelle@usherbrooke.ca

september 26, 2012

abstract

abstract

september 26, 2012

k=1 ap(y0k, y0k+1)   

math for my slides    training crfs   .

    unary:

math for my slides    training crfs   .

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1

are xk and yk compatible
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
are xk-1 and yk compatible
are xk+1 and yk compatible
    ap(yk, yk+1) = 11   k<k vyk,yk+1

    pairwise:

abstract

math for my slides    training crfs   .
abstract
math for my slides    training crfs   .

2

training crfs
linear chain crf

training crfs

training crfs
review
training crfs
hugo larochelle
d  epartement d   informatique
universit  e de sherbrooke
hugo.larochelle@usherbrooke.ca
d  epartement d   informatique
universit  e de sherbrooke
september 26, 2012

hugo larochelle

hugo.larochelle@usherbrooke.ca

hugo larochelle

hugo larochelle

d  epartement d   informatique
universit  e de sherbrooke

topics: reminder of notation 
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    then we have:
d  epartement d   informatique
    p(y|x) = exp   pk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 au(yk) +pk 1
universit  e de sherbrooke
    p(y|x) = exp   pk
k=1 ap(yk, yk+1)    /z(x)
k=1 au(yk) +pk 1
hugo.larochelle@usherbrooke.ca
where
exp   pk
    pz(x) =py01py02       py0k
exp   pk
    z(x) =py01py02       py0k
k=1 au(y0k) +pk 1

k=1 ap(yk, yk+1)    /z(x)
k=1 au(y0k) +pk 1
k=1 ap(y0k, y0k+1)   

september 26, 2012
    two types of (log-)factors:

hugo.larochelle@usherbrooke.ca

september 26, 2012

abstract

abstract

september 26, 2012

k=1 ap(y0k, y0k+1)   

math for my slides    training crfs   .

    unary:

math for my slides    training crfs   .

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1

are xk and yk compatible
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
are xk-1 and yk compatible
are xk+1 and yk compatible
    ap(yk, yk+1) = 11   k<k vyk,yk+1
are yk and yk+1 compatible

    pairwise:

abstract

math for my slides    training crfs   .
abstract
math for my slides    training crfs   .

2

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
review
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    random variables that are connected share at least one factor
    each maximal clique in the network corresponds to a factor
2

2

3

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
review
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

math for my slides    training crfs   .

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    random variables that are connected share at least one factor
    each maximal clique in the network corresponds to a factor
2

2

3

topics: markov network
    illustration for k=5 

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

universit  e de sherbrooke

c
hugo.larochelle@usherbrooke.ca

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
review
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    random variables that are connected share at least one factor
    each maximal clique in the network corresponds to a factor
2

2

3

topics: markov network
    illustration for k=5 

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

universit  e de sherbrooke

hugo.larochelle@usherbrooke.ca

c
hugo.larochelle@usherbrooke.ca

d  epartement d   informatique
universit  e de sherbrooke
c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
hugo larochelle
review
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
september 26, 2012
pk
pk
pk
= observed
c,i
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
math for my slides    training crfs   .
abstract
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    random variables that are connected share at least one factor
    each maximal clique in the network corresponds to a factor
2

2

3

c

c

c

c

c,i
c,i

universit  e de sherbrooke

hugo.larochelle@usherbrooke.ca

hugo.larochelle@usherbrooke.ca

c
hugo.larochelle@usherbrooke.ca

topics: markov network
    illustration for k=5 

d  epartement d   informatique
c,i
universit  e de sherbrooke
c,i

d  epartement d   informatique
hugo larochelle
universit  e de sherbrooke
c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
hugo larochelle
review
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
september 26, 2012
pk
pk
pk
= observed
september 26, 2012
c,i
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
math for my slides    training crfs   .
abstract
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
math for my slides    training crfs   .
abstract
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i
c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    random variables that are connected share at least one factor
    each maximal clique in the network corresponds to a factor
2

2

3

abstract

review

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)

t pt(x(t)  b  )(x(t)  b  )>
machine learning

t b    = 1
    training set: dtrain = {(x(t), y(t))}
machine learning
    f (x;    )
    supervised learning example: (x, y) x y
math for my slides    training crfs   .
    dvalid dtest
    training set: dtrain = {(x(t), y(t))}
topics: empirical risk minimization, id173
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
   
    f (x;    )
    empirical risk minimization
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    dvalid dtest
    framework to design learning algorithms
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
   
   

    l(f (x(t);    ), y(t))
1
l(f (x(t);    ), y(t)) +     (   )
t xt
l(f (x(t);    ), y(t)) +     (   )
arg min
       (   )
t pt r   l(f (x(t);    ), y(t))    r      (   )
      =   1
    l(f (x(t);    ), y(t))
                                  is a id168
    l(f (x(t);    ), y(t))
               is a regularizer (penalizes certain values of     )
              +  
       (   )
      =  r   l(f (x(t);    ), y(t))    r      (   )
    learning is cast as optimization
      =  r   l(f (x(t);    ), y(t))    r      (   )
    (x(t), y(t))
    ideally, we   d optimize classi   cation error, but it   s not smooth
    l(f (x(t);    ), y(t))
    id168 is a surrogate for what we truly should optimize
    r   l(f (x(t);    ), y(t))

t xt

l(f (x(t);    ), y(t)) +     (   )

t xt

t xt

arg min

1
arg min

arg min

1

   

1

   

   

   

4

   

arg min

math for my slides    training crfs   .

t xt

abstract
math for my slides    training crfs   .

abstract
review
hugo larochelle

hugo.larochelle@usherbrooke.ca

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
math for my slides    training crfs   .
machine learning
d  epartement d   informatique
    l(f (x(t);    ), y(t))
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
universit  e de sherbrooke
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
hugo.larochelle@usherbrooke.ca
       (   )
topics: stochastic id119 (sgd)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
   
t xt
t pt r   l(f (x(t);    ), y(t))    r      (   )
1
l(f (x(t);    ), y(t)) +     (   )
l(f (x(t);    ), y(t)) +     (   )
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
arg min
      =   1
    algorithm that performs updates after each example
september 13, 2012
   
    initialize     
              +  
t xt
1
    for n iterations

    9w,t    x(t   ) =pt6=t    wtx(t)
    r(x) ={x2rh|9w x =pj wjx  ,j}
    {x2rh| x /2r(x)}
    { i,ui| xui =  iui et u>i uj = 1i=j}

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1
   
1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
   
   
t xt
    l(f (x(t);    ), y(t))
    l(f (x(t);    ), y(t))
arg min
      =  r   l(f (x(t);    ), y(t))    r      (   )
math for my slides    feedforward neural network   .
       (   )
    l(f (x(t);    ), y(t))
for each training example
    (x(t), y(t))
t pt r   l(f (x(t);    ), y(t))    r      (   )
    l(f (x(t);    ), y(t))
training epoch 
    l(f (x(t);    ), y(t))
      =   1
    f (x)
     
=
      =  r   l(f (x(t);    ), y(t))    r      (   )
    l(f (x(t);    ), y(t))
      =  r   l(f (x(t);    ), y(t))    r      (   )
iteration over all examples
      =  r   l(f (x(t);    ), y(t))    r      (   )
     
              +      
    (x(t), y(t))
    f (x)
    l(f (x(t);    ), y(t))
    r   l(f (x(t);    ), y(t))
    to apply this algorithm to a crf, we need
    (x(t), y(t))
    (x(t), y(t))
    {x 2 rd | rxf (x) = 0}
    l(f (x(t);    ), y(t))
    l(f (x(t);    ), y(t))
    r   l(f (x(t);    ), y(t))
    the id168
    l(f (x(t);    ), y(t))
    l(f (x(t);    ), y(t))
    r   l(f (x(t);    ), y(t))
    v>r2
xf (x)v > 0 8v
    r   l(f (x(t);    ), y(t))
       (   )
    a procedure to compute the parameter gradients
    r   l(f (x(t);    ), y(t))
    r   l(f (x(t);    ), y(t))
    v>r2
xf (x)v < 0 8v
    the regularizer             (and the gradient                 )
    r      (   )
       (   )
5
      =  r   l(f (x(t);    ), y(t))    r      (   )
    initialization method
    f (x)c = p(y = c|x)
    r      (   )
    (x(t), y(t))

math for my slides    feedforward neural network   .

l(f (x(t);    ), y(t)) +     (   )

l(f (x(t);    ), y(t)) +     (   )

t xt

abstract

arg min

1

   

   

5

   

   

-

1

arg min

t xt
      =  r   l(f (x(t);    ), y(t))    r      (   )
    l(f (x(t);    ), y(t))
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    ap(yk, yk+1) = 11   k<k vyk,yk+1
      =  r   l(f (x(t);    ), y(t))    r      (   )
    (x(t), y(t))
      =  r   l(f (x(t);    ), y(t))    r      (   )
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
id168
    l(f (x(t);    ), y(t))
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    (x(t), y(t))
    l(f (x(t);    ), y(t))
    (x(t), y(t))
t xt
   
      =  r   l(f (x(t);    ), y(t))    r      (   )
    l(f (x(t);    ), y(t))
topics: id168 for sequential classi   cation with crf
t xt
    l(f (x(t);    ), y(t))
    r   l(f (x(t);    ), y(t))
l(f (x(t);    ), y(t)) +     (   )
arg min
    crf estimates
    r   l(f (x(t);    ), y(t))
    r   l(f (x(t);    ), y(t))
    p(y|x) l(f (x), y) =   log p(y|x)
    (x(t), y(t))
    we could maximize the probabilities of         given          in the training set
    p(y|x) y(t) x(t)
    p(y|x) y(t) x(t)
    l(f (x(t);    ), y(t))
    l(f (x(t);    ), y(t))
      =  r   l(f (x(t);    ), y(t))    r      (   )
      =  r   l(f (x(t);    ), y(t))    r      (   )
    to frame as minimization, we minimize the 
negative log-likelihood
    r   l(f (x(t);    ), y(t))
    (x(t), y(t))
    l(f (x(t);    ), y(t))
    p(y|x) y(t) x(t)
    r   l(f (x(t);    ), y(t))
    unlike for non-sequential classi   cation, we never explicitly compute the value of
@   log p(y|x)
               for all values of 
    p(y|x) l(f (x), y) =   log p(y|x)
l(f (x), y) =   log p(y|x) y
@au(yk)
@   log p(y|x)

l(f (x), y) =   log p(y|x)
@au(yk)
@   log p(y|x)

l(f (x), y) =   log p(y|x)

l(f (x), y) =   log p(y|x)

l(f (x(t);    ), y(t)) +     (   )

@   log p(y|x)

=

=

1

   

   

6

@   log p(y|x)

=

@au(yk)

@au(yk)

      =  r   l(f (x(t);    ), y(t))    r      (   )
      =  r   l(f (x(t);    ), y(t))    r      (   )

id168

topics: loss gradient at unary (log-)factors
    partial derivative wrt au(yk   ):

q

   

l(f (x), y) =   log p(y|x) y
l(f (x), y) =   log p(y|x) y
@   log p(y|x)
@au(y0k)

@   log p(y|x)
@au(y0k)

d
e
t
(

   

   

   

   

x
=

{
 

=  (1yk=y0k   p(y0k|x))

=  (1yk=y0k   p(yk = y0k|x))

{
x
2

,

i

x
p
    gradient for each unary (log-)factors:
=

)

 

i

i

|

u

r
h

|

i

i

i

i

 

u

u

ra(l+1,0)(xk)   log p(y|x) =  (e(yk)   p(yk|x))
ra(l+1,0)(xk)   log p(y|x) =  (e(yk)   p(yk|x))

x
/2
ra(l+1, 1)(xk 1)   log p(y|x) =  1k>1 (e(yk)   p(yk|x))
ra(l+1, 1)(xk 1)   log p(y|x) =  1k>1 (e(yk)   p(yk|x))
r
ra(l+1,+1)(xk+1)   log p(y|x) =  1k<k (e(yk)   p(yk|x))
x
ra(l+1,+1)(xk+1)   log p(y|x) =  1k<k (e(yk)   p(yk|x))
)
}
vector of all
marginal probabilities

=
 

e
t

>i

u

u

(

i

i

i

x
u

r

{

2

r

|

9

=
=

@
@

@au(y0k)     kxk=1
@au(y0k)     kxk=1
=     1yk=y0k  

au(yk) +
au(yk) +

=

>i

u
j

ap(yk, yk+1)!   log z(x)!
k 1xk=1
ap(yk, yk+1)!   log z(x)!
k 1xk=1
log z(x)   

p

7

j

@   log p(y|x)
@   log p(y|x)
@au(y0k)
@au(y0k)

6
@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

@   log p(y|x)

@au(y0k)

@

=

@au(y0k)     kxk=1
=     1yk=y0k  

@

@au(y0k)

k 1xk=1
log z(x)   

au(yk) +

ap(yk, yk+1)!   log z(x)!

@

@au(y0k)

log z(x) =

1

@

z(x)

@au(y0k)

1
z(x)

=

1

z(x)

@

@au(y0k)xy001 xy002
      xy00k
      xy00k

1

1

=

=

z(x)xy001 xy002
z(x)xy001 xy002
      xy00k
= xy001 xy002
= p(y0k|x)

      xy00k

@

@au(y0k)

exp  kxk=1
exp  kxk=1
exp  kxk=1

au(y00k ) +

au(y00k ) +

ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1
ap(y00k , y00k+1)!
k 1xk=1

1y0k=y00k

au(y00k ) +

1y0k=y00k

p(y001 , . . . , y00k|x)

8

gradients, from every
position, into parameters

id168
topics: loss gradient at unary factor parameters
    use regular backprop
    backprop at all positions k
    accumulate all

math for my slides    conditional random    elds   .

    l(f (x(t);    ), y(t))
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
      =  r   l(f (x(t);    ), y(t))    r      (   )
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    (x(t), y(t))
    x(t 1) x(t) x(t+1)
    a(l+1)(x(t 1)) a(l+1)(x(t)) a(l+1)(x(t+1))
    x(t 1) x(t) x(t+1)
    l(f (x(t);    ), y(t))
    x(t 1) x(t) x(t+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    v w(l+1) b(l+1)
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    v w(l+1) b(l+1)
    r   l(f (x(t);    ), y(t))
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
p(y|x) = exp  kxk=1
    p(y(t 1)|x(t 1)) p(y(t)|x(t)) p(y(t+1)|x(t+1))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
    p(y|x) y(t) x(t)
l(f (x), y) =   log p(y|x) y
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
a(l+1,0)(xk)yk +
    p(y(1), . . . , y(t )|x(1), . . . , x(t ))
...
...
@   log p(y|x)
    y(t) = [y(t)
1 , . . . , y(t)
    y(t) = [y(t)
1 , . . . , y(t)
]
]
kxk=2
kxk=2
kxk=2
kt
@au(y0k)
kt
a(l+1, 1)(xk 1)yk +
a(l+1, 1)(xk 1)yk +
    y(t) = [y(t)
1 , . . . , y(t)
a(l+1, 1)(xk 1)yk +
kt
1 , . . . , x(t)
    x(t) = [x(t)
    x(t) = [x(t)
1 , . . . , x(t)
]
]
kt
kt
1 , . . . , x(t)
    x(t) = [x(t)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
ra(l+1,0)(xk)   log p(y|x) =  (e(yk)   p(yk|x))
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)
...
    kt
    kt
    kt
...
    x(t)
    x(t)
    x(t)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
@au(y0k)     kxk=1
    a(l+1)(xk 1) a(l+1)(xk) a(l+1)(xk+1)
@   log p(y|x)
    xk 1 xk xk+1
    xk 1 xk xk+1
    xk 1 xk xk+1
=     1yk=y0k  

ra(l+1, 1)(xk 1)   log p(y|x) =  1k>1 (e(yk)   p(yk|x))
ra(l+1,+1)(xk+1)   log p(y|x) =  1k<k (e(yk)   p(yk|x))

=  (1yk=y0k   p(yk = y0k|x))

@au(y0k)

.
.
.

...

=

@

k

k

k

9

id168
topics: loss gradient at unary factor parameters
    logpy0k
    for linear log-factors (as in the 2nd assignment):

(  )
    the log-factors are directly connected to the input:
    maxy    p(y|x) (= maxy0k
    a(1,0)(xk) = b(1) + w(1,0)xk
    a(1, 1)(xk) = w(1, 1)xk
    a(1,+1)(xk) = w(1,+1)xk

exp(  ) maxy0k

au(y0k)) + log    k 1(y0k)

10

@   log p(y|x)
@ap(y0k, y0k+1)

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

id168
topics: loss gradient at unary factor parameters
    for linear log-factors (as in the 2nd assignment):

ra(l+1, 1)(xk 1)yk   log p(y|x) =  1k>1 (e(yk)   p(yk|x))
ra(l+1,+1)(xk+1)yk   log p(y|x) =  1k<k (e(yk)   p(yk|x))

rv   log p(y|x) = e(yk)e(yk+1)>

    the gradients are:

rb(1)   log p(y|x) =

rw(1,0)   log p(y|x) =

rw(1, 1)   log p(y|x) =

rw(1,+1)   log p(y|x) =

kxk=1 ra(1,0)(xk)   log p(y|x)  =
kxk=1 ra(1,0)(xk)   log p(y|x)  x>k =
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =

 (e(yk)   p(yk|x))

 (e(yk)   p(yk|x)) x>k

kxk=1
kxk=1
kxk=2
  (e(yk)   p(yk|x)) x>k 1
k 1xk=1

  (e(yk)   p(yk|x)) x>k+1

11

rw(1, 1)   log p(y|x) =

rw(1, 1)   log p(y|x) =

rw(1, 1)   log p(y|x) =

kxk=1 ra(1,0)(xk)   log p(y|x)  x>k =
kxk=1
kxk=1 ra(1,0)(xk)   log p(y|x)  x>k =
kxk=1
kxk=1
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
kxk=2
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
kxk=2
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
kxk=2
 (e(yk)   p(yk|x)) x>k
  (e(yk)   p(yk|x)) x>k 1
  (e(yk)   p(yk|x)) x>k 1
  (e(yk)   p(yk|x)) x>k 1
id168
kxk=2
k 1xk=1
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
k 1xk=1
k 1xk=1
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
  (e(yk)   p(yk|x)) x>k 1
  (e(yk)   p(yk|x)) x>k+1
  (e(yk)   p(yk|x)) x>k+1
topics: loss gradient at pairwise (log-)factor and parameters
k 1xk=1
    partial derivative for log-factor:
  (e(yk)   p(yk|x)) x>k+1
   

kxk=1 ra(1,0)(xk)   log p(y|x)  x>k =
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =

rw(1,+1)   log p(y|x) =

  (e(yk)   p(yk|x)) x>k+1

}

rw(1,+1)   log p(y|x) =

rw(1,+1)   log p(y|x) =

@   log p(y|x)
@   log p(y|x)
@ap(y0k, y0k+1)
@ap(y0k, y0k+1)

    partial derivative of log-factor parameters:

j
,
  

@   log p(y|x)
=  (1yk=y0k,yk+1=y0k+1   p(y0k, y0k+1|x))
=  (1yk=y0k,yk+1=y0k+1   p(y0k, y0k+1|x))
x
@ap(y0k, y0k+1)
w
   

j

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

}

j
=

i

   

1
   
=
9
 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

j
u

(

=

i

i

t

j

,

|

   

)
t
(

=
@vy0k,y0k+1

r
h

@   log p(y|x)
@vy0k,y0k+1

x
w

r
x

{
@   log p(y|x)
x
=
=
2
x

p
{
@   log p(y|x)
 
@vy0k,y0k+1
u

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
k 1xk=1
    gradient of log-factor parameters 
k 1xk=1

k 1xk=1
k 1xk=1
 (1yk=y0k,yk+1=y0k+1   p(y0k, y0k+1|x))
 (1yk=y0k,yk+1=y0k+1   p(y0k, y0k+1|x))
 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
p(yk, yk+1|x)!
x
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1) +
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
p(yk, yk+1|x)!
k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1
u
rv   log p(y|x) =
=
p(yk, yk+1|x)!
 
u
matrix of all pairwise
label frequencies
u

=
{
}
x
)
2
x
r
r
h
/2
9
w
x
z(yk 1,x) exp (au(yk) + ap(yk 1, yk))
z(yk 1,x) exp (au(yk) + ap(yk 1, yk))

w
x
9
/2
r
x
2
)
}
x
{
1

 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  

k=1 p(yk|yk 1, x) p(yk|yk 1, x) =

k=1 p(yk|yk 1, x) p(yk|yk 1, x) =

matrix of all pairwise
marginal probabilities

h
r

   
=

rv   log p(y|x) =

rv   log p(y|x) =
p

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)

)
   
t
(

=

e
t

k 1xk=1

x

|

|

|

|

(

)

(

t

t

i

i

i

1

i

u

i

 
=

>i

u

t
e

i
   

12

u
x

p

p

6
6
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk

id173

topics: id173
    for id173, we can use the same regularizers as for a 
non-sequential neural network
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    add a regularizing term for all connection matrices
    do not regularize the bias vectors

l(f (x(t);    ), y(t)) +     (   )

    we could scale    by the sequence size

    with the loss and id173 gradients, we have all the 
ingredients to perform stochastic id119

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
rv   log p(y|x) =

 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

@   log p(y|x)
@ap(y0k, y0k+1)

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
=

p(yk, yk+1|x)!
k 1xk=1
k 1xk=1
 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

generative vs. discriminative
topics: generative learning, discriminative learning
    in discriminative learning, we optimize the conditional 
likelihood
    crfs are discriminative 

@   log p(y|x)

@vy0k,y0k+1

 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  

k 1xk=1

 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  

    in generative learning, we optimize the joint likelihood:
p(yk, yk+1|x)!

2

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
    id48s are generative
                       is similar to a regularizer

k 1xk=1

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)

2

2

generative vs. discriminative
topics: generative learning, discriminative learning
    it can be shown that:

    if model is well-speci   ed (i.e. is the true model) generative learning is better

0,5
0,4
0,3
0,2
0,1
0

generative

discriminative

training set size

generative vs. discriminative
topics: generative learning, discriminative learning
    it can be shown that:

    if model is not well-speci   ed (i.e. most of the time) discriminative, it depends:

generative

discriminative

0,5
0,4
0,3
0,2
0,1
0

    see these papers for more details:

training set size

- on discriminative vs. generative classi   ers: a comparison of id28 and naive 

bayes. andrew ng and michael jordan, 2001

rw(1, 1)   log p(y|x) =

rw(1,+1)   log p(y|x) =
   

c

c

c

c

c

c,i

c,i

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

rw(1,+1)   log p(y|x) =

  (e(yk)   p(yk|x)) x>k+1

  (e(yk)   p(yk|x)) x>k+1

kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
kxk=2
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
kxk=2
  (e(yk)   p(yk|x)) x>k 1
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
k 1xk=1
pk 1
pk 1
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
maximum-id178 markov model
pk
pk
pk
k 1xk=1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: memm
pk
pk
pk
= observed
    memm is directed and discriminative: 
@   log p(y|x)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
@ap(y0k, y0k+1)
=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
k 1xk=1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
@   log p(y|x)
@vy0k,y0k+1
k 1xk=1
 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
k 1xk=1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
p(yk, yk+1|x)!
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
k 1xk=1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
regressors (or neural networks):
      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
    p(y|x) =qk
2
-

    it   s a markov model where the transition probabilities are given by logistic 

 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

2
z(yk 1,x) exp (au(yk) + ap(yk 1, yk))

k=1 p(yk|yk 1, x) p(yk|yk 1, x) =

rv   log p(y|x) =

k 1xk=1

z(yk 1,x) exp (au(yk) + ap(yk 1, yk))

c,i

c,i

c,i

c,i

c,i

c,i

c,i

=

=

 

1

1

-

17

@   log p(y|x)
@ap(y0k, y0k+1)

@   log p(y|x)

@vy0k,y0k+1

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)

k=1 p(yk|yk 1, x) p(yk|yk 1, x) =

rv   log p(y|x) =

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
maximum-id178 markov model
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
topics: memm
pk
pk
pk
= observed
    memm is directed and discriminative: 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

      label bias   problem: observations far away don   t impact early predictions

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

- example: p(y3|x) = p(y2|x1, ... ,x4)
- observations after x4 do not change our decision about y3!

2

2

18

c

c

c

c

c

 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
hidden markov model
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
p(yk, yk+1|x)!
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k 1xk=1
topics: discriminative id48
pk
pk
pk
= observed
    id48s can be trained discriminatively
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
(i.e. minimize                  )
      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    used a lot in id103 (called   maximum mutual information training  )
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    we don   t have the same label bias anymore
    however, optimization might be more complicated, since factors most correspond 

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

2

2

2

to normalized probabilities

19

topics: markov network
    illustration for k=5 

c

c

c

c

c

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
markov network view
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

    each clique in the network corresponds to a factor
    the factors don   t need to correspond to id203 
distributions

2

2

20

c

c

c

c

   

c,i
c,i

c,i
c,i

c,i
c,i

c,i
c,i

rw(1,+1)   log p(y|x) =
c

rw(1,+1)   log p(y|x) =

rw(1,+1)   log p(y|x) =

rw(1, 1)   log p(y|x) =

rw(1,+1)   log p(y|x) =

rw(1, 1)   log p(y|x) =

  (e(yk)   p(yk|x)) x>k+1
   

rw(1, 1)   log p(y|x) =
rw(1,+1)   log p(y|x) =

kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
topics: markov network
   
@   log p(y|x)
    illustration for k=5 
@ap(y0k, y0k+1)

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
kxk=2 ra(1, 1)(xk)   log p(y|x)  x>k 1 =
kxk=2
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
  (e(yk)   p(yk|x)) x>k 1
pk
pk
pk
pk
pk
kxk=2
  (e(yk)   p(yk|x)) x>k 1
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
markov network view
k 1xk=1 ra(1,+1)(xk)   log p(y|x)  x>k+1 =
k 1xk=1
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
k 1xk=1
  (e(yk)   p(yk|x)) x>k+1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
= observed
@   log p(y|x)
@   log p(y|x)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
@ap(y0k, y0k+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
@ap(y0k, y0k+1)
=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k 1xk=1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
@   log p(y|x)
k 1xk=1
k 1xk=1
@   log p(y|x)
@   log p(y|x)
=
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
=
@vy0k,y0k+1
@vy0k,y0k+1
 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
p(yk, yk+1|x)!
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
k 1xk=1
k 1xk=1
k 1xk=1
k 1xk=1
rv   log p(y|x) =
rv   log p(y|x) =
rv   log p(y|x) =
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
p(yk, yk+1|x)!
 (e(yk) e(yk+1)>   p(yk, yk+1|x)) =   freq(yk, yk+1)  
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k 1xk=1
k 1xk=1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    representation is misleading:
    p(y|x) =qk
      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
    p(y|x) =qk
    p(y|x) =qk
    p(y|x) =qk
      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)
k=1 p(yk|yk 1, x) p(yk|yk 1, x) =
k=1 p(yk|yk 1, x) p(yk|yk 1, x) =
k=1 p(yk|yk 1, x) p(yk|yk 1, x) =
     f (y1, y2, x2)  f (y2, x2)  f (y1, y2)  f (y1, y2, x2) =  f (y1, y2) f (y2, x2)

    clique between y1, y2 and x1, but we didn   t explicitly de   ne a joint factor 
z(yk 1,x) exp (au(yk) + ap(yk 1, yk))
    in fact, we de   ned                 ,                  and                 , which is equivalent to 

2
z(yk 1,x) exp (au(yk) + ap(yk 1, yk))
     f (y1, y2, x2)  f (y2, x2)  f (y1, x2)  f (y1, y2)  f (y1, y2, x2) =  f (y1, y2) f (y2, x2) f (y1, x2)
     f (y1, y2, x2)  f (y2, x2)  f (y1, y2)  f (y1, y2, x2) =  f (y1, y2) f (y2, x2)

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

=  (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

 (1yk=y0k,yk+1=y0k+1   p(yk = y0k, yk+1 = y0k+1|x))

z(yk 1,x) exp (au(yk) + ap(yk 1, yk))

k=1 p(yk|yk 1, x) p(yk|yk 1, x) =

z(yk 1,x) exp (au(yk) + ap(yk 1, yk))

@   log p(y|x)
@ap(y0k, y0k+1)

rv   log p(y|x) =

@   log p(y|x)

k 1xk=1

@vy0k,y0k+1

@vy0k,y0k+1

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

c,i

2

=

=

1

1

1

1

k=1 p(yk|yk 1, x) p(yk|yk 1, x) =

having:  

     f (y1, y2, x2)  f (y2, x2)  f (y1, x2)  f (y1, y2)  f (y1, y2, x2) =  f (y1, y2) f (y2, x2) f (y1, x2)

21

      log p(y, x) =   log (p(y|x)p(x)) =   log p(y|x)   log p(x)   log p(y|x)

     f (y1, y2, x2)  f (y2, x2)  f (y1, y2)  f (y1, y2, x2) =  f (y1, y2) f (y2, x2)

c

c

c

c
c

c

c,i
c,i
c,i

c,i
c,i
c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

c,i
c,i

c,i

c,i

c,i
c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c

c
c

c

c,i
c,i
c,i

c,i
c,i
c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

c,i
c,i

c,i

c,i

c,i
c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c

c
c

c

c,i
c,i
c,i

c,i
c,i
c,i
c,i

c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

math for my slides    training crfs   .

c,i
c,i

c,i

c,i

c,i
c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c
c

c

c,i
c,i
c,i

c,i
c,i
c,i
c,i

c,i
c,i

universit  e de sherbrooke

c
hugo.larochelle@usherbrooke.ca

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
= observed
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i
c,i

c,i

c,i

c,i
c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c
c

c

c,i
c,i
c,i
c,i

c,i
c,i

hugo larochelle

universit  e de sherbrooke

hugo.larochelle@usherbrooke.ca

c
hugo.larochelle@usherbrooke.ca

d  epartement d   informatique
universit  e de sherbrooke
c,i
c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
september 26, 2012
pk
pk
pk
pk
= observed
c,i
c,i
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
math for my slides    training crfs   .
abstract
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i
c,i

c,i

c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c
c

c

c,i
c,i

hugo larochelle

universit  e de sherbrooke

hugo.larochelle@usherbrooke.ca

hugo.larochelle@usherbrooke.ca

c
hugo.larochelle@usherbrooke.ca

d  epartement d   informatique
c,i
c,i
universit  e de sherbrooke
c,i
c,i

d  epartement d   informatique
hugo larochelle
universit  e de sherbrooke
c,i
c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
september 26, 2012
pk
pk
pk
pk
= observed
september 26, 2012
c,i
c,i
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
math for my slides    training crfs   .
abstract
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
math for my slides    training crfs   .
abstract
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i
c,i

c,i

c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c
c

c

c,i
c,i

hugo larochelle

universit  e de sherbrooke

hugo.larochelle@usherbrooke.ca

hugo.larochelle@usherbrooke.ca

c
hugo.larochelle@usherbrooke.ca

d  epartement d   informatique
c,i
c,i
universit  e de sherbrooke
c,i
c,i

d  epartement d   informatique
hugo larochelle
universit  e de sherbrooke
c,i
c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
september 26, 2012
pk
pk
pk
pk
= observed
september 26, 2012
c,i
c,i
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
math for my slides    training crfs   .
abstract
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
math for my slides    training crfs   .
abstract
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i
c,i

c,i

c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

2
2

2
2

22

c

c

c
c

c

c,i
c,i

hugo larochelle

universit  e de sherbrooke

hugo.larochelle@usherbrooke.ca

hugo.larochelle@usherbrooke.ca

c
hugo.larochelle@usherbrooke.ca

d  epartement d   informatique
c,i
c,i
universit  e de sherbrooke
c,i
c,i

d  epartement d   informatique
hugo larochelle
universit  e de sherbrooke
c,i
c,i
c,i

     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) = exp (ps    f,s t(y, x))
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
pk
pk
pk
pk
pk
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
k=1 1yk=c   
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
k=1 1yk=c   
     f (y, x) =  f (yk) = exp   b(l+1)
pk
pk
pk
pk
pk
pk
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
pk 1
factor graph view
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
k=2 xk 1,i 1yk=c   
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
     f (y, x) =  f (yk, xk 1,i) = exp   w (l+1, 1)
pk
pk
pk
pk
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
k=1 xk,i 1yk=c   
     f (y, x) =  f (yk, xk,i) = exp   w (l+1,0)
september 26, 2012
pk
pk
pk
pk
= observed
september 26, 2012
c,i
c,i
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
k=1 xk+1,i 1yk=c   
k=1 xk+1,i 1yk=c   
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
     f (y, x) =  f (yk, xk+1,i) = exp   w (l+1,+1)
pk 1
pk 1
pk 1
pk 1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
k=1 1yk=c 1yk+1=c0   
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
     f (y, x) =  f (yk, yk+1) = exp   vc,c0 pk 1
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

topics: factor graph
    factor graphs better represent factors 
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
math for my slides    training crfs   .
abstract
= factor
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
math for my slides    training crfs   .
abstract
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    au(yk) = a(l+1,0)(xk)yk + 1k>1 a(l+1, 1)(xk 1)yk + 1k<k a(l+1,+1)(xk+1)yk
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
     f (yk, yk+2)  f (yk, yk+1, yk+2)
    ap(yk, yk+1) = 11   k<k vyk,yk+1
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    x1 x2 x3 x4 x5
    exp(a(l+1,0)(x3)y3) exp(a(l+1, 1)(x2)y3) exp(a(l+1,+1)(x4)y3) exp(vy3,y4)
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5
    y1 y2 y3 y4 y5

math for my slides    training crfs   .

math for my slides    training crfs   .

september 26, 2012

c,i
c,i

c,i

c,i

c,i
c,i

c,i

c,i

c,i

c,i

c,i

    this is less ambiguous:

factor graph 1

markov network

factor graph 2

?

?

2
2

2
2

22

factor graph view

s.t. zs=i

  s0!f (zs0)

 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
    there are two types of message: 

   
  f!s(i) = xz2dom(f )
  f!s(i) = xz is unobs.
   
   
from a variable node (    ) to its neighbor factor nodes (    ):

topics: belief propagation, message passing
    factor graphs better represent the computations needed to 
do id136
   
    we can write the forward-backward algorithm seen before into a general message 
passing form
   
   
  s!f (i) = yf02ne(s)\f
   

  f!s(i) = xz2dom(f )|zs=i
  f!s(i) = xz2dom(f )|zs=i
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz2dom(f )|zs=i
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz2dom(f )|zs=i
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f

  f!s(i) = xz2dom(f )
   
from a factor node (    ) to its neighbor variable nodes (    ):
  f!s(i) = xz is unobs.

  f!s(i) = xz2dom(f )|zs=i

 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s

  s!f (i) = yf02ne(s)\f

  f!s(i) = xz2dom(f )|zs=i

 f (z) ys02ne(f )\s

  s0!f (zs0)

  s0!f (zs0)

  f0!s(zi)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  f0!s(i)

and zs=i

and zs=i

s.t. zs=i

23

-

-

   

   

  s!f (i) = yf02ne(s)\f

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

  s0!f (zs0)

   
topics: belief propagation, message passing
    example: our (simpli   ed) linear chain crf
   

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
    y1 y2 y3 x1 x2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2

    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2

   
    y1 y2 y3 x1 x2
   
   
   

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

   
1 exp(au(y2))
   
    y1 y2 y3 x1 x2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

  s0!f (zs0)

  s0!f (zs0)

  f0!s(i)

and zs=i

and zs=i

and zs=i

s.t. zs=i

s.t. zs=i

   

   

    1 exp(au(y1)) exp(au(y1)) py1

   
1 exp(au(y2))
   

   

    y1 y2 y3 x1 x2

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

   

   

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i
  s0!f (zs0)

  s0!f (zs0)

   
topics: belief propagation, message passing
    example: our (simpli   ed) linear chain crf
   

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

   
1 exp(au(y2))
   

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

    y1 y2 y3 x1 x2

1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

  f0!s(i)

  f0!s(i)

and zs=i

and zs=i

s.t. zs=i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

   

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

  s0!f (zs0)

and zs=i
  s0!f (zs0)

  s0!f (zs0)

   
  f!s(i) = xz2dom(f )
  f!s(i) = xz is unobs.

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
   
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
topics: belief propagation, message passing
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
  f0!s(i)
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

   
1 exp(au(y2))
   

    1 exp(au(y1)) exp(au(y1)) py1

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

    y1 y2 y3 x1 x2

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

  f0!s(i)

and zs=i

s.t. zs=i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

   

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

  f0!s(i)

  s0!f (zs0)

  s0!f (zs0)

and zs=i
  s0!f (zs0)

  s0!f (zs0)

    1 exp(au(y1)) exp(au(y1)) py1

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
   
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
topics: belief propagation, message passing
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
  f0!s(i)
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
   
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

    y1 y2 y3 x1 x2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

and zs=i

and zs=i

s.t. zs=i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

and zs=i
  s0!f (zs0)

  s0!f (zs0)

    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
factor graph view
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s0!f (zs0)
   
  s0!f (zs0)
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
topics: belief propagation, message passing
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
   
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
  f0!s(i)
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
   
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

    y1 y2 y3 x1 x2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

  f0!s(i)

and zs=i

and zs=i

s.t. zs=i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

p

}

}

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

and zs=i

i

s.t. zs=i

s.t. zs=i

s.t. zs=i

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

j
=

  s0!f (zs0)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

  f0!s(i)
   

  f!s(i) = xz is unobs.

1
and zs=i
  s0!f (zs0)
=
u

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
factor graph view
  s0!f (zs0)
   
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s0!f (zs0)
   
  s0!f (zs0)
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
topics: belief propagation, message passing
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
   
   
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
   
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
}
exp(au(y2))   1(y2) py2
)
  f0!s(i)
x
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
r
  s!f (i) = yf02ne(s)\f
/2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
   
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
x
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
x
    y1 y2 y3 x1 x2
   
{
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
  s0!f (zs0)
u

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

    y1 y2 y3 x1 x2

 
=

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

r

    y1 y2 y3 x1 x2

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

t
e

   

>i

  f0!s(i)

|

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

(

  f0!s(i)

h

and zs=i

and zs=i

s.t. zs=i

j

i

i

i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

|

i

,

u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

 
{

i

   

9

|

2

{

r

   

p

}

}

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

and zs=i

i

s.t. zs=i

s.t. zs=i

s.t. zs=i

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

j
=

  s0!f (zs0)
  s0!f (zs0)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

  f0!s(i)
   

  f!s(i) = xz is unobs.

1
and zs=i
  s0!f (zs0)
=
u

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
factor graph view
  s0!f (zs0)
   
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s0!f (zs0)
   
  s0!f (zs0)
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
topics: belief propagation, message passing
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
   
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
}
exp(au(y2))   1(y2) py2
)
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
   
x
  s!f (i) = yf02ne(s)\f
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
r
  s!f (i) = yf02ne(s)\f
/2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
   
    1 exp(au(y1)) exp(au(y1)) py1
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
x
    1 exp(au(y1)) exp(au(y1)) py1
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
   
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
   
2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
x
    y1 y2 y3 x1 x2
   
1 exp(au(y2))
{
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
  s0!f (zs0)
u

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)
  s0!f (zs0)

 
=

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

1 exp(au(y2))
1 exp(au(y2))

r

    y1 y2 y3 x1 x2

1 exp(au(y2))

t
and zs=i
e

   

>i

  f0!s(i)

|

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

(

  f0!s(i)

  f0!s(i)

h

and zs=i

and zs=i

s.t. zs=i

j

i

i

i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

|

i

,

u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

 
{

i

   

9

|

2

{

r

   

p

}

}

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

and zs=i

and zs=i

i

s.t. zs=i

s.t. zs=i

s.t. zs=i

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

j
=

  s0!f (zs0)
  s0!f (zs0)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

  f0!s(i)
   

  f!s(i) = xz is unobs.

1
and zs=i
  s0!f (zs0)
=
u

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  s0!f (zs0)
   
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s0!f (zs0)
   
  s0!f (zs0)
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
topics: belief propagation, message passing
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
   
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
}
exp(au(y2))   1(y2) py2
)
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
   
x
  s!f (i) = yf02ne(s)\f
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
r
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
/2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
   
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
x
   
1 exp(au(y2))
    1 exp(au(y1)) exp(au(y1)) py1
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
1 exp(au(y2))
r
   
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
   
2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
x
    y1 y2 y3 x1 x2
   
1 exp(au(y2))
{
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
  f0!s(i)
  s0!f (zs0)
u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)
  s0!f (zs0)

 
=

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

1 exp(au(y2))
1 exp(au(y2))

    y1 y2 y3 x1 x2

1 exp(au(y2))

t
and zs=i
e

   

>i

  f0!s(i)

|

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

(

  f0!s(i)

  f0!s(i)

h

and zs=i

and zs=i

s.t. zs=i

j

i

i

i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

|

i

,

u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

 
{

i

   

9

|

2

{

r

   

p

}

}

   

   

   

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

and zs=i

and zs=i

i

s.t. zs=i

s.t. zs=i

and zs=i
s.t. zs=i

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

j
=

  s0!f (zs0)
  s0!f (zs0)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

  f0!s(i)
   

  f!s(i) = xz is unobs.

1
and zs=i
  s0!f (zs0)
=
u

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  s0!f (zs0)
   
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s0!f (zs0)
   
  s0!f (zs0)
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
topics: belief propagation, message passing
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
    example: our (simpli   ed) linear chain crf
   
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
}
exp(au(y2))   1(y2) py2
)
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
   
x
  s!f (i) = yf02ne(s)\f
    y1 y2 y3 x1 x2
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    1 exp(au(y1)) exp(au(y1)) py1
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
r
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
    y1 y2 y3 x1 x2
/2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
x
   
1 exp(au(y2))
    1 exp(au(y1)) exp(au(y1)) py1
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
1 exp(au(y2))
r
   
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
   
2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
x
    y1 y2 y3 x1 x2
   
1 exp(au(y2))
{
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

u
  f0!s(i)
  s0!f (zs0)
u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)
  s0!f (zs0)

  s0!f (zs0)
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

 
=

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

1 exp(au(y2))
1 exp(au(y2))

1 exp(au(y2))

t
and zs=i
e

   

>i

  f0!s(i)

|

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

(

  f0!s(i)

  f0!s(i)

  f0!s(i)

h

and zs=i

and zs=i

s.t. zs=i

j

i

i

i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

u
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

|

i

,

u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

 
{

i

   

9

|

2

{

r

   

p

}

}

   

   

   

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

and zs=i

and zs=i

and zs=i

i

s.t. zs=i

and zs=i
s.t. zs=i

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

j
=

  f0!s(i)
s.t. zs=i

s.t. zs=i
  s0!f (zs0)

  s0!f (zs0)
  s0!f (zs0)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

  f0!s(i)
   

  f!s(i) = xz is unobs.

1
and zs=i
  s0!f (zs0)
=
u

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  s0!f (zs0)
   
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  s0!f (zs0)
   
  s0!f (zs0)
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
topics: belief propagation, message passing
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    example: our (simpli   ed) linear chain crf
   
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
   
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
}
exp(au(y2))   1(y2) py2
   
)
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
   
x
  s!f (i) = yf02ne(s)\f
    y1 y2 y3 x1 x2
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    1 exp(au(y1)) exp(au(y1)) py1
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
r
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
    y1 y2 y3 x1 x2
/2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
x
   
1 exp(au(y2))
    1 exp(au(y1)) exp(au(y1)) py1
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
1 exp(au(y2))
r
   
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
   
2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
x
    y1 y2 y3 x1 x2
   
1 exp(au(y2))
{
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

u
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
  s0!f (zs0)
u

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)
  s0!f (zs0)

  s0!f (zs0)
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

 
=

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

1 exp(au(y2))
1 exp(au(y2))

1 exp(au(y2))

t
and zs=i
e

   

>i

  f0!s(i)

|

  s0!f (zs0)

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

(

  f0!s(i)

  f0!s(i)

  f0!s(i)

h

and zs=i

and zs=i

j

i

i

i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

u
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

|

i

,

u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

 
{

i

   

9

|

2

{

r

   

p

|

r

p

j

  s0!f (zs0)
p

and zs=i

s.t. zs=i

}

}

}

x
w

=
x

   

   

   

   

   

   

   

   

   

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

s.t. zs=i

and zs=i

and zs=i

and zs=i

and zs=i

and zs=i

i

j

  

s.t. zs=i

  f0!s(i)

and zs=i
s.t. zs=i

j
,

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  s0!f (zs0)

  f0!s(i)
  f0!s(i)

j
=

  f0!s(i)
s.t. zs=i

    y1 y2 y3 x1 x2

s.t. zs=i
  s0!f (zs0)

  s0!f (zs0)
  s0!f (zs0)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

  f0!s(i)
   

  f!s(i) = xz is unobs.

  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
factor graph view
  s0!f (zs0)
   
   
   
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  s0!f (zs0)
   
  s!f (i) = yf02ne(s)\f
  s0!f (zs0)
  f!s(i) = xz2dom(f )
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
topics: belief propagation, message passing
 f (z) ys02ne(f )\s
  f!s(i) = xz2dom(f )
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    1 exp(au(y1)) exp(au(y1)) py1
    example: our (simpli   ed) linear chain crf
   
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
   
exp(au(y2))   1(y2) py2
   
  f!s(i) = xz is unobs.
  f!s(i) = xz is unobs.
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
1 exp(au(y2))
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
}
exp(au(y2))   1(y2) py2
   
)
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
   
x
  s!f (i) = yf02ne(s)\f
    y1 y2 y3 x1 x2
   
...
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
    1 exp(au(y1)) exp(au(y1)) py1
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
    y1 y2 y3 x1 x2
and zs=i
r
    1 exp(au(y1)) exp(au(y1)) py1
  s!f (i) = yf02ne(s)\f
    y1 y2 y3 x1 x2
/2
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
   
    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
   
  s!f (i) = yf02ne(s)\f
  s!f (i) = yf02ne(s)\f
x
   
1 exp(au(y2))
    1 exp(au(y1)) exp(au(y1)) py1
   
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
    y1 y2 y3 x1 x2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2
1 exp(au(y2))
r
   
exp(au(y2))   1(y2) py2
    1 exp(au(y1)) exp(au(y1)) py1
   
   
1 exp(au(y2))
   
   
2
  f!s(i) = xz2dom(f )
 f (z) ys02ne(f )\s
exp(au(y2))   1(y2) py2
x
    y1 y2 y3 x1 x2
   
1 exp(au(y2))
{
   
  s!f (i) = yf02ne(s)\f
    1 exp(au(y1)) exp(au(y1)) py1
    1 exp(au(y1)) exp(au(y1)) py1
 f (z) ys02ne(f )\s
  f!s(i) = xz is unobs.
exp(au(y2))   1(y2) py2
exp(au(y2))   1(y2) py2

u
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)
  s0!f (zs0)
}
x
u
r
/2
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  s0!f (zs0)

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  f0!s(i)

   
1 exp(au(y2))
   

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
1 exp(au(y2))
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

1
and zs=i
  s0!f (zs0)
=
u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

    y1 y2 y3 x1 x2

  s0!f (zs0)
  s0!f (zs0)

  s0!f (zs0)
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

 
=

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
and zs=i

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

2

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

1 exp(au(y2))
1 exp(au(y2))

r

1 exp(au(y2))

t
and zs=i
e

   

>i

   

{

  f0!s(i)

x

|

  s0!f (zs0)

|

  s0!f (zs0)

1 exp(au(y2))

1 exp(au(y2))

1 exp(au(y2))

(

(

)

  f0!s(i)

  f0!s(i)

  f0!s(i)

h

h

and zs=i

and zs=i

j

i

i

i

and zs=i

s.t. zs=i

s.t. zs=i

and zs=i

   

   

24

  s!f (i) = yf02ne(s)\f

  f0!s(i)

9

w
9

|

2

x

2

{

{
=

)

x
r

(

   

r

   

  s!f (i) = yf02ne(s)\f

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

and zs=i

u
exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
x

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
  f0!s(i)

|

i

,

u

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
  s0!f (zs0)

 
{

i

   

  f!s(i) = xz is unobs.

  f!s(i) = xz is unobs.

  s!f (i) = yf02ne(s)\f

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

factor graph view

   

   

    y1 y2 y3 x1 x2

topics: belief propagation, message passing
    on a linear chain graph, belief propagation is the same a 
    y1 y2 y3 x1 x2
    1 exp(au(y1)) exp(au(y1)) py1
forward-backward
   
    forward pass of message passing computes the
       k(yk+1)  k(yk 1)
    backward pass of message passing computes the 

    1 exp(au(y1)) exp(au(y1)) py1
exp(au(y2))   1(y2) py2

   
       k(yk+1)  k(yk 1)
    can do id136 on other types of structures

1 exp(au(y2))

1 exp(au(y2))

exp(au(y2))   1(y2) py2

    belief propagation is also exact on arbitrary trees
    on a graph with loops, (loopy-)belief propagation can be used to do approximate 

id136 (but can divergence, if not careful)

    many general purpose libraries are publicly available

    for numerical stability, passing log-messages is preferred

25

    v w(l+1) b(l+1)

a(l+1,0)(xk)yk +

p(y|x) = exp  kxk=1
general crf
kxk=2

a(l+1,+1)(xk+1)yk! /z(x)
topics: crfs in general
    we don   t have to restrict the crf structure to linear chains

k 1xk=1
k 1xk=1

a(l+1, 1)(xk 1)yk +

vyk,yk+1+

    w(l+1, 1) w(l+1,+1) w(l+1,0) b(l+1)

p(y|x) =

1

z(x)yf

 f (y, x)

grid structure
(pixels in image)

     f (y, x) =  f (yk, xk 1) = exp a(l+1, 1)(xk 1)c 1yk=c 
     f (y, x) =  f (yk, xk+1) = exp a(l+1,+1)(xk+1)c 1yk=c 
     f (y, x) =  f (yk, xk) = exp a(l+1,0)(xk)c 1yk=c 
     f (y, x) =  f (yk, yk+1) = exp vc,c0 1yk=c 1yk+1=c0 

    we could also have n-ary factors, with n>2

general pair-wise structure
(webpages sharing a link)

26

p

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

  s!f (i) = yf02ne(s)\f

  f0!s(i)

exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

}

j
,

  

j

j

    1 exp(au(y1)) exp(au(y1)) py1

9

|

r

       k(yk+1)  k(yk 1)

2

{

1 exp(au(y2))

{

   

  s!f (i) = yf02ne(s)\f
general crf
  f0!s(i)
    y1 y2 y3 x1 x2
    1 exp(au(y1)) exp(au(y1)) py1
topics: crfs in general
exp(au(y2))   1(y2) py2
   
    gradients in general crfs always take the form:
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )
       k(yk+1)  k(yk 1)
exp(au(y2))   1(y2) py2
=     pf
    @ log p(y(t)|x(t))
=     pf

@    log  f (y(t), x(t))   eyhpf

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )
}
x
r
/2
x

@    log  f (y(t), x(t))   eyhpf
@    log  f (y, x(t))  x(t)i   

/2
r

2

2
x
{

x

}

r

make everything less likely

x

x

make y(t) more likely

|

(

)

r

|

h

(

)

h

@   

@

@

@

@

    the expectation over y will often need to be approximated, 
using loopy belief propagation
    it will often involve only a few of the yk variables

   

27

e
t

>i

r

>i

t
e

@    log  f (y, x(t))  x(t)i   

   

p

6
exp(au(y1) + ap(y1, y2)) ( =    1(y2) )

exp(au(y2) + ap(y2, y3))   1(y2) ( =    2(y3) )

    1 exp(au(y1)) exp(au(y1)) py1

1 exp(au(y2))

exp(au(y2))   1(y2) py2
general crf
   
       k(yk+1)  k(yk 1)
topics: crfs in general
=     pf
    marginals can be approximated with:
    @ log p(y(t)|x(t))
exp(log  f (yk)+pf02ne(k)\f log   f0!k(yk))
    p(yk|x) =
exp(log  f (y0k)+pf02ne(k)\f log   f0!k(y0k))
py0k

@    log  f (y(t), x(t))   eyhpf

@   

@

    in general, an approximated marginal is computed by
1. summing all the log-factors that involve only the yk variables of interest
2. summing all the log-messages coming into the yk variables from other factors
3. exponentiating
4. renormalizing

28

exp(au(y2))   1(y2) py2
       k(yk+1)  k(yk 1)
general crf
=     pf
    @ log p(y(t)|x(t))
topics: pseudolikelihood
exp(log  f (yk)+pf02ne(k)\f log   f0!k(yk))
    p(yk|x) =
exp(log  f (y0k)+pf02ne(k)\f log   f0!k(y0k))
py0k
    why not just change the id168 to a tractable one
k=1 log p(yk|y1, . . . , yk 1, yk+1, . . . , yk, x)

@    log  f (y(t), x(t))   eyhpf

@   

@

     pk

    predict, in turn, each yk not just from x, but also all the other elements of y
    can compute the exact gradients

-

this is because these probabilities only require normalizing yk individually, like in a regular 
softmax

    however, often tends to work less well
    we still need to compute p(yk|x) to do predictions anyways

29

conclusion

    we saw how to compute the gradients in a linear-chain crf

    requires the id136 of p(yk|x), p(yk, yk+1|x) (seen previous class)

    we saw how to interpret id136 as the process of passing 
messages between variables and factors
    allows for a general procedure to do approximate id136 on arbitrary graphs
    this procedure can be adapted to do approximate id136 of the maximum 

id203 assignment (max-product algorithm, not seen)

    you now have the basic notions required to learn more about 
structured id114
    this is a very vast and growing    eld of research

30

