neural	machine	transla/on	

thang	luong	
lecture	@	cs224d	

spring	2016	

(special	thanks	to	chris	manning	for	feedback!)		

	

7	billion	people,	7000	languages	

5/19/16	

thang	luong	-	neural	machine	translahon	

2	

a	universal	translator	

(the	babel	fish	from	   the	hitchhiker's	guide	to	the	galaxy   )	

5/19/16	

thang	luong	-	neural	machine	translahon	

3	

machine	vs.	human	transla/on	

faithful	transla/on	

   nevertheless,	within	the	discipline	of	machine	learning,	a	
specializa8on	called	deep	learning	has	been	developed.	its	
dis8nguishing	feature	is	that	it	is	inspired	by	neurobiology.	deep	
learning	deals	with	computa8onal	elements	which	allow	a	network	
of	ar8   cial	neurons	to	learn	a	model	of	the	human	brain.   	

       grammahcally	incorrect.	

5/19/16	

thang	luong	-	neural	machine	translahon	

4	

machine	vs.	human	transla/on	

faithful	transla/on	

   nevertheless,	within	the	discipline	of	machine	learning,	a	
specializa8on	called	deep	learning	has	been	developed.	its	
dis8nguishing	feature	is	that	it	is	inspired	by	neurobiology.	deep	
learning	deals	with	computa8onal	elements	which	allow	a	network	
of	ar8   cial	neurons	to	learn	a	model	of	the	human	brain.   	

       bad	word	choices.	

5/19/16	

thang	luong	-	neural	machine	translahon	

5	

machine	vs.	human	transla/on	

faithful	transla/on	

   nevertheless,	within	the	discipline	of	machine	learning,	a	
specializa8on	called	deep	learning	has	been	developed.	its	
dis8nguishing	feature	is	that	it	is	inspired	by	neurobiology.	deep	
learning	deals	with	computa8onal	elements	which	allow	a	network	
of	ar8   cial	neurons	to	learn	a	model	of	the	human	brain.   	

       bad	sentence	structures.	

5/19/16	

thang	luong	-	neural	machine	translahon	

6	

machine	vs.	human	transla/on	

fluent	transla/on	

   however,	in	machine	learning	a	specializa8on	called	deep	learning	
has	emerged.	it	can	be	recognized	by	its	dis8nc8ve	neurobiological	
in   uence.	deep	learning	is	centered	around	networks	of	ar8   cial	
neurons	which	can	learn	models	of	the	human	brain.   	

a	big	gap!	

5/19/16	

thang	luong	-	neural	machine	translahon	

7	

how	has	mt	evolved?	

5/19/16	

thang	luong	-	neural	machine	translahon	

8	

phrase-based	mt	

she	loves	

cute	

cats	

elle	aime	

les	chats	

mignons	

(brown	et	al.,	1993;	koehn	et	al.,	2003;	och	&	ney,	2004)	
       break	sentences	into	chunks.	
       transla8on	model:	look	up	phrase	translahons.	
       language	model:	he	phrases	together.	

translate	locally		 lm	uses	only	target	words		

5/19/16	

thang	luong	-	neural	machine	translahon	

9	

joint	neural	language	model	

we	went	for	a	stroll	along	the	south	bank	

   	all  s	pour	une	promenade	le	long	de	la	

rive	
bank	
(river)	
       condihoned	on	source	words	(devlin	et	al.,	2014)	
       shll	translate	locally.	

along	

walk	

mt	systems	become	more	complex!	

5/19/16	

thang	luong	-	neural	machine	translahon	

10	

neural	machine	transla/on	

to	the	rescue!	

id4	

i	am	a	student	

je	suis	  tudiant	

(sutskever	et	al.,	2014;	cho	et	al.,	2014)	

       sequence-to-sequence:	translate	globally.	
       end-to-end:	simple	&	generalizable.	

let   s	   nd	out!	

5/19/16	

thang	luong	-	neural	machine	translahon	

11	

outline	

       basic	id4	

      id56	recap.	
      encoder-decoder.	
      training.	
      teshng.	

       advanced	id4	

5/19/16	

thang	luong	-	neural	machine	translahon	

12	

recurrent	neural	networks	(id56s)	

input:	

i	

am	

a	

student	

5/19/16	

thang	luong	-	neural	machine	translahon	

13	

(picture	adapted	from	andrej	karparthy)	

recurrent	neural	networks	(id56s)	

ht-1	

ht	

input:	

i	

am	

a	

student	

xt	
id56s	to	represent	sequences!	

5/19/16	

thang	luong	-	neural	machine	translahon	

14	

(picture	adapted	from	andrej	karparthy)	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

15	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

16	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

17	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

18	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

19	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

encoder	

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

20	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

encoder	

i

am

a student

_

suis   tudiant
je
boundary	marker	

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

21	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

encoder	

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

22	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

encoder	

	
	

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

23	

neural	machine	transla/on	(id4)	

je

suis   tudiant

_

boundary	marker	

encoder	

decoder	

i

am

a student

_

je

suis   tudiant

       recurrent	neural	networks:	

      model	p(target	|	source)	directly.		
      can	be	trained	end-to-end.	

5/19/16	

thang	luong	-	neural	machine	translahon	

24	

word	embeddings	

je

suis   tudiant

_

source	

embeddings	

target	

embeddings	

i

am

a student

_

je

suis   tudiant

       one	for	each	language:	can	learn	from	scratch.	

5/19/16	

thang	luong	-	neural	machine	translahon	

25	

recurrent	connec/ons	

je

suis   tudiant

_

inihal		
states	

i

am

a student

_

je

suis   tudiant

       olen	set	to	0.	

5/19/16	

thang	luong	-	neural	machine	translahon	

26	

recurrent	connec/ons	

je

suis   tudiant

_

encoder	
1st	layer	

i

am

a student

_

je

suis   tudiant

       di   erent:	{1st	layer,	2nd	layer}	x	{encoder,	decoder}.	

5/19/16	

thang	luong	-	neural	machine	translahon	

27	

recurrent	connec/ons	

je

suis   tudiant

_

encoder	
2nd	layer	

i

am

a student

_

je

suis   tudiant

       di   erent:	{1st	layer,	2nd	layer}	x	{encoder,	decoder}.	

5/19/16	

thang	luong	-	neural	machine	translahon	

28	

recurrent	connec/ons	

je

suis   tudiant

_

decoder	
1st	layer	

i

am

a student

_

je

suis   tudiant

       di   erent:	{1st	layer,	2nd	layer}	x	{encoder,	decoder}.	

5/19/16	

thang	luong	-	neural	machine	translahon	

29	

recurrent	connec/ons	

je

suis   tudiant

_

decoder	
2nd	layer	

i

am

a student

_

je

suis   tudiant

       di   erent:	{1st	layer,	2nd	layer}	x	{encoder,	decoder}.	

5/19/16	

thang	luong	-	neural	machine	translahon	

30	

recurrent	units	

id56	

vanishing	

gradient	problem!		

c   mon,	it   s	
been	around	
for	20	years!	

       vanilla:		

       lstm:		

lstm	

5/19/16	

thang	luong	-	neural	machine	translahon	

31	

sotmax:	vectors	   	categories	

je

suis   tudiant

solmax	

parameters	

target	

hidden	state	

i

am

a student

_

je

je

	
	

suis   tudiant
	
	

_

suis   tudiant

_

|v|	
je

5/19/16	

thang	luong	-	neural	machine	translahon	

32	

sotmax:	vectors	   	categories	

je

suis   tudiant

scores	
_
=	
normalize	

exp	&	

je

	
	

suis   tudiant
	
	
	
	

_

suis   tudiant

i

am

a student

_

je

probs	

p(je|	   )	

	
	

|v|	
je

       hidden	states	   	scores		   	probabilihes.	

5/19/16	

thang	luong	-	neural	machine	translahon	

33	

training	loss	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       maximize	p(target	|	source)		

5/19/16	

thang	luong	-	neural	machine	translahon	

34	

training	loss	

-log p(je)

-log p(suis)	
	
	

i

am

je
       sum	of	all	individual	losses	

a student

_

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

35	

training	loss	

-log p(je)

	
	
	
	

-log p(suis)

	
	
	
	

i

am

je
       sum	of	all	individual	losses	

a student

_

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

36	

training	loss	

-log p(  tudiant)

	
	
	
	

i

am

je
       sum	of	all	individual	losses	

a student

_

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

37	

training	loss	

	
	
	
	

-log p(_)

suis   tudiant

i

am

je
       sum	of	all	individual	losses	

a student

_

5/19/16	

thang	luong	-	neural	machine	translahon	

38	

backpropaga/on	through	time	

	
	
	
	

-log p(_)

init	to	0	

i

am

a student

_

je

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

39	

backpropaga/on	through	time	

	
	
	
	

-log p(  tudiant)

i

am

a student

_

je

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

40	

backpropaga/on	through	time	

	
	
	
	

-log p(  tudiant)

i

am

a student

_

je

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

41	

backpropaga/on	through	time	

	
	
	
	

-log p(suis)

i

am

a student

_

je

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

42	

backpropaga/on	through	time	

	
	
	
	

-log p(suis)

i

am

a student

_

je

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

43	

backpropaga/on	through	time	

	
	
	
	

i

am

a student

_

je

suis   tudiant

id56	gradients	are	accumulated.		

5/19/16	

thang	luong	-	neural	machine	translahon	

44	

training	vs.	tes/ng	

je

suis   tudiant

_

       training	

      correct	translahons	
are	available.	

	

       tes8ng	

      only	source	
sentences	are	given.	

i

am

a student

_
je

je
suis   tudiant

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

5/19/16	

thang	luong	-	neural	machine	translahon	

45	

tes/ng	

       feed	the	most	likely	word	

5/19/16	

thang	luong	-	neural	machine	translahon	

46	

tes/ng	

       feed	the	most	likely	word	

5/19/16	

thang	luong	-	neural	machine	translahon	

47	

tes/ng	

       feed	the	most	likely	word	

5/19/16	

thang	luong	-	neural	machine	translahon	

48	

tes/ng	

       feed	the	most	likely	word	

5/19/16	

thang	luong	-	neural	machine	translahon	

49	

tes/ng	

simple	beam-search	decoders!	

5/19/16	

thang	luong	-	neural	machine	translahon	

50	

english-french	wmt   14	results	

38	

37	

36	

35	

34	

33	

32	

	

u
e
l
b

31	
5/19/16	

37	

36.5	

sota	smt	(durrani+,	2014)	

34.8	

33.3	

avg	smt	(schwenk,	2014)	

id4	(sutskever+,	2014)	

smt	+	id4	rescore	
(sutskever+,	2014)	

thang	luong	-	neural	machine	translahon	

51	

english-french	wmt   14	results	

2	decades	
of	research		

1-2	years	of	
research	

37	

36.5	

sota	smt	(durrani+,	2014)	

34.8	

33.3	

avg	smt	(schwenk,	2014)	

id4	(sutskever+,	2014)	

smt	+	id4	rescore	
(sutskever+,	2014)	

thang	luong	-	neural	machine	translahon	

52	

38	

37	

36	

35	

34	

33	

32	

	

u
e
l
b

31	
5/19/16	

encoder-decoder	variants	

(sutskever	et	al.,	2014)	

my	id4	models	
(cho	et	al.,	2014)	

(bahdanau	et	al.,	2015)	

(jean	et	al.,	2015)	
(kalchbrenner	&	
blunsom,	2013)	

encoder	

decoder	

deep	lstm	

deep	lstm	

(bidirechonal)	

gru	

gru	

id98	

(inverse	id98)	

id56	

next,	advanced	id4!	

5/19/16	

thang	luong	-	neural	machine	translahon	

53	

break	/me:	when	mt	fails	   	

sale	of	chicken	murder	

go	back	toward	your	behind	

5/19/16	

deep	fried	baby	

thang	luong	-	neural	machine	translahon	

meat	muscle	stupid	bean	sprouts	

54	

limita/ons	
       #1:	the	vocabulary	size	problem	

      goal:	extend	the	vocabulary	coverage.	

       #2:	the	sentence	length	problem	

      goal:	translate	long	sentences	bever.	

       #3:	the	language	complexity	problem	
      goal:	handle	more	language	variahons.	

5/19/16	

thang	luong	-	neural	machine	translahon	

55	

advancing	id4	
       #1:	the	vocabulary	size	problem	

      sol:	   copy   	mechanism.	

ecotax	

pont-de-buis	

the			<unk>			porhco			in			<unk>	

	

le			<unk>			<unk>			de				<unk>	

por8que	   cotaxe	

pont-de-buis	

       #2:	the	sentence	length	problem	

      sol:	avenhon	mechanism.	

je

suis   tudiant

i

am

a student

_

je

suis   tudiant

       #3:	the	language	complexity	problem	

      sol:	character-level	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

56	

cv	vs.	nlp	

1k	categories	

cat	

computer	

vision	

1m	categories	

mat	

nlp	

the	cat	sat	on	a		

5/19/16	

thang	luong	-	neural	machine	translahon	

57	

#1	the	vocabulary	size	problem	

       word	generahon	problem	

      vocabs	are	modest:	50k.	
      simple	solmax:	gpu	friendliness.	

je

suis   tudiant

the			ecotax			porhco			in			pont-de-buis	
le			porhque			  cotaxe	de				pont-de-buis	

i

am

a student

_

je

suis   tudiant

the			<unk>			porhco			in			<unk>	
le			<unk>			<unk>			de				<unk>	

5/19/16	

thang	luong	-	neural	machine	translahon	

58	

       propose	   copy   	mechanisms	for	<unk>.	
       simple	&	e   echve	

      treat	any	id4	as	a	black	box.	
      annotate	training	data.	
      post-process	translahons.	

sota	for	english-french	translahon.	

thang	luong*,	ilya	sutskever*,	quoc	le*,	oriol	vinyals,	and	wojciech	zaremba.	
addressing	the	rare	word	problem	in	neural	machine	transla>on.	acl	2015.	

5/19/16	

thang	luong	-	neural	machine	translahon	

59	

our	approach	   	training	annota>on	

       learn	

alignments.	

the			ecotax			porhco			in			pont-de-buis	

	

le			porhque			  cotaxe	de				pont-de-buis	

       add	relahve	

posihons.	

the			<unk>			porhco			in			<unk>	

	

le			unk1			unk-1			de				unk0	

   avenhon   	for	rare	words	

5/19/16	

thang	luong	-	neural	machine	translahon	

60	

our	approach	   	post-process	

test	sentence	

ecotax	

pont-de-buis	
the			<unk>			porhco			in			<unk>	

		

transla8on	

le			porhque			unk-1			de				unk0	

5/19/16	

thang	luong	-	neural	machine	translahon	

61	

our	approach	   	post-process	

test	sentence	

ecotax	

pont-de-buis	
the			<unk>			porhco			in			<unk>	

		

transla8on	

le			porhque			unk-1			de				unk0	

		

dic/onary	translahon	

post-edit	
transla8on	

le			porhque			  cotaxe			de				pont-de-buis	

	

5/19/16	

thang	luong	-	neural	machine	translahon	

62	

our	approach	   	post-process	

test	sentence	

ecotax	

pont-de-buis	
the			<unk>			porhco			in			<unk>	

		

transla8on	

le			porhque			unk-1			de				unk0	

		

iden/ty	copy	

post-edit	
transla8on	

le			porhque			  cotaxe			de				pont-de-buis	

orthogonal	to	large-vocab	techniques	

	

5/19/16	

thang	luong	-	neural	machine	translahon	

63	

e   ects	of	transla/ng	rare	words	

	

u
e
l
b

40	

35	

30	

25	

durrani	et	al.	(37.0)	

sutskever	et	al.	(34.8)	

this	work	(37.5)	

sentences	ordered	by	average	frequency	rank	
first	sota	id4	system!	

5/19/16	

thang	luong	-	neural	machine	translahon	

64	

sample	transla/ons	

source	 an	addihonal	2600	operahons	including	orthopedic	and	cataract	surgery	

will	help	clear	a	backlog	.	

human	 2600	op  rahons	suppl  mentaires	,	notamment	dans	le	domaine	de	la	

chirurgie	orthop  dique	et	de	la	cataracte	,	aideront	  	ravraper	le	retard	.	
trans	 en	outre	,	unk1	op  rahons	suppl  mentaires	,	dont	la	chirurgie	unk5	et	la	

unk6	,	permevront	de	r  sorber	l'	arri  r  	.	
en	outre	,	2600	op  rahons	suppl  mentaires	,	dont	la	chirurgie	
orthop  diques	et	la	cataracte	,	permevront	de	r  sorber	l'	arri  r  	.	

trans
+unk	

       predict	well	long-distance	alignments.	

      correct:	cataract	vs.	cataracte.	
	

thang	luong	-	neural	machine	translahon	

5/19/16	

65	

sample	transla/ons	

source	

human	

trans	

trans
+unk	

this	trader	,	richard	usher	,	lel	rbs	in	2010	and	is	understand	to	have	
be	given	leave	from	his	current	posihon	as	european	head	of	forex	spot	
trading	at	jpmorgan	.	
ce	trader	,	richard	usher	,	a	quiv  	rbs	en	2010	et	aurait	  t  	mis	
suspendu	de	son	poste	de	responsable	europ  en	du	trading	au	
comptant	pour	les	devises	chez	jpmorgan	.	
ce	unk0	,	richard	unk0	,	a	quiv  	unk1	en	2010	et	a	compris	qu'	il	est	
autoris  	  	quiver	son	poste	actuel	en	tant	que	leader	europ  en	du	
march  	des	points	de	vente	au	unk5	.	
ce	n  gociateur	,	richard	usher	,	a	quiv  	rbs	en	2010	et	a	compris	qu'	il	
est	autoris  	  	quiver	son	poste	actuel	en	tant	que	leader	europ  en	du	
march  	des	points	de	vente	au	jpmorgan	.	

       translate	well	long	sentences.	
      correct:	jpmorgan	vs.	jpmorgan.	
	

thang	luong	-	neural	machine	translahon	

5/19/16	

66	

sample	transla/ons	

source	 but	concerns	have	grown	aler	mr	mazanga	was	quoted	as	saying	

renamo	was	abandoning	the	1992	peace	accord	.	

human	 mais	l'	inqui  tude	a	grandi	apr  s	que	m.	mazanga	a	d  clar  	que	la	

renamo	abandonnait	l'	accord	de	paix	de	1992	.	

trans	 mais	les	inqui  tudes	se	sont	accrues	apr  s	que	m.	unkpos3	a	d  clar  	

que	la	unk3	unk3	l'	accord	de	paix	de	1992	.	
mais	les	inqui  tudes	se	sont	accrues	apr  s	que	m.	mazanga	a	d  clar  	
que	la	renamo	  tait	l'	accord	de	paix	de	1992	.	

trans
+unk	

      

incorrect	alignment	predichon:	was	   	  tait	vs.	abandonnait.	

5/19/16	

thang	luong	-	neural	machine	translahon	

67	

advancing	id4	
       #1:	the	vocabulary	size	problem	

      sol:	   copy   	mechanism.	

ecotax	

pont-de-buis	

the			<unk>			porhco			in			<unk>	

	

le			<unk>			<unk>			de				<unk>	

por8que	   cotaxe	

pont-de-buis	

       #2:	the	sentence	length	problem	

      sol:	avenhon	mechanism.	

je

suis   tudiant

i

am

a student

_

je

suis   tudiant

       #3:	the	language	complexity	problem	

      sol:	character-level	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

68	

#2	the	sentence	length	problem	

je

suis   tudiant

_

i

am

a student

_

je

suis   tudiant

       translahon	quality	degrades	with	long	sentences.	

problem:	sentence	meaning	is	represented	

by	a	   xed-dimensional	vector.	

5/19/16	

thang	luong	-	neural	machine	translahon	

69	

you	can't	cram	the	meaning	of	a	whole	

%&!$#	sentence	into	a	single	$&!#*	vector!	

	

5/19/16	

thang	luong	-	neural	machine	translahon	

70	

(adapted	from	kyunghuyn	cho   	talk)	

amen/on	mechanism	

je

suis   tudiant

_

pool	of		
source		
states	

i

am

a student

_

je

suis   tudiant

       soluhon:	random	access	memory	

      retrieve	as	needed.	

5/19/16	

thang	luong	-	neural	machine	translahon	

71	

without	avenhon	

with	avenhon	

dzmitry	bahdanau,	kyunghuyn	cho,	and	yoshua	bengio.	neural	machine	

transla>on	by	jointly	learning	to	translate	and	align.	iclr	2015.	

5/19/16	

thang	luong	-	neural	machine	translahon	

72	

amen/on	mechanism	

suis

attention layer
context 
vector

?	

i

am

a student

_

je

a	simpli   ed	version	of	(bahdanau	et	al.,	2015)	

5/19/16	

thang	luong	-	neural	machine	translahon	

73	

amen/on	mechanism	   	scoring	

suis

attention layer
context 
vector
3	

?	

i

am

a student

_

je

       compare	target	and	source	hidden	states.	

5/19/16	

thang	luong	-	neural	machine	translahon	

74	

amen/on	mechanism	   	scoring	

suis

attention layer
context 
vector
3	
5	

?	

i

am

a student

_

je

       compare	target	and	source	hidden	states.	

5/19/16	

thang	luong	-	neural	machine	translahon	

75	

amen/on	mechanism	   	scoring	

suis

attention layer
context 
vector
5	
3	

1	

?	

i

am

a student

_

je

       compare	target	and	source	hidden	states.	

5/19/16	

thang	luong	-	neural	machine	translahon	

76	

amen/on	mechanism	   	scoring	

suis

attention layer
context 
vector
5	
3	

1	

1	

?	

i

am

a student

_

je

       compare	target	and	source	hidden	states.	

5/19/16	

thang	luong	-	neural	machine	translahon	

77	

amen/on	mechanism	   	normaliza>on	

attention layer
context 
vector
0.3	 0.5	 0.1	

0.1	

suis

?	

i

am

a student

_

je

       convert	into	alignment	weights.	

5/19/16	

thang	luong	-	neural	machine	translahon	

78	

amen/on	mechanism	   	context	vector	

context vector

suis

?	

i

am

a student

_

je

       build	context	vector:	weighted	average.	

5/19/16	

thang	luong	-	neural	machine	translahon	

79	

amen/on	mechanism	   	hidden	state	

context vector

suis

i

am

a student

_

je

       compute	the	next	hidden	state.	

5/19/16	

thang	luong	-	neural	machine	translahon	

80	

amen/on	mechanism	   	predict	

context vector

suis

i

am

a student

_

je

       predict	the	next	word.	

5/19/16	

thang	luong	-	neural	machine	translahon	

81	

       examine	various	avenhon	mechanisms:	

global:	all	source	states.	

local:	subset	of	source	states.	

sota	for	english-german	translahon.	

thang	luong,	hieu	pham,	and	chris	manning.	e   ec>ve	approaches	to	

agen>on-based	neural	machine	transla>on.	emnlp	2015.	

5/19/16	

thang	luong	-	neural	machine	translahon	

82	

translate	long	sentences	

avenhon	

 

ours, no attn (id7 13.9)
ours, local   p attn (id7 20.9)
ours, best system (id7 23.0)
wmt   14 best (id7 20.7)
jeans et al., 2015 (id7 21.6)

no	avenhon	

25

20

15

10

(cid:0)
(cid:0)
(cid:0)
(cid:0)
(cid:0)
u
e
l
b

 

10

20

30

40

sent lengths

50

60

70

5/19/16	

thang	luong	-	neural	machine	translahon	

83	

sample	english-german	transla/ons	

source	 orlando	bloom	and	miranda	kerr	shll	love	each	other		

human	 orlando	bloom	und	miranda	kerr	lieben	sich	noch	immer	
best	 orlando	bloom	und	miranda	kerr	lieben	einander	noch	

immer	.		

base	 orlando	bloom	und	lucas	miranda	lieben	einander	noch	

immer	.		

       translate	names	correctly.	

5/19/16	

thang	luong	-	neural	machine	translahon	

84	

sample	english-german	transla/ons	

source	

human	

we	  	re	pleased	the	faa	recognizes	that	an	enjoyable	passenger	experience	is	
not	incompa>ble	with	safety	and	security	,	said	roger	dow	,	ceo	of	the	u.s.	
travel	associahon	.		
wir	freuen	uns	,	dass	die	faa	erkennt	,	dass	ein	angenehmes	passagiererlebnis	
nicht	im	wider-	spruch	zur	sicherheit	steht	,	sagte	roger	dow	,	ceo	der	u.s.	
travel	associahon	.		

best	 wir	freuen	uns	,	dass	die	faa	anerkennt	,	dass	ein	angenehmes	ist	nicht	mit	

sicherheit	und	sicherheit	unvereinbar	ist	,	sagte	roger	dow	,	ceo	der	us	-	die	.		
wir	freuen	uns	u	  ber	die	<unk>	,	dass	ein	<unk>	<unk>	mit	sicherheit	nicht	
vereinbar	ist	mit	sicherheit	und	sicherheit	,	sagte	roger	cameron	,	ceo	der	us	
-	<unk>	.		

base	

       translate	a	doubly-negated	phrase	correctly	
       fail	to	translate	   passenger	experience   .	

5/19/16	

thang	luong	-	neural	machine	translahon	

85	

sample	english-german	transla/ons	

source	

human	

we	  	re	pleased	the	faa	recognizes	that	an	enjoyable	passenger	experience	is	
not	incompa>ble	with	safety	and	security	,	said	roger	dow	,	ceo	of	the	u.s.	
travel	associahon	.		
wir	freuen	uns	,	dass	die	faa	erkennt	,	dass	ein	angenehmes	passagiererlebnis	
nicht	im	wider-	spruch	zur	sicherheit	steht	,	sagte	roger	dow	,	ceo	der	u.s.	
travel	associahon	.		

best	 wir	freuen	uns	,	dass	die	faa	anerkennt	,	dass	ein	angenehmes	ist	nicht	mit	

sicherheit	und	sicherheit	unvereinbar	ist	,	sagte	roger	dow	,	ceo	der	us	-	die	.		
wir	freuen	uns	u	  ber	die	<unk>	,	dass	ein	<unk>	<unk>	mit	sicherheit	nicht	
vereinbar	ist	mit	sicherheit	und	sicherheit	,	sagte	roger	cameron	,	ceo	der	us	
-	<unk>	.		

base	

       translate	a	doubly-negated	phrase	correctly	
       fail	to	translate	   passenger	experience   .	

5/19/16	

thang	luong	-	neural	machine	translahon	

86	

ted	talk,	english-german	

winning	

30.85	

id7	

26.18	 26.02	 24.96	

22.51	

20.08	

35	

30	

25	

20	

15	

10	

5	

0	

human	ter	

28.18	

26%	

21.84	 22.67	 23.42	

16.16	

30	

25	

20	

15	

10	

5	

stanford	 edinburgh	karlsruhe	heidelberg	 pjait	
thang	luong	and	chris	manning.	stanford	neural	machine	transla>on	

systems	for	spoken	language	domain.	iwslt	2015.	

5/19/16	

thang	luong	-	neural	machine	translahon	

87	

0	

advancing	id4	
       #1:	the	vocabulary	size	problem	

      sol:	   copy   	mechanism.	

ecotax	

pont-de-buis	

the			<unk>			porhco			in			<unk>	

	

le			<unk>			<unk>			de				<unk>	

por8que	   cotaxe	

pont-de-buis	

       #2:	the	sentence	length	problem	

      sol:	avenhon	mechanism.	

je

suis   tudiant

i

am

a student

_

je

suis   tudiant

       #3:	the	language	complexity	problem	

      sol:	character-level	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

88	

#3	the	rare	word	problem	
          copying   	mechanisms	are	not	su   cient.	

      di   erent	alphabets:	christopher	   	kry  tof	
      mulh-word	alignment:	solar	system	   	sonnensystem	

       need	to	handle	large,	open	vocabulary	

      rich	morphology:	nejneobhospoda  ov  vateln  j    mu	

	

	

	

	

	

					(   to	the	worst	farmable	one   )	

      informal	spelling:	goooooood	morning	!!!!!	
be	able	to	generate	at	the	character	level.	

5/19/16	

thang	luong	-	neural	machine	translahon	

89	

recent	character-level	id4	

       unsahsfactory	performance	

      (wang	ling,	isabel	trancoso,	chris	dyer,	alan	black,	
arxiv	2015)	

       incomplete	soluhon	

      decoder	only	(junyoung	chung,	kyunghyun	cho,	
yoshua	bengio.	arxiv	2016).	

5/19/16	

thang	luong	-	neural	machine	translahon	

90	

       a	best-of-both-worlds	architecture:	

      translate	mostly	at	the	word	level	
      only	go	the	character	level	when	needed.	

       addihonal	+2.1	   	+11.4	id7	improvement.	

sota	for	english-czech	translahon.	

thang	luong	and	chris	manning.	achieving	open	vocabulary	neural	machine	

transla>on	with	hybrid	word-character	models.	in	submission,	acl	2016.	

5/19/16	

thang	luong	-	neural	machine	translahon	

91	

hybrid	id4	

word-level	
(4	layers)	

end-to-end	training	

8-stacking	lstm	layers.	

5/19/16	

thang	luong	-	neural	machine	translahon	

92	

source		

representa/ons	

       on-the-   y	embeddings.	

      zero-init,	batch	computahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

	

93	

target	

genera/on	

init	with	word	
hidden	states.	

purposely,	use	<unk>	to	
make	decoding	easier.	

5/19/16	

thang	luong	-	neural	machine	translahon	

94	

english-czech	wmt   15	results	

systems	

winning	entry	(bojar	&	tamchyna,	2015)	

id7	
18.8	

exis8ng	word-level	id4	(jean	et	al.,	2015)	

30x	data	
3	systems	

single	model	
ensemble	4	models	

15.7	
18.3	

large	vocab	
+	unk	replace	

5/19/16	

thang	luong	-	neural	machine	translahon	

95	

english-czech	wmt   15	results	

systems	

winning	entry	(bojar	&	tamchyna,	2015)	

id7	
18.8	

exis8ng	word-level	id4	(jean	et	al.,	2015)	

single	model	
ensemble	4	models	

our	character-based	id4	

single	model	(600-step	backprop)	

15.7	
18.3	

15.9	

30x	data	
3	systems	

large	vocab	
+	unk	replace	

       purely	character-based:	slow	but	promising!	

5/19/16	

thang	luong	-	neural	machine	translahon	

96	

english-czech	wmt   15	results	

systems	

winning	entry	(bojar	&	tamchyna,	2015)	

id7	
18.8	

exis8ng	word-level	id4	(jean	et	al.,	2015)	

single	model	
ensemble	4	models	

our	character-based	id4	

single	model	(600-step	backprop)	
our	hybrid	id4	

single	model	

15.7	
18.3	

15.9	

19.6	

30x	data	
3	systems	

large	vocab	
+	unk	replace	

	new	
sota!	

5/19/16	

thang	luong	-	neural	machine	translahon	

97	

english-czech	wmt   15	results	

systems	

winning	entry	(bojar	&	tamchyna,	2015)	

id7	
18.8	

exis8ng	word-level	id4	(jean	et	al.,	2015)	

single	model	
ensemble	4	models	

our	character-based	id4	

single	model	(600-step	backprop)	
our	hybrid	id4	

single	model	
ensemble	4	models	

15.7	
18.3	

15.9	

19.6	
20.7	

5/19/16	

thang	luong	-	neural	machine	translahon	

30x	data	
3	systems	

large	vocab	
+	unk	replace	

bemer	
sota!	

98	

e   ects	of	vocabulary	sizes	

word	

word	+	unk	replace	

hybrid	

1k	

20k	
10k	
vocabulary	size	

50k	

	

u
e
l
b

20	
18	
16	
14	
12	
10	
8	
6	
4	
2	
0	

5/19/16	

thang	luong	-	neural	machine	translahon	

99	

e   ects	of	vocabulary	sizes	

word	

word	+	unk	replace	

hybrid	

+3.5	

+4.5	

+2.1	

+11.4	

1k	

20k	
10k	
vocabulary	size	

50k	

addihonal	gains	of	+2.1	   	+11.4	id7	

thang	luong	-	neural	machine	translahon	

100	

	

u
e
l
b

20	
18	
16	
14	
12	
10	
8	
6	
4	
2	
0	

5/19/16	

e   ects	of	vocabulary	sizes	

word	

word	+	unk	replace	

hybrid	

1k	

small-vocab	hybrid	=	large-vocab	word	

20k	
10k	
vocabulary	size	

50k	

	

u
e
l
b

20	
18	
16	
14	
12	
10	
8	
6	
4	
2	
0	

5/19/16	

thang	luong	-	neural	machine	translahon	

101	

rare	word	embeddings	

loveless
spiritless

heartlessly
heartlessness

narrow(cid:239)mindedness

narrow(cid:239)minded

wholeheartedness

nonconscious
uncontroversial

unattainableness
inabilities

impossibilities

untrustworthy

unrealizable

possible

necessary

impossible

acceptable
satisfactory

unacceptable

unsatisfactory
unsuitable

insufficiency

uncomfortable
insensitive

unaffected

noticeable
perceptible

immobile

immoveable

disrespectful
ungraceful
regretful

illiberal

unconcern

admittanceadmitting

founder

chooses
nominated

sponsor

antagonist

antagonize

obvious

advance

explicit

evidently

acknowledgement

developments

develop

unsighted
unfeathered
unfledged

practice

governance

management

0.6

0.7

connect
link
0.8

0.1

0.2

0.3

0.4

0.5

       word	&	character-based	embeddings.	

5/19/16	

thang	luong	-	neural	machine	translahon	

admissionadmit

decide

choose

cofounders

companionships
1

0.9

102	

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

rare	word	embeddings	

loveless
spiritless

heartlessly
heartlessness

narrow(cid:239)mindedness

narrow(cid:239)minded

wholeheartedness

nonconscious
uncontroversial

unattainableness
inabilities

impossibilities

untrustworthy

unrealizable

possible

necessary

impossible

acceptable
satisfactory

unacceptable

unsatisfactory
unsuitable

insufficiency

uncomfortable
insensitive

unaffected

noticeable
perceptible

immobile

immoveable

disrespectful
ungraceful
regretful

illiberal

unconcern

admittanceadmitting

founder

chooses
nominated

sponsor

antagonist

antagonize

obvious

advance

explicit

evidently

acknowledgement

developments

develop

unsighted
unfeathered
unfledged

practice

governance

management

0.6

0.7

connect
link
0.8

0.1

0.2

0.3

0.4

0.5

       word	&	character-based	embeddings.	

5/19/16	

thang	luong	-	neural	machine	translahon	

admissionadmit

decide

choose

cofounders

companionships
1

0.9

103	

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

rare	word	embeddings	

loveless
spiritless

heartlessly
heartlessness

narrow(cid:239)mindedness

narrow(cid:239)minded

wholeheartedness

nonconscious
uncontroversial

unattainableness
inabilities

impossibilities

untrustworthy

unrealizable

possible

necessary

impossible

acceptable
satisfactory

unacceptable

unsatisfactory
unsuitable

insufficiency

uncomfortable
insensitive

unaffected

noticeable
perceptible

immobile

immoveable

disrespectful
ungraceful
regretful

illiberal

unconcern

admittanceadmitting

founder

chooses
nominated

sponsor

antagonist

antagonize

obvious

advance

explicit

evidently

acknowledgement

developments

develop

unsighted
unfeathered
unfledged

practice

governance

management

0.6

0.7

connect
link
0.8

0.1

0.2

0.3

0.4

0.5

       word	&	character-based	embeddings.	

5/19/16	

thang	luong	-	neural	machine	translahon	

admissionadmit

decide

choose

cofounders

companionships
1

0.9

104	

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

sample	english-czech	transla/ons	

source	 the	author	stephen	jay	gould	died	20	years	aler	diagnosis	.	
human	 autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	
char	 autor	stepher	stepher	zem  el	20	let	po	diagn  ze	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	po	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	

hybrid	

word	

5/19/16	

thang	luong	-	neural	machine	translahon	

perfect	

translahon!	

105	

sample	english-czech	transla/ons	

source	 the	author	stephen	jay	gould	died	20	years	aler	diagnosis	.	
human	 autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	
char	 autor	stepher	stepher	zem  el	20	let	po	diagn  ze	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	po	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	

hybrid	

word	

       char-based:	wrong	name	translahon.	
       char-based:	wrong	name	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

106	

sample	english-czech	transla/ons	

source	 the	author	stephen	jay	gould	died	20	years	aler	diagnosis	.	
human	 autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	
char	 autor	stepher	stepher	zem  el	20	let	po	diagn  ze	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	po	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	

hybrid	

word	

       word-based:	incorrect	alignment	
       char-based:	wrong	name	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

107	

sample	english-czech	transla/ons	

word	

source	 the	author	stephen	jay	gould	died	20	years	aler	diagnosis	.	
human	 autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	
char	 autor	stepher	stepher	zem  el	20	let	po	diagn  ze	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	po	.	
autor	stephen	jay	<unk>	zem  el	20	let	po	<unk>	.	
autor	stephen	jay	gould	zem  el	20	let	po	diagn  ze	.	
       char-based	&	hybrid:	correct	translahon	of	diagn  ze.	
       char-based:	wrong	name	translahon.	

hybrid	

5/19/16	

thang	luong	-	neural	machine	translahon	

108	

sample	english-czech	transla/ons	

source	 as	the	reverend	mar>n	luther	king	jr.	said	   ty	years	ago	:	
human	 jak	p  ed	pades  /	lety	  ekl	reverend	mar/n	luther	king	jr	.	:	
char	

jako	reverend	mar/n	luther	kr  l	    kal	p  ed	pades  >	lety	:	
jak	  ekl	reverend	marhn	<unk>	king	<unk>	p  ed	pades  h	lety	:	
jak	  ekl	reverend	mar/n	luther	king	  ekl	p  ed	pades  >	lety	:	
jak	  ekl	reverend	marhn	<unk>	king	<unk>	p  ed	pades  h	lety	:	
jak	p  ed	pades  /	lety	  ekl	reverend	mar/n	luther	king	jr.	:	

word	

hybrid	

5/19/16	

thang	luong	-	neural	machine	translahon	

correct	

reordering!	

109	

sample	english-czech	transla/ons	

source	 as	the	reverend	mar>n	luther	king	jr.	said	   ty	years	ago	:	
human	 jak	p  ed	pades  /	lety	  ekl	reverend	mar/n	luther	king	jr	.	:	
char	

jako	reverend	mar/n	luther	kr  l	    kal	p  ed	pades  >	lety	:	
jak	  ekl	reverend	marhn	<unk>	king	<unk>	p  ed	pades  h	lety	:	
jak	  ekl	reverend	mar/n	luther	king	  ekl	p  ed	pades  >	lety	:	
jak	  ekl	reverend	marhn	<unk>	king	<unk>	p  ed	pades  h	lety	:	
jak	p  ed	pades  /	lety	  ekl	reverend	mar/n	luther	king	jr.	:	

word	

hybrid	

       char-based:	   kr  l   	means	   king   .	
       char-based:	wrong	name	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

110	

sample	english-czech	transla/ons	

source	 her	11-year-old	daughter	,	shani	bart	,	said	it	felt	a	livle	bit	weird	
human	 jej  	jeden  c/let  	dcera	shani	bartov  	prozradila	,	  e	je	to	trochu	zvl    tn  	

char	 jej  	jeden  c/let  	dcera	,	shani	bartov  	,	    kala	,	  e	c  (cid:136)	trochu	divn  	

word	

hybrid	

jej  	<unk>	dcera	<unk>	<unk>	  ekla	,	  e	je	to	trochu	divn  	

jej  	11-year-old	dcera	shani	,	  ekla	,	  e	je	to	trochu	divn  	

jej  	<unk>	dcera	,	<unk>	<unk>	,	  ekla	,	  e	je	to	<unk>	<unk>	

jej  	jeden  c/let  	dcera	,	graham	bart	,	  ekla	,	  e	c  (cid:136)	trochu	divn  	

5/19/16	

thang	luong	-	neural	machine	translahon	

generate	

complex	words!	

111	

sample	english-czech	transla/ons	

source	 her	11-year-old	daughter	,	shani	bart	,	said	it	felt	a	livle	bit	weird	
human	 jej  	jeden  c/let  	dcera	shani	bartov  	prozradila	,	  e	je	to	trochu	zvl    tn  	

char	 jej  	jeden  c/let  	dcera	,	shani	bartov  	,	    kala	,	  e	c  (cid:136)	trochu	divn  	

word	

jej  	<unk>	dcera	<unk>	<unk>	  ekla	,	  e	je	to	trochu	divn  	

jej  	11-year-old	dcera	shani	,	  ekla	,	  e	je	to	trochu	divn  	

jej  	<unk>	dcera	,	<unk>	<unk>	,	  ekla	,	  e	je	to	<unk>	<unk>	

hybrid	

jej  	jeden  c/let  	dcera	,	graham	bart	,	  ekla	,	  e	c  (cid:136)	trochu	divn  	
       word-based:	idenhty	copy	fails.	
       char-based:	wrong	name	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

112	

sample	english-czech	transla/ons	

source	 her	11-year-old	daughter	,	shani	bart	,	said	it	felt	a	livle	bit	weird	
human	 jej  	jeden  c/let  	dcera	shani	bartov  	prozradila	,	  e	je	to	trochu	zvl    tn  	

char	 jej  	jeden  c/let  	dcera	,	shani	bartov  	,	    kala	,	  e	c  (cid:136)	trochu	divn  	

word	

jej  	<unk>	dcera	<unk>	<unk>	  ekla	,	  e	je	to	trochu	divn  	

jej  	11-year-old	dcera	shani	,	  ekla	,	  e	je	to	trochu	divn  	

jej  	<unk>	dcera	,	<unk>	<unk>	,	  ekla	,	  e	je	to	<unk>	<unk>	

hybrid	

jej  	jeden  c/let  	dcera	,	graham	bart	,	  ekla	,	  e	c  (cid:136)	trochu	divn  	
       hybrid:	translate	names	incorrectly.	
       char-based:	wrong	name	translahon.	

5/19/16	

thang	luong	-	neural	machine	translahon	

113	

we	have	advanced	id4	

       #1:	the	vocabulary	size	problem	

       sol:	   copy   	mechanism.	
       sota	english-french	

       #2:	the	sentence	length	problem	

       sol:	avenhon	mechanism.	
       sota	english-german	

ecotax	

pont-de-buis	

the			<unk>			porhco			in			<unk>	

	

le			<unk>			<unk>			de				<unk>	

por8que	   cotaxe	

pont-de-buis	

je

suis   tudiant

i

am

a student

_

je

suis   tudiant

       #3:	the	language	complexity	problem	

       sol:	character-level	translahon.	
       sota	english-czech	

5/19/16	

thang	luong	-	neural	machine	translahon	

114	

thank	you!	

id4	&	beyond	
       unsupervised	learning	for	id4	

       uhlize	monolingual	data.	

       long-context	id4	

       translahng	an	arhcle	/	a	book.	
       smarter	avenhon,	longer	sequences.	

       mulh-modal	language	understanding	system	

       mulh-lingual	translahon	+	speech	recognihon	+	more	
       mulh-task	learning	

5/19/16	

thang	luong	-	neural	machine	translahon	

115	

i   m	done.		

but	if	you	are	curious,	read	on!	

5/19/16	

thang	luong	-	neural	machine	translahon	

116	

#4	for	the	future	of	id4	

       can	we	uhlize	all	sequence-to-sequence	data?		

	
	

machine	translahon	

	
	

conshtuent	parsing	

       can	we	compress	id4	for	mobile	devices?	

5/19/16	

thang	luong	-	neural	machine	translahon	

117	

our	work	

       mulh-task	learning:	
      machine	translahon	
      image	caphon	generahon		   	unsupervised	learning	

	   	conshtuent	parsing	

	

       translahon	improvement:	up	to	+1.5	id7.	
       state-of-the-art	in	conshtuent	parsing.	

thang	luong,	quoc	le,	ilya	sutskever,	oriol	vinyals,	and	lukasz	kaiser.		

mul>-task	sequence	to	sequence	learning.	iclr	2016.	

5/19/16	

thang	luong	-	neural	machine	translahon	

118	

many-to-one:		
shared	decoder	

german (translation)

image (captioning)

english

english (unsupervised)

19	
18.5	
18	
17.5	
17	
16.5	
16	

big	(transla>on)	+	medium	(cap>on)	

+0.7	
id7	

german-english	transla/on	(id7)	

(luong	et	al.,	2015)	

single	

+	caphon	(0.1x)	

+	caphon	(0.05x)	

+	caphon	(0.01x)	

5/19/16	

thang	luong	-	neural	machine	translahon	

119	

one-to-many:		
shared	encoder	

german (translation)

english

tags (parsing)

english (unsupervised)

16	
15.5	
15	
14.5	
14	
13.5	
13	

big	(transla>on)	+	small	(ptb	parsing)	

+1.5	
id7	

english-german	transla/on	(id7)	

(luong	et	al.,	2015)	

single	

+	parsing	(1x)	

+	parsing	(0.1x)	

+	parsing	(0.01x)	

5/19/16	

thang	luong	-	neural	machine	translahon	

mixing	raho	

120	

our	work	
       compress	id4	via	pruning	&	retraining:	

e
r
o
c
s
u
e
l
b

25

20

15

10

5

0

0

original	model	

prune	+	retrain	

prune	smallest	weights	

pruned
pruned and retrained

10

20

30

40

50

60

70

80

90

abigail	see*,	thang	luong*,	and	chris	manning.	compression	of	neural	

figure 1: performance of pruned models, immediately after pruning and after
retraining.

machine	transla>on	models	via	pruning.	in	submission.	

thang	luong	-	neural	machine	translahon	

5/19/16	

121	

percentage pruned

our	work	
       compress	id4	via	pruning	&	retraining:	

e
r
o
c
s
u
e
l
b

25

20

15

10

5

0

0

original	model	

prune	+	retrain	

prune	smallest	weights	

pruned
pruned and retrained

10

20

30

40

50

60

70

80

90

percentage pruned

prune	80%	without	loss	of	performance.	

figure 1: performance of pruned models, immediately after pruning and after
retraining.

thang	luong	-	neural	machine	translahon	

5/19/16	

122	

id4	redundancy	   	embeddings	
       frequent	words	have	larger	weights	

      white:	large.	
      black:	small.	

most common word

least common word

target embedding weights

source embedding weights

source layer 1 weights

source layer 2 weights

source layer 3 weights

source layer 4 weights

input gate

forget gate

5/19/16	

output gate

thang	luong	-	neural	machine	translahon	

123	

id4	redundancy	   	lstm	

least common word

most common word

target embedding weights

source embedding weights

layer	1	

source layer 1 weights

layer	2	

source layer 2 weights

layer	3	

source layer 3 weights

layer	4	

source layer 4 weights

input	gate	

input gate

forget	gate	

forget gate

output	gate	

output gate

input	signal	

input

feed-forward	 recurrent	

feed-forward

recurrent

target layer 1 weights

target layer 2 weights

target layer 3 weights

target layer 4 weights

encoder	

decoder	

5/19/16	

thang	luong	-	neural	machine	translahon	

124	

id4	redundancy	   	lstm	

least common word

most common word

target embedding weights

source embedding weights

layer	1	

source layer 1 weights

layer	2	

source layer 2 weights

layer	3	

source layer 3 weights

layer	4	

source layer 4 weights

input	gate	

input gate

forget	gate	

forget gate

output	gate	

output gate

input	signal	

input

feed-forward	 recurrent	

feed-forward

recurrent

target layer 1 weights

target layer 2 weights

input	signal	
is	important!	

target layer 3 weights

target layer 4 weights

encoder	

decoder	

5/19/16	

thang	luong	-	neural	machine	translahon	

125	

id4	redundancy	   	lstm	

least common word

most common word

target embedding weights

source embedding weights

layer	1	

source layer 1 weights

layer	2	

source layer 2 weights

layer	3	

source layer 3 weights

layer	4	

source layer 4 weights

input	gate	

input gate

forget	gate	

forget gate

output	gate	

output gate

input	signal	

input

feed-forward	 recurrent	

feed-forward

recurrent

target layer 1 weights

target layer 2 weights

forget	gate:	
small	   	layer	1	
large	   	layer	4	

target layer 3 weights

target layer 4 weights

encoder	

decoder	

5/19/16	

thang	luong	-	neural	machine	translahon	

126	

future	challenges	

thank	you!	

she	saw	an	elephant	in	her	dress.	

she	saw	an	elephant	in	her	dress.	
the	elephant	must	have	a	good	

sense	of	fashion!	

needs	to	understand		

common	sense	&	larger	context.	

5/19/16	

thang	luong	-	neural	machine	translahon	

127	

