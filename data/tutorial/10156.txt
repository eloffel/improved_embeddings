extracting spatial information from networks with

low-order eigenvectors

mihai cucuringu   , vincent d. blondel    , and paul van dooren   

abstract. we consider the problem of inferring meaningful spatial information in networks from incomplete
information on the connection intensity between the nodes of the network. we consider two spatially distributed
networks: a population migration    ow network within the us, and a network of mobile phone calls between cities
in belgium. for both networks we use the eigenvectors of the laplacian matrix constructed from the link intensities
to obtain informative visualizations and capture natural geographical subdivisions. we observe that some low order
eigenvectors localize very well and seem to reveal small geographically cohesive regions that match remarkably well
with political and administrative boundaries. we discuss possible explanations for this observation by describing
diffusion maps and localized eigenfunctions. in addition, we discuss a possible connection with the weighted graph
cut problem, and provide numerical evidence supporting the idea that lower order eigenvectors point out local cuts
in the network. however, we do not provide a formal and rigorous justi   cation for our observations.

key words. eigenvector localization, diffusion maps, visualization of large data sets, social-economic networks,

community detection, gravity model.

ams subject classi   cations. 15a18, 92-08, 91c20, 90b18

1. introduction. extensive research over the last decades has greatly increased our un-
derstanding of the topology and the spatial distribution of many social, biological and tech-
nological networks. this paper considers the problem of inferring meaningful spatial and
structural information from incomplete data sets of pairwise interactions between nodes in a
network.

the way people interact in many aspects of everyday life often re   ect surprisingly well
geopolitical boundaries. this inhomogeneity of connections in networks leads to natural
divisions, and identifying such divisions can provide valuable insight into how interactions
in a network are in   uenced by its topology. the problem of    nding the so-called network
communities, i.e., groups of tightly connected nodes, has been extensively studied in recent
years and many community detection algorithms exist with different levels of success [10].
in this paper, we consider two particular networks: a county-to-county migration network
constructed from 1995-2000 us census data, and a city-to-city communication network built
from mobile phone data over a six months period in belgium. communities in these net-
works emerge naturally and are revealed, often at different scales, by the eigenvectors of a
normalized matrix constructed from the weighted adjacency matrix of the network. we dis-
cuss possible explanations for this observation by describing diffusion maps and localized
eigenfunctions.

in the remaining part of this introduction we report on some related contributions that
deal with communities in networks and spectrum of matrices. however, in none of these
contributions we were able to    nd an explanation of why low order eigenvectors localize so
well and seem to identify meaningful geographical boundaries.

one example of a recent study that is related to our work both in terms of the technique
and end goal, is a paper by ratti et al. [23]. starting from measures of the communication
intensities between counties in the uk, the authors propose a spectral modularity    optimiza-

1
1
0
2

 
v
o
n
3

 

 
 
]
i
s
.
s
c
[
 
 

1
v
0
2
9
0

.

1
1
1
1
:
v
i
x
r
a

road, princeton nj 08544-1000 usa, email: mcucurin@math.princeton.edu
emails: {vincent.blondel, paul.vandooren}@uclouvain.be

   program in applied and computational mathematics (pacm), princeton university, fine hall, washington
   department of applied mathematics, universit  e catholique de louvain, b-1348 louvain-la-neuve, belgium,
   many popular methods for community detection in networks are based on the optimization of the modularity

function, a measure of the quality of a network partition into communities.

1

2

mihai cucuringu, paul van dooren, vincent d. blondel

tion algorithm that partitions the country into small non-overlapping geographically cohesive
regions that correspond remarkably well with administrative regions.

in [27], the authors shi and malik develop a spectral-based algorithm that solves the
perceptual grouping problem in id161 by treating the task of image segmentation
as a graph partitioning problem. their approach is to segment the graph by introducing a
new global criterion called normalized cut, that measures not just the dissimilarity between
different groups but also the total similarity within the groups themselves. they successfully
extract global impressions of a scene and provide a hierarchical description of it.

in another recent paper [24], the authors connect mobile data from telecom italia mobile
to a series of human activities derived from data on commercial premises advertised through
the italian version of    yellow pages   . the eigendecomposition of a speci   c correlation ma-
trix provides a top eigenvector which clearly indicates a common underlying pattern to mobile
phone usage in rome, while the second and third eigenvectors indicate spatial variation that
is very suggestive of temporally-related and activity-related patterns.

another line of work where lower order eigenvectors provide useful information comes
from the community detection literature. newman [20] shows that the modularity of a net-
work can be expressed in terms of the top eigenvalues and eigenvectors of a matrix called
the modularity matrix, which plays a role in the maximization of the modularity equivalent
to that played by the laplacian in standard spectral partitioning. in related work, richardson
et al. [25] extend previously available methods for spectral optimization of modularity by in-
troducing a computationally ef   cient algorithm for spectral tripartitioning of a network using
the top two eigenvectors of the modularity matrix.

recent work [9], co-authored by one of the authors of this paper, investigates the con-
straints imposed by space on the network topology, and focuses on community detection by
proposing a modularity function adapted to spatial networks. the proposed methods were
tested on a large mobile phone network and computer-generated benchmarks, and showed
that it is possible to factor out the effect of space in order to reveal more clearly any hidden
structural similarities between the nodes.

finally, we point out a recent paper of onnela et al. [21] who investigate social networks
of individuals whose most frequent geographic locations are known. the authors classify
the members into groups using community detection algorithms, and explore the relationship
between their topological and geographic positions.

this paper is organized as follows: section 2 is an introduction to the diffusion map
technique and some of its underlying theory. section 3 contains the results of numerical sim-
ulations in which we applied diffusion maps and eigenvector colorings to the us migration
data set. in section 4 we present the outcome of similar experiments on the belgium mobile
phone data set. in section 5, we explore the connection with localized eigenfunctions, a phe-
nomenon observed before in the mathematics and physics community. finally, the last section
is a summary and a discussion of possible extensions of our approach and its usefulness in
other applications.

2. diffusion maps and eigenvector colorings. this section is a brief introduction to
the diffusion maps literature and references therein. we also clarify the notion of eigen-
vector localizations and eigenvector coloring, that we use in subsequent sections. diffusion
maps were introduced in s. lafon   s ph.d. thesis [14] in 2004 as a id84
tool, and connected data analysis and id91 techniques based on eigenvectors of similar-
ity matrices with the geometric structure of non-linear manifolds. in recent years, diffusion
maps have gained a lot of popularity. a nonexhaustive list of references to its underlying
theory and applications includes [1, 6, 7, 8, 14]. often called laplacian eigenmaps, these
manifold learning techniques identify signi   cant variables that live in a lower dimensional

extracting spatial information from networks with low-order eigenvectors

3

space, while preserving the local proximity between data points. consider a set of n points
v = {x1, x2, . . . , xn} in an n-dimensional space rn, where each point (typically) character-
izes an image (or an audio stream, text string, etc.). if two images xi and xj are similar, then
||xi     xj|| is small. a popular measure of similarity between points in rn is de   ned using
the gaussian kernel wij = e   ||xi   xj||2/ , for some constant  , so that the closer xi is from
xj, the larger wij. the matrix w = (wij)1   i,j   n is symmetric and has positive coef   cients.

to normalize w , we de   ne the diagonal matrix d, with dii =(cid:80)n

j=1 wij and de   ne a by

a = d   1w

such that every row of a sums to 1.
next, one may also de   ne the symmetric matrix s = d   1/2w d   1/2, which can also
be written as s = d1/2ad   1/2 and hence is similar to a. as a symmetric matrix, s
has an orthogonal basis of eigenvectors v0, v1, . . . , vn   1 associated to the n real ordered
eigenvalues 1 =   0       1     . . .       n   1.
if we decompose s as s = v   v t with
v v t = v t v = i and    = diag(  0,   1, . . . ,   n   1), then a becomes a =       t
where    = d   1/2v and    = d1/2v . therefore a   =      and the columns of    form
a d-orthogonal basis of eigenvectors with columns   0,   1, . . . ,   n   1 (i.e. (cid:104)  i, d  j(cid:105) =
0,   i (cid:54)= j) associated to the n real eigenvalues   0,   1, . . . ,   n   1 such that a  i =   i  i, for
i = 0, 1, . . . n     1. also,   t a =     t implies that the columns of    are left eigenvectors
of a, which we denote by   0,   1, . . . ,   n   1. since   t    = i, it follows that the vectors   i
and   j are bi-orthonormal (cid:104)  i,   j(cid:105) =   i,j.

note that since a is a row-stochastic matrix,   0 = 1 and   0 = (1, 1, . . . , 1)t , and we
disregard this trivial eigenvalue/eigenvector pair as irrelevant. using the stochasticity of a,
we can interpret it as a random walk matrix on a weighted graph g = (v, e, w ), where the
set of nodes consists of the points xi, and there is an edge between nodes i and j if and ony
if wij > 0. taking this perspective, aij denotes the transition id203 from point xi to xj
in one step time    t =  

p r{x(t +  ) = xj|x(t) = xi} = aij.

   

   

the parameter   can now be interpreted in two ways. on the one hand, it is the squared radius
of the neighborhood used to infer local geometric and density information, in particular wij
 , but it is exponentially small for points that
is o(1) when xi and xj are in a ball of radius
are more than
  apart. on the other hand,   represents the the discrete time step at which
the random walk jumps from one point to another.
interpreting the eigenvectors as functions over our data set, the diffusion map (also called
laplacian eigenmap) maps points from the original space to the    rst k eigenvectors, l : v (cid:55)   
rk, is de   ned as
(2.1)

lt(xj) = (  t

2  2(j), . . . ,   t

1  1(j),   t

k  k(j))

aij =(cid:80)n   1

where the meaning of the exponent t will be made clear in what follows.

r=0   r  r(i)  r(j), and note that at

using the left and right eigenvectors denoted earlier, we now write the entries of a as
r  r(i)  r(j). however, recall that
the id203 distribution of a random walk landing at location xj after exactly t steps, given
ij = p r{x(t) = xj|x(0) = xi}.
that is starts at point xi is precisely given by the expression at
given the random walk interpretation, it is natural to quantify the similarity between two
points according to the evolution of their id203 distributions

r=0   t

ij =(cid:80)n   1

n(cid:88)

k=1

d2

t (i, j) =

(at

ik     at

jk)2 1
dk

,

4

mihai cucuringu, paul van dooren, vincent d. blondel

where the weight 1
takes into account the empirical local density of the points by giving
dk
larger weight to the vertices of lower degree. since dt(i, j) naturally depends on the random
walk on the graph, it is denoted as the diffusion distance at time t.
in the diffusion map
introduced above, it is a matter of choice to tune the parameter t corresponding to the number
of time steps of the random walk. note that we used t = 1 in the diffusion maps embeddings
throughout our simulations, and that using different values of t corresponds to rescaling the
axis. the euclidean distance between two points in the diffusion map space introduced in
(2.1) is given by

(2.2)

||l(xi)     l(xj)||2 =

r  r(i)       t

n   1(cid:88)

(cid:0)  t

r  r(j)(cid:1)2

.

r=1

notice that the    rst eigenvalue   0 does not enter this expression, since it cancels out. more-
over, as shown in [19], the expression (2.2) equals the diffusion distance d2
t (i, j), when
k = n     1, i.e., when all n     1 eigenvectors are considered. for ease of visualization, we
used the top k = 2 eigenvectors for the projections shown in figures 3.1, 3.2 and 4.1.
finally, we denote by ci the coloring of the n data points given by the eigenvector   i,
where the color of point xk     v is given by the j-th entry in   i, i.e.

ci(xk) =   i(k), for all i = 1, . . . , n and k = 0, . . . , n     1.

1       t

k >    but   t

2 . . .       t

we refer to ci as an eigenvector coloring    of order i. the top left plot in figure 3.4 shows the
eigenvector coloring of order k = 1, together with the associated colorbar. in practice, only
the    rst k eigenvectors are used in the diffusion map introduced in (2.1), with k << n     1
chosen such that   t
k+1 <   , where    is a chosen tolerance. typi-
cally, only the top few eigenvectors of a are expected to contain meaningful information, but
as illustrated by the eigenvector colorings shown in this paper, one can extract relevant infor-
mation from eigenvectors of much lower order. the phenomenon of eigenvector localization
occurs when most of the components of an eigenvector are zero or close to zero, and almost
all the mass is localized on a relatively small subset of nodes. on the contrary, delocalized
eigenvectors have most of their components small and of roughly the same magnitude. fur-
thermore, note there is no issue with the fact that the eigenvectors are de   ned up to a scalar.
since each of them is normalized and real, we can just consider eigenvectors of different
sign, however this can only reverse the color map used, and does not change the localization
phenomenon.

3. us census migration data. we apply the diffusion map technique to the 2000 us
census that reports the number of people that migrated from every county to every other
county in the us during the 1995-2000 time frame [5, 22]. we denote by m = (mij)1   i,j   n
the total number of people that migrated between county i and county j (so mij = mji),
where n = 3107 denotes the number of counties in mainland us. we let pi denote the
population of county i. figures 3.1 and 3.2 show the results of the diffusion map technique
m 2
for longitude and latitude colorings when the following kernels are used: w (1)
,
ij
pipj
w (2)
. the diffusion map resulting from these kernels place
the midwest closer to the west coast (figure 3.1), but further from the east coast. similarly,
the colorings based on latitude reveal the north-south separation. note that kernel w (1) does
a better job at separating the east and west coasts, figure 3.1 (b), while kernel w (2) highlights
best the separation between north and south as shown in figure 3.2 (c). figure 3.3 shows the

ij = 5500 mij
pipj

ij = mij
pi+pj

, and w (3)

ij =

   not to be confused with the    coloring    terminology from id207, where the colors are integers.

extracting spatial information from networks with low-order eigenvectors

5

histogram of the top 500 eigenvalues of the diffusion matrix a, when different kernels are
used.

our kernel of choice for the eigenvector colorings in figures 3.4 and 3.5 was w (1), as it
produced more visually appealing results in terms of state boundary detection. for the same
reason, we omit the numerical simulations where we used exponential weights to compute
the similarity between the nodes. note also that the spectrum of a = d   1w (1) in the left of
figure 3.3 is rather different from the other two spectra, with many more large eigenvalues
and without a visible spectral gap. for the rest of this section, we drop the superscript from
matrix w (1) and refer to it as w .

(a) map of usa, colored by longitude

(b) kernel w (1)

ij =

m 2
ij
pipj

(c) kernel w (2)

ij =

mij

pi+pj

(d) kernel w (3)

ij =

mij
pipj

fig. 3.1. diffusion map reconstructions from the top two eigenvectors, for various kernels, with nodes colored

by longitude.

in figure 3.6 we plot the histograms of the entries of several eigenvectors of a. note
that the top eigenvector provides a meaningful partitioning that separates the east from the
midwest, and has its entries spread in the interval [   0.03, 0.03] with few entries of zero
magnitude. on the other hand, the eigenvectors   7,   28 and   83 are localized in the sense
that they have their larger entries localized on a speci   c subregion of the us map (highlighted
in blue or red in the eigenvector colorings), while taking small values in magnitude on the rest
of the domain. we explore in section 5 the connection with the phenomenon of    localized
eigenfunctions    of the laplace operator.

we use the rest of this section to provide a possible interpretation of the color coded
regions that stand out in the eigenvector colorings in figures 3.4 and 3.5. by interpreting
the matrix w as a weighted graph, we explore a possible connection of such geographically
cohesive colored subgraphs with the graph partitioning problem. in general, the graph par-
titioning problem seeks to decompose a graph into k disjoint subgraphs (clusters), while
minimizing the sum of the weights of the    cut    edges, i.e., edges with endpoints in different

6

mihai cucuringu, paul van dooren, vincent d. blondel

(a) map of usa, colored by latitude

(b) kernel w (1)

ij =

m 2
ij
pipj

(c) kernel w (2)

ij =

mij

pi+pj

(d) kernel w (3)

ij = 5500

mij
pipj

fig. 3.2. diffusion map reconstructions from the top two eigenvectors, for various kernels, with nodes colored

by latitude.

(a) a = d   1w (1)

(b) a = d   1w (2)

(c) a = d   1w (3)

fig. 3.3. histogram of the top 500 eigenvalues of matrix a for different kernels.

(3.1)

where ew(x, y ) =(cid:80)

clusters. given the number of clusters k, the weighted-min-cut problem is an optimization
problem that computes a partition p1, . . . ,pk of the vertex set, by minimizing the weights
of the cut edges

weighted cut(p1, . . . ,pk) =

ew(pi,pi),

k(cid:88)

i=1

i   x,j   y wij, and x denotes the complement of x. for an extensive
literature survey on spectral id91 algorithms we refer the reader to [30], and point out
the popular spectral relaxation of (3.1) introduced by shi and malik [27].

when dividing a graph into two smaller subgraphs, one wishes to minimize the sum of
the weights on the edges across two different subgraphs, and simultaneously, maximize the
sum of the weights on the edges within the subgraphs. alternatively, one tries to maximize the

extracting spatial information from networks with low-order eigenvectors

7

fig. 3.4. top eigenvector colorings for the similarity matrix wij =

m 2
ij
pipj

.

8

mihai cucuringu, paul van dooren, vincent d. blondel

fig. 3.5. selected colorings by lower order eigenvectors for the similarity matrix wij =

m 2
ij
pipj

.

extracting spatial information from networks with low-order eigenvectors

9

(a)   1

(b)   7

(c)   28

(d)   83

fig. 3.6. histogram of the entries in the eigenvectors   1,   7,   28 and   83 of matrix a = d   1w (1)

ratio between the latter quantity and the former, i.e., between the weights of the inside edges
and the weights of the outside edges. to that end, we perform the following experiment,
where we regard the us states as the clusters, and investigate the possibility that the isolated
colored regions that emerge correspond to local cuts in the weighted graph.
we denote by s the matrix of size n    n (n = 49 the number of mainland us states)
that aggregates the similarities between counties at the level of states. in particular, if state i
has k counties with indices x1, . . . , xk, and state j has l counties with indices y1, . . . , yl, then
we consider the k    l submatrix

(3.2)

  wi,j = w{x1,...,xk},{y1,...,yl}

i

i

(cid:80)n

and denote by sij the sum of the kl entries in   wi,j. in other words, matrix s is a    state-
collapsed    version of the matrix w , and gives a measure of similarity between pairs of states.
the heatmap in    gure 3.7 shows the components of the matrix s on a logarithmic scale,
where the intensity of entry (i, j) denotes the aggregated similarity between states i and j.

we refer to the diagonal entry sii as the    inside degree    of state i, din

measures the internal similarity between the counties of state i. we denote by dout

i = sii, which
i =
u=1,u(cid:54)=i si,u (i.e., the sum of the non-diagonal elements in row i) the    outside degree   
of node i, which measures the similarity/migration between the counties of state i and all
other counties outside of state i. finally, we denote by dratio
, the    ratio degree    of
node i which straddles the boundary between intra-state and inter-state migration. a large
ratio degree is a good indicative that a state is very well connected internally, and has little
connectivity with the outside world, and thus is a good candidate for a cluster. in other words,
a large    ratio degree    of a cluster (i.e., state) denotes a high measure of separation between
that cluster and its environment, which is something discovered by the localization properties
of the low-order eigenvectors. table 3 ranks the top 15 states within the us in terms of their
ratio degree.

= din
dout

i

next, we examine the top several eigenvector colorings in figure 3.4, and point out the
individual states on which the eigenvectors localize, together with its rank in terms of    ratio
degree   . note that the entries of large magnitude are colored in red and blue, while the rest
of the spectrum denotes values of smaller magnitude or very close to zero. the top three
eigenvectors correspond to global cuts between various coasts within the us. the only state
that stands out individually is michigan (mi) for k = 3, which has rank 2. for k = 4, the
largest entries correspond to counties in virginia (va) which is also ranked 1st, and similarly
for wisconsin (wi) for k = 5, ranked 14. for k = 6, the states colored in dark red and dark
blue are georgia (ga) with rank 3, and missouri (mo) of rank 8. when k = 7, michigan
(mi), of rank 2, stands out as the only dark blue colored state. for k = 8, we point out
georgia, rank 3, together with mississippi (ms) of rank 11, and louisiana (la) of rank 10.
eigenvector k = 9 localizes mostly on maine (me) of rank 6, and the new york (ny) area

10

mihai cucuringu, paul van dooren, vincent d. blondel

fig. 3.7. heatmap of the inter-state migration    ows, where the rows and columns of the matrix are sorted by
the ratio degrees of the states. the intensity of entry (i, j) denotes, on a logarithmic scale, the similarity between
states i and j, i.e., the sum of all entries in the submatrix   wi,j de   ned in 3.2. table 3 lists the top 15 states in terms
of ratio degree.

with rank 7. finally, eigenvector k = 10 localizes on a combination of states we already
pointed out. we have thus enumerated nine states that stand out in the top ten eigenvector
colorings, and all nine of them appear in table 3 that ranks the top    fteen states in terms
of    ratio degree   . although this experiment does not provide a formal justi   cation for the
eigenvector localization phenomenon, we believe it is a    rst step in providing evidence that
the low order eigenvectors point out local cuts in the network.

4. belgium mobile network. in a recent work [13], we studied the anonymized mobile
phone communication from a belgian operator and derived a statistical model of interaction
between cities, showing that inter-city communication intensity is characterized be a gravity
model: the communication intensity between two cities is proportional to the product of their
sizes divided by the square of their distance. in this section, we brie   y describe the belgium
mobile data set, summarize the results in [13], and apply the diffusion map technique. we
refer the reader to [2] for more information on the mobile phone data set.

the data set contains anonymous communication patterns of 2.5 million mobile phone
customers, grouped in 571 cities in belgium over a period of six months in 2006 (see also
[15] for a description of the data set). every customer is associated with the zip code of
her/his billing address. note that calls involving other operators were    ltered out, meaning
that both the calling and receiving individuals in the data set are customers of the mobile
phone company. also, there is a link between two customers if at least three calls were made

extracting spatial information from networks with low-order eigenvectors

11

state
ratio degree
rank
va
26.7
1.
mi
20.4
2.
ga
19.9
3.
in
19.7
4.
tx
19.0
5.
me
18.9
6.
ny
18.7
7.
mo 18.5
8.
17.1
co
9.
16.6
10.
la
11. ms
16.1
15.7
ca
12.
15.6
13.
oh
14.5
14. wi
nc
14.4
15.

left: top 15 states within the us, ordered by ratio degree. right: map of mainland us showing the names of

table 3.1

the states.

in both directions during the six month interval. after this pre-processing, the network has
2.5 million nodes and 38 million links. for every pair of customers we associate a commu-
nication intensity by computing the total communication time in seconds. after grouping
the customers into their corresponding cities, we compute tij, the aggregated communica-
tion time in seconds between the customers of city i and j, and denote the resulting matrix
by t = (tij)1   i<j   n. we denote by nij the number of phone calls between cities i and
j, by rij = tij
the average duration of a call, and by pi the number of customers that
nij
have the zip code billing address of city i (from now on, we refer to pi as the population of
city i). furthermore, the normalized number of phone calls with respect to the population of
the cities is denoted by   nij = nij
, and similarly the normalized communication time by
pipj
  tij = tij
. finally, d = (dij)1   i<j   n represents the distances between the centroids of the
pipj
areas of cities i and j. using these quantities, we now consider the following three kernels:
ij = e   (rij   tij)2
w (1)
figure 4.1 shows the diffusion map reconstructions for various matrices w that relate
cities based on their communication intensities and population sizes. for w (2) and w (3),
there is an obvious separation between the north and south parts of belgium, which stems
from the fact that the two regions belong to different linguistic groups. the same separation
is emphasized by the colorings associated to the top eigenvector of matrix a, shown in figure
4.2. the remaining eigenvector colorings in figure 4.2 clearly isolate various subregions in
belgium. for example, eigenvectors   1 and   11 highlight language communities (french,
dutch and german), while   3 and   5 isolate the regions of li`ege and limburg.

(cid:18) r0.16

/0.22, w (2)

, and w (3)

= nij
pipj

ij = e

ij =

(cid:19)2

  tij
rij

  n 0.26

   

.

ij

ij

5. localized eigenfunctions. let us    rst make more precise what is meant by a lo-
calized eigenfunction. this phenomenon of localization occurs when there exist eigenfunc-
tions supported by small regions of the domain, i.e. they are localized in these regions. an
eigenfunction localized on a domain    1 has support on    1 signi   cantly larger than on the
complement    \   1, and yet it cannot vanish on    \   1 since eigenfunctions of isolated eigen-
values are real analytic functions and cannot vanish on any open set. this is also observed

12

mihai cucuringu, paul van dooren, vincent d. blondel

(a) map of belgium, colored by latitude

(b) kernel w (1)

ij = e   (rij

  tij)2/0.22

(cid:32) r0.16

ij

  n 0.26

ij

   

(c) kernel w (2)

ij = e

(cid:33)2

(d) kernel w (3)

ij =

  tij
rij

=

nij
pipj

fig. 4.1. diffusion map reconstructions from the top two eigenvectors, for various kernels. tij denotes the
tij
aggregated communication time in seconds, nij the number of phone calls between cities i and j, rij =
nij
the average duration of a call, and pi the population of city i. we normalize by the population size by de   ning
  nij =

and   tij =

.

nij
pipj

tij
pipj

in the histogram of the entries of the eigenvectors   7,   28 and   83 shown in figure 3.6 and
the corresponding colorings in the    gures 3.4 and 3.5. in contrast, eigenfunctions that do not
localize have their support    uniformly    distributed across the domain, similar to the case of
eigenvector   1 from figure 3.6. for example, in the case of the unit interval, the eigenfunc-
tions of the laplacian are the sine or cosine functions (depending on the boundary conditions)
with the larger eigenvalues corresponding to higher oscillations, and they are not localized in
the sense that there is no speci   c subinterval that carries the most (potential) energy of the
eigenfunction, and any subinterval supports an amount of energy that is proportional to its
length. in other words, the energy of the top eigenfunctions is distributed uniformly across
the domain, and similar results are known to hold for the disk and the sphere, where the
laplacian eigenvalues and eigenfunctions are explicitly known.

the behavior observed in the eigenvector colorings from    gures 3.4, 3.5 and 4.2 is related
to the notion of localized eigenfunctions, a phenomenon observed before in the mathematics
and physics community. the spectrum of the (continuous) laplace operator has been exten-
sively studied, and there exists a rich literature on the relationship between the spectrum and
the geometry of the domain. as more complicated objects, eigenfunctions are more dif   cult

extracting spatial information from networks with low-order eigenvectors

13

fig. 4.2. colorings by the top 18 eigenvectors of a = d   1w (3), where w (3)

ij =

  tij
rij

=

nij
pipj

to analyze than the spectrum, and less is known about them. most of the literature is fo-
cused on high frequency eigenfunctions (associated to larger eigenvalues), such as [3, 4, 12],
although recent studies such as [11] advocated localized eigenfunctions associated to small
eigenvalues.
in our experiments, we found the bottom eigenvectors uninteresting as they
did not contain any meaningful geometric information. in his work, sapoval [26] studied
localized eigenfunctions in different domains and pointed out their importance for physical
applications, such as designing ef   cient noise-protective walls.

finally, considering that a is a stochastic matrix, one may further explore ideas from

14

mihai cucuringu, paul van dooren, vincent d. blondel

the theory of nearly completely decomposable matrices developed in 1961 by nobel laureate
herbert simon and his collaborator albert ando to describe and identify the short, medium
and long-term behaviors of a dynamical system [28]. very recent work [18] explores this idea
in the context of stochastic data id91, and proposes a technique that uses the evolution
of the system to infer information on the initial structure.

6. summary and discussion. we have shown how the diffusion map technique can be
used to obtain informative visualizations and capture natural subdivisions within two different
real networks. we    nd surprising that some low order eigenvectors localize very well and
seem to reveal small geographically cohesive regions; it is natural to ask for an explanation
for our observation.

in looking at    gures 3.4 and 3.5 many more questions come to mind. are the state
boundaries a consequence of people migrating within the same state or not? in other words,
do states emerge as communities because of people migrating from one county to the other
within the state, or because of similar migration patterns directed outside the state? prelim-
inary analysis on the migration data set in the context of local id91 on graphs supports
the idea that the localized low-order eigenvectors highlight local cuts in the network. this is
perhaps counter-intuitive since such low-order eigenvectors must satisfy the global require-
ment of exact orthogonality with respect to all of the earlier delocalized eigenvectors, and
they must do so while keeping most of their components zero or close to zero. another ques-
tion to consider is whether, besides the state boundary detection, the eigenvector colorings
reveal any extra information on the intensity of the migration from one region to the other.
furthermore, inter-county migration is most common among young adults and declines as
people age, and one may ask how the age composition (or income level) of individual us
counties impacts the migration pattern.

in answering these questions, one needs to complement the mathematical description
of diffusion maps and id91 by eigenvectors with a socio-demographic behavioral inter-
pretation of migration trends, as considered for example in [16, 17]. a more recent paper
by slater [29] is of particular interest since it analyzes migration patterns in the us census
data from 1965-1970 and 1995-2000. amongst others, it highlights cosmopolitan or hub like
regions, as well as isolated regions that emerge when there is a high measure of separation
between a cluster and its environment.

another interesting direction worth exploring is seeing how the diffusion map recon-
structions and colorings change when the matrices used are no longer symmetric. in the case
of the us migration data, it may be the case that there are many states for which the most
common migration destination is the major city/capital of that state (although there might be
other destinations spread across the us that attract people migrating out from that state). it is
therefore natural to expect that major cities will stand out in the colorings, however this is not
the case in our simulations since we symmetrize the migration matrix and take into account
both the in- and out-migration from a given state.

7. acknowledgments. we would like to thank amit singer for introducing m.c. to
diffusion maps and suggesting this as a possible approach for analyzing the belgium mobile
data set; etienne huens and gautier krings for useful discussions and help with processing
the same data set; michael mahoney, mauro maggioni, peter mucha, mark newman and
mason porter for useful discussions on community detection and references to the literature
on localized eigenfunctions; thomas espenshade, kevin o   neil, john palmer, and ashton
verdery for references and useful discussions on demographic trends in us migration.

references

extracting spatial information from networks with low-order eigenvectors

15

[1] m. belkin and p. niyogi, laplacian eigenmaps for id84 and data representation,

neural computation, 6 (2003), pp. 1373   1396.

[2] v. d. blondel, j.-l. guillaume, r. lambiotte, and e. lefebvre, fast unfolding of communites in

large networks, journal of statistical mechanics: theory and experiment, 1742-5468 (2008). p10008.
[3] n. burq and m. zworski, bouncing ball modes and quantum chaos, siam rev., 47 (2005), pp. 43   49.
[4] v. m. b. c and v. f. lazutkin, the eigenfunctions which are concentrated near a closed geodesic, prob-

lems of mathematical physics, spectral theory, diffraction problems (russian), 2 (1967), pp. 15   25.

[5] u. s. census bureau, 2002. www.census.gov/population/www.cen2000/ctytoctyflow/

index.html.

[6] r. r. coifman, i. g. kevrekidis, s. lafon, m. maggioni, and b. nadler, diffusion maps, reduc-
tion coordinates and low dimensional representation of stochastic systems, siam multiscale modeling
and simulation, 7 (2008), pp. 842   864.

[7] r. r. coifman and s. lafon, diffusion maps, appl comput harmonic anal, 21 (2006), pp. 5   30.
[8] r. r. coifman, s. lafon, a. b. lee, m. maggioni, b. nadler, f. warner, and s. w. zucker,
geometric diffusions as a tool for harmonic analysis and structure de   nition of data: diffusion maps,
pnas, 102 (2005), pp. 7426   7431.

[9] p. expert, t. evans, v. blondel, and r. lambiotte, uncovering space-independent communities in
spatial networks, pnas (proceedings of the national academy of sciences), 108 (2011), pp. 7663   7668.

[10] s. fortunato, community detection in graphs, physics reports, 486 (2010), pp. 75   174.
[11] s. m. heilman and r. s. strichartz, localized eigenfunctions: here you see them, there you don   t,

notices amer. math. soc., 57 (2010), pp. 624   629.

[12] p. w. jones, m. maggioni, and r. schul, manifold parameterizations by eigenfunctions of the laplacian

and heat kernels, proc. natl. acad. sci. usa, 6 (2008), pp. 1803   1808.

[13] g. krings, f. calabrese, c. ratti, and v. d. blondel, urban gravity: a model for inter-city

telecommunication    ows, journal of statistical mechanics: theory and experiment, l07003 (2009).

[14] s. lafon, diffusion maps and geometric harmonics, ph.d. thesis, (2004).
[15] r. lambiotte, v. d. blondel, c. de kerchove, e. huens, c. prieur, z. smoreda, and p. v.
dooren, geographical dispersal of mobile communication networks, physica a: statistical mechanics
and its applications, 387 (2008), pp. 5317   5325.

[16] e. s. lee, a theory of migration, population association of america, demography, 3 (1966), pp. 47   57.
[17] d. s. massey, j. a. g. hugo, a. kouaouci, a. pellegrino, and j. e. taylor, theories of interna-
tional migration: a review and appraisal, population and development review, 19 (1993), pp. 431   466.

[18] c. d. meyer and c. d. wessell, stochastic data id91, (2010). submitted, arxiv:1008.1758.
[19] b. nadler, s. lafon, r. coifman, and i. kevrekidis, diffusion maps, spectral id91 and eigen-

functions of fokker-planck operators, vol. 18, 2005.

[20] m. e. j. newman, finding community structure in networks using the eigenvectors of matrices, physical

review e, 74 (2006). 036104.

[21] j. onnela, s. arbesman, m. c. gonzalez, a. l. barabasi, and n. a. christakis, geographic

constraints on social network groups, plos one, 6 (2011). e16939.

[22] m. j. perry, state-to-state migration flows: 1995 to 2000, census 2000 special reports, (2003).
[23] c. ratti, s. sobolevsky, f. calabrese, c. andris, j. reades, m. martino, r. claxton, and
s. h. strogatz, redrawing the map of great britain from a network of human interactions, plos
one, 5 (2010).

[24] j. reades, f. calabrese, and c. ratti, eigenplaces: analyzing cities using the space-time structure of

the mobile phone network, environment and planning b, 36 (2009), pp. 824   836.

[25] t. richardson, p. j. mucha, and m. a. porter, spectral tripartitioning of networks, physical review

e, 80 (2009). 036111.

[26] s. russ, b. sapoval, and o. haeberl   e, irregular and fractal resonators with neumann boundary con-

ditions: density of states and localization, phys. rev. e, 55 (1997), pp. 1413   1421.

[27] j. shi and j. malik, normalized cuts and image segmentation, ieee transactions on pattern analysis and

machine intelligence, 22 (2000), pp. 888   905.

[28] h. a. simon and a. ando, aggregation of variables in dynamic systems, econometrica, 29 (1961),

pp. 111   138.

[29] p. b. slater, hubs and clusters in the evolving united states internal migration network, isber, university

of california, santa barbara, (2008). arxiv:0809.2768v3.

[30] u. von luxburg, a tutorial on spectral id91, statistics and computing, springer netherlands, 17

(2007), pp. 395   416. issn 0960-3174.

