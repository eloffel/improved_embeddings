6
1
0
2

 
l
u
j
 

2
2

 
 
]

g
l
.
s
c
[
 
 

7
v
0
2
5
3
0

.

2
0
5
1
:
v
i
x
r
a

rand-walk: a latent variable model approach to word

embeddings

sanjeev arora

yuanzhi li

yingyu liang

tengyu ma

andrej risteski    

abstract

semantic id27s represent the meaning of a word via a vector, and are created by diverse
methods. many use nonlinear operations on co-occurrence statistics, and have hand-tuned hyperparam-
eters and reweighting methods.

this paper proposes a new generative model, a dynamic version of the log-linear topic model of mnih
and hinton (2007). the methodological novelty is to use the prior to compute closed form expressions
for word statistics. this provides a theoretical justi   cation for nonlinear models like pmi, id97,
and glove, as well as some hyperparameter choices. it also helps explain why low-dimensional semantic
embeddings contain id202ic structure that allows solution of word analogies, as shown by mikolov
et al. (2013a) and many subsequent papers.

experimental support is provided for the generative model assumptions, the most important of which

is that latent word vectors are fairly uniformly dispersed in space.

1 introduction

vector representations of words (id27s) try to capture relationships between words as distance or
angle, and have many applications in computational linguistics and machine learning. they are constructed
by various models whose unifying philosophy is that the meaning of a word is de   ned by    the company it
keeps    (firth, 1957), namely, co-occurrence statistics. the simplest methods use word vectors that explicitly
represent co-occurrence statistics. reweighting heuristics are known to improve these methods, as is dimen-
sion reduction (deerwester et al., 1990). some reweighting methods are nonlinear, which include taking the
square root of co-occurrence counts (rohde et al., 2006), or the logarithm, or the related pointwise mutual
information (pmi) (church and hanks, 1990). these are collectively referred to as vector space models,
surveyed in (turney and pantel, 2010).

neural network language models (rumelhart et al., 1986; 1988; bengio et al., 2006; collobert and weston,
2008a) propose another way to construct embeddings: the word vector is simply the neural network   s internal
representation for the word. this method is nonlinear and nonconvex. it was popularized via id97, a
family of energy-based models in (mikolov et al., 2013b;c), followed by a id105 approach called
glove (pennington et al., 2014). the    rst paper also showed how to solve analogies using id202 on
id27s. experiments and theory were used to suggest that these newer methods are related to
the older pmi-based models, but with new hyperparameters and/or term reweighting methods (levy and
goldberg, 2014b).
but note that even the old pmi method is a bit mysterious. the simplest version considers a symmetric
matrix with each row/column indexed by a word. the entry for (w, w(cid:48)) is pmi(w, w(cid:48)) = log p(w,w(cid:48))
p(w)p(w(cid:48)) , where
p(w, w(cid:48)) is the empirical id203 of words w, w(cid:48) appearing within a window of certain size in the corpus,
and p(w) is the marginal id203 of w. (more complicated models could use asymmetric matrices with
   princeton university, computer science department. {arora,yuanzhil,yingyul,tengyu,risteski}@cs.princeton.edu.
this work was supported in part by nsf grants ccf-0832797, ccf-1117309, ccf-1302518, dms-1317308, simons investigator
award, and simons collaboration grant. tengyu ma was also supported by simons award for graduate students in theoretical
computer science and ibm phd fellowship.

1

columns corresponding to context words or phrases, and also involve tensorization.) then word vectors are
obtained by low-rank svd on this matrix, or a related matrix with term reweightings. in particular, the
pmi matrix is found to be closely approximated by a low rank matrix: there exist word vectors in say 300
dimensions, which is much smaller than the number of words in the dictionary, such that

(cid:104)vw, vw(cid:48)(cid:105)     pmi(w, w(cid:48))

(1.1)

where     should be interpreted loosely.

there appears to be no theoretical explanation for this empirical    nding about the approximate low
rank of the pmi matrix. the current paper addresses this. speci   cally, we propose a probabilistic model
of text generation that augments the log-linear topic model of mnih and hinton (2007) with dynamics, in
the form of a random walk over a latent discourse space. the chief methodological contribution is using the
model priors to analytically derive a closed-form expression that directly explains (1.1); see theorem 2.2
in section 2. section 3 builds on this insight to give a rigorous justi   cation for models such as id97
and glove, including the hyperparameter choices for the latter. the insight also leads to a mathematical
explanation for why these id27s allow analogies to be solved using id202; see section 4.
section 5 shows good empirical    t to this model   s assumtions and predictions, including the surprising one
that word vectors are pretty uniformly distributed (isotropic) in space.

1.1 related work

latent variable probabilistic models of language have been used for id27s before, including
id44 (lda) and its more complicated variants (see the survey (blei, 2012)), and some
neurally inspired nonlinear models (mnih and hinton, 2007; maas et al., 2011). in fact, lda evolved out of
e   orts in the 1990s to provide a generative model that    explains    the success of older vector space methods
like id45 (papadimitriou et al., 1998; hofmann, 1999). however, none of these earlier
generative models has been linked to pmi models.

levy and goldberg (2014b) tried to relate id97 to pmi models. they showed that if there were no
dimension constraint in id97, speci   cally, the    skip-gram with negative sampling (sgns)    version of the
model, then its solutions would satisfy (1.1), provided the right hand side were replaced by pmi(w, w(cid:48))       
for some scalar   . however, skip-gram is a discriminative model (due to the use of negative sampling), not
generative. furthermore, their argument only applies to very high-dimensional id27s, and thus
does not address low-dimensional embeddings, which have superior quality in applications.

hashimoto et al. (2016) focuses on issues similar to our paper. they model text generation as a random
walk on words, which are assumed to be embedded as vectors in a geometric space. given that the last word
produced was w, the id203 that the next word is w(cid:48) is assumed to be given by h(|vw     vw(cid:48)|2) for a
suitable function h, and this model leads to an explanation of (1.1). by contrast our random walk involves
a latent discourse vector, which has a clearer semantic interpretation and has proven useful in subsequent
work, e.g. understanding structure of id27s for polysemous words arora et al. (2016). also our
work clari   es some weighting and bias terms in the training objectives of previous methods (section 3) and
also the phenomenon discussed in the next paragraph.

researchers have tried to understand why vectors obtained from the highly nonlinear id97 models
exhibit linear structures (levy and goldberg, 2014a; pennington et al., 2014). speci   cally, for analogies like
   man:woman::king:??,    queen happens to be the word whose vector vqueen is the most similar to the vector
vking     vman + vwoman. this suggests that simple semantic relationships, such as masculine vs feminine
tested in the above example, correspond approximately to a single direction in space, a phenomenon we will
henceforth refer to as relations=lines.

section 4 surveys earlier attempts to explain this phenomenon and their shortcoming, namely, that they
ignore the large approximation error in relationships like (1.1). this error appears larger than the di   erence
between the best solution and the second best (incorrect) solution in analogy solving, so that this error could
in principle lead to a complete failure in analogy solving. in our explanation, the low dimensionality of the
word vectors plays a key role. this can also be seen as a theoretical explanation of the old observation that

2

dimension reduction improves the quality of id27s for various tasks. the intuitive explanation
often given    that smaller models generalize better   turns out to be fallacious, since the training method
for creating embeddings makes no reference to analogy solving. thus there is no a priori reason why low-
dimensional model parameters (i.e., lower model capacity) should lead to better performance in analogy
solving, just as there is no reason they are better at some other unrelated task like predicting the weather.

1.2 bene   ts of generative approaches

in addition to giving some form of    uni   cation    of existing methods, our generative model also brings
more intepretability to id27s beyond traditional cosine similarity and even analogy solving. for
example, it led to an understanding of how the di   erent senses of a polysemous word (e.g., bank) reside in
linear superposition within the id27 (arora et al., 2016). such insight into embeddings may
prove useful in the numerous settings in nlp and neuroscience where they are used.

another new explanatory feature of our model is that low dimensionality of id27s plays a key
theoretical role    unlike in previous papers where the model is agnostic about the dimension of the embed-
dings, and the superiority of low-dimensional embeddings is an empirical    nding (starting with deerwester
et al. (1990)). speci   cally, our theoretical analysis makes the key assumption that the set of all word vectors
(which are latent variables of the generative model) are spatially isotropic, which means that they have no
preferred direction in space. having n vectors be isotropic in d dimensions requires d (cid:28) n. this isotropy is
needed in the calculations (i.e., multidimensional integral) that yield (1.1). it also holds empirically for our
word vectors, as shown in section 5.

the isotropy of low-dimensional word vectors also plays a key role in our explanation of the rela-
tions=lines phenomenon (section 4). the isotropy has a    puri   cation    e   ect that mitigates the e   ect of
the (rather large) approximation error in the pmi models.

2 generative model and its properties

the model treats corpus generation as a dynamic process, where the t-th word is produced at step t. the
process is driven by the random walk of a discourse vector ct     (cid:60)d. its coordinates represent what is being
talked about.1 each word has a (time-invariant) latent vector vw     (cid:60)d that captures its correlations with
the discourse vector. we model this bias with a log-linear word production model:

pr[w emitted at time t | ct]     exp((cid:104)ct, vw(cid:105)).

(2.1)

the discourse vector ct does a slow random walk (meaning that ct+1 is obtained from ct by adding a small
random displacement vector), so that nearby words are generated under similar discourses. we are interested
in the probabilities that word pairs co-occur near each other, so occasional big jumps in the random walk
are allowed because they have negligible e   ect on these probabilities.

a similar log-linear model appears in mnih and hinton (2007) but without the random walk. the linear
chain crf of collobert and weston (2008b) is more general. the dynamic topic model of blei and la   erty
(2006) utilizes topic dynamics, but with a linear word production model. belanger and kakade (2015) have
proposed a dynamic model for text using kalman filters, where the sequence of words is generated from
gaussian linear dynamical systems, rather than the log-linear model in our case.

the novelty here over such past works is a theoretical analysis in the method-of-moments tradition (hsu
et al., 2012; cohen et al., 2012). assuming a prior on the random walk we analytically integrate out the
hidden random variables and compute a simple closed form expression that approximately connects the
model parameters to the observable joint probabilities (see theorem 2.2). this is reminiscent of analysis of
similar random walk models in    nance (black and scholes, 1973).

1this is a di   erent interpretation of the term    discourse    compared to some other settings in computational linguistics.

3

model details. let n denote the number of words and d denote the dimension of the discourse space,
where 1     d     n. inspecting (2.1) suggests word vectors need to have varying lengths, to    t the empirical
   nding that word probabilities satisfy a power law. furthermore, we will assume that in the bulk, the word
vectors are distributed uniformly in space, earlier referred to as isotropy. this can be quanti   ed as a prior
in the bayesian tradition. more precisely, the ensemble of word vectors consists of i.i.d draws generated by
v = s      v, where   v is from the spherical gaussian distribution, and s is a scalar random variable. we assume
s is a random scalar with expectation    =   (1) and s is always upper bounded by   , which is another
constant. here    governs the expected magnitude of (cid:104)v, ct(cid:105), and it is particularly important to choose it to
be   (1) so that the distribution pr[w|ct]     exp((cid:104)vw, ct(cid:105)) is interesting.2 moreover, the dynamic range of
word probabilities will roughly equal exp(  2), so one should think of    as an absolute constant like 5. these
details about s are important for realistic modeling but not too important in our analysis. (furthermore,
readers uncomfortable with this simplistic bayesian prior should look at section 2.2 below.)
finally, we clarify the nature of the random walk. we assume that the stationary distribution of the
random walk is uniform over the unit sphere, denoted by c. the transition kernel of the random walk can
d in (cid:96)2 norm.3
be in any form so long as at each step the movement of the discourse vector is at most  2/
this is still fast enough to let the walk mix quickly in the space.

under the bayesian prior, the partition function zc =(cid:80)

the following lemma (whose proof appears in the appendix) is central to the analysis.

it says that
w exp((cid:104)vw, c(cid:105)), which is the implied id172
in equation (2.1), is close to some constant z for most of the discourses c. this can be seen as a plausible
theoretical explanation of a phenomenon called self-id172 in id148: ignoring the partition
function or treating it as a constant (which greatly simpli   es training) is known to often give good results.
this has also been studied in (andreas and klein, 2014).

   

lemma 2.1 (concentration of partition functions). if the word vectors satisfy the bayesian prior described
in the model details, then

for  z = (cid:101)o(1/

   

n), and    = exp(      (log2 n)).

c   c [(1      z)z     zc     (1 +  z)z]     1       ,

pr

the concentration of the partition functions then leads to our main theorem (the proof is in the appendix).
the theorem gives simple closed form approximations for p(w), the id203 of word w in the corpus, and
p(w, w(cid:48)), the id203 that two words w, w(cid:48) occur next to each other. the theorem states the result for
the window size q = 2, but the same analysis works for pairs that appear in a small window, say of size 10,
as stated in corollary 2.3. recall that pmi(w, w(cid:48)) = log[p(w, w(cid:48))/(p(w)p(w(cid:48)))].

theorem 2.2. suppose the word vectors satisfy the inequality (2.2), and window size q = 2. then,

log p(w, w(cid:48)) =

    2 log z     ,

2

(cid:107)vw + vw(cid:48)(cid:107)2
2d
(cid:107)vw(cid:107)2
    log z     .
2d

2

for   = o( z) + (cid:101)o(1/d) + o( 2). jointly these imply:

log p(w) =

pmi (w, w(cid:48)) =

(cid:104)vw, vw(cid:48)(cid:105)

d

   o( ).
   

remarks 1. since the word vectors have (cid:96)2 norm of the order of
(cid:107)vw + vw(cid:48)(cid:107)2

d, for two typical word vectors vw, vw(cid:48),
2 is of the order of   (d). therefore the noise level   is very small compared to the leading

2a larger    will make pr[w|ct] too peaked and a smaller one will make it too uniform.
3 more precisely, the proof extends to any symmetric product stationary distribution c with sub-gaussian coordinate

(cid:2)(cid:107)c(cid:107)2(cid:3) = 1, and the steps are such that for all ct, ep(ct+1|ct)[exp(  

d(cid:107)ct+1     ct(cid:107))]     1 +  2 for some small  2.

satisfying ec

   

4

(2.2)

(2.3)

(2.4)

(2.5)

2d(cid:107)vw + vw(cid:48)(cid:107)2

term 1
empirically we also    nd higher error here.

2. for pmi however, the noise level o( ) could be comparable to the leading term, and

remarks 2. variants of the expression for joint id203 in (2.3) had been hypothesized based upon
empirical evidence in mikolov et al. (2013b) and also globerson et al. (2007), and maron et al. (2010) .

remarks 3. theorem 2.2 directly leads to the extension to a general window size q as follows:
corollary 2.3. let pq(w, w(cid:48)) be the co-occurrence id203 in windows of size q, and pmiq(w, w(cid:48)) be the
corresponding pmi value. then

log pq(w, w(cid:48)) =
pmiq (w, w(cid:48)) =

(cid:107)vw + vw(cid:48)(cid:107)2
2d
(cid:104)vw, vw(cid:48)(cid:105)

2

d

+       o( ).

    2 log z +        ,

(cid:16) q(q   1)

(cid:17)

where    = log

pair w, w(cid:48) could appear in any of (cid:0)q

.

2

2

(cid:1) positions within the window, and the joint id203 of w, w(cid:48) is

it is quite easy to see that theorem 2.2 implies the corollary 2.3, as when the window size is q the

roughly the same for any positions because the discourse vector changes slowly.
(of course, the error
term gets worse as we consider larger window sizes, although for any constant size, the statement of the
theorem is correct.) this is also consistent with the shift    for    tting pmi in (levy and goldberg, 2014b),
which showed that without dimension constraints, the solution to skip-gram with negative sampling satis   es
pmi (w, w(cid:48))        = (cid:104)vw, vw(cid:48)(cid:105) for a constant    that is related to the negative sampling in the optimization.
our result justi   es via a generative model why this should be satis   ed even for low dimensional word vectors.

2.1 proof sketches

here we provide the proof sketches, while the complete proof can be found in the appendix.

proof sketch of theorem 2.2 let w and w(cid:48) be two arbitrary words. let c and c(cid:48) denote two consecutive
context vectors, where c     c and c(cid:48)|c is de   ned by the markov kernel p(c(cid:48) | c).

we start by using the law of total expectation, integrating out the hidden variables c and c(cid:48):

p(w, w(cid:48)) = e
c,c(cid:48)
= e
c,c(cid:48)
= e
c,c(cid:48)

[pr[w, w(cid:48)|c, c(cid:48)]]
[p(w|c)p(w(cid:48)|c(cid:48))]

(cid:20) exp((cid:104)vw, c(cid:105))

exp((cid:104)vw(cid:48), c(cid:48)(cid:105))

zc

zc(cid:48)

(cid:21)

(2.6)

an expectation like (2.6) would normally be di   cult to analyze because of the partition functions.
however, we can assume the inequality (2.2), that is, the partition function typically does not vary much for
most of context vectors c. let f be the event that both c and c(cid:48) are within (1    z)z. then by (2.2) and the
union bound, event f happens with id203 at least 1     2 exp(      (log2 n)). we will split the right-hand
side (rhs) of (2.6) into the parts according to whether f happens or not.
exp((cid:104)vw(cid:48), c(cid:48)(cid:105))

rhs of (2.6) = e
c,c(cid:48)

(2.7)

zc

(cid:20) exp((cid:104)vw, c(cid:105))
(cid:123)(cid:122)
(cid:20) exp((cid:104)vw, c(cid:105))
(cid:123)(cid:122)

zc

t1

t2

(cid:124)
(cid:124)

+ e
c,c(cid:48)

zc(cid:48)

zc(cid:48)

exp((cid:104)vw(cid:48), c(cid:48)(cid:105))

(cid:21)
(cid:125)
(cid:21)
(cid:125)

1f

1   f

5

where   f denotes the complement of event f and 1f and 1   f denote indicator functions for f and   f ,
respectively. when f happens, we can replace zc by z with a 1     z factor loss: the    rst term of the rhs
of (2.7) equals to

(2.8)
on the other hand, we can use e[1   f ] = pr[   f ]     exp(      (log2 n)) to show that the second term of rhs

t1 =

z 2

[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f ]

1    o( z)

e
c,c(cid:48)

of (2.7) is negligible,

|t2| = exp(      (log1.8 n)) .
   
this claim must be handled somewhat carefully since the rhs does not depend on d at all. brie   y, the
d = o(log2 n)), any word vector vw and
reason this holds is as follows:
d)), and since e[1   f ] = exp(      (log2 n)), the
discourse c satis   es that exp((cid:104)vw, c(cid:105))     exp((cid:107)vw(cid:107)) = exp(o(
d =    (log2 n)), we can use concentration inequalities
claim follows directly; in the regime when d is large (
to show that except with a small id203 exp(      (d)) = exp(      (log2 n)), a uniform sample from the
sphere behaves equivalently to sampling all of the coordinates from a standard gaussian distribution with
mean 0 and variance 1
therefore it su   ces to only consider (2.8). our model assumptions state that c and c(cid:48) cannot be too

d , in which case the claim is not too di   cult to show using gaussian tail bounds.

in the regime when d is small (

(2.9)

   

   

di   erent. we leverage that by rewriting (2.8) a little, and get that it equals
[exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]

1    o( z)

t1 =

(cid:21)

z 2

1    o( z)

exp((cid:104)vw, c(cid:105)) e
c(cid:48)|c
[exp((cid:104)vw, c(cid:105))a(c)]

e
c

e
c

=

(2.10)
[exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]. we claim that a(c) = (1    o( 2)) exp((cid:104)vw(cid:48), c(cid:105)). doing some algebraic

z 2

where a(c) := e
c(cid:48)|c

manipulations,

a(c) = exp((cid:104)vw(cid:48), c(cid:105)) e
[exp((cid:104)vw(cid:48), c(cid:48)     c(cid:105))] .
c(cid:48)|c
   
furthermore, by our model assumptions, (cid:107)c     c(cid:48)(cid:107)      2/

d. so

(cid:104)vw, c     c(cid:48)(cid:105)     (cid:107)vw(cid:107)(cid:107)c     c(cid:48)(cid:107) = o( 2)

and thus a(c) = (1    o( 2)) exp((cid:104)vw(cid:48), c(cid:105)). plugging the simpli   cation of a(c) to (2.10),

1    o( z)

e[exp((cid:104)vw + vw(cid:48), c(cid:105))].

(2.11)
since c has uniform distribution over the sphere, the random variable (cid:104)vw + vw(cid:48), c(cid:105) has distribution pretty
similar to gaussian distribution n (0,(cid:107)vw + vw(cid:48)(cid:107)2/d), especially when d is relatively large. observe that
e[exp(x)] has a closed form for gaussian random variable x     n (0,   2),

t1 =

z 2

(cid:20)

(cid:90)

e[exp(x)] =

   
1
2  

exp(    x2

2  2 ) exp(x)dx

  

x

(2.12)
bounding the di   erence between (cid:104)vw + vw(cid:48), c(cid:105) from gaussian random variable, we can show that for

= exp(  2/2) .

  = (cid:101)o(1/d),

e[exp((cid:104)vw + vw(cid:48), c(cid:105))] = (1     ) exp

.

(2.13)

(cid:18)(cid:107)vw + vw(cid:48)(cid:107)2

(cid:19)

2d

therefore, the series of simpli   cation/approximation above (concretely, combining equations (2.6), (2.7), (2.9), (2.11),

and (2.13)) lead to the desired bound on log p(w, w(cid:48)) for the case when the window size q = 2. the bound
on log p(w) can be shown similarly.

6

in our model, zc =(cid:80)

proof sketch of lemma 2.1 note that for    xed c, when word vectors have gaussian priors assumed as

w exp((cid:104)vw, c(cid:105)) is a sum of independent random variables.

we    rst claim that using proper concentration of measure tools, it can be shown that the variance of
zc are relatively small compared to its mean evw [zc], and thus zc concentrates around its mean. note this
is quite non-trivial: the random variable exp((cid:104)vw, c(cid:105)) is neither bounded nor subgaussian/sub-exponential,
since the tail is approximately inverse poly-logarithmic instead of inverse exponential.
in fact, the same
concentration phenomenon does not happen for w. the occurrence id203 of word w is not necessarily
concentrated because the (cid:96)2 norm of vw can vary a lot in our model, which allows the frequency of the words
to have a large dynamic range.
so now it su   ces to show that evw [zc] for di   erent c are close to each other. using the fact that the
word vector directions have a gaussian distribution, evw [zc] turns out to only depend on the norm of c
(which is equal to 1). more precisely,

[zc] = f ((cid:107)c(cid:107)2

2) = f (1)

e
vw

(2.14)

where f is de   ned as f (  ) = n es[exp(s2  /2)] and s has the same distribution as the norms of the word
vectors. we sketch the proof of this. in our model, vw = sw      vw, where   vw is a gaussian vector with identity
covariance i. then

[exp((cid:104)vw, c(cid:105))]

(cid:20)

e
vw

[zc] = n e

vw
= n e
sw

[exp((cid:104)vw, c(cid:105)) | sw]

e

vw|sw

(cid:21)

where the second line is just an application of the law of total expectation, if we pick the norm of the
(random) vector vw    rst, followed by its direction. conditioned on sw, (cid:104)vw, c(cid:105) is a gaussian random variable
with variance (cid:107)c(cid:107)2

w, and therefore using similar calculation as in (2.12), we have

2s2

[exp((cid:104)vw, c(cid:105)) | sw] = exp(s2(cid:107)c(cid:107)2

2/2) .

e

vw|sw

hence, evw [zc] = n es[exp(s2(cid:107)c(cid:107)2

2/2)] as needed.

proof of theorem 4.1 the proof uses the standard analysis of id75. let v = p   qt be the
svd of v and let   1, . . . ,   d be the left singular values of v (the diagonal entries of   ). for notational ease
we omit the subscripts in      and   (cid:48) since they are not relevant for this proof. since v     = q     1p t and thus
     = v      (cid:48) = q     1p t   (cid:48), we have

(cid:107)    (cid:107)2          1

d (cid:107)p t   (cid:48)(cid:107)2.

(cid:114) 1

.

c1n

d    
     1

(2.15)

(2.16)

from the    rst assumption. furthermore, by the second assumption, (cid:107)p t   (cid:48)(cid:107)        c2   

i = o(nd), since the average squared norm of a word vector is d. the claim then follows

n(cid:107)  (cid:48)(cid:107)2, so

i=1   2

(cid:107)p t   (cid:48)(cid:107)2

2     c2
2d
n

(cid:107)  (cid:48)(cid:107)2
2.

(2.17)

plugging (2.16) and (2.17) into (2.15), we get

(cid:114) 1

(cid:114)

c1n

(cid:107)    (cid:107)2    

c2
2d
n

(cid:107)  (cid:48)(cid:107)2

2 =

   
d   
c2
c1n

(cid:107)  (cid:48)(cid:107)2

as desired. the last statement follows because the norm of the signal, which is d log(  r) originally and is
v    d log(  r) = va     vb after dimension reduction, also gets reduced by a factor of

n.

   

7

we claim

indeed, (cid:80)d

2.2 weakening the model assumptions

for readers uncomfortable with bayesian priors, we can replace our assumptions with concrete properties of
word vectors that are empirically veri   able (section 5.1) for our    nal word vectors, and in fact also for word
vectors computed using other recent methods.

in the following two speci   c ways: (i) for almost all unit vectors c the sum (cid:80)

the word meanings are assumed to be represented by some    ground truth    vectors, which the experi-
menter is trying to recover. these ground truth vectors are assumed to be spatially isotropic in the bulk,
w exp((cid:104)vw, c(cid:105)) is close to a
constant z; (ii) singular values of the matrix of word vectors satisfy properties similar to those of random
matrices, as formalized in the paragraph before theorem 4.1. our bayesian prior on the word vectors hap-
pens to imply that these two conditions hold with high id203. but the conditions may hold even if the
prior doesn   t hold. furthermore, they are compatible with all sorts of local structure among word vectors
such as existence of id91s, which would be absent in truly random vectors drawn from our prior.

3 training objective and relationship to other models

to get a training objective out of theorem 2.2, we reason as follows. let xw,w(cid:48) be the number of times words
w and w(cid:48) co-occur within the same window in the corpus. the id203 p(w, w(cid:48)) of such a co-occurrence
at any particular time is given by (2.3). successive samples from a random walk are not independent.
but if the random walk mixes fairly quickly (the mixing time is related to the logarithm of the vocabulary
size), then the distribution of xw,w(cid:48)   s is very close to a multinomial distribution mul(   l,{p(w, w(cid:48))}), where

w,w(cid:48) xw,w(cid:48) is the total number of word pairs.

assuming this approximation, we show below that the maximum likelihood values for the word vectors

  l =(cid:80)

correspond to the following optimization,

(cid:88)

w,w(cid:48)

min
{vw},c

(cid:16)

xw,w(cid:48)

log(xw,w(cid:48))     (cid:107)vw +vw(cid:48)(cid:107)2

2     c

(cid:17)2

as is usual, empirical performance is improved by weighting down very frequent word pairs, possibly
because very frequent words such as    the    do not    t our model. this is done by replacing the weighting
xw,w(cid:48) by its truncation min{xw,w(cid:48), xmax} where xmax is a constant such as 100. we call this objective with
the truncated weights sn (squared norm).

we now give its derivation. maximizing the likelihood of {xw,w(cid:48)} is equivalent to maximizing

       (cid:89)

(w,w(cid:48))

(cid:96) = log

p(w, w(cid:48))xw,w(cid:48)

       .

denote the logarithm of the ratio between the expected count and the empirical count as

(cid:32)   lp(w, w(cid:48))

(cid:33)

xw,w(cid:48)

   w,w(cid:48) = log

.

(3.1)

then with some calculation, we obtain the following where c is independent of the empirical observations
xw,w(cid:48)   s.

(cid:96) = c +

xw,w(cid:48)   w,w(cid:48)

(3.2)

(cid:88)

(w,w(cid:48))

8

on the other hand, using ex     1 + x + x2/2 when x is small,4 we have

  l =

(cid:88)
    (cid:88)

(w,w(cid:48))

(w,w(cid:48))

(cid:88)

(w,w(cid:48))

  lpw,w(cid:48) =

(cid:32)

xw,w(cid:48)

1 +    w,w(cid:48) +

xw,w(cid:48)e   w,w(cid:48)

(cid:33)

.

   2
w,w(cid:48)
2

note that   l =(cid:80)

(w,w(cid:48)) xw,w(cid:48), so(cid:88)

plugging this into (3.2) leads to

(w,w(cid:48))

xw,w(cid:48)   w,w(cid:48)         1
2

(cid:88)

(w,w(cid:48))

xw,w(cid:48)   2

w,w(cid:48).

2(c     (cid:96))     (cid:88)

(w,w(cid:48))

xw,w(cid:48)   2

w,w(cid:48).

(3.3)

so maximizing the likelihood is approximately equivalent to minimizing the right hand side, which (by
examining (3.1)) leads to our objective.

objective for training with pmi. a similar objective pmi can be obtained from (2.5), by computing
an approximate id113, using the fact that the error between the empirical and true value of pmi(w, w(cid:48)) is
driven by the smaller term p(w, w(cid:48)), and not the larger terms p(w), p(w(cid:48)).

(cid:88)

w,w(cid:48)

min
{vw},c

xw,w(cid:48) (pmi(w, w(cid:48))     (cid:104)vw, vw(cid:48)(cid:105))2

this is of course very analogous to classical vsm methods, with a novel reweighting method.

fitting to either of the objectives involves solving a version of weighted svd which is np-hard, but

empirically seems solvable in our setting via adagrad (duchi et al., 2011).

(cid:88)

connection to glove. compare sn with the objective used by glove (pennington et al., 2014):

f (xw,w(cid:48))(log(xw,w(cid:48))     (cid:104)vw, vw(cid:48)(cid:105)     sw     sw(cid:48)     c)2

w,w(cid:48)
w,w(cid:48), 100}. their weighting methods and the need for bias terms sw, sw(cid:48), c were
with f (xw,w(cid:48)) = min{x 3/4
derived by trial and error; here they are all predicted and given meanings due to theorem 2.2, speci   cally
sw = (cid:107)vw(cid:107)2.

connection to id97(cbow). the cbow model in id97 posits that the id203 of a
word wk+1 as a function of the previous k words w1, w2, . . . , wk:

(cid:16)

p

wk+1

(cid:12)(cid:12){wi}k

i=1

(cid:17)     exp((cid:104)vwk+1,

k(cid:88)

i=1

1
k

vwi(cid:105)).

4this taylor series approximation has an error of the order of x3, but ignoring it can be theoretically justi   ed as follows.
for a large xw,w(cid:48) , its value approaches its expectation and thus the corresponding    w,w(cid:48)
is close to 0 and thus ignoring
w,w(cid:48) is well justi   ed. the terms where    w,w(cid:48) is signi   cant correspond to xw,w(cid:48)    s that are small. but empirically, xw,w(cid:48)    s
   3
obey a power law distribution (see, e.g. pennington et al. (2014)) using which it can be shown that these terms contribute a
small fraction of the    nal objective (3.3). so we can safely ignore the errors. full details appear in the arxiv version of this
paper (arora et al., 2015).

9

(w1, w2, . . . , wk)     exp((cid:104)(cid:80)k
(cid:80)k
(cid:107)(cid:80)k
i=1 vwi
i=1 vwi(cid:107)2

this expression seems mysterious since it depends upon the average word vector for the previous k words.
we show it can be theoretically justi   ed. assume a simpli   ed version of our model, where a small window
of k words is generated as follows: sample c     c, where c is a uniformly random unit vector, then sample

i=1 vwi , c(cid:105))/zc. furthermore, assume zc = z for any c.

lemma 3.1. in the simpli   ed version of our model, the maximum-a-posteriori (map) estimate of c given

.

(w1, w2, . . . , wk) is
p(c(cid:48)) for any c, c(cid:48), and we have p (w1, w2, . . . , wk|c) = exp((cid:104)(cid:80)
proof. the c maximizing p (c|w1, w2, . . . , wk) is the maximizer of p(c)p (w1, w2, . . . , wk|c). since p(c) =
(cid:80)k
i vwi, c(cid:105))/z, the maximizer is clearly c =
(cid:107)(cid:80)k
i=1 vwi
i=1 vwi(cid:107)2
thus using the map estimate of ct gives essentially the same expression as cbow apart from the

.

rescaling, which is often omitted due to computational e   ciency in empirical works.

4 explaining relations=lines

as mentioned, word analogies like    a:b::c:??    can be solved via a id202ic expression:

(cid:107)va     vb     vc + vd(cid:107)2
2 ,

d

argmin

(4.1)
where vectors have been normalized such that (cid:107)vd(cid:107)2 = 1. this suggests that the semantic relationships
being tested in the analogy are characterized by a straight line,5 referred to earlier as relations=lines.
using our model we will show the following for low-dimensional embeddings: for each such relation r
there is a direction   r in space such that for any word pair a, b satisfying the relation, va     vb is like   r
plus some noise vector. this happens for relations satisfying a certain condition described below. empirical
results supporting this theory appear in section 5, where this linear structure is further leveraged to slightly
improve analogy solving.

a side product of our argument will be a mathematical explanation of the empirically well-established su-
periority of low-dimensional id27s over high-dimensional ones in this setting (levy and goldberg,
2014a). as mentioned earlier, the usual explanation that smaller models generalize better is fallacious.

we    rst sketch what was missing in prior attempts to prove versions of relations=lines from    rst
principles. the basic issue is approximation error: the di   erence between the best solution and the 2nd best
solution to (4.1) is typically small, whereas the approximation error in the objective in the low-dimensional
solutions is larger. for instance, if one uses our pmi objective, then the weighted average of the termwise
error in (2.5) is 17%, and the expression in (4.1) above contains six inner products. thus in principle the
approximation error could lead to a failure of the method and the emergence of linear relationship, but it
does not.

prior explanations. pennington et al. (2014) try to propose a model where such linear relationships
should occur by design. they posit that queen is a solution to the analogy    man:woman::king:??    because

p(   | king)
p(   | queen)

    p(   | man)
p(   | woman)

,

(4.2)

where p(   | king) denotes the id155 of seeing word    in a small window of text around
king. relationship (4.2) is intuitive since both sides will be     1 for gender-neutral    like    walks    or    food   ,
5note that this interpretation has been disputed; e.g., it is argued in levy and goldberg (2014a) that (4.1) can be understood
using only the classical connection between inner product and word similarity, using which the objective (4.1) is slightly
improved to a di   erent objective called 3cosmul. however, this    explanation    is still dogged by the issue of large termwise
error pinpointed here, since inner product is only a rough approximation to word similarity. furthermore, the experiments in
section 5 clearly support the relations=lines interpretation.

10

will be > 1 when    is like    he, henry    and will be < 1 when    is like    dress, she, elizabeth.    this was
also observed by levy and goldberg (2014a). given (4.2), they then posit that the correct model describing
id27s in terms of word occurrences must be a homomorphism from ((cid:60)d, +) to ((cid:60)+,  ), so vector
di   erences map to ratios of probabilities. this leads to the expression
pw,w(cid:48) = (cid:104)vw, vw(cid:48)(cid:105) + bw + bw(cid:48),

and their method is a (weighted) least squares    t for this expression. one shortcoming of this argument
is that the homomorphism assumption assumes the linear relationships instead of explaining them from a
more basic principle. more importantly, the empirical    t to the homomorphism has nontrivial approximation
error, high enough that it does not imply the desired strong linear relationships.
levy and goldberg (2014b) show that empirically, skip-gram vectors satisfy

(cid:104)vw, vw(cid:48)(cid:105)     pmi(w, w(cid:48))

(4.3)

up to some shift. they also give an argument suggesting this relationship must be present if the solution
is allowed to be very high-dimensional. unfortunately, that argument does not extend to low-dimensional
embeddings. even if it did, the issue of termwise approximation error remains.

our explanation. the current paper has introduced a generative model to theoretically explain the
emergence of relationship (4.3). however, as noted after theorem 2.2, the issue of high approximation error
does not go away either in theory or in the empirical    t. we now show that the isotropy of word vectors
(assumed in the theoretical model and veri   ed empirically) implies that even a weak version of (4.3) is enough
to imply the emergence of the observed linear relationships in low-dimensional embeddings.
this argument will assume the analogy in question involves a relation that obeys pennington et al.   s
suggestion in (4.2). namely, for such a relation r there exists function   r(  ) depending only upon r such
that for any a, b satisfying r there is a noise function   a,b,r(  ) for which:

p(   | a)
p(   | b)

=   r(  )      a,b,r(  )

(4.4)

for di   erent words    there is huge variation in (4.4), so the multiplicative noise may be large.
our goal is to show that the low-dimensional id27s have the property that there is a vector
  r such that for every pair of words a, b in that relation, va     vb =   r + noise vector, where the noise vector
is small.

taking logarithms of (4.4) results in:

log

= log(  r(  )) +   a,b,r(  )

(cid:16) p(  |a)

p(  |b)

(cid:17)

(4.5)

= 1

d (cid:104)v  , va     vb(cid:105) +  a,b(  ) where

theorem 2.2 implies that the left-hand side simpli   es to log

  captures the small approximation errors induced by the inexactness of theorem 2.2. this adds yet more
noise! denoting by v the n    d matrix whose rows are the v   vectors, we rewrite (4.5) as:

v (va     vb) = d log(  r) +   (cid:48)

a,b,r

(4.6)

where log(  r) in the element-wise log of vector   r and   (cid:48)
in essence, (4.6) shows that va     vb is a solution to a id75 in d variables and m constraints,
with   (cid:48)
a,b,r being the    noise.    the design matrix in the regression is v , the matrix of all word vectors, which
in our model (as well as empirically) satis   es an isotropy condition. this makes it random-like, and thus
solving the regression by left-multiplying by v    , the pseudo-inverse of v , ought to    denoise    e   ectively. we
now show that it does.

a,b,r = d(  a,b,r      a,b,r) is the noise.

our model assumed the set of all word vectors satis   es bulk properties similar to a set of gaussian vectors.
the next theorem will only need the following weaker properties. (1) the smallest non-zero singular value

11

(cid:19)

(cid:18) p(   | a)

p(   | b)

(a) sn

(b) glove

(c) cbow

(d) skip-gram

figure 1: the partition function zc. the    gure shows the histogram of zc for 1000 random vectors c of
appropriate norm, as de   ned in the text. the x-axis is normalized by the mean of the values. the values zc
for di   erent c concentrate around the mean, mostly in [0.9, 1.1]. this concentration phenomenon is predicted
by our analysis.
   
of v is larger than some constant c1 times the quadratic mean of the singular values, namely, (cid:107)v (cid:107)f /
d.
empirically we    nd c1     1/3 holds; see section 5. (2) the left singular vectors behave like random vectors
with respect to   (cid:48)
a,b,r, for some constant c2.
(3) the max norm of a row in v is o(

n with   (cid:48)
d). the proof is included in the appendix.

a,b,r, namely, have inner product at most c2(cid:107)  (cid:48)

a,b,r(cid:107)/

   

   

theorem 4.1 (noise reduction). under the conditions of the previous paragraph, the noise in the dimension-
reduced semantic vector space satis   es

as a corollary, the relative error in the dimension-reduced space is a factor of(cid:112)d/n smaller.

(cid:107)    a,b,r(cid:107)2 (cid:46) (cid:107)  (cid:48)

a,b,r(cid:107)2

d
n

.

   

5 experimental veri   cation

in this section, we provide experiments empirically supporting our generative model.

corpus. all id27 vectors are trained on the english wikipedia (march 2015 dump).
it is
pre-processed by standard approach (removing non-textual elements, sentence splitting, and id121),
leaving about 3 billion tokens. words that appeared less than 1000 times in the corpus are ignored, resulting
in a vocabulary of 68, 430. the co-occurrence is then computed using windows of 10 tokens to each side of
the focus word.

training method. our embedding vectors are trained by optimizing the sn objective using adagrad (duchi
et al., 2011) with initial learning rate of 0.05 and 100 iterations. the pmi objective derived from (2.5) was
also used. sn has average (weighted) term-wise error of 5%, and pmi has 17%. we observed that sn
vectors typically    t the model better and have better performance, which can be explained by larger errors
in pmi, as implied by theorem 2.2. so, we only report the results for sn.

for comparison, glove and two variants of id97 (skip-gram and cbow) vectors are trained. glove   s
vectors are trained on the same co-occurrence as sn with the default parameter values.6 id97 vectors
are trained using a window size of 10, with other parameters set to default values.7

6http://nlp.stanford.edu/projects/glove/
7https://code.google.com/p/id97/

12

0.511.5202040partition function valuepercentage0.511.52020406080100partition function value0.511.52020406080partition function value0.511.5202040partition function valuefigure 2: the linear relationship between the squared norms of our word vectors and the logarithms of
the word frequencies. each dot in the plot corresponds to a word, where x-axis is the natural logarithm of
the word frequency, and y-axis is the squared norm of the word vector. the pearson correlation coe   cient
between the two is 0.75, indicating a signi   cant linear relationship, which strongly supports our mathematical
prediction, that is, equation (2.4) of theorem 2.2.

5.1 model veri   cation

experiments were run to test our modeling assumptions. first, we tested two counter-intuitive properties:
the concentration of the partition function zc for di   erent discourse vectors c (see theorem 2.1), and the
random-like behavior of the matrix of id27s in terms of its singular values (see theorem 4.1).
for comparison we also tested these properties for id97 and glove vectors, though they are trained by
di   erent objectives. finally, we tested the linear relation between the squared norms of our word vectors
and the logarithm of the word frequencies, as implied by theorem 2.2.

zc = (cid:80)

partition function. our theory predicts the counter-intuitive concentration of the partition function
w(cid:48) exp(c(cid:62)vw(cid:48)) for a random discourse vector c (see lemma 2.1). this is veri   ed empirically by
picking a uniformly random direction, of norm (cid:107)c(cid:107) = 4/  w, where   w is the average norm of the word
vectors.8 figure 1(a) shows the histogram of zc for 1000 such randomly chosen c   s for our vectors. the
values are concentrated, mostly in the range [0.9, 1.1] times the mean. concentration is also observed for
other types of vectors, especially for glove and cbow.

isotropy with respect to singular values. our theoretical explanation of relations=lines assumes
that the matrix of word vectors behaves like a random matrix with respect to the properties of singular
values. in our embeddings, the quadratic mean of the singular values is 34.3, while the minimum non-zero
singular value of our word vectors is 11. therefore, the ratio between them is a small constant, consistent
with our model. the ratios for glove, cbow, and skip-gram are 1.4, 10.1, and 3.1, respectively, which are
also small constants.

squared norms v.s. word frequencies. figure 2 shows a scatter plot for the squared norms of our
vectors and the logarithms of the word frequencies. a linear relationship is observed (pearson correlation
0.75), thus supporting theorem 2.2. the correlation is stronger for high frequency words, possibly because
the corresponding terms have higher weights in the training objective.

8note that our model uses the inner products between the discourse vectors and word vectors, so it is invariant if the
discourse vectors are scaled by s while the word vectors are scaled by 1/s for any s > 0. therefore, one needs to choose the
norm of c properly. we assume (cid:107)c(cid:107)  w =
d/       4 for a constant    = 5 so that it gives a reasonable    t to the predicted
dynamic range of word frequencies according to our theory; see model details in section 2.

   

13

68101214161812345678910natural logarithm of frequencysquared normrelations
semantic
syntactic
total
adjective
noun
verb
total

g

m

sn glove cbow skip-gram
0.84
0.61
0.71
0.50
0.69
0.48
0.53

0.85
0.65
0.73
0.56
0.70
0.53
0.57

0.79
0.71
0.74
0.58
0.56
0.64
0.62

0.73
0.68
0.70
0.58
0.58
0.56
0.57

table 1: the accuracy on two word analogy task testbeds: g (the google testbed); m (the msr testbed).
performance is close to the state of the art despite using a generative model with provable properties.

this correlation is much weaker for other types of id27s. this is possibly because they have
more free parameters (   knobs to turn   ), which imbue the embeddings with other properties. this can also
cause the di   erence in the concentration of the partition function for the two methods.

5.2 performance on analogy tasks

we compare the performance of our word vectors on analogy tasks, speci   cally the two testbeds google
and msr (mikolov et al., 2013a;c). the former contains 7874 semantic questions such as    man:woman::king:??   ,
and 10167 syntactic ones such as    run:runs::walk :??.    the latter has 8000 syntactic questions for adjectives,
nouns, and verbs.

to solve these tasks, we use id202ic queries.9 that is,    rst normalize the vectors to unit norm

and then solve    a:b::c:??    by

(cid:107)va     vb     vc + vd(cid:107)2
2 .

argmin

d

(5.1)

the algorithm succeeds if the best d happens to be correct.

the performance of di   erent methods is presented in table 1. our vectors achieve performance compara-
ble to the state of art on semantic analogies (similar accuracy as glove, better than id97). on syntactic
tasks, they achieve accuracy 0.04 lower than glove and skip-gram, while cbow typically outperforms the
others.10 the reason is probably that our model ignores local word order, whereas the other models capture
it to some extent. for example, a word    she    can a   ect the context by a lot and determine if the next word
is    thinks    rather than    think    . incorporating such linguistic features in the model is left for future work.

5.3 verifying relations=lines

the theory in section 4 predicts the existence of a direction for a relation, whereas earlier levy and goldberg
(2014a) had questioned if this phenomenon is real. the experiment uses the analogy testbed, where each
relation is tested using 20 or more analogies. for each relation, we take the set of vectors vab = va     vb
where the word pair (a, b) satis   es the relation. then calculate the top singular vectors of the matrix formed
by these vab   s, and compute the cosine similarity (i.e., normalized inner product) of individual vab to the
singular vectors. we observed that most (va     vb)   s are correlated with the    rst singular vector, but have
inner products around 0 with the second singular vector. over all relations, the average projection on the
   rst singular vector is 0.51 (semantic: 0.58; syntactic: 0.46), and the average on the second singular vector
is 0.035. for example, table 2 shows the mean similarities and standard deviations on the    rst and second
singular vectors for 4 relations. similar results are also obtained for word embedings by glove and id97.
therefore, the    rst singular vector can be taken as the direction associated with this relation, while the other
components are like random noise, in line with our model.

9one can instead use the 3cosmul in (levy and goldberg, 2014a), which increases the accuracy by about 3%. but it is

not linear while our focus here is the id202ic structure.

10it was earlier reported that skip-gram outperforms cbow (mikolov et al., 2013a; pennington et al., 2014). this may be

due to the di   erent training data sets and hyperparameters used.

14

relation

1st
2nd

relation

1st
2nd

1

0.65    0.07
0.02    0.28

8

0.56    0.09
0.00    0.22

2

0.61    0.09
0.00    0.23

9

0.53    0.08
0.01    0.26

3

0.52    0.08
0.05    0.30

10

0.37    0.11
0.02    0.20

4

0.54    0.18
0.06    0.27

11

0.72    0.10
0.01    0.24

5

0.60    0.21
0.01    0.24

12

0.37    0.14
0.07    0.26

6

0.35    0.17
0.07    0.24

13

0.40    0.19
0.07    0.23

7

0.42    0.16
0.01    0.25

14

0.43    0.14
0.09    0.23

table 2: the veri   cation of relation directions on 2 semantic and 2 syntactic relations in the google
testbed. relations include cap-com: capital-common-countries; cap-wor: capital-world; adj-adv: gram1-
adjective-to-adverb; opp: gram2-opposite. for each relation, take vab = va     vb for pairs (a, b) in the
relation, and then calculate the top singular vectors of the matrix formed by these vab   s. the row with label
   1st   /   2nd    shows the cosine similarities of individual vab to the 1st/2nd singular vector (the mean and
standard deviation).

w/o rd

rd(k = 20)
rd(k = 30)
rd(k = 40)

sn glove cbow skip-gram
0.71
0.74
0.79
0.76

0.73
0.77
0.80
0.80

0.74
0.79
0.82
0.80

0.70
0.75
0.80
0.77

table 3: the accuracy of the rd algorithm (i.e., the cheater method) on the google testbed. the rd
algorithm is described in the text. for comparison, the row    w/o rd    shows the accuracy of the old method
without using rd.

cheating solver for analogy testbeds. the above linear structure suggests a better (but cheating) way
to solve the analogy task. this uses the fact that the same semantic relationship (e.g., masculine-feminine,
singular-plural) is tested many times in the testbed. if a relation r is represented by a direction   r then the
cheating algorithm can learn this direction (via rank 1 svd) after seeing a few examples of the relationship.
then use the following method of solving    a:b::c:??   : look for a word d such that vc     vd has the largest
projection on   r, the relation direction for (a, b). this can boost success rates by about 10%.

the testbed can try to combat such cheating by giving analogy questions in a random order. but the
cheating algorithm can just cluster the presented analogies to learn which of them are in the same relation.
thus the    nal algorithm, named analogy solver with relation direction (rd), is: take all vectors va     vb for
all the word pairs (a, b) presented among the analogy questions and do id116 id91 on them; for each
(a, b), estimate the relation direction by taking the    rst singular vector of its cluster, and substitute that
for va     vb in (5.1) when solving the analogy. table 3 shows the performance on google with di   erent
values of k; e.g. using our sn vectors and k = 30 leads to 0.79 accuracy. thus future designers of analogy
testbeds should remember not to test the same relationship too many times! this still leaves other ways to
cheat, such as learning the directions for interesting semantic relations from other collections of analogies.

non-cheating solver for analogy testbeds. now we show that even if a relationship is tested only
once in the testbed, there is a way to use the above structure. given    a:b::c:??,    the solver    rst    nds the
top 300 nearest neighbors of a and those of b, and then    nds among these neighbors the top k pairs (a(cid:48), b(cid:48))
so that the cosine similarities between va(cid:48)     vb(cid:48) and va     vb are largest. finally, the solver uses these pairs
to estimate the relation direction (via rank 1 svd), and substitute this (corrected) estimate for va     vb in
(5.1) when solving the analogy. this algorithm is named analogy solver with relation direction by nearest
neighbors (rd-nn). table 4 shows its performance, which consistently improves over the old method by
about 3%.

15

w/o rd-nn

rd-nn (k = 10)
rd-nn (k = 20)
rd-nn (k = 30)

sn glove cbow skip-gram
0.71
0.71
0.72
0.73

0.74
0.77
0.77
0.78

0.70
0.73
0.74
0.74

0.73
0.74
0.75
0.76

table 4: the accuracy of the rd-nn algorithm on the google testbed. the algorithm is described in the
text. for comparison, the row    w/o rd-nn    shows the accuracy of the old method without using rd-nn.

6 conclusions

a simple generative model has been introduced to explain the classical pmi based id27 models,
as well as recent variants involving energy-based models and id105. the model yields an
optimization objective with essentially    no knobs to turn   , yet the embeddings lead to good performance
on analogy tasks, and    t other predictions of our generative model. a model with fewer knobs to turn
should be seen as a better scienti   c explanation (occam   s razor), and certainly makes the embeddings more
interpretable.

the spatial isotropy of word vectors is both an assumption in our model, and also a new empirical
   nding of our paper. we feel it may help with further development of language models. it is important for
explaining the success of solving analogies via low dimensional vectors (relations=lines). it also implies
that semantic relationships among words manifest themselves as special directions among id27s
(section 4), which lead to a cheater algorithm for solving analogy testbeds.

our model is tailored to capturing semantic similarity, more akin to a log-linear dynamic topic model.
in particular, local word order is unimportant. designing similar generative models (with provable and
interpretable properties) with linguistic features is left for future work.

acknowledgements

we thank the editors of tacl for granting a special relaxation of the page limit for our paper. we thank
yann lecun, christopher d. manning, and sham kakade for helpful discussions at various stages of this
work.

this work was supported in part by nsf grants ccf-1527371, dms-1317308, simons investigator award,
simons collaboration grant, and onr-n00014-16-1-2329. tengyu ma was supported in addition by simons
award in theoretical computer science and ibm phd fellowship.

references

jacob andreas and dan klein. when and why are id148 self-normalizing? in proceedings of the
annual meeting of the north american chapter of the association for computational linguistics, 2014.

sanjeev arora, yuanzhi li, yingyu liang, tengyu ma, and andrej risteski. a latent variable model approach

to pmi-based id27s. technical report, arxiv, 2015. http://arxiv.org/abs/1502.03520.

sanjeev arora, yuanzhi li, yingyu liang, tengyu ma, and andrej risteski.

braic structure of word senses, with applications to polysemy.
http://arxiv.org/abs/1502.03520.

linear alge-
technical report, arxiv, 2016.

david belanger and sham m. kakade. a linear dynamical system model for text. in proceedings of the 32nd

international conference on machine learning, 2015.

yoshua bengio, holger schwenk, jean-s  ebastien sen  ecal, fr  ederic morin, and jean-luc gauvain. neural

probabilistic language models. in innovations in machine learning. 2006.

16

fischer black and myron scholes. the pricing of options and corporate liabilities. journal of political

economy, 1973.

david m. blei. probabilistic topic models. communication of the association for computing machinery,

2012.

david m. blei and john d. la   erty. dynamic topic models.

in proceedings of the 23rd international

conference on machine learning, 2006.

kenneth ward church and patrick hanks. word association norms, mutual information, and id69.

computational linguistics, 1990.

shay b. cohen, karl stratos, michael collins, dean p. foster, and lyle ungar. spectral learning of latent-
variable pid18s. in proceedings of the 50th annual meeting of the association for computational lin-
guistics: long papers-volume 1, 2012.

ronan collobert and jason weston. a uni   ed architecture for natural language processing: deep neural net-
works with multitask learning. in proceedings of the 25th international conference on machine learning,
2008a.

ronan collobert and jason weston. a uni   ed architecture for natural language processing: deep neural net-
works with multitask learning. in proceedings of the 25th international conference on machine learning,
2008b.

scott c. deerwester, susan t dumais, thomas k. landauer, george w. furnas, and richard a. harshman.

indexing by latent semantic analysis. journal of the american society for information science, 1990.

john duchi, elad hazan, and yoram singer. adaptive subgradient methods for online learning and stochastic

optimization. the journal of machine learning research, 2011.

john rupert firth. a synopsis of linguistic theory. 1957.

amir globerson, gal chechik, fernando pereira, and naftali tishby. euclidean embedding of co-occurrence

data. journal of machine learning research, 2007.

tatsunori b. hashimoto, david alvarez-melis, and tommi s. jaakkola. id27s as metric recovery

in semantic spaces. transactions of the association for computational linguistics, 2016.

thomas hofmann. probabilistic latent semantic analysis.

in proceedings of the fifteenth conference on

uncertainty in arti   cial intelligence, 1999.

daniel hsu, sham m. kakade, and tong zhang. a spectral algorithm for learning id48.

journal of computer and system sciences, 2012.

omer levy and yoav goldberg. linguistic regularities in sparse and explicit word representations.

in

proceedings of the eighteenth conference on computational natural language learning, 2014a.

omer levy and yoav goldberg. neural id27 as implicit id105. in advances in

neural information processing systems, 2014b.

andrew l. maas, raymond e. daly, peter t. pham, dan huang, andrew y. ng, and christopher potts.
learning word vectors for id31. in the 49th annual meeting of the association for compu-
tational linguistics, 2011.

yariv maron, michael lamar, and elie bienenstock. sphere embedding: an application to part-of-speech

induction. in advances in neural information processing systems, 2010.

17

tomas mikolov, kai chen, greg corrado, and je   rey dean. e   cient estimation of word representations in

vector space. proceedings of the international conference on learning representations, 2013a.

tomas mikolov, ilya sutskever, kai chen, greg s. corrado, and je    dean. distributed representations of
words and phrases and their compositionality. in advances in neural information processing systems,
2013b.

tomas mikolov, wen-tau yih, and geo   rey zweig. linguistic regularities in continuous space word rep-
in proceedings of the conference of the north american chapter of the association for

resentations.
computational linguistics: human language technologies, 2013c.

andriy mnih and geo   rey hinton. three new id114 for statistical language modelling.

in

proceedings of the 24th international conference on machine learning, 2007.

christos h. papadimitriou, hisao tamaki, prabhakar raghavan, and santosh vempala. latent semantic
indexing: a probabilistic analysis. in proceedings of the 7th acm sigact-sigmod-sigart symposium
on principles of database systems, 1998.

je   rey pennington, richard socher, and christopher d. manning. glove: global vectors for word represen-

tation. proceedings of the empiricial methods in natural language processing, 2014.

douglas l. t. rohde, laura m. gonnerman, and david c. plaut. an improved model of semantic similarity

based on lexical co-occurence. communication of the association for computing machinery, 2006.

david e. rumelhart, geo   rey e. hinton, and james l. mcclelland, editors. parallel distributed processing:

explorations in the microstructure of cognition. 1986.

david e. rumelhart, geo   rey e. hinton, and ronald j. williams. learning representations by back-

propagating errors. cognitive modeling, 1988.

peter d. turney and patrick pantel. from frequency to meaning: vector space models of semantics. journal

of arti   cial intelligence research, 2010.

18

a proofs of theorem 1

in this section we prove theorem 2.2 and lemma 2.1 (restated below).

theorem 2.2. suppose the word vectors satisfy equation (2.2), and window size q = 2. then,

log p(w, w(cid:48)) =

    2 log z     ,

2

(cid:107)vw + vw(cid:48)(cid:107)2
2d
(cid:107)vw(cid:107)2
    log z     .
2d

2

for   = o( z) + (cid:101)o(1/d) + o( 2). jointly these imply:

log p(w) =

pmi (w, w(cid:48)) =

(cid:104)vw, vw(cid:48)(cid:105)

   o( ).

(a.3)
lemma 2.1. if the word vectors satisfy the bayesian prior v = s      v, where   v is from the spherical gaussian
distribution, and s is a scalar random variable, then with high id203 the entire ensemble of word vectors
satis   es that

d

for  z = (cid:101)o(1/

   

n), and    = exp(      (log2 n)).

c   c [(1      z)z     zc     (1 +  z)z]     1       ,

pr

we    rst prove theorem 2.2 using lemma 2.1, and lemma 2.1 will be proved in section a.1. please see
section 2 of the main paper for the intuition of the proof and a cleaner sketch without too many technicalities.
proof of theorem 2.2. let c be the hidden discourse that determines the id203 of word w, and c(cid:48) be
the next one that determines w(cid:48). we use p(c(cid:48)|c) to denote the markov kernel (transition matrix) of the
markov chain. let c be the stationary distribution of discourse vector c, and d be the joint distribution of
(c, c(cid:48)). we marginalize over the contexts c, c(cid:48) and then use the independence of w, w(cid:48) conditioned on c, c(cid:48),

(cid:20) exp((cid:104)vw, c(cid:105))

exp((cid:104)vw(cid:48), c(cid:48)(cid:105))

zc

zc(cid:48)

(cid:21)

p(w, w(cid:48)) = e

(c,c(cid:48))   d

we    rst get rid of the partition function zc using lemma 2.1. as sketched in the main paper, essentially
we will replace zc by z in equation (a.5), though a very careful control of the approximation error is
required. formally, let f1 be the event that c satis   es

(1      z)z     zc     (1 +  z)z .

(a.6)
similarly, let f2 be the even that c(cid:48) satis   es (1     z)z     zc(cid:48)     (1 +  z)z, and let f = f1    f2, and f be its
negation. moreover, let 1f be the indicator function for the event f. therefore by lemma 2.1 and union
bound, we have e[1f ] = pr[f]     1     exp(      (log2 n)).

we    rst decompose the integral (a.5) into the two parts according to whether event f happens,

we bound the    rst quantity on the right hand side using (2.2) and the de   nition of f.

(cid:20)
(cid:20)

p(w, w(cid:48)) = e

(c,c(cid:48))   d

+ e

(c,c(cid:48))   d

(cid:20)

e

(c,c(cid:48))   d
zczc(cid:48)
    (1 +  z)2 1
z 2

1

zczc(cid:48)

1

zczc(cid:48)

exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f

exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f

(cid:21)
(cid:21)

(cid:21)

1

exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f

e

(c,c(cid:48))   d

[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f ]

19

(a.1)

(a.2)

(a.4)

(a.5)

(a.7)

(a.8)

for the second quantity of the right hand side of (a.7), we have by cauchy-schwartz,

(cid:20)

(cid:18)

e

(c,c(cid:48))   d
   

e

(cid:18)
(cid:18)

(cid:20) 1

zczc(cid:48)

1

(cid:20) 1

exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f
exp((cid:104)vw, c(cid:105))21f

e

(c,c(cid:48))   d

(c,c(cid:48))   d

z 2
c

(cid:21)(cid:19)2
(cid:20)(cid:90)

(cid:21)(cid:19)

1
z 2
c(cid:48)

c,c(cid:48)

(cid:21)(cid:19)
exp((cid:104)vw(cid:48), c(cid:48)(cid:105))21f

exp((cid:104)vw(cid:48), c(cid:48)(cid:105))2 e
c|c(cid:48)

   

e
c

z 2
c

exp((cid:104)vw, c(cid:105))2 e
c(cid:48)|c

[1f ]
using the fact that zc     1, then we have that
exp((cid:104)vw, c(cid:105))2 e
c(cid:48)|c

(cid:20) 1

e
c

z 2
c

we can split that expectation as

(cid:20)
exp((cid:104)vw, c(cid:105))21(cid:104)vw,c(cid:105)>0 e
c(cid:48)|c

e
c

[1f ]

+ e

c

.

(a.9)

[1f ]

(cid:21)

(cid:21)

[1f ]

.

(a.10)

    e

c

exp((cid:104)vw, c(cid:105))2 e
c(cid:48)|c

[1f ]

(cid:20)
exp((cid:104)vw, c(cid:105))21(cid:104)vw,c(cid:105)<0 e
c(cid:48)|c

(cid:20) 1

z 2
c(cid:48)

(cid:20)

(cid:21)(cid:19)(cid:18)
(cid:21)(cid:19)(cid:18)
(cid:21)

[1f ]

e
c(cid:48)

(cid:21)

the second term of (a.10) is upper bounded by

(cid:20)
exp((cid:104)vw, c(cid:105))21(cid:104)vw,c(cid:105)>0 e
c(cid:48)|c

e
c

we proceed to the    rst term of (a.10) and observe the following property of it:
    e

    e

[1f ]

[1f ]

(cid:21)

(cid:21)

c

(cid:20)

exp((cid:104)  vw, c(cid:105))2 e
c(cid:48)|c

(cid:21)

[1f ]

where    > 1. therefore, it   s su   cient to bound

e
c,c(cid:48)

(cid:20)

c

[1f ]     exp(      (log2 n))

exp((cid:104)  vw, c(cid:105))21(cid:104)vw,c(cid:105)>0 e
c(cid:48)|c
(cid:21)
(cid:20)

e
c

exp((cid:104)vw, c(cid:105))2 e
c(cid:48)|c

[1f ]

   
when (cid:107)vw(cid:107) =    (

d).

let   s denote by z the random variable 2(cid:104)vw, c(cid:105).
let   s denote r(z) = ec(cid:48)|z[1f ] which is a function of z between [0, 1]. we wish to upper bound ec [exp(z)r(z)].
the worst-case r(z) can be quanti   ed using a continuous version of abel   s inequality as proven in lemma a.4,
which gives

[exp(z)r(z)]     e(cid:2)exp(z)1[t,+   ](z)(cid:3)

(a.11)
where t satis   es that ec[1[t,+   ]] = pr[z     t] = ec[r(z)]     exp(      (log2 n)). then, we claim pr[z     t]    
exp(      (log2 n)) implies that t        (log.9 n).

e
c

d i), this would be a simple tail bound. however, as c is distributed uniformly
on the sphere, this requires special care, and the claim follows by applying lemma a.1 instead. finally,
applying corollary a.3, we have:

if c were distributed as n (0, 1

(a.12)
we have the same bound for c(cid:48) as well. hence, for the second quantity of the right hand side of (a.7),

e[exp(z)r(z)]     e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(      (log1.8 n))
(cid:20)
(cid:20) 1

exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f
(cid:21)(cid:19)1/2(cid:18)

(cid:21)
(cid:20) 1

1

e

(cid:18)

zczc(cid:48)

(c,c(cid:48))   d
   
    exp(      (log1.8 n))

z 2
c

e
c

exp((cid:104)vw, c(cid:105))2 e
c(cid:48)|c

[1f ]

e
c(cid:48)

z 2
c(cid:48)

exp((cid:104)vw(cid:48), c(cid:48)(cid:105))2 e
c|c(cid:48)

[1f ]

(cid:21)(cid:19)1/2

(a.13)

we have

20

where the    rst inequality follows from cauchy-schwartz, and the second from the calculation above. com-
bining (a.7), (a.8) and (a.13), we obtain

p(w, w(cid:48))     (1 +  z)2 1
z 2
    (1 +  z)2 1
z 2

e

(c,c(cid:48))   d

e

(c,c(cid:48))   d

[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f ] +
[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))] +   0

1

n2 exp(      (log1.8 n))

where   0 = exp(      (log1.8 n))z 2     exp(      (log1.8 n)) by the fact that z     exp(2  )n = o(n). note that
   is treated as an absolute constant throughout the paper. on the other hand, we can lowerbound similarly

p(w, w(cid:48))     (1      z)2 1
z 2
    (1      z)2 1
z 2
    (1      z)2 1
z 2

e

(c,c(cid:48))   d

e

(c,c(cid:48))   d

e

(c,c(cid:48))   d

[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))1f ]
[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]     1

n2 exp(      (log1.8 n))

[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]       0

taking logarithm, the multiplicative error translates to a additive error

log p(w, w(cid:48)) = log

e

(c,c(cid:48))   d

[exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]      0

    2 log z + 2 log(1     z)

for the purpose of exploiting the fact that c, c(cid:48) should be close to each other, we further rewrite log p(w, w(cid:48))
by re-organizing the expectations above,

log p(w, w(cid:48)) = log

= log

exp((cid:104)vw, c(cid:105)) e
c(cid:48)|c

[exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]

     0

    2 log z + 2 log(1     z)

[exp((cid:104)vw, c(cid:105))a(c)]      0

    2 log z + 2 log(1     z)

(a.14)

where the inner integral which is denoted by a(c),

   
since (cid:107)vw(cid:107)       

   
d. therefore we have that (cid:104)vw, c     c(cid:48)(cid:105)     (cid:107)vw(cid:107)(cid:107)c     c(cid:48)(cid:107)       

d(cid:107)c     c(cid:48)(cid:107).

a(c) := e
c(cid:48)|c

[exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]

then we can bound a(c) by

a(c) = e
c(cid:48)|c

[exp((cid:104)vw(cid:48), c(cid:48)(cid:105))]

= exp((cid:104)vw(cid:48), c(cid:105)) e
c(cid:48)|c
   
    exp((cid:104)vw(cid:48), c(cid:105)) e
[exp(  
c(cid:48)|c
    (1 +  2) exp((cid:104)vw(cid:48), c(cid:105))

[exp((cid:104)vw(cid:48), c(cid:48)     c(cid:105))]
d(cid:107)c     c(cid:48)(cid:107))]

where the last inequality follows from our model assumptions. to derive a lower bound of a(c), observe that

21

(cid:19)

(cid:19)

(cid:21)

(cid:19)

(cid:18)

(cid:20)

(cid:18)
(cid:18)

e
c

e
c

   
[exp(  

e
c(cid:48)|c

d(cid:107)c     c(cid:48)(cid:107))] + e
c(cid:48)|c

   
[exp(     

d(cid:107)c     c(cid:48)(cid:107))]     2

therefore, our model assumptions imply that
   
[exp(     

e
c(cid:48)|c

d(cid:107)c     c(cid:48)(cid:107))]     1      2

hence,

a(c) = exp((cid:104)vw(cid:48), c(cid:105)) e
c(cid:48)|c
    exp((cid:104)vw(cid:48), c(cid:105)) e
c(cid:48)|c
    (1      2) exp((cid:104)vw(cid:48), c(cid:105))

exp((cid:104)vw(cid:48), c(cid:48)     c(cid:105))
   
exp(     

d(cid:107)c     c(cid:48)(cid:107))

therefore, we obtain that a(c) = (1     2) exp((cid:104)vw(cid:48), c(cid:105)). plugging the just obtained estimate of a(c) into

the equation (a.14), we get that

log p(w, w(cid:48)) = log

= log

= log

(cid:18)
(cid:18)
(cid:18)

e
c

e
c

e
c

(cid:19)

(cid:19)

[exp((cid:104)vw, c(cid:105))a(c)]      0

    2 log z + 2 log(1     z)

(cid:19)

[(1     2) exp((cid:104)vw, c(cid:105)) exp((cid:104)vw(cid:48), c(cid:105))]      0

    2 log z + 2 log(1     z)

[exp((cid:104)vw + vw(cid:48), c(cid:105))]      0

    2 log z + 2 log(1     z) + log(1     2)

(a.15)

where  3 = (cid:101)o(1/d).

now it su   ces to compute ec[exp((cid:104)vw + vw(cid:48), c(cid:105))]. note that if c had the distribution n (0, 1

d i), which
is very similar to uniform distribution over the sphere, then we could get straightforwardly ec[exp((cid:104)vw +
vw(cid:48), c(cid:105))] = exp((cid:107)vw + vw(cid:48)(cid:107)2/(2d)). for c having a uniform distribution over the sphere, by lemma a.5, the
same equality holds approximately,

[exp((cid:104)vw + vw(cid:48), c(cid:105))] = (1     3) exp((cid:107)vw + vw(cid:48)(cid:107)2/(2d))
e
c

(a.16)

plugging in equation (a.16) into equation (a.15), we have that

log p(w, w(cid:48)) = log(cid:0)(1     3) exp((cid:107)vw + vw(cid:48)(cid:107)2/(2d))      0

= (cid:107)vw + vw(cid:48)(cid:107)2/(2d) + o( 3) + o(  (cid:48)

(cid:1)     2 log z + 2 log(1     z) + log(1     2)
   1 = exp(      (log1.8 n)). note that  3 = (cid:101)o(1/d),  z = (cid:101)o(1/

0)     2 log z    2 z     2

   

n),

where   (cid:48)

0 =   0    (ec   c[exp((cid:104)vw + vw(cid:48), c(cid:105))])

and  2 by assumption, therefore we obtain that

log p(w, w(cid:48)) =

1
2d

(cid:107)vw + vw(cid:48)(cid:107)2     2 log z    o( z) + o( 2) + (cid:101)o(1/d).

the following lemmas are helper lemmas that were used in the proof above. we use cd to denote the

uniform distribution over the unit sphere in rd.
lemma a.1 (tail bound for spherical distribution). if c     cd, v     rd is a vector with (cid:107)v(cid:107) =    (
t =   (1), the random variable z = (cid:104)v, c(cid:105) satis   es pr[z     t] = e   o(t2).

   

d) and

22

(cid:17)

proof. if c = (c1, c2, . . . , cd)     cd, c is in distribution equal to
samples from a univariate gaussian with mean 0 and variance 1

(cid:16)   c1(cid:107)  c(cid:107) ,   c2(cid:107)  c(cid:107) , . . . ,   cd(cid:107)  c(cid:107)
that v = ((cid:107)v(cid:107), 0, . . . , 0). let   s introduce the random variable r =(cid:80)d
(cid:21)
(cid:21)
(cid:104)(cid:107)v(cid:107)   c1(cid:107)c(cid:107)     t | r     100
(cid:35)

(cid:20)(cid:107)v(cid:107)  c1(cid:107)  c(cid:107)     t | r     1
(cid:115)
(cid:34)

it   s su   cient to lower bound pr [r     100] and pr

(cid:20)
(cid:107)v|   c1(cid:107)  c(cid:107)     t

pr [(cid:104)v, c(cid:105)     t] = pr

(cid:20)(cid:107)v(cid:107)  c1(cid:107)  c(cid:107)     t | r     1
(cid:34)

r     1
2

i . since

(cid:115)

    pr

i=2   c2

+ pr

(cid:21)

(cid:20)

(cid:105)

pr

2

2

(cid:35)

seen to be lower bounded by a constant by a cherno    bound. consider the latter one next. it holds that

where the   ci are i.i.d.
d . by spherical symmetry, we may assume

(cid:21)

(cid:21)

(cid:20)

pr

r     1
2

. the former id203 is easily

= pr

  c1    

    pr

  c1    

100t2
(cid:107)v(cid:107)2     t2

(cid:21)

(cid:20)
(cid:107)v(cid:107)   c1(cid:107)  c(cid:107)     t | r     100
(cid:113) 100t2

pr

denoting   t =

(cid:107)v(cid:107)2   t2 , by a well-known gaussian tail bound it follows that

pr(cid:2)  c1       t(cid:3) = e   o(d  t2)

= e   o(t2)

t2    r
(cid:107)v(cid:107)2     t2 | r     100
(cid:19)3(cid:33)
(cid:32)

(cid:18) 1   

   

1   
d  t

d  t

d) and t =   (1).

   

   
where the last equality holds since (cid:107)v(cid:107) =    (

lemma a.2. if c     cd, v     rd is a vector with (cid:107)v(cid:107) =   (
satis   es

e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(      (t2)) + exp(      (d))

d) and t =   (1), the random variable z = (cid:104)v, c(cid:105)

(cid:16)   c1(cid:107)  c(cid:107) ,   c2(cid:107)  c(cid:107) , . . . ,   cd(cid:107)  c(cid:107)

(cid:17)

d . again, by spherical
i . then, for

i=2   c2

proof. similarly as in lemma a.1, if c = (c1, c2, . . . , cd)     cd, c is in distribution equal to
where the   ci are i.i.d. samples from a univariate gaussian with mean 0 and variance 1

symmetry, we may assume v = ((cid:107)v(cid:107), 0, . . . , 0). let   s introduce the random variable r =(cid:80)d
pr(cid:2)exp ((cid:104)v, c(cid:105)) 1[t,+   ]((cid:104)v, c(cid:105))     u(cid:3) = pr [exp ((cid:104)v, c(cid:105))     u     (cid:104)v, c(cid:105)     t] =

an arbitrary u > 1, some algebraic manipulation shows

(cid:20)

(cid:18)

pr

exp

(cid:19)

(cid:107)v(cid:107)   c1(cid:107)  c(cid:107)

    u     (cid:107)v(cid:107)   c1(cid:107)  c(cid:107)     u
(cid:115)

(cid:34)

(cid:21)

(cid:34)

(cid:32)(cid:115)

= pr

  c1 = max

  u2r

(cid:107)v(cid:107)2       u2 ,

(cid:115)

(cid:33)(cid:35)

t2r

(cid:107)v(cid:107)2     t2

(a.17)
   
d , and (cid:107)v(cid:107) =    (

(cid:35)

pr

  c1    

where we denote   u = log u. since   c1 is a mean 0 univariate gaussian with variance 1
have    x     r

next, we show that r is lower bounded by a constant with id203 1     exp(      (d)).
distribution equal to 1
concentration bounds (?) imply that           0, pr[r     1        2
implies that with id203 1     exp(      (d)), r     m for some constant m . we can now rewrite

(cid:16)
(cid:113)   
indeed, r is in
k is a chi-squared distribution with k degrees of freedom. standard
d ]     exp(     ). taking    =   d for    a constant
(cid:35)

e      (x2r)(cid:17)

d   1, where   2

(cid:107)v(cid:107)2     u2

(cid:115)

d) we

d   2

(cid:34)

= o

x2r

  c1    

pr

x2r

(cid:107)v(cid:107)2     x2

=

23

(cid:34)

(cid:115)

(cid:35)

(cid:34)

(cid:115)

pr

x2r

x2r

  c1    

  c1    

pr[r     m ] + pr

(cid:107)v(cid:107)2     x2 | r     m
(cid:34)

(cid:107)v(cid:107)2     x2 | r     m
the    rst term is clearly bounded by e      (x2) and the second by exp(      (d)). therefore,
= o(cid:0)max(cid:0)exp(cid:0)      (cid:0)x2(cid:1)(cid:1) , exp (       (d))(cid:1)(cid:1)
(cid:16)

pr(cid:2)exp ((cid:104)v, c(cid:105)) 1[t,+   ]((cid:104)v, c(cid:105))     u(cid:3) = o

putting a.17 and a.18 together, we get that

d, (max (  u, t))2(cid:17)(cid:17)(cid:17)(cid:17)(cid:17)

(cid:16)      

(cid:107)v(cid:107)2     x2

(cid:115)

  c1    

(cid:16)

(cid:16)

(cid:16)

(cid:35)

max

min

x2r

exp

pr

(cid:35)

pr[r     m ]

(a.18)

(a.19)

(where again, we denote   u = log u)

for any random variable x which has non-negative support, it   s easy to check that

hence,

e(cid:2)exp(z)1[t,+   ](z)(cid:3) =

(cid:90)    

0

(cid:90) exp((cid:107)v(cid:107))

0

pr(cid:2)exp(z)1[t,+   ](z)     u(cid:3) du

(cid:90)    

e[x] =

pr[x     x]dx

0

pr(cid:2)exp(z)1[t,+   ](z)     u(cid:3) du =

(cid:16)

d, (max (  u, t))2(cid:17)

to bound this integral, we split into the following two cases:

    case t2     d: max (  u, t)     t, so min

e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp((cid:107)v(cid:107)) exp(      (d)) = exp(      (d))

= d. hence, a.19 implies

   
where the last inequality follows since (cid:107)v(cid:107) = o(

d).

(cid:90) exp(t)

0

u     [exp(t), exp((cid:107)v(cid:107))].
when u     [0, exp(t)], max (  u, t) = t, so min(d, (max (  u, t))2) = t2. hence,

   
when u     [exp(t), exp((cid:107)v(cid:107))], max (  u, t) =   u. but   u     log(exp((cid:107)v(cid:107))) = o(
  u. hence,

pr(cid:2)exp(z)1[t,+   ](z)     u(cid:3) du     exp(t) exp(      (t2)) =     exp(   (t2))
pr(cid:2)exp(z)1[t,+   ](z)     u(cid:3) du    
(cid:90) (cid:107)v(cid:107)

(cid:90) exp((cid:107)v(cid:107))

exp(   (log(u))2)du

exp(t)

exp(     u2) exp(  u)d  u = o(exp(   t2))

(cid:90) exp((cid:107)v(cid:107))

exp(t)

making the change of variable   u = log(u), the we can rewrite the last integral as

t

where the last inequality is the usual gaussian tail bound.

in either case, we get that

(cid:90) exp((cid:107)v(cid:107))

pr(cid:2)exp(z)1[t,+   ](z)     u(cid:3) du = exp(      (t2)) + exp(      (d)))

0

which is what we want.

24

    case t2 < d: in the second case, we will split the integral into two portions: u     [0, exp(t)] and

d), so min(d, (max (  u, t))2) =

as a corollary to the above lemma, we get the following:
   
corollary a.3. if c     cd, v     rd is a vector with (cid:107)v(cid:107) =   (

e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(      (log1.8 n))

d) and t =    (log.9 n) then

   
proof. we claim the proof is trivial if d = o(log4 n).
exp(o(

d)). hence,

indeed,

in this case, exp((cid:104)v, c(cid:105))     exp((cid:107)v(cid:107)) =

since by lemma a.1, pr[z     t]     exp(      (log2 n), we get

   

   

d)) e[1[t,+   ](z)] = exp(o(

e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(o(
e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(o(
e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(    log1.8 n) + exp(      (d))) = exp(    log1.8 n)

d)        (log2 n)) = exp(      (log1.8 n))

d)) pr[z     t]

   

as we wanted.

so, we may, without loss of generality assume that d =    (log4 n). in this case, lemma a.2 implies

where the last inequality holds because d =    (log4 n) and t2 =    (log.9 n), so we get the claim we wanted.

lemma a.4 (continuous abel   s inequality). let 0     r(x)     1 be a function such that such that e[r(x)] =   .
moreover, suppose increasing function u(x) satis   es that e[|u(x)|] <    . let t be the real number such that
e[1[t,+   ]] =   . then we have

proof. let g(z) =(cid:82)    
(cid:82)    

z f (x)r(x)dx, and h(z) =(cid:82)    
z f (x)1[t,+   ](x)dx. then we have that g(z)     h(z) for
all z. indeed, for z     t, this is trivial since r(z)     1. for z     t, we have h(z) = e[1[t,+   ]] =    = e[r(x)]    
(cid:90)    
(cid:90)    
z f (x)r(x)dx. then by integration by parts we have,

e[u(x)r(x)]     e[u(x)1[t,+   ]]

(a.20)

u(x)f (x)r(x)dx =    

      

u(x)dg

      

(cid:90) +   

      

=    u(x)g(x) |   

       +

g(x)u(cid:48)(x)dx

(cid:90) +   
(cid:90)    

      

      

   

=

h(x)u(cid:48)(x)dx

u(x)f (x)1[t,+   ](x)dx,

where at the third line we use the fact that u(x)g(x)     0 as x         and that u(cid:48)(x)     0, and at the last line
we integrate by parts again.
   
lemma a.5. let v     rd be a    xed vector with norm (cid:107)v(cid:107)       
variable c with uniform distribution over the sphere, we have that

d for absolute constant   . then for random

where   = (cid:101)o( 1

d ).

log e[exp((cid:104)v, d(cid:105))] = (cid:107)v(cid:107)2/2d     

(a.21)

25

y =(cid:112)g2

proof. let g     n (0, i), then g/(cid:107)g(cid:107) has the same distribution as c. let r = (cid:107)v(cid:107). since c is spherically
symmetric, we could, we can assume without loss of generality that v = (r, 0, . . . , 0). let x = g1 and
d. therefore x     n (0, 1) and y2 has   2 distribution with mean d     1 and variance o(d).
d. note that the pr[f]     1   exp(      (log1.8(d)).

   
d     y     0.5

2 +        + g2

by proposition 2, we have that e[exp((cid:104)v, c(cid:105))] = e[exp((cid:104)v, c(cid:105)) | f]    (1       (    log1.8 d)).

let f be the event that x     20 log d and 1.5
conditioned on event f, we have

   

e[exp((cid:104)v, c(cid:105)) | f] = e

= e

= e

(cid:34)
(cid:34)
(cid:34)
(cid:20)

(cid:35)

rx(cid:112)x2 + y2

) | f

exp(

exp(

   

exp(

)    exp(

) | f

rx3

y(cid:112)x2 + y2(y +(cid:112)x2 + y2)
y(cid:112)x2 + y2(y +(cid:112)x2 + y2)
(cid:21)

rx3

log3 d

rx
y

rx
y

rx
y

(cid:35)

(cid:35)

) | f

= e

exp(

) | f

   (1    o(

d
   
d. let e be the event that 1.5

))

(a.22)

   
d     y     0.5

d. by using proposition 1,

   
where we used the fact that r       
we have that

(a.23)
then let z = y2/(d    1) and w = z     1. therefore z has   2 distribution with mean 1 and variance 1/(d    1),
and w has mean 0 and variance 1/(d     1).

e[exp(rx/y) | f] = e[exp(rx/y) | e]    exp(      (log2(d))

(cid:20)

e

exp(

) | e

rx
y

(cid:21)

= e[e[exp(rx/y) | y] | e] = e[exp(r2/y2) | e]
= e[exp(r2/(d     1)    1/z2) | e]
= e[exp(r2/(d     1)    (1 +

2w + w2

(1 + w)2 )) | e]

2w + w2

= exp(r2/(d     1)) e[exp(1 +
= exp(r2/(d     1)) e[1 + 2w    o(w2) | e]
= exp(r2/(d     1)2)(1    1/d)

(1 + w)2 )) | e]

where the second-to-last line uses the fact that conditioned on 1/2     e, w        1/2 and therefore the taylor
expansion approximates the exponential accurately, and the last line uses the fact that | e[w | e]| = o(1/d)
and e[w2 | e]     o(1/d). combining the series of approximations above completes the proof.

we    nally provide the proofs for a few helper propositions on conditional probabilities for high id203

events used in the lemma above.
proposition 1. suppose x     n (0,   2) with    = o(1). then for any event e with pr[e] = 1   o(      (log2 d)),
we have that e[exp(x)] = e[exp(x) | e]    exp(      (log2(d)).
proof. let   s denote by   e the complement of the event e. we will consider the upper and lower bound
separately. since

e[exp(x)] = e[exp(x) | e] pr[e] + e[exp(x) |   e] pr[   e]

we have that

e[exp(x)]     e[exp(x) | e] + e[exp(x) |   e] pr[   e]

(a.24)

26

and

e[exp(x)]     e[exp(x) | e](1     exp(      (log2 d)))     e[exp(x) | e]     e[exp(x) | e] exp(      (log2 d)))

(a.25)

consider the upper bound (a.24)    rst. to show the statement of the lemma, it su   ces to bound

e[exp(x) |   e] pr[   e].

working towards that, notice that

e[exp(x) |   e] pr[   e] = e[exp(x)1   e ] = e[exp(x) e[1   e|x]] = e[exp(x)r(x)]

if we denote r(x) = e[1   e|x]. we wish to upper bound e[exp(x)r(x)]. by lemma a.4, we have

e[exp(x)r(x)]     e[exp(x)1[t,   ]]

where t is such that e[1[t,   ]] = e[r(x)]. however, since e[r(x)] = pr[   e] = exp(      (log2 d)), it must be the
case that t =    (log d) by the standard gaussian tail bound, and the assumption that    = o(1). in turn,
this means

   
e[exp(x)1[t,   ]]     1

  

2  

    x2

  2 dx =

exe

   
1
2  

  

e   ( x

         

2 )2+   2

4 dx = e

  2
4

1   
2  

e   (x(cid:48)      
2 )2

dx(cid:48)

where the last equality follows from the change of variables x =   x(cid:48). however,

(cid:90) +   

t/  

1   
2  

e   (x(cid:48)      
2 )2

dx(cid:48)

is nothing more than pr[x(cid:48) > t
1. bearing in mind that    = o(1)

   ], where x(cid:48) is distributed like a univariate gaussian with mean   
(cid:90) +   

dx(cid:48) = exp(      (t2)) = exp(      (log2 d))

e   (x(cid:48)      
2 )2

2 and variance

  2
4

e

1   
2  

t/  

(cid:90) +   

t/  

(cid:90)    

t

(cid:90)    

t

by the usual gaussian tail bounds, which proves the lower bound we need.
e[exp(x) | e]. notice trivially that since exp(x)     0,

we proceed to consider the lower bound a.25. to show the statement of the lemma, we will bound

e[exp(x) | e]     e[exp(x)]
pr[e]

since pr[e]     1     exp(   (log2 d)),

pr[e]     1 + exp(o(log2)). so, it su   ces to bound e[exp(x)]. however,

1

(cid:90) +   

(cid:90) +   

e[exp(x)] =

where the last equality follows from the same change of variables x =   x(cid:48) as before. since(cid:82) +   

  2 dx =

4 dx =

t=      

t=      

t=      

  

  

e   ( x

         

2 )2+   2

    x2

exe

   
1
2  

1   
2  

   
1
2  

e   (x(cid:48)      

2 )2+   2

4 dx(cid:48)

(cid:90) +   

   

2  , we get

1   
2  

(cid:90) +   
t=      
pr[e] , we get that e[exp(x) | e] = o(1). plugging this back in a.25,

4 dx(cid:48) = e

  2
4 = o(1)

t=       e   (x(cid:48)      
2 )2

e   (x(cid:48)      

2 )2+   2

1

dx(cid:48) =

putting together with the estimate of
we get the desired upper bound.
   
proposition 2. suppose c     c and v is an arbitrary vector with (cid:107)v(cid:107) = o(
pr[e]     1     exp(      (log2 d)), we have that e[exp((cid:104)v, c(cid:105))] = e[exp((cid:104)v, c(cid:105)) | e]    exp(    log1.8 d).

d). then for any event e with

27

proof of proposition 2. let z = (cid:104)v, c(cid:105). we proceed similarly as in the proof of proposition 1. we have

e[exp(z)] = e[exp(z) | e] pr[e] + e[exp(z) |   e] pr[   e]

and

and

e[exp(z)]     e[exp(z) | e] + e[exp(z) |   e] pr[   e]

e[exp(z)]     e[exp(z) | e] pr[e] = e[exp(z) | e]     e[exp(z) | e] exp(      (log2 d))

(a.26)

(a.27)

we again proceed by separating the upper and lower bound.

we    rst consider the upper bound a.26.
notice that that

we can split the last expression as

e[exp(z) |   e] pr[   e] = e[exp(z)1   e ]

e(cid:2)exp((cid:104)vw, c(cid:105))1(cid:104)vw,c(cid:105)>01e

(cid:3) + e(cid:2)exp((cid:104)vw, c(cid:105))1(cid:104)vw,c(cid:105)<01e

(cid:3) .

the second term is upper bounded by

we proceed to the    rst term of (a.10) and observe the following property of it:

e(cid:2)exp((cid:104)vw, c(cid:105))1(cid:104)vw,c(cid:105)>01e

e[1e ]     exp(      (log2 n))

(cid:3)     e(cid:2)exp((cid:104)  vw, c(cid:105))1(cid:104)vw,c(cid:105)>0 1e

(cid:3)     e [exp((cid:104)  vw, c(cid:105))1e ]

where    > 1. therefore, it   s su   cient to bound

   
when (cid:107)vw(cid:107) =   (

d). let   s denote r(z) = e[1   e|z].

using lemma a.4, we have that

e [exp(z)1e ]

[exp(z)r(z)]     e(cid:2)exp(z)1[t,+   ](z)(cid:3)

e
c

(a.28)
where t satis   es that ec[1[t,+   ]] = pr[z     t] = ec[r(z)]     exp(      (log2 d)). then, we claim pr[z     t]    
exp(      (log2 d)) implies that t        (log.9 d).

indeed, this follows by directly applying lemma a.1. afterward, applying lemma a.2, we have:

e[exp(z)r(z)]     e(cid:2)exp(z)1[t,+   ](z)(cid:3) = exp(      (log1.8 d))

(a.29)

which proves the upper bound we want.
proposition 1: we just need to bound e[exp(z) | e]. same as in proposition 1, since exp(x)     0,

we now proceed to the lower bound a.27, which is again similar to the lower bound in the proof of

e[exp(z) | e]     e[exp(z)]
pr[e]

consider the event e(cid:48) : z     t, for t =   (log.9 d), which by lemma a.1 satis   es pr[e(cid:48)]     1    exp(      (log2 d)).
by the upper bound we just showed,

e[exp(z)]     e[exp(z) | e(cid:48)] + exp(      (log2 n)) = o(exp(log.9 d))

where the last equality follows since conditioned on e(cid:48), z = o(log.9 d). finally, this implies

e[exp(z) | e]     1

pr[e]

o(exp(log.9 d)) = o(exp(log.9 d))

where the last equality follows since pr[e]     1     exp(      (log2 n)). putting this together with a.27, we get

e[exp(z)]     e[exp(z) | e] pr[e] = e[exp(z) | e]     e[exp(z) | e] exp(      (log2 d))    
e[exp(z) | e]     o(exp(log.9 d)) exp(      (log2 d))     e[exp(z) | e]     exp(      (log2 d))

which is what we needed.

28

a.1 analyzing partition function zc

in this section, we prove lemma 2.1. we basically    rst prove that for the means of zc are all (1 + o(1))-close
to each other, and then prove that zc is concentrated around its mean. it turns out the concentration part
is non trivial because the random variable of concern, exp((cid:104)vw, c(cid:105)) is not well-behaved in terms of the tail.
note that exp((cid:104)vw, c(cid:105)) is not sub-gaussian for any variance proxy. this essentially disallows us to use an
existing concentration inequality directly. we get around this issue by considering the truncated version of
exp((cid:104)vw, c(cid:105)), which is bounded, and have similar tail properties as the original one, in the regime that we
are concerning.

we bound the mean and variance of zc    rst in the lemma below.

lemma a.6. for any    xed unit vector c     rd, we have that e[zc]     n and v[zc]     o(n).
proof of lemma a.6. recall that by de   nition

(cid:88)

zc =

exp((cid:104)vw, c(cid:105)).

w

we    x context c and view vw   s as random variables throughout this proof. recall that vw is composed of
vw = sw      vw, where sw is the scaling and   vw is from spherical gaussian with identity covariance id  d. let
s be a random variable that has the same distribution as sw.

we lowerbound the mean of zc as follows:

e[zc] = n e [exp((cid:104)vw, c(cid:105))]     n e [1 + (cid:104)vw, c(cid:105)] = n

where the last equality holds because of the symmetry of the spherical gaussian distibution. on the other
hand, to upperbound the mean of zc, we condition on the scaling sw,

e[zc] = n e[exp((cid:104)vw, c(cid:105))]

= n e [e [exp((cid:104)vw, c(cid:105)) | sw]]

note that conditioned on sw, we have that (cid:104)vw, c(cid:105) is a gaussian random variable with variance   2 = s2
w.

therefore,

e [exp((cid:104)vw, c(cid:105)) | sw] =

(cid:90)
(cid:90)

x

  

   
1
2  
   
1
2  
= exp(  2/2)

=

  

x

2  2 ) exp(x)dx

exp(    x2
exp(    (x       2)2

2  2

+   2/2)dx

it follows that

e[zc] = n e[exp(  2/2)] = n e[exp(s2

w/2)] = n e[exp(s2/2)].

we calculate the variance of zc as follows:

(cid:88)

v[zc] =

v [exp((cid:104)vw, c(cid:105))]     n e[exp(2(cid:104)vw, c(cid:105))]

w

= n e [e [exp(2(cid:104)vw, c(cid:105)) | sw]]

by a very similar calculation as above, using the fact that 2(cid:104)vw, c(cid:105) is a gaussian random variable with
variance 4  2 = 4s2
w,

e [exp(2(cid:104)vw, c(cid:105)) | sw] = exp(2  2)

29

therefore, we have that

v[zc]     n e [e [exp(2(cid:104)vw, c(cid:105)) | sw]]

= n e(cid:2)exp(2  2)(cid:3) = n e(cid:2)exp(2s2)(cid:3)       n

for    = exp(8  2) a constant, and at the last step we used the facts that s        a.s.

now we are ready to prove lemma 2.1.

proof of lemma 2.1. we    x the choice of c, and the proving the concentration using the randomness of vw   s
   rst. note that that exp((cid:104)vw, c(cid:105)) is neither sub-gaussian nor sub-exponential (actually the orlicz norm of
random variable exp((cid:104)vw, c(cid:105)) is never bounded). this prevents us from applying the usual concentration
inequalities. the proof deals with this issue in a slightly more specialized manner.
2 log n. we claim that pr[fw]     1   exp(      (log2 n)). indeed
note that (cid:104)vw, c(cid:105) | sw has a gaussian distribution with standard deviation sw(cid:107)c(cid:107) = sw     2   a.s. therefore
by the gaussianity of (cid:104)vw, c(cid:105) we have that

let   s de   ne fw be the event that |(cid:104)vw, c(cid:105)|     1

pr[|(cid:104)vw, c(cid:105)|        log n | sw]     2 exp(      (

log2 n/  2)) = exp(      (log2 n)),

1
4

where    (  ) hides the dependency on    which is treated as absolute constants. taking expectations over sw,
we obtain that

pr[fw] = pr[|(cid:104)vw, c(cid:105)|     1
2

log n]     1     exp(      (log2 n)).

note that by de   nition, we in particular have that conditioned on fw, it holds that exp((cid:104)vw, c(cid:105))        
variable z(cid:48)
of z(cid:48)

let the random variable xw have the same distribution as exp((cid:104)vw, c(cid:105))|fw . we prove that the random
w xw concentrates well. by convexity of the exponential function, we have that the mean

c =(cid:80)

n.

c is lowerbounded

e[z(cid:48)

c] = n e [exp((cid:104)vw, c(cid:105))|fw ]     n exp(e [(cid:104)vw, c(cid:105)|fw ]) = n

and the variance is upperbounded by

v[z(cid:48)

c]     n e(cid:2)exp((cid:104)vw, c(cid:105))2|fw
(cid:3)
e(cid:2)exp((cid:104)vw, c(cid:105))2(cid:3)

   

1

pr[fw]
pr[fw]

1

   

  n     1.1  n

where the second line uses the fact that

e(cid:2)exp((cid:104)vw, c(cid:105))2(cid:3)

= pr[fw] e(cid:2)exp((cid:104)vw, c(cid:105))2|fw
    pr[fw] e(cid:2)exp((cid:104)vw, c(cid:105))2|fw

(cid:3) + pr[f w] e(cid:2)exp((cid:104)vw, c(cid:105))2|f w
(cid:3) .

(cid:3)

moreover, by de   nition, for any w, |xw|        

n. therefore by bernstein   s inequality, we have that

1

2  2n2
   

1.1  n + 1
3

n     n

)

pr [|z(cid:48)

c     e[z(cid:48)

c]| >  n]     exp(   

30

note that e[z(cid:48)

c]     n, therefore for   (cid:29) log2 n   

n , we have,

pr [|z(cid:48)

c     e[z(cid:48)

c]| >   e[z(cid:48)

c]]     pr [|z(cid:48)

c     e[z(cid:48)

c]| >  n]     exp(   

1

2  2n2
   

n     n

)

  n + 1
3

   
    exp(      (min{ 2n/  ,  
    exp(      (log2 n))

n}))

let f =    wfw be the union of all fw. then by union bound, it holds that pr[   f]     (cid:80)

n    exp(      (log2 n)) = exp(      (log2 n)). we have that by de   nition, z(cid:48)
therefore, we have that

w pr[   fw]    
c has the same distribution as zc|f .

pr[|zc     e[z(cid:48)

c]| >   e[z(cid:48)

c] | f]     exp(      (log2 n))

(a.30)

and therefore
pr[|zc     e[z(cid:48)

c]| >   e[z(cid:48)

c]] = pr[f]    pr[|zc     e[z(cid:48)

c]| >   e[z(cid:48)

c] | f] + pr[   f] pr[|zc     e[z(cid:48)

c]| >   e[z(cid:48)

c] |   f]

    pr[|zc     e[z(cid:48)
    exp(      (log2 n))

c]| >   e[z(cid:48)

c] | f] + pr[   f]

(a.31)

where at the last line we used the fact that pr[   f]     exp(      (log2 n)) and equation (a.30).

let z = e[z(cid:48)

c] = e[exp((cid:104)vw, c(cid:105)) | |(cid:104)vw, c(cid:105)| < 1

2 log n] (note that e[z(cid:48)

c] only depends on the norm of (cid:107)c(cid:107)

which is equal to 1). therefore we obtain that with high id203 over the randomness of vw   s,

(1      z)z     zc     (1 +  z)z

(a.32)

taking expectation over the randomness of c, we have that

[ (a.32) holds]     1     exp(      (log2 n))

pr
c,vw

therefore by a standard averaging argument (using markov inequality), we have

(cid:104)

[ (a.32) holds]     1     exp(      (log2 n))

pr
c

pr
vw

(cid:105)     1     exp(      (log2 n))

for now on we    x a choice of vw   s so that prc[ (a.32) holds]     1    exp(      (log2 n)) is true. therefore in the
rest of the proof, only c is random variable, and with id203 1     exp(      (log2 n)) over the randomness
of c, it holds that,

(1      z)z     zc     (1 +  z)z.

(a.33)

b maximum likelihood estimator for co-occurrence
let l be the corpus size, and xw,w(cid:48) the number of times words w, w(cid:48) co-occur within a context of size 10
in the corpus. according to the model, the id203 of this event at any particular time is log p(w, w(cid:48))    
(cid:107)vw + vw(cid:48)(cid:107)2
2 . successive samples from a random walk are not independent of course, but if the random walk
mixes fairly quickly (and the mixing time of our random walk is related to the logarithm of the number
of words) then the set of xw,w(cid:48)   s over all word pairs is distributed up to a very close approximation as a
w,w(cid:48) xw,w(cid:48) is the total number of word pairs in

multinomial distribution mul(   l,{p(w, w(cid:48))}) where   l = (cid:80)

consideration (roughly 10l).

31

assuming this approximation, we show below that the maximum likelihood values for the word vectors

correspond to the following optimization,

(cid:88)

w,w(cid:48)

min
{vw},c

(cid:16)

xw,w(cid:48)

log(xw,w(cid:48))     (cid:107)vw +vw(cid:48)(cid:107)2

2     c

(objective sn)

now we give the derivation of the objective. according to the multinomial distribution, maximizing the

likelihood of {xw,w(cid:48)} is equivalent to maximizing

(cid:96) = log

p(w, w(cid:48))xw,w(cid:48)

xw,w(cid:48) log p(w, w(cid:48)).

(cid:17)2

(cid:88)

       =
(cid:32)   lp(w, w(cid:48))

(w,w(cid:48))

xw,w(cid:48)

(cid:33)

.

       (cid:89)

(w,w(cid:48))

   w,w(cid:48) = log

to reason about the likelihood, denote the logarithm of the ratio between the expected count and the

empirical count as

note that

(cid:96) =

=

(cid:88)
(cid:88)
(cid:88)

(w,w(cid:48))

(w,w(cid:48))

=

(w,w(cid:48))

= c +

(w,w(cid:48))

(cid:88)
where we let c denote the constant(cid:80)
(cid:88)
(cid:88)
(cid:88)

(w,w(cid:48))

(w,w(cid:48))

  l =

=

and also   l =(cid:80)

xw,w(cid:48) log p(w, w(cid:48))

(cid:34)

xw,w(cid:48)

log

xw,w(cid:48)

  l

xw,w(cid:48) log

xw,w(cid:48)

  l

+

+ log

(cid:88)

(w,w(cid:48))

(cid:32)   lp(w, w(cid:48))

xw,w(cid:48)

xw,w(cid:48) log

(cid:33)(cid:35)
(cid:32)   lp(w, w(cid:48))

(cid:33)

xw,w(cid:48)

(w,w(cid:48)) xw,w(cid:48) log xw,w(cid:48)

  l

. furthermore, we have

  lpw,w(cid:48)

xw,w(cid:48)e   w,w(cid:48)

xw,w(cid:48)   w,w(cid:48)

(b.1)

=

xw,w(cid:48)(1 +    w,w(cid:48) +    2

w,w(cid:48)/2 + o(|   w,w(cid:48)|3))

(w,w(cid:48))

(w,w(cid:48)) xw,w(cid:48). so

(cid:88)

(w,w(cid:48))

xw,w(cid:48)   w,w(cid:48) =    

       (cid:88)

(w,w(cid:48))

xw,w(cid:48)   2

w,w(cid:48)/2 +

       .

xw,w(cid:48)o(|   w,w(cid:48)|3)

(cid:88)

(w,w(cid:48))

plugging this into (3.2) leads to
c     (cid:96) =

(cid:88)

(w,w(cid:48))

(cid:88)

(w,w(cid:48))

xw,w(cid:48)   2

w,w(cid:48)/2 +

32

xw,w(cid:48)o(|   w,w(cid:48)|3).

(b.2)

when the last term is much smaller than the    rst term on the right hand side, maximizing the likelihood

is approximately equivalent to minimizing the    rst term on the right hand side, which is our objective:

(cid:88)

(w,w(cid:48))

w,w(cid:48)     (cid:88)

(w,w(cid:48))

(cid:16)(cid:107)vw + vw(cid:48)(cid:107)2

xw,w(cid:48)   2

xw,w(cid:48)

2/(2d)     log xw,w(cid:48) + log   l     2 log z

(cid:17)2

where z is the partition function.

that the objective (cid:80)

we now argue that the last term is much smaller than the    rst term on the right hand side in (b.2). for
a large xw,w(cid:48), the    w,w(cid:48) is close to 0 and thus the induced approximation error is small. small xw,w(cid:48)   s only
contribute a small fraction of the    nal objective (3.3), so we can safely ignore the errors. to see this, note
(w,w(cid:48)) xw,w(cid:48)o(|   w,w(cid:48)|3) di   er by a factor of
|   w,w(cid:48)| for each xw,w(cid:48). for large xw,w(cid:48)   s, |   w,w(cid:48)| (cid:28) 1, and thus their corresponding errors are much smaller
than the objective. so we only need to consider the xw,w(cid:48)   s that are small constants. the co-occurrence
counts obey a power law distribution (see, e.g. (pennington et al., 2014)). that is, if one sorts {xw,w(cid:48)} in
decreasing order, then the r-th value in the list is roughly

w,w(cid:48) and the error term (cid:80)

(w,w(cid:48)) xw,w(cid:48)   2

where k is some constant. some calculation shows that

and thus when x is a small constant(cid:80)

x[r] =

k

r5/4

(cid:88)

xw,w(cid:48)   x

  l     4k,

xw,w(cid:48)     4k4/5x1/5,

(cid:18) 4x

(cid:19)1/5

  l

   

(cid:18) 1

  l1/5

(cid:19)

.

= o

xw,w(cid:48)   x xw,w(cid:48)

  l

so there are only a negligible mass of xw,w(cid:48)   s that are small constants, which vanishes when   l increases.
furthermore, we empirically observe that the relative error of our objective is 5%, which means that the
errors induced by xw,w(cid:48)   s that are small constants is only a small fraction of the objective. therefore,

(cid:80)
w,w(cid:48) xw,w(cid:48)o(|   w,w(cid:48)|3) is small compared to the objective and can be safely ignored.

33

