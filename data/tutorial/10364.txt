distributed representations of sentences and documents

4
1
0
2

 

y
a
m
2
2

 

 
 
]
l
c
.
s
c
[
 
 

2
v
3
5
0
4

.

5
0
4
1
:
v
i
x
r
a

quoc le
tomas mikolov
google inc, 1600 amphitheatre parkway, mountain view, ca 94043

qvl@google.com
tmikolov@google.com

abstract

many machine learning algorithms require the
input to be represented as a    xed-length feature
vector. when it comes to texts, one of the most
common    xed-length features is bag-of-words.
despite their popularity, bag-of-words features
have two major weaknesses: they lose the order-
ing of the words and they also ignore semantics
of the words. for example,    powerful,       strong   
and    paris    are equally distant. in this paper, we
propose paragraph vector, an unsupervised algo-
rithm that learns    xed-length feature representa-
tions from variable-length pieces of texts, such as
sentences, paragraphs, and documents. our algo-
rithm represents each document by a dense vec-
tor which is trained to predict words in the doc-
ument. its construction gives our algorithm the
potential to overcome the weaknesses of bag-of-
words models. empirical results show that para-
graph vectors outperform bag-of-words models
as well as other techniques for text representa-
tions. finally, we achieve new state-of-the-art re-
sults on several text classi   cation and sentiment
analysis tasks.

1. introduction

text classi   cation and id91 play an important role
in many applications, e.g, document retrieval, web search,
spam    ltering. at the heart of these applications is ma-
chine learning algorithms such as id28 or k-
means. these algorithms typically require the text input to
be represented as a    xed-length vector. perhaps the most
common    xed-length vector representation for texts is the
bag-of-words or bag-of-id165s (harris, 1954) due to its
simplicity, ef   ciency and often surprising accuracy.

however, the bag-of-words (bow) has many disadvan-

proceedings of the 31 st international conference on machine
learning, beijing, china, 2014. jmlr: w&cp volume 32. copy-
right 2014 by the author(s).

tages. the word order is lost, and thus different sentences
can have exactly the same representation, as long as the
same words are used. even though bag-of-id165s con-
siders the word order in short context, it suffers from data
sparsity and high dimensionality. bag-of-words and bag-
of-id165s have very little sense about the semantics of the
words or more formally the distances between the words.
this means that words    powerful,       strong    and    paris    are
equally distant despite the fact that semantically,    power-
ful    should be closer to    strong    than    paris.   

in this paper, we propose paragraph vector, an unsuper-
vised framework that learns continuous distributed vector
representations for pieces of texts. the texts can be of
variable-length, ranging from sentences to documents. the
name paragraph vector is to emphasize the fact that the
method can be applied to variable-length pieces of texts,
anything from a phrase or sentence to a large document.

in our model, the vector representation is trained to be use-
ful for predicting words in a paragraph. more precisely, we
concatenate the paragraph vector with several word vec-
tors from a paragraph and predict the following word in the
given context. both word vectors and paragraph vectors are
trained by the stochastic id119 and backpropaga-
tion (rumelhart et al., 1986). while paragraph vectors are
unique among paragraphs, the word vectors are shared. at
prediction time, the paragraph vectors are inferred by    x-
ing the word vectors and training the new paragraph vector
until convergence.

our technique is inspired by the recent work in learn-
ing vector representations of words using neural net-
works (bengio et al., 2006; collobert & weston, 2008;
mnih & hinton, 2008; turian et al., 2010; mikolov et al.,
2013a;c). in their formulation, each word is represented by
a vector which is concatenated or averaged with other word
vectors in a context, and the resulting vector is used to pre-
dict other words in the context. for example, the neural
network language model proposed in (bengio et al., 2006)
uses the concatenation of several previous word vectors to
form the input of a neural network, and tries to predict the
next word. the outcome is that after the model is trained,
the word vectors are mapped into a vector space such that

distributed representations of sentences and documents

semantically similar words have similar vector representa-
tions (e.g.,    strong    is close to    powerful   ).

following these successful techniques, researchers have
tried to extend the models to go beyond word level
to achieve phrase-level or sentence-level
representa-
tions (mitchell & lapata, 2010; zanzotto et al., 2010;
yessenalina & cardie, 2011; grefenstette et al., 2013;
mikolov et al., 2013c). for instance, a simple approach is
using a weighted average of all the words in the document.
a more sophisticated approach is combining the word vec-
tors in an order given by a parse tree of a sentence, using
matrix-vector operations (socher et al., 2011b). both ap-
proaches have weaknesses. the    rst approach, weighted
averaging of word vectors, loses the word order in the same
way as the standard bag-of-words models do. the second
approach, using a parse tree to combine word vectors, has
been shown to work for only sentences because it relies on
parsing.

paragraph vector is capable of constructing representations
of input sequences of variable length. unlike some of the
previous approaches, it is general and applicable to texts of
any length: sentences, paragraphs, and documents. it does
not require task-speci   c tuning of the word weighting func-
tion nor does it rely on the parse trees. further in the paper,
we will present experiments on several benchmark datasets
that demonstrate the advantages of paragraph vector. for
example, on id31 task, we achieve new state-
of-the-art results, better than complex methods, yielding a
relative improvement of more than 16% in terms of error
rate. on a text classi   cation task, our method convincingly
beats bag-of-words models, giving a relative improvement
of about 30%.

2. algorithms

we start by discussing previous methods for learning word
vectors. these methods are the inspiration for our para-
graph vector methods.

2.1. learning vector representation of words

this section introduces the concept of distributed vector
representation of words. a well known framework for
learning the word vectors is shown in figure 1. the task
is to predict a word given the other words in a context.

in this framework, every word is mapped to a unique vec-
tor, represented by a column in a matrix w . the column
is indexed by position of the word in the vocabulary. the
concatenation or sum of the vectors is then used as features
for prediction of the next word in a sentence.

more formally, given a sequence of
training words
w1, w2, w3, ..., wt , the objective of the word vector model

figure1.a framework for learning word vectors. context of
three words (   the,       cat,    and    sat   ) is used to predict the fourth
word (   on   ). the input words are mapped to columns of the ma-
trix w to predict the output word.

is to maximize the average log id203

1
t

t    k

x

t=k

log p(wt|wt   k, ..., wt+k)

the prediction task is typically done via a multiclass clas-
si   er, such as softmax. there, we have

p(wt|wt   k, ..., wt+k) =

eywt
pi eyi

each of yi is un-normalized log-id203 for each output
word i, computed as

y = b + u h(wt   k, ..., wt+k; w )

(1)

where u, b are the softmax parameters. h is constructed by
a concatenation or average of word vectors extracted from
w .

in practice, hierarchical softmax (morin & bengio, 2005;
mnih & hinton, 2008; mikolov et al., 2013c) is preferred
to softmax for fast training.
in our work, the structure
of the hierarical softmax is a binary huffman tree, where
short codes are assigned to frequent words. this is a good
speedup trick because common words are accessed quickly.
this use of binary huffman code for the hierarchy is the
same with (mikolov et al., 2013c).

the neural network based word vectors are usually
trained using stochastic id119 where the gra-
dient is obtained via id26 (rumelhart et al.,
1986).
this type of models is commonly known as
neural
a
particular implementation of neural network based al-
gorithm for training the word vectors is available at
code.google.com/p/id97/ (mikolov et al.,
2013a).

language models (bengio et al., 2006).

after the training converges, words with similar meaning
are mapped to a similar position in the vector space. for

distributed representations of sentences and documents

example,    powerful    and    strong    are close to each other,
whereas    powerful    and    paris    are more distant. the dif-
ference between word vectors also carry meaning. for ex-
ample, the word vectors can be used to answer analogy
questions using simple vector algebra:    king    -    man    +
   woman    =    queen    (mikolov et al., 2013d). it is also pos-
sible to learn a linear matrix to translate words and phrases
between languages (mikolov et al., 2013b).

these properties make word vectors attractive for many
natural language processing tasks such as language mod-
eling (bengio et al., 2006; mikolov, 2012), natural lan-
guage understanding (collobert & weston, 2008; zhila
et al., 2013), id151 (mikolov et al.,
2013b; zou et al., 2013), image understanding (frome
et al., 2013) and relational extraction (socher et al., 2013a).

2.2. paragraph vector: a distributed memory model

our approach for learning paragraph vectors is inspired by
the methods for learning the word vectors. the inspiration
is that the word vectors are asked to contribute to a predic-
tion task about the next word in the sentence. so despite
the fact that the word vectors are initialized randomly, they
can eventually capture semantics as an indirect result of the
prediction task. we will use this idea in our paragraph vec-
tors in a similar manner. the paragraph vectors are also
asked to contribute to the prediction task of the next word
given many contexts sampled from the paragraph.

in our paragraph vector framework (see figure 2), every
paragraph is mapped to a unique vector, represented by a
column in matrix d and every word is also mapped to a
unique vector, represented by a column in matrix w . the
paragraph vector and word vectors are averaged or concate-
nated to predict the next word in a context. in the experi-
ments, we use concatenation as the method to combine the
vectors.

more formally, the only change in this model compared
to the word vector framework is in equation 1, where h is
constructed from w and d.

the paragraph token can be thought of as another word. it
acts as a memory that remembers what is missing from the
current context     or the topic of the paragraph. for this
reason, we often call this model the distributed memory
model of paragraph vectors (pv-dm).

the contexts are    xed-length and sampled from a sliding
window over the paragraph. the paragraph vector is shared
across all contexts generated from the same paragraph but
not across paragraphs. the word vector matrix w , how-
ever, is shared across paragraphs. i.e., the vector for    pow-
erful    is the same for all paragraphs.

the paragraph vectors and word vectors are trained using

stochastic id119 and the gradient is obtained via
id26. at every step of stochastic gradient de-
scent, one can sample a    xed-length context from a random
paragraph, compute the error gradient from the network in
figure 2 and use the gradient to update the parameters in
our model.

at prediction time, one needs to perform an id136 step
to compute the paragraph vector for a new paragraph. this
is also obtained by id119. in this step, the pa-
rameters for the rest of the model, the word vectors w and
the softmax weights, are    xed.

suppose that there are n paragraphs in the corpus, m
words in the vocabulary, and we want to learn paragraph
vectors such that each paragraph is mapped to p dimen-
sions and each word is mapped to q dimensions, then the
model has the total of n    p + m    q parameters (ex-
cluding the softmax parameters). even though the number
of parameters can be large when n is large, the updates
during training are typically sparse and thus ef   cient.

figure2.a framework for learning paragraph vector. this frame-
work is similar to the framework presented in figure 1; the only
change is the additional paragraph token that is mapped to a vec-
tor via matrix d. in this model, the concatenation or average of
this vector with a context of three words is used to predict the
fourth word. the paragraph vector represents the missing infor-
mation from the current context and can act as a memory of the
topic of the paragraph.

after being trained, the paragraph vectors can be used as
features for the paragraph (e.g., in lieu of or in addition
to bag-of-words). we can feed these features directly to
conventional machine learning techniques such as logistic
regression, support vector machines or id116.

in summary, the algorithm itself has two key stages: 1)
training to get word vectors w , softmax weights u, b and
paragraph vectors d on already seen paragraphs; and 2)
   the id136 stage    to get paragraph vectors d for new
paragraphs (never seen before) by adding more columns
in d and gradient descending on d while holding w, u, b
   xed. we use d to make a prediction about some particular
labels using a standard classi   er, e.g., id28.

distributed representations of sentences and documents

advantages of paragraph vectors: an important ad-
vantage of paragraph vectors is that they are learned from
unlabeled data and thus can work well for tasks that do not
have enough labeled data.

paragraph vectors also address some of the key weaknesses
of bag-of-words models. first, they inherit an important
property of the word vectors: the semantics of the words. in
this space,    powerful    is closer to    strong    than to    paris.   
the second advantage of the paragraph vectors is that they
take into consideration the word order, at least in a small
context, in the same way that an id165 model with a large
n would do. this is important, because the id165 model
preserves a lot of information of the paragraph, including
the word order. that said, our model is perhaps better than
a bag-of-id165s model because a bag of id165s model
would create a very high-dimensional representation that
tends to generalize poorly.

2.3. paragraph vector without word ordering:

distributed bag of words

the above method considers the concatenation of the para-
graph vector with the word vectors to predict the next word
in a text window. another way is to ignore the context
words in the input, but force the model to predict words
randomly sampled from the paragraph in the output. in re-
ality, what this means is that at each iteration of stochastic
id119, we sample a text window, then sample
a random word from the text window and form a classi   -
cation task given the paragraph vector. this technique is
shown in figure 3. we name this version the distributed
bag of words version of paragraph vector (pv-dbow), as
opposed to distributed memory version of paragraph vec-
tor (pv-dm) in previous section.

figure3.distributed bag of words version of paragraph vectors.
in this version, the paragraph vector is trained to predict the words
in a small window.

in addition to being conceptually simple, this model re-
quires to store less data. we only need to store the softmax
weights as opposed to both softmax weights and word vec-
tors in the previous model. this model is also similar to the

skip-gram model in word vectors (mikolov et al., 2013c).

in our experiments, each paragraph vector is a combina-
tion of two vectors: one learned by the standard paragraph
vector with distributed memory (pv-dm) and one learned
by the paragraph vector with distributed bag of words (pv-
dbow). pv-dm alone usually works well for most tasks
(with state-of-art performances), but its combination with
pv-dbow is usually more consistent across many tasks
that we try and therefore strongly recommended.

3. experiments

we perform experiments to better understand the behavior
of the paragraph vectors. to achieve this, we benchmark
paragraph vector on two text understanding problems that
require    xed-length vector representations of paragraphs:
id31 and information retrieval.

for id31, we use two datasets: stanford sen-
timent treebank dataset (socher et al., 2013b) and imdb
dataset (maas et al., 2011). documents in these datasets
differ signi   cantly in lengths: every example in socher et
al. (socher et al., 2013b)   s dataset is a single sentence while
every example in maas et al. (maas et al., 2011)   s dataset
consists of several sentences.

we also test our method on an information retrieval task,
where the goal is to decide if a document should be re-
trieved given a query.

3.1. id31 with the stanford sentiment

treebank dataset

dataset: this dataset was    rst proposed by (pang & lee,
2005) and subsequently extended by (socher et al., 2013b)
as a benchmark for id31. it has 11855 sen-
tences taken from the movie review site rotten tomatoes.

the dataset consists of three sets: 8544 sentences for train-
ing, 2210 sentences for test and 1101 sentences for valida-
tion (or development).

every sentence in the dataset has a label which goes from
very negative to very positive in the scale from 0.0 to 1.0.
the labels are generated by human annotators using ama-
zon mechanical turk.

the dataset comes with detailed labels for sentences,
and subphrases in the same scale.
to achieve this,
socher et al. (socher et al., 2013b) used the stanford
parser (klein & manning, 2003) to parse each sentence
to subphrases. the subphrases were then labeled by hu-
man annotators in the same way as the sentences were
labeled.
there are 239,232 labeled phrases
in the dataset.
the dataset can be downloaded at:
http://nlp.stanford.edu/sentiment/

in total,

distributed representations of sentences and documents

tasks and baselines:
in (socher et al., 2013b), the au-
thors propose two ways of benchmarking. first, one could
consider a 5-way    ne-grained classi   cation task where
the labels are {very negative, negative, neutral, posi-
tive, very positive} or a 2-way coarse-grained classi   ca-
tion task where the labels are {negative, positive}. the
other axis of variation is in terms of whether we should la-
bel the entire sentence or all phrases in the sentence. in this
work we only consider labeling the full sentences.

socher et al. (socher et al., 2013b) apply several methods
to this dataset and    nd that their recursive neural tensor
network works much better than bag-of-words model. it
can be argued that this is because movie reviews are often
short and compositionality plays an important role in de-
ciding whether the review is positive or negative, as well as
similarity between words does given the rather tiny size of
the training set.

experimental protocols: we follow the experimental
protocols as described in (socher et al., 2013b). to make
use of the available labeled data, in our model, each sub-
phrase is treated as an independent sentence and we learn
the representations for all the subphrases in the training set.

after learning the vector representations for training sen-
tences and their subphrases, we feed them to a logistic re-
gression to learn a predictor of the movie rating.

at test time, we freeze the vector representation for each
word, and learn the representations for the sentences using
id119. once the vector representations for the
test sentences are learned, we feed them through the logis-
tic regression to predict the movie rating.

in our experiments, we cross validate the window size us-
ing the validation set, and the optimal window size is 8.
the vector presented to the classi   er is a concatenation of
two vectors, one from pv-dbow and one from pv-dm.
in pv-dbow, the learned vector representations have 400
dimensions. in pv-dm, the learned vector representations
have 400 dimensions for both words and paragraphs. to
predict the 8-th word, we concatenate the paragraph vec-
tors and 7 word vectors. special characters such as ,.!? are
treated as a normal word. if the paragraph has less than 9
words, we pre-pad with a special null word symbol.

results: we report the error rates of different methods in
table 1. the    rst highlight for this table is that bag-of-
words or bag-of-id165s models (nb, id166, binb) per-
form poorly. simply averaging the word vectors (in a bag-
of-words fashion) does not improve the results. this is
because bag-of-words models do not consider how each
sentence is composed (e.g., word ordering) and therefore
fail to recognize many sophisticated linguistic phenom-
ena, for instance sarcasm. the results also show that

table1.the performance of our method compared to other ap-
proaches on the stanford sentiment treebank dataset. the error
rates of other methods are reported in (socher et al., 2013b).

model

na    ve bayes
(socher et al., 2013b)
id166s (socher et al., 2013b)
bigram na    ve bayes
(socher et al., 2013b)
word vector averaging
(socher et al., 2013b)
id56
(socher et al., 2013b)
matrix vector-id56
(socher et al., 2013b)
recursive neural tensor network
(socher et al., 2013b)
paragraph vector

error rate
(positive/
negative)
18.2 %

error rate
(fine-
grained)
59.0%

20.6%
16.9%

59.3%
58.1%

19.9%

67.3%

17.6%

56.8%

17.1%

55.6%

14.6%

54.3%

12.2%

51.3%

more advanced methods (such as recursive neural net-
work (socher et al., 2013b)), which require parsing and
take into account the compositionality, perform much bet-
ter.

our method performs better than all these baselines, e.g.,
recursive networks, despite the fact that it does not re-
quire parsing. on the coarse-grained classi   cation task, our
method has an absolute improvement of 2.4% in terms of
error rates. this translates to 16% relative improvement.

3.2. beyond one sentence: id31 with

imdb dataset

some of the previous techniques only work on sentences,
but not paragraphs/documents with several sentences. for
instance, recursive neural tensor network (socher et al.,
2013b) is based on the parsing over each sentence and it
is unclear how to combine the representations over many
sentences. such techniques therefore are restricted to work
on sentences but not paragraphs or documents.

our method does not require parsing, thus it can produce
a representation for a long document consisting of many
sentences. this advantage makes our method more general
than some of the other approaches. the following experi-
ment on imdb dataset demonstrates this advantage.

dataset: the imdb dataset was    rst proposed by maas
et al. (maas et al., 2011) as a benchmark for sentiment anal-
ysis. the dataset consists of 100,000 movie reviews taken
from imdb. one key aspect of this dataset is that each
movie review has several sentences.

the 100,000 movie reviews are divided into three datasets:

distributed representations of sentences and documents

25,000 labeled training instances, 25,000 labeled test in-
stances and 50,000 unlabeled training instances. there are
two types of labels: positive and negative. these labels are
balanced in both the training and the test set. the dataset
can be downloaded at http://ai.stanford.edu/
amaas/data/sentiment/index.html

experimental protocols: we learn the word vectors and
paragraph vectors using 75,000 training documents (25,000
labeled and 50,000 unlabeled instances). the paragraph
vectors for the 25,000 labeled instances are then fed
through a neural network with one hidden layer with 50
units and a logistic classi   er to learn to predict the senti-
ment.1

at test time, given a test sentence, we again freeze the rest
of the network and learn the paragraph vectors for the test
reviews by id119. once the vectors are learned,
we feed them through the neural network to predict the sen-
timent of the reviews.

the hyperparameters of our paragraph vector model are se-
lected in the same manner as in the previous task. in par-
ticular, we cross validate the window size, and the opti-
mal window size is 10 words. the vector presented to the
classi   er is a concatenation of two vectors, one from pv-
dbow and one from pv-dm. in pv-dbow, the learned
vector representations have 400 dimensions. in pv-dm,
the learned vector representations have 400 dimensions for
both words and documents. to predict the 10-th word, we
concatenate the paragraph vectors and word vectors. spe-
cial characters such as ,.!? are treated as a normal word.
if the document has less than 9 words, we pre-pad with a
special null word symbol.

results: the results of paragraph vector and other base-
lines are reported in table 2. as can be seen from the
table, for long documents, bag-of-words models perform
quite well and it is dif   cult to improve upon them using
word vectors. the most signi   cant improvement happened
in 2012 in the work of (dahl et al., 2012) where they com-
bine a restricted id82s model with bag-of-
words. the combination of two models yields an improve-
ment approximately 1.5% in terms of error rates.

another signi   cant improvement comes from the work
of (wang & manning, 2012). among many variations they
tried, nbid166 on bigram features works the best and yields
a considerable improvement of 2% in terms of the error
rate.

the method described in this paper is the only approach
that goes signi   cantly beyond the barrier of 10% error rate.

1in our experiments, the neural network did perform better

than a linear logistic classi   er in this task.

it achieves 7.42% which is another 1.3% absolute improve-
ment (or 15% relative improvement) over the best previous
result of (wang & manning, 2012).

table2.the performance of paragraph vector compared to other
approaches on the imdb dataset. the error rates of other methods
are reported in (wang & manning, 2012).

model
bow (bnc) (maas et al., 2011)
bow (b   t   c) (maas et al., 2011)
lda (maas et al., 2011)
full+bow (maas et al., 2011)
full+unlabeled+bow (maas et al., 2011)
wrrbm (dahl et al., 2012)
wrrbm + bow (bnc) (dahl et al., 2012)
mnb-uni (wang & manning, 2012)
mnb-bi (wang & manning, 2012)
id166-uni (wang & manning, 2012)
id166-bi (wang & manning, 2012)
nbid166-uni (wang & manning, 2012)
nbid166-bi (wang & manning, 2012)
paragraph vector

error rate
12.20 %
11.77%
32.58%
11.67%
11.11%
12.58%
10.77%
16.45%
13.41%
13.05%
10.84%
11.71%
8.78%
7.42%

3.3. information retrieval with paragraph vectors

we turn our attention to an information retrieval task which
requires    xed-length representations of paragraphs.

here, we have a dataset of paragraphs in the    rst 10 results
returned by a search engine given each of 1,000,000 most
popular queries. each of these paragraphs is also known as
a    snippet    which summarizes the content of a web page
and how a web page matches the query.

from such collection, we derive a new dataset to test vector
representations of paragraphs. for each query, we create
a triplet of paragraphs: the two paragraphs are results of
the same query, whereas the third paragraph is a randomly
sampled paragraph from the rest of the collection (returned
as the result of a different query). our goal is to identify
which of the three paragraphs are results of the same query.
to achieve this, we will use paragraph vectors and compute
the distances the paragraphs. a better representation is one
that achieves a small distance for pairs of paragraphs of the
same query and a larg distance for pairs of paragraphs of
different queries.

here is a sample of three paragraphs, where the    rst para-
graph should be closer to the second paragraph than the
third paragraph:

    paragraph 1: calls from ( 000 ) 000 - 0000 . 3913
calls reported from this number . according to 4 re-
ports the identity of this caller is american airlines .

distributed representations of sentences and documents

    paragraph 2: do you want to    nd out who called you
from +1 000 - 000 - 0000 , +1 0000000000 or ( 000
) 000 - 0000 ? see reports and share information you
have about this caller

    paragraph 3: allina health clinic patients for your
convenience , you can pay your allina health clinic
bill online . pay your clinic bill now , question and
answers...

the triplets are split into three sets: 80% for training, 10%
for validation, and 10% for testing. any method that re-
quires learning will be trained on the training set, while its
hyperparameters will be selected on the validation set.

we benchmark four methods to compute features for para-
graphs: bag-of-words, bag-of-bigrams, averaging word
vectors and paragraph vector. to improve bag-of-bigrams,
we also learn a weighting matrix such that the distance be-
tween the    rst two paragraphs is minimized whereas the
distance between the    rst and the third paragraph is max-
imized (the weighting factor between the two losses is a
hyperparameter).

we record the number of times when each method produces
smaller distance for the    rst two paragraphs than the    rst
and the third paragraph. an error is made if a method does
not produce that desirable distance metric on a triplet of
paragraphs.

the results of paragraph vector and other baselines are re-
ported in table 3. in this task, we    nd that tf-idf weight-
ing performs better than raw counts, and therefore we only
report the results of methods with tf-idf weighting.

the results show that paragraph vector works well and
gives a 32% relative improvement in terms of error rate.
the fact that the paragraph vector method signi   cantly out-
performs bag of words and bigrams suggests that our pro-
posed method is useful for capturing the semantics of the
input text.

table3.the performance of paragraph vector and bag-of-words
models on the information retrieval task.
   weighted bag-of-
bigrams    is the method where we learn a linear matrix w on tf-
idf bigram features that maximizes the distance between the    rst
and the third paragraph and minimizes the distance between the
   rst and the second paragraph.

model
vector averaging
bag-of-words
bag-of-bigrams
weighted bag-of-bigrams
paragraph vector

error rate
10.25%
8.10 %
7.28 %
5.67%
3.82%

3.4. some further observations

we perform further experiments to understand various as-
pects of the models. here   s some observations

    pv-dm is consistently better than pv-dbow. pv-
dm alone can achieve results close to many results
in this paper (see table 2). for example, in imdb,
pv-dm only achieves 7.63%. the combination of
pv-dm and pv-dbow often work consistently bet-
ter (7.42% in imdb) and therefore recommended.

    using concatenation in pv-dm is often better than
sum. in imdb, pv-dm with sum can only achieve
8.06%. perhaps, this is because the model loses the
ordering information.

    it   s better to cross validate the window size. a good
guess of window size in many applications is between
5 and 12. in imdb, varying the window sizes between
5 and 12 causes the error rate to    uctuate 0.7%.

    paragraph vector can be expensive, but it can be done
in parallel at test time. on average, our implementa-
tion takes 30 minutes to compute the paragraph vec-
tors of the imdb test set, using a 16 core machine
(25,000 documents, each document on average has
230 words).

4. related work

distributed representations for words were    rst proposed
in (rumelhart et al., 1986) and have become a successful
paradigm, especially for statistical id38 (el-
man, 1990; bengio et al., 2006; mikolov, 2012). word vec-
tors have been used in nlp applications such as word rep-
resentation, id39, word sense disam-
biguation, parsing, tagging and machine translation (col-
lobert & weston, 2008; turney & pantel, 2010; turian
et al., 2010; collobert et al., 2011; socher et al., 2011b;
huang et al., 2012; zou et al., 2013).

representing phrases is a recent trend and received much
attention (mitchell & lapata, 2010; zanzotto et al., 2010;
yessenalina & cardie, 2011; grefenstette et al., 2013;
mikolov et al., 2013c). in this direction, autoencoder-style
models have also been used to model paragraphs (maas
et al., 2011; larochelle & lauly, 2012; srivastava et al.,
2013).

distributed representations of phrases and sentences are
also the focus of socher et al. (socher et al., 2011a;c;
2013b). their methods typically require parsing and is
shown to work for sentence-level representations. and it
is not obvious how to extend their methods beyond single
sentences. their methods are also supervised and thus re-
quire more labeled data to work well. paragraph vector,

distributed representations of sentences and documents

in contrast, is mostly unsupervised and thus can work well
with less labeled data.

our approach of computing the paragraph vectors via gra-
dient descent bears resemblance to a successful paradigm
in id161 (perronnin & dance, 2007; perronnin
et al., 2010) known as fisher kernels (jaakkola & haus-
sler, 1999). the basic construction of fisher kernels is the
gradient vector over an unsupervised generative model.

5. discussion

we described paragraph vector, an unsupervised learning
algorithm that learns vector representations for variable-
length pieces of texts such as sentences and documents.
the vector representations are learned to predict the sur-
rounding words in contexts sampled from the paragraph.

our experiments on several text classi   cation tasks such as
stanford treebank and imdb id31 datasets
show that the method is competitive with state-of-the-art
methods. the good performance demonstrates the merits
of paragraph vector in capturing the semantics of para-
graphs.
in fact, paragraph vectors have the potential to
overcome many weaknesses of bag-of-words models.

although the focus of this work is to represent texts, our
method can be applied to learn representations for sequen-
tial data. in non-text domains where parsing is not avail-
able, we expect paragraph vector to be a strong alternative
to bag-of-words and bag-of-id165s models.

references
bengio, yoshua, schwenk, holger, sen  ecal,

jean-
s  ebastien, morin, fr  ederic, and gauvain, jean-luc.
neural probabilistic language models. in innovations in
machine learning, pp. 137   186. springer, 2006.

collobert, ronan and weston, jason. a uni   ed architecture
for natural language processing: deep neural networks
with multitask learning. in proceedings of the 25th in-
ternational conference on machine learning, pp. 160   
167. acm, 2008.

collobert, ronan, weston, jason, bottou, l  eon, karlen,
michael, kavukcuoglu, koray, and kuksa, pavel. nat-
ural language processing (almost) from scratch. the
journal of machine learning research, 12:2493   2537,
2011.

elman, jeff. finding structure in time. in cognitive sci-

ence, pp. 179   211, 1990.

frome, andrea, corrado, greg s., shlens, jonathon, ben-
gio, samy, dean, jeffrey, ranzato, marc   aurelio, and
mikolov, tomas. devise: a deep visual-semantic em-
bedding model. in advances in neural information pro-
cessing systems, 2013.

grefenstette, e., dinu, g., zhang, y., sadrzadeh, m., and
baroni, m. multi-step regression learning for composi-
tional id65. in conference on empir-
ical methods in natural language processing, 2013.

harris, zellig. distributional structure. word, 1954.

huang, eric, socher, richard, manning, christopher, and
improving word representations via
ng, andrew y.
global context and multiple word prototypes.
in pro-
ceedings of the 50th annual meeting of the association
for computational linguistics: long papers-volume 1,
pp. 873   882. association for computational linguistics,
2012.

jaakkola, tommi and haussler, david. exploiting gener-
ative models in discriminative classi   ers. in advances
in neural information processing systems 11, pp. 487   
493, 1999.

klein, dan and manning, chris d. accurate unlexical-
ized parsing. in proceedings of association for compu-
tational linguistics, 2003.

larochelle, hugo and lauly, stanislas. a neural autore-
gressive topic model. in advances in neural information
processing systems, 2012.

maas, andrew l., daly, raymond e., pham, peter t.,
huang, dan, ng, andrew y., and potts, christopher.
learning word vectors for id31.
in pro-
ceedings of the 49th annual meeting of the association
for computational linguistics, 2011.

mikolov, tomas. statistical language models based on
neural networks. phd thesis, brno university of tech-
nology, 2012.

mikolov, tomas, chen, kai, corrado, greg, and dean, jef-
frey. ef   cient estimation of word representations in vec-
tor space. arxiv preprint arxiv:1301.3781, 2013a.

mikolov, tomas, le, quoc v., and sutskever, ilya. ex-
ploiting similarities among languages for machine trans-
lation. corr, abs/1309.4168, 2013b.

dahl, george e., adams, ryan p., and larochelle, hugo.
training restricted id82s on word obser-
vations. in international conference on machine learn-
ing, 2012.

mikolov, tomas, sutskever, ilya, chen, kai, corrado,
greg, and dean, jeffrey. distributed representations of
phrases and their compositionality. in advances on neu-
ral information processing systems, 2013c.

distributed representations of sentences and documents

socher, richard, perelygin, alex, wu, jean y., chuang, ja-
son, manning, christopher d., ng, andrew y., and potts,
christopher. recursive deep models for semantic com-
positionality over a sentiment treebank. in conference
on empirical methods in natural language processing,
2013b.

srivastava, nitish, salakhutdinov, ruslan, and hinton, ge-
offrey. modeling documents with deep boltzmann ma-
chines. in uncertainty in arti   cial intelligence, 2013.

turian, joseph, ratinov, lev, and bengio, yoshua. word
representations: a simple and general method for semi-
supervised learning. in proceedings of the 48th annual
meeting of the association for computational linguis-
tics, pp. 384   394. association for computational lin-
guistics, 2010.

turney, peter d. and pantel, patrick. from frequency to
meaning: vector space models of semantics. journal of
arti   cial intelligence research, 2010.

wang, sida and manning, chris d. baselines and bigrams:
simple, good sentiment and text classi   cation. in pro-
ceedings of the 50th annual meeting of the association
for computational linguistics, 2012.

yessenalina, ainur and cardie, claire. compositional
matrix-space models for id31. in confer-
ence on empirical methods in natural language pro-
cessing, 2011.

zanzotto, fabio, korkontzelos,

ioannis, fallucchi,
francesca, and manandhar, suresh. estimating linear
models for compositional id65.
in
coling, 2010.

zhila, a., yih, w.t., meek, c., zweig, g., and mikolov,
t. combining heterogeneous models for measuring re-
lational similarity. in naacl hlt, 2013.

zou, will, socher, richard, cer, daniel, and manning,
christopher. bilingual id27s for phrase-
based machine translation. in conference on empirical
methods in natural language processing, 2013.

mikolov, tomas, yih, scott wen-tau, and zweig, geoffrey.
linguistic regularities in continuous space word repre-
sentations. in naacl hlt, 2013d.

mitchell, jeff and lapata, mirella. composition in distri-
butional models of semantics. cognitive science, 2010.

mnih, andriy and hinton, geoffrey e. a scalable hi-
erarchical distributed language model.
in advances in
neural information processing systems, pp. 1081   1088,
2008.

morin, frederic and bengio, yoshua. hierarchical proba-
bilistic neural network language model. in proceedings
of the international workshop on arti   cial intelligence
and statistics, pp. 246   252, 2005.

pang, bo and lee, lillian. seeing stars: exploiting class
relationships for sentiment categorization with respect to
rating scales. in proceedings of association for compu-
tational linguistics, pp. 115   124, 2005.

perronnin, florent and dance, christopher. fisher kernels
on visual vocabularies for image categorization. in ieee
conference on id161 and pattern recogni-
tion, 2007.

perronnin, florent, liu, yan, sanchez, jorge, and poirier,
herve. large-scale id162 with compressed
   sher vectors. in ieee conference on id161
and pattern recognition, 2010.

rumelhart, david e, hinton, geoffrey e, and williams,
ronald j. learning representations by back-propagating
errors. nature, 323(6088):533   536, 1986.

socher, richard, huang, eric h., pennington, jeffrey,
manning, chris d., and ng, andrew y. dynamic pool-
ing and unfolding recursive autoencoders for paraphrase
detection. in advances in neural information process-
ing systems, 2011a.

socher, richard, lin, cliff c, ng, andrew, and manning,
chris. parsing natural scenes and natural language with
id56s.
in proceedings of the 28th
international conference on machine learning (icml-
11), pp. 129   136, 2011b.

socher, richard, pennington, jeffrey, huang, eric h,
ng, andrew y, and manning, christopher d. semi-
supervised recursive autoencoders for predicting senti-
ment distributions.
in proceedings of the conference
on empirical methods in natural language processing,
2011c.

socher, richard, chen, danqi, manning, christopher d.,
and ng, andrew y. reasoning with neural tensor net-
works for knowledge base completion. in advances in
neural information processing systems, 2013a.

