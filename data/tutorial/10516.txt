compositional and non-compositional phrase embeddings

adaptive joint learning of

kazuma hashimoto and yoshimasa tsuruoka

the university of tokyo, 3-7-1 hongo, bunkyo-ku, tokyo, japan

{hassy,tsuruoka}@logos.t.u-tokyo.ac.jp

6
1
0
2

 

n
u
j
 

8

 
 
]
l
c
.
s
c
[
 
 

3
v
7
6
0
6
0

.

3
0
6
1
:
v
i
x
r
a

abstract

and

compositional

we present a novel method for jointly
learning
non-
compositional phrase
embeddings by
adaptively weighting both types of em-
beddings using a compositionality scoring
function. the scoring function is used to
quantify the level of compositionality of
each phrase, and the parameters of the
function are jointly optimized with the ob-
jective for learning phrase embeddings. in
experiments, we apply the adaptive joint
learning method to the task of learning
embeddings of transitive verb phrases,
and show that the compositionality scores
have
strong correlation with human
ratings for verb-object compositionality,
substantially outperforming the previous
state of the art. moreover, our embeddings
improve upon the previous best model
on a transitive verb disambiguation task.
we also show that a simple ensemble
technique further improves the results for
both tasks.

introduction

1
representing words and phrases in a vector space
has proven effective in a variety of language pro-
cessing tasks (pham et al., 2015; sutskever et al.,
2014). in most of the previous work, phrase em-
beddings are computed from id27s
by using various kinds of composition functions.
such composed embeddings are called composi-
tional embeddings. an alternative way of comput-
ing phrase embeddings is to treat phrases as single
units and assigning a unique embedding to each
candidate phrase (mikolov et al., 2013; yazdani
et al., 2015). such embeddings are called non-
compositional embeddings.

relying solely on non-compositional embed-
dings has the obvious problem of data sparsity (i.e.
rare or unknown phrase problems). at the same
time, however, using compositional embeddings
is not always the best option since some phrases
are inherently non-compositional. for example,
the phrase    bear fruits    means    to yield results   1
but it is hard to infer its meaning by composing
the meanings of    bear    and    fruit   . treating all
phrases as compositional also has a negative ef-
fect in learning the composition function because
the words in those idiomatic phrases are not just
uninformative but can serve as noisy samples in
the training. these problems have motivated us to
adaptively combine both types of embeddings.

most of the existing methods for learning
phrase embeddings can be divided into two ap-
proaches. one approach is to learn compositional
embeddings by regarding all phrases as composi-
tional (pham et al., 2015; socher et al., 2012). the
other approach is to learn both types of embed-
dings separately and use the better ones (kartsak-
lis et al., 2014; muraoka et al., 2014). kartsaklis
et al. (2014) show that non-compositional embed-
dings are better suited for a phrase similarity task,
whereas muraoka et al. (2014) report the opposite
results on other tasks. these results suggest that
we should not stick to either of the two types of
embeddings unconditionally and could learn better
phrase embeddings by considering the composi-
tionality levels of the individual phrases in a more
   exible fashion.

in this paper, we propose a method that jointly
learns compositional and non-compositional em-
beddings by adaptively weighting both types of
phrase embeddings using a compositionality scor-
ing function. the scoring function is used to quan-
tify the level of compositionality of each phrase

1the

de   nition

is

found

at http://idioms.

thefreedictionary.com/bear+fruit.

more complex ones such as recurrent neural net-
works (sutskever et al., 2014) are also commonly
used. the id27s and the composi-
tion function are jointly learned on a certain target
task. since compositional embeddings are built
on word-level (i.e. unigram) information, they are
less prone to the data sparseness problem.

i.e.,

2.2 non-compositional phrase embeddings
in contrast to the compositional embedding, the
non-compositional embedding of a phrase n(p)    
rd  1 is independently parameterized,
the
phrase p is treated just like a single word. mikolov
et al. (2013) show that non-compositional em-
beddings are preferable when dealing with id-
iomatic phrases. some recent studies (kartsak-
lis et al., 2014; muraoka et al., 2014) have dis-
cussed the (dis)advantages of using compositional
or non-compositional embeddings. however, in
most cases, a phrase is neither completely com-
positional nor completely non-compositional. to
the best of our knowledge, there is no method that
allows us to jointly learn both types of phrase em-
beddings by incorporating the levels of composi-
tionality of the phrases as real-valued scores.

2.3 adaptive joint learning
to simultaneously consider both compositional
and non-compositional aspects of each phrase, we
compute a phrase embedding v(p) by adaptively
weighting c(p) and n(p) as follows:

v(p) =   (p)c(p) + (1       (p))n(p),

(2)
where   (  ) is a scoring function that quanti   es
the compositionality levels, and outputs a real
value ranging from 0 to 1. what we expect from
the scoring function is that large scores indicate
high levels of compositionality.
in other words,
when   (p) is close to 1, the compositional em-
bedding is mainly considered, and vice versa. for
example, we expect   (buy car) to be large and
  (bear fruit) to be small as shown in figure 1.

we parameterize the scoring function   (p) as

id28:

  (p) =   (w      (p)),

(3)
where   (p)     rn  1 is a feature vector of the
phrase p, w     rn  1 is a weight vector, n is the
number of features, and   (  ) is the logistic func-
tion. the weight vector w is jointly optimized in
conjunction with the objective j for the target task
of learning phrase embeddings v(p).

figure 1: the overview of our method and ex-
amples of the compositionality scores. given a
phrase p, our method    rst computes the composi-
tionality score   (p) (eq. (3)), and then computes
the phrase embedding v(p) using the composi-
tional and non-compositional embeddings, c(p)
and n(p), respectively (eq. (2)).

and learned in conjunction with the target task for
learning phrase embeddings. in experiments, we
apply our method to the task of learning transitive
verb phrase embeddings and demonstrate that it
allows us to achieve state-of-the-art performance
on standard datasets for compositionality detec-
tion and verb disambiguation.

2 method
in this section, we describe our approach in the
most general form, without specifying the func-
tion to compute the compositional embeddings or
the target task for optimizing the embeddings.

figure 1 shows the overview of our proposed
method. at each iteration of the training (i.e.
gradient calculation) of a certain target task (e.g.
id38 or id31), our
method    rst computes a compositionality score for
each phrase. then the score is used to weight
the compositional and non-compositional embed-
dings of the phrase in order to compute the ex-
pected embedding of the phrase which is to be
used in the target task. some examples of the com-
positionality scores are also shown in the    gure.

2.1 compositional phrase embeddings
the compositional embedding c(p)     rd  1 of a
phrase p = (w1,       , wl) is formulated as
c(p) = f (v(w1),       , v(wl)),

(1)

where d is the dimensionality, l is the phrase
length, v(  )     rd  1 is a id27, and
f (  ) is a composition function. the function
can be simple ones such as element-wise addi-
tion or multiplication (mitchell and lapata, 2008).

updating the model parameters given the par-
   v(p)     rd  1 for the target
tial derivative   p =    j
task, we can compute the partial derivative for up-
dating w as follows:
     =   (p)(1       (p)){  p    (c(p)     n(p))} (4)
   j
(5)
   w

=       (p).

if   (p) is not constructed by static features but is
computed by a id171 model such as neu-
ral networks, we can propagate the error term     
into the id171 model by the following
equation:

   j

     (p)

=     w .

(6)

when we use only static features, as in this work,
we can simply compute the partial derivatives of j
with respect to c(p) and n(p) as follows:

   j

   c(p)
   j

   n(p)

=   (p)  p
= (1       (p))  p.

(7)

(8)

   j

as mentioned above, eq. (7) and (8) show that
the non-compositional embeddings are mainly up-
dated when   (p) is close to 0, and vice versa.
the partial derivative
   c(p) is used to update the
model parameters in the composition function via
the id26 algorithm. any differentiable
composition functions can be used in our method.
expected behavior of our method the training
of our method depends on the target task; that is,
the model parameters are updated so as to mini-
mize the cost function as described above. more
concretely,   (p) for each phrase p is adaptively ad-
justed so that the corresponding parameter updates
contribute to minimizing the cost function. as a
result, different phrases will have different   (p)
values depending on their compositionality.
if
the size of the training data were almost in   nitely
large,   (p) for all phrases would become nearly
zero, and the non-compositional embeddings n(p)
are dominantly used (since that would allow the
model to better    t the data). in reality, however,
the amount of the training data is limited, and thus
the compositional embeddings c(p) are effectively
used to overcome the data sparseness problem.

3 learning verb phrase embeddings
this section describes a particular instantiation of
our approach presented in the previous section, fo-

cusing on the task of learning the embeddings of
transitive verb phrases.

3.1 word and phrase prediction in
predicate-argument relations

acquisition of selectional preference using em-
beddings has been widely studied, where word
and/or phrase embeddings are learned based on
syntactic links (bansal et al., 2014; hashimoto and
tsuruoka, 2015; levy and goldberg, 2014; van de
cruys, 2014). as with id38, these
methods perform word (or phrase) prediction us-
ing (syntactic) contexts.

in this work, we focus on verb-object rela-
tionships and employ a phrase embedding learn-
ing method presented in hashimoto and tsuruoka
(2015). the task is a plausibility judgment task
for predicate-argument tuples. they extracted
subject-verb-object (svo) and svo-preposition-
noun (svopn) tuples using a probabilistic hpsg
parser, enju (miyao and tsujii, 2008), from the
training corpora. transitive verbs and preposi-
tions are extracted as predicates with two argu-
ments. for example, the extracted tuples include
(s, v, o) = (   importer   ,    make   ,    payment   ) and
(svo, p, n) = (   importer make payment   ,    in   ,
   currency   ). the task is to discriminate between
observed and unobserved tuples, such as the (s, v,
o) tuple mentioned above and (s, v   , o) = (   im-
porter   ,    eat   ,    payment   ), which is generated by
replacing    make    with    eat   . the (s, v   , o) tuple
is unlikely to be observed.

for each tuple (p, a1, a2) observed in the train-

ing data, a cost function is de   ned as follows:
    log   (s(p, a1, a2))    log   (   s(p(cid:48), a1, a2))
1, a2))
2)),

    log   (   s(p, a(cid:48)
    log   (   s(p, a1, a(cid:48)

(9)

1, a2), and (p, a1, a(cid:48)

where s(  ) is a plausibility scoring function, and
p, a1 and a2 are a predicate and its arguments, re-
spectively. each of the three unobserved tuples
(p(cid:48), a1, a2), (p, a(cid:48)
2) is gener-
ated by replacing one of the entries with a random
sample.
in their method, each predicate p is represented
with a matrix m (p)     rd  d and each argument
a with an embedding v(a)     rd  1. the matri-
ces and embeddings are learned by minimizing the
cost function using adagrad (duchi et al., 2011).
the scoring function is parameterized as
s(p, a1, a2) = v(a1)    (m (p)v(a2)),

(10)

and the vo and svo embeddings are computed as

v(v o) = m (v )v(o)
v(sv o) = v(s) (cid:12) v(v o),

(11)
(12)

as proposed by kartsaklis et al. (2012). the op-
erator (cid:12) denotes element-wise multiplication. in
summary, the scores are computed as
s(v, s, o) = v(s)    v(v o)

(13)

s(p, sv o, n ) = v(sv o)    (m (p )v(n )).

(14)

with this method, the word and composed phrase
embeddings are jointly learned based on co-
occurrence statistics of predicate-argument struc-
tures.
they
achieved state-of-the-art accuracy on a transi-
tive verb disambiguation task (grefenstette and
sadrzadeh, 2011).

using the learned embeddings,

3.2 applying the adaptive joint learning
in this section, we apply our adaptive joint learn-
ing method to the task described in section 3.1.
we here rede   ne the computation of v(v o) by
   rst replacing v(v o) in eq. (11) with c(v o) as,

c(v o) = m (v )v(o),

(15)

and then assigning v o to p in eq. (2) and (3):
v(v o) =   (v o)c(v o) + (1       (v o))n(v o),
(16)
(17)

  (v o) =   (w      (v o)).

the v(v o) in eq. (16) is used in eq. (12) and
(13). we assume that the candidates of the phrases
are given in advance. for the phrases not included
in the candidates, we set v(v o) = c(v o). this
is analogous to the way a human guesses the
meaning of an idiomatic phrase she does not know.
we should note that   (v o) can be computed for
phrases not included in the candidates, using par-
tial features among the features described below.
if any features do not    re,   (v o) becomes 0.5
according to the logistic function.

for the feature vector   (v o), we use the fol-

lowing simple binary and real-valued features:

    indices of v, o, and vo
    frequency and pointwise mutual information

(pmi) values of vo.

more concretely, the    rst set of the features (in-
dices of v, o, and vo) is the concatenation of
traditional one-hot vectors. the second set of
features, frequency and pmi (church and hanks,
1990) features, have proven effective in detect-
ing the compositionality of transitive verbs in mc-
carthy et al. (2007) and venkatapathy and joshi
(2005). given the training corpus, the frequency
feature for a vo pair is computed as

f req(v o) = log(count(v o)),

(18)

,

where count(v o) counts how many times the vo
pair appears in the training corpus, and the pmi
feature is computed as

count(v o)count(   )
count(v )count(o)

pmi(v o) = log

(19)
where count(v ), count(o), and count(   ) are the
counts of the verb v , the object o, and all vo
pairs in the training corpus, respectively. we nor-
malize the frequency and pmi features so that their
maximum absolute value becomes 1.
4 experimental settings
4.1 training data
as the training data, we used two datasets, one
small and one large: the british national corpus
(bnc) (leech, 1992) and the english wikipedia.
more concretely, we used the publicly available
data2 preprocessed by hashimoto and tsuruoka
(2015). the bnc data consists of 1.38 million
svo tuples and 0.93 million svopn tuples. the
wikipedia data consists of 23.6 million svo tu-
ples and 17.3 million svopn tuples. follow-
ing the provided code3, we used exactly the same
train/development/test split (0.8/0.1/0.1) for train-
ing the overall model. as the third training data,
we also used the concatenation of the two data,
which is hereafter referred to as bnc-wikipedia.
we applied our adaptive joint learning method
to verb-object phrases observed more than k
times in each corpus.
to 10
for the bnc data and 100 for the wikipedia
and bnc-wikipedia data.
the
non-compositional embeddings were assigned to
17,817, 28,933, and 30,682 verb-object phrase
types in the bnc, wikipedia, and bnc-wikipedia
data, respectively.

consequently,

k was set

2http://www.logos.t.u-tokyo.ac.jp/

  hassy/publications/cvsc2015/
3https://github.com/hassygo/

svoembedding

4.2 training details
the model parameters consist of d-dimensional
id27s for nouns, non-compositional
phrase embeddings, d  d-dimensional matrices
for verbs and prepositions, and a weight vector
w for   (v o). all the model parameters are
jointly optimized. we initialized the embeddings
and matrices with zero-mean gaussian random val-
ues with a variance of 1
d2 , respectively, and
w with zeros. initializing w with zeros forces
the initial value of each   (v o) to be 0.5 since we
use the logistic function to compute   (v o).

d and 1

the optimization was performed via mini-
batch adagrad (duchi et al., 2011). we
   xed d to 25 and the mini-batch size to
100. we set candidate values for the learn-
ing rate    to {0.01, 0.02, 0.03, 0.04, 0.05}. for
the weight vector w , we
employed l2-
norm id173 and set
the coef   cient   
to {10   3, 10   4, 10   5, 10   6, 0}.
for selecting
the hyperparameters, each training process was
stopped when the evaluation score on the devel-
opment split decreased. then the best perform-
ing hyperparameters were selected for each train-
ing dataset. consequently,    was set to 0.05 for
all training datasets, and    was set to 10   6, 10   3,
and 10   5 for the bnc, wikipedia, and bnc-
wikipedia data, respectively. once the training is
   nished, we can use the learned embeddings and
the scoring function in downstream target tasks.

5 evaluation on the compositionality

detection function
5.1 evaluation settings
datasets first, we evaluated the learned com-
positionality detection function on two datasets,
vj   054 and mc   075, provided by venkatapathy
and joshi (2005) and mccarthy et al. (2007),
respectively. vj   05 consists of 765 verb-object
pairs with human ratings for the compositional-
ity. mc   07 is a subset of vj   05 and consists of
638 verb-object pairs. for example, the rating of
   buy car    is 6, which is the highest score, indicat-
ing the phrase is highly compositional. the rating
of    bear fruit     is 1, which is the lowest score, in-
dicating the phrase is highly non-compositional.

4http://www.dianamccarthy.co.uk/
downloads/svaj2005compositionality_
rating.txt

5http://www.dianamccarthy.co.uk/

downloads/emnlp2007data.txt

method
proposed method (wikipedia)
proposed method (bnc)
proposed method (bnc-wikipedia)
proposed method (ensemble)
kiela and clark (2013) w/ id138
kiela and clark (2013)
dsproto (mccarthy et al., 2007)
pmi (mccarthy et al., 2007)
frequency (mccarthy et al., 2007)
dsproto+ (mccarthy et al., 2007)
human agreement

mc   07 vj   05
0.508
0.514
0.507
0.507
0.527
0.518
0.552
0.550
0.461
n/a
n/a
0.420
n/a
0.398
n/a
0.274
n/a
0.141
0.454
n/a
0.716
0.702

table 1: compositionality detection task.

evaluation metric the evaluation was per-
formed by calculating spearman   s rank correlation
scores6 between the averaged human ratings and
the learned compositionality scores   (v o).

ensemble technique we also produced the re-
sult by employing an ensemble technique. more
concretely, we used the averaged compositionality
scores from the results of the bnc and wikipedia
data for the ensemble result.

5.2 results and discussion
5.2.1 result overview
table 1 shows our results and the state of the art.
our method outperforms the previous state of the
art in all settings. the result denoted as ensem-
ble is the one that employs the ensemble tech-
nique, and achieves the strongest correlation with
the human-annotated datasets. even without the
ensemble technique, our method performs better
than all of the previous methods.

kiela and clark (2013) used window-based co-
occurrence vectors and improved their score us-
ing id138 hypernyms. by contrast, our method
does not rely on such external resources, and only
needs parsed corpora. we should note that kiela
and clark (2013) reported that their score did not
improve when using parsed corpora. our method
also outperforms dsproto+, which used a small
amount of the labeled data, while our method is
fully unsupervised.

we calculated con   dence intervals (p < 0.05)
using bootstrap resampling (noreen, 1989). for
example, for the results using the bnc-wikipedia
data, the intervals on mc   07 and vj   05 are (0.455,
0.574) and (0.475, 0.579), respectively. these re-
sults show that our method signi   cantly outper-
forms the previous state-of-the-art results.

6we used the scipy 0.12.0 implementation in python.

phrase

gold standard

(a) bnc (b) wikipedia bnc-wikipedia

ensemble ((a)+(b))  0.5

(a)

buy car
own land
take toll
shed light
bear fruit
(b) make noise
have reason
smoke cigarette
catch eye

(c)

6
6
1.5
1
1
6
5
6
1

0.78
0.79
0.14
0.21
0.15
0.37
0.26
0.56
0.48

0.71
0.73
0.11
0.07
0.19
0.33
0.39
0.90
0.14

0.80
0.76
0.06
0.07
0.17
0.30
0.33
0.78
0.17

table 2: examples of the compositionality scores.

0.74
0.76
0.13
0.14
0.17
0.35
0.33
0.73
0.31

highest average scores
approve
reject
discuss
visit
want
describe
involve
own
attend
re   ect

0.83
0.72
0.71
0.70
0.70
0.70
0.69
0.68
0.68
0.67

lowest average scores
bear
play
have
make
break
take
raise
reach
gain
draw

0.37
0.38
0.38
0.39
0.40
0.40
0.41
0.41
0.42
0.42

table 3: the 10 highest and lowest average com-
positionality scores with the corresponding verbs
on the bnc data.

method can recognize that the light verbs are
frequently used to form idiomatic (i.e.
non-
compositional) phrases. to verify the assumption,
we calculated the average compositionality score
for each verb by averaging the compositionality
scores paired with its candidate objects. here we
used 135 verbs which take more than 30 types of
objects in the bnc data. table 3 shows the 10
highest and lowest average scores with the corre-
sponding verbs. we see that relatively low scores
are assigned to the light verbs as well as other
verbs which often form idiomatic phrases. as
shown in the group (b) in table 2, however, light
verb phrases are not always non-compositional.
despite this,
the learned function assigns low
scores to compositional phrases formed by the
light verbs.
that using
a more    exible scoring function may further
strengthen our method.

these results suggest

context dependence both our method and the
two datasets, vj   05 and mc   07, assume that the
compositionality score can be computed for each
phrase with no contextual information. however,
in general, the compositionality level of a phrase
depends on its contextual information. for ex-
ample, the meaning of the idiomatic phrase    bear

figure 2: trends of   (v o) during the training on
the bnc data.

5.2.2 analysis of compositionality scores
figure 2 shows how   (v o) changes for the seven
phrases during the training on the bnc data. as
shown in the    gure, starting from 0.5,   (v o) for
each phrase converges to its corresponding value.
the differences in the trends indicate that our
method can adaptively learn compositionality lev-
els for the phrases. table 2 shows the learned com-
positionality scores for the three groups of the ex-
amples along with the gold-standard scores given
by the annotators. the group (a) is considered
to be consistent with the gold-standard scores, the
group (b) is not, and the group (c) shows exam-
ples for which the difference between the compo-
sitionality scores of our results is large.
characteristics of
light verbs the verbs
   take   ,    make   , and    have    are known as light
verbs 7, and the scoring function tends to assign
low scores to light verbs.
in other words, our

7in section 5.2.2 in newton (2006), the term light verb is
used to refer to verbs which can be used in combination with
some other element where their contribution to the meaning
of the whole construction is reduced in some way.

fruit    can be compositionaly interpreted as    to
yield fruit    for a plant or tree. we manually in-
spected the bnc data to check whether the phrase
   bear fruit    is used as the compositional mean-
ing or the idiomatic meaning (   to yield results   ).
as a result, we have found that most of the usage
was its idiomatic meaning. in the model training,
our method is affected by the majority usage and
   ts the evaluation datasets where the phrase    bear
fruit    is regarded as highly non-compositional. in-
corporating contextual information into the com-
positionality scoring function is a promising direc-
tion of future work.

5.2.3 effects of ensemble

we used the two different corpora for construct-
ing the training data, and our method achieves the
state-of-the-art results in all settings. to inspect
the results on vj   05, we calculated the correlation
score between the outputs from our results of the
bnc and wikipedia data. the correlation score is
0.674 and that is, the two different corpora lead to
reasonably consistent results, which indicates the
robustness of our method. however, the correla-
tion score is still much lower than perfect correla-
tion; in other words, there are disagreements be-
tween the outputs learned with the corpora. the
group (c) in table 2 shows such two examples. in
these cases, the ensemble technique is helpful in
improving the results as shown in the examples.

another interesting observation in our results is
that the result of the ensemble technique outper-
forms that of the bnc-wikipedia data as shown in
table 1. this shows that separately using the train-
ing corpora of different nature and then perform-
ing the ensemble technique can yield better re-
sults. by contrast, many of the previous studies on
embedding-based methods combine different cor-
pora into a single dataset, or use multiple corpora
just separately and compare them (hashimoto and
tsuruoka, 2015; muraoka et al., 2014; penning-
ton et al., 2014). it would be worth investigating
whether the results in the previous work can be
improved by ensemble techniques.

6 evaluation on the phrase embeddings

6.1 evaluation settings

gs   118 provided by grefenstette and sadrzadeh
(2011). gs   11 consists of 200 pairs of transitive
verbs and each verb pair takes the same subject
and object. for example, the transitive verb    run   
is known as a polysemous word and this task re-
quires one to identify the meanings of    run    and
   operate    as similar to each other when taking
   people    as their subject and    company    as their
object. in the same setting, however, the meanings
of    run    and    move    are not similar to each other.
each pair has multiple human ratings indicating
how similar the phrases of the pair are.

evaluation metric the evaluation was per-
formed by calculating spearman   s rank correla-
tion scores between the human ratings and the
cosine similarity scores of v(sv o) in eq. (12).
following the previous studies, we used the gold-
standard ratings in two ways: averaging the human
ratings for each svo tuple (gs   11a) and treating
each human rating separately (gs   11b).

ensemble technique we used the same ensem-
ble technique described in section 5.1. in this task
we produced two ensemble results: ensemble a
and ensemble b. the former used the averaged
cosine similarity from the results of the bnc and
wikipedia data, and the latter further incorporated
the result of the bnc-wikipedia data.

baselines we compared our adaptive joint learn-
ing method with two baseline methods. one is the
method in hashimoto and tsuruoka (2015) and it
is equivalent to    xing   (v o) to 1 in our method.
the other is    xing   (v o) to 0.5 in our method,
which serves as a baseline to evaluate how effec-
tive the proposed adaptive weighting method is.

6.2 results and discussion
6.2.1 result overview
table 4 shows our results and the state of the art,
and our method outperforms almost all of the pre-
vious methods in both datasets. again, the en-
semble technique further improves the results, and
overall, ensemble b yields the best results.

the scores in hashimoto and tsuruoka (2015),
the baseline results with   (v o) = 1 in our
method, have been the best to date. as shown
in table 4, our method outperforms the base-
line results with   (v o) = 0.5 as well as those

dataset next, we evaluated the learned embed-
dings on the transitive verb disambiguation dataset

8http://www.cs.ox.ac.uk/activities/

compdistmeaning/gs2011data.txt

proposed method

take toll

  (take toll) = 0.11

catch eye

  (catch eye) = 0.14

bear fruit

  (bear fruit) = 0.19

make noise

  (make noise) = 0.33

buy car

  (buy car) = 0.71

put strain
place strain
cause strain
have affect
exacerbate injury
catch attention
grab attention
make impression
lift spirit
become favorite
accentuate effect
enhance beauty
enhance atmosphere
rejuvenate earth
enhance habitat
attack intruder
attack trespasser
avoid predator
attack diver
attack pedestrian
buy bike
buy machine
buy motorcycle
buy automobile
purchase coins

  (v o) = 1

deplete division
necessitate monitoring
deplete pool
create pollution
deplete    eld
catch ear
catch heart
catch e-mail
catch imagination
catch attention
bear herb
bear grain
bear spore
bear variety
bear seed
make sound
do beating
get bounce
get pulse
lose bit
buy truck
buy bike
buy automobile
buy motorcycle
buy vehicle

  (v o) = 0.5

put strain
cause lack
befall army
exacerbate weakness
cause strain
grab attention
make impression
catch attention
become legend
inspire playing
increase richness
reduce biodiversity
fuel boom
enhance atmosphere
worsen violence
burn can
kill monster
wash machine
lightn    ash
cook raman
buy bike
buy instrument
buy chip
buy scooter
buy motorcycle

table 5: examples of the closest neighbors in the learned embedding space. all of the results were
obtained by using the wikipedia data, and the values of   (v o) are the same as those in table 2.

method
proposed method (wikipedia)
proposed method (bnc)
proposed method (bnc-wikipedia)
proposed method (ensemble a)
proposed method (ensemble b)
  (v o) = 0.5 (wikipedia)
  (v o) = 0.5 (bnc)
  (v o) = 0.5 (bnc-wikipedia)
  (v o) = 0.5 (ensemble a)
  (v o) = 0.5 (ensemble b)
  (v o) = 1 (wikipedia)
  (v o) = 1 (bnc)
milajevs et al. (2014)
polajnar et al. (2014)
hashimoto et al. (2014)
polajnar et al. (2015)
grefenstette and sadrzadeh (2011)
human agreement

gs   11a gs   11b
0.461
0.598
0.463
0.595
0.483
0.623
0.661
0.511
0.524
0.680
0.386
0.491
0.462
0.599
0.477
0.610
0.612
0.474
0.495
0.638
n/a
0.576
n/a
0.574
n/a
0.456
n/a
0.370
0.340
0.420
0.330
n/a
0.210
n/a
0.750
0.620

table 4: transitive verb disambiguation task. the
results for   (v o) = 1 are reported in hashimoto
and tsuruoka (2015).

with   (v o) = 1. we see that our method im-
proves the baseline scores by adaptively combin-
ing compositional and non-compositional embed-
dings. along with the results in table 1, these re-
sults show that our method allows us to improve
the composition function by jointly learning non-
compositional embeddings and the scoring func-

tion for compositionality detection.

6.2.2 analysis of the learned embeddings
we inspected the effects of adaptively weighting
the compositional and non-compositional embed-
dings. table 5 shows the    ve closest neighbor
phrases in terms of the cosine similarity for the
three idiomatic phrases    take toll   ,    catch eye   ,
and    bear fruit    as well as the two non-idiomatic
phrases    make noise    and    buy car   . the exam-
ples trained with the wikipedia data are shown for
our method and the two baselines, i.e.,   (v o) =
1 and   (v o) = 0.5. as shown in table 2, the
compositionality levels of the    rst three phrases
are low and their non-compositional embeddings
are dominantly used to represent their meaning.

one observation with   (v o) = 1 is that head
words (i.e. verbs) are emphasized in the shown
examples except    take toll    and    make noise   . as
with other embedding-based methods, the compo-
sitional embeddings are highly affected by their
component words. as a result, the phrases consist-
ing of the same verb and the similar objects are of-
ten listed as the closest neighbors. by contrast, our
method    exibly allows us to adaptively omit the
information about the component words. there-
fore, our method puts more weight on capturing
the idiomatic aspects of the example phrases by

adaptively using the non-compositional embed-
dings.

the results of   (v o) = 0.5 are similar to those
with our proposed method, but we can see some
differences. for example, the phrase list for    make
noise    of our proposed method captures offensive
meanings, whereas that of   (v o) = 0.5 is some-
what ambiguous. as another example, the phrase
lists for    buy car    show that our method better cap-
tures the semantic similarity between the objects
than   (v o) = 0.5. this is achieved by adaptively
assigning a relatively large compositionality score
(0.71) to the phrase to use the information about
the object    car   .

we

that

should note

   make noise   

is
highly compositional but our method outputs
  (make noise) = 0.33, and the phrase list of
  (v o) = 1 is the most appropriate in this
case.
improving the compositionality detection
function should thus further improve the learned
embeddings.

7 related work

learning embeddings of words and phrases has
been widely studied, and the phrase embeddings
have proven effective in many language process-
ing tasks, such as machine translation (cho et al.,
2014; sutskever et al., 2014), id31
and semantic textual similarity (tai et al., 2015).
most of the phrase embeddings are constructed
by word-level information via various kinds of
composition functions like long short-term mem-
ory (hochreiter and schmidhuber, 1997) recur-
rent neural networks. such composition functions
should be powerful enough to ef   ciently encode
information about all the words into the phrase
embeddings. by simultaneously considering the
compositionality of the phrases, our method would
be helpful in saving the composition models from
having to be powerful enough to perfectly encode
the non-compositional phrases. as a    rst step to-
wards this purpose, in this paper we have shown
the effectiveness of our method on the task of
learning verb phrase embeddings.

many studies have focused on detecting the
compositionality of a variety of phrases (lin,
1999), including the ones on verb phrases (diab
and bhutada, 2009; mccarthy et al., 2003) and
compound nouns (farahmand et al., 2015; reddy
et al., 2011). compared to statistical feature-based
methods (mccarthy et al., 2007; venkatapathy

and joshi, 2005), recent methods use word and
phrase embeddings (kiela and clark, 2013; yaz-
dani et al., 2015). the embedding-based meth-
ods assume that id27s are given in
advance and as a post-processing step, learn or
simply employ composition functions to com-
pute phrase embeddings.
in other words, there
is no distinction between compositional and non-
compositional phrases. yazdani et al. (2015) fur-
ther proposed to incorporate latent annotations
(binary labels) for the compositionality of the
phrases. however, binary judgments cannot con-
sider numerical scores of the compositionality. by
contrast, our method adaptively weights the com-
positional and non-compositional embeddings us-
ing the compositionality scoring function.

8 conclusion and future work

we have presented a method for adaptively learn-
ing compositional and non-compositional phrase
embeddings by jointly detecting compositionality
levels of phrases. our method achieves the state
of the art on a compositionality detection task of
verb-object pairs, and also improves upon the pre-
vious state-of-the-art method on a transitive verb
disambiguation task. in future work, we will ap-
ply our method to other kinds of phrases and tasks.

acknowledgments

we thank the anonymous reviewers for their help-
ful comments and suggestions. this work was
supported by crest, jst.

references
mohit bansal, kevin gimpel, and karen livescu.
2014. tailoring continuous word representations
for id33. in proceedings of the 52nd
annual meeting of the association for computa-
tional linguistics (volume 2: short papers), pages
809   815.

kyunghyun cho, bart van merrienboer, caglar gul-
cehre, dzmitry bahdanau, fethi bougares, hol-
ger schwenk, and yoshua bengio. 2014. learn-
ing phrase representations using id56 encoder   
decoder for id151. in pro-
ceedings of the 2014 conference on empirical meth-
ods in natural language processing (emnlp),
pages 1724   1734.

kenneth church and patrick hanks. 1990. word as-
sociation norms, mutual information and lexicog-
raphy. computational linguistics, 19(2):263   312.

mona diab and pravin bhutada. 2009. verb noun
in pro-
construction mwe token classi   cation.
ceedings of the workshop on multiword expres-
sions:
identi   cation, interpretation, disambigua-
tion and applications, pages 17   22.

john duchi, elad hazan, and yoram singer. 2011.
adaptive subgradient methods for online learning
and stochastic optimization. journal of machine
learning research, 12:2121   2159.

meghdad farahmand, aaron smith, and joakim nivre.
2015. a multiword expression data set: annotat-
ing non-compositionality and conventionalization
in proceedings of
for english noun compounds.
the 11th workshop on multiword expressions, pages
29   33.

edward grefenstette and mehrnoosh sadrzadeh. 2011.
experimental support for a categorical composi-
in pro-
tional distributional model of meaning.
ceedings of the 2011 conference on empirical meth-
ods in natural language processing, pages 1394   
1404.

kazuma hashimoto and yoshimasa tsuruoka. 2015.
learning embeddings for transitive verb disam-
biguation by implicit tensor factorization. in pro-
ceedings of the 3rd workshop on continuous vector
space models and their compositionality, pages 1   
11.

kazuma hashimoto, pontus stenetorp, makoto miwa,
and yoshimasa tsuruoka. 2014. jointly learning
word representations and composition functions
using predicate-argument structures. in proceed-
ings of the 2014 conference on empirical methods
in natural language processing (emnlp), pages
1544   1555.

sepp hochreiter and j  urgen schmidhuber.

1997.
long short-term memory. neural computation,
9(8):1735   1780.

dimitri kartsaklis, mehrnoosh sadrzadeh, and stephen
pulman.
2012. a uni   ed sentence space for
categorical distributional-compositional seman-
in proceedings of
tics: theory and experiments.
the 24th international conference on computational
linguistics, pages 549   558.

dimitri kartsaklis, nal kalchbrenner, and mehrnoosh
sadrzadeh. 2014. resolving lexical ambiguity in
tensor regression models of meaning. in proceed-
ings of the 52nd annual meeting of the association
for computational linguistics (volume 2: short pa-
pers), pages 212   217.

geoffrey leech. 1992. 100 million words of english:
the british national corpus. language research,
28(1):1   13.

omer levy and yoav goldberg. 2014. dependency-
in proceedings of the
based id27s.
52nd annual meeting of the association for compu-
tational linguistics (volume 2: short papers), pages
302   308.

dekang lin. 1999. automatic identi   cation of non-
compositional phrases. in proceedings of the 37th
annual meeting of the association for computa-
tional linguistics, pages 317   324.

diana mccarthy, bill keller, and john carroll. 2003.
detecting a continuum of compositionality in
in proceedings of the acl 2003
phrasal verbs.
workshop on multiword expressions: analysis, ac-
quisition and treatment, pages 73   80.

diana mccarthy, sriram venkatapathy, and aravind
joshi. 2007. detecting compositionality of verb-
object combinations using selectional preferences.
in proceedings of the 2007 joint conference on
empirical methods in natural language process-
ing and computational natural language learning,
pages 369   379.

tomas mikolov, ilya sutskever, kai chen, greg s cor-
rado, and jeff dean. 2013. distributed representa-
tions of words and phrases and their composition-
ality. in advances in neural information processing
systems 26, pages 3111   3119.

dmitrijs milajevs, dimitri kartsaklis, mehrnoosh
sadrzadeh, and matthew purver. 2014. evaluating
neural word representations in tensor-based com-
positional settings. in proceedings of the 2014 con-
ference on empirical methods in natural language
processing, pages 708   719.

jeff mitchell and mirella lapata. 2008. vector-based
in proceedings
models of semantic composition.
of 46th annual meeting of the association for com-
putational linguistics: human language technolo-
gies, pages 236   244.

yusuke miyao and jun   ichi tsujii. 2008. feature for-
est models for probabilistic hpsg parsing. compu-
tational linguistics, 34(1):35   80, march.

masayasu muraoka, sonse shimaoka, kazeto ya-
mamoto, yotaro watanabe, naoaki okazaki, and
finding the best model
kentaro inui.
among representative compositional models.
in
proceedings of the 28th paci   c asia conference
on language, information, and computation, pages
65   74.

2014.

douwe kiela and stephen clark. 2013. detecting
compositionality of multi-word expressions using
nearest neighbours in vector space models.
in
proceedings of the 2013 conference on empirical
methods in natural language processing, pages
1427   1432.

mark newton. 2006. basic english syntax with exer-

cises. b  olcs  esz konzorcium.

eric w. noreen. 1989. computer-intensive methods
for testing hypotheses: an introduction. wiley-
interscience.

(v-n) collocations by integrating features. in pro-
ceedings of human language technology confer-
ence and conference on empirical methods in nat-
ural language processing, pages 899   906.

majid yazdani, meghdad farahmand, and james hen-
derson. 2015. learning semantic composition to
detect non-compositionality of multiword expres-
in proceedings of the 2015 conference on
sions.
empirical methods in natural language process-
ing, pages 1733   1742.

jeffrey pennington, richard socher, and christopher
manning. 2014. glove: global vectors for word
in proceedings of the 2014 con-
representation.
ference on empirical methods in natural language
processing (emnlp), pages 1532   1543.

nghia the pham, germ  an kruszewski, angeliki
lazaridou, and marco baroni. 2015. jointly opti-
mizing word representations for lexical and senten-
tial tasks with the c-phrase model. in proceed-
ings of the 53rd annual meeting of the association
for computational linguistics and the 7th interna-
tional joint conference on natural language pro-
cessing (volume 1: long papers), pages 971   981.

tamara polajnar, laura rimell, and stephen clark.
2014. using sentence plausibility to learn the
in proceedings of
semantics of transitive verbs.
workshop on learning semantics at the 2014 con-
ference on neural information processing systems.

tamara polajnar, laura rimell, and stephen clark.
2015. an exploration of discourse-based sentence
spaces for compositional id65.
in proceedings of the first workshop on linking
computational models of lexical, sentential and
discourse-level semantics, pages 1   11.

siva reddy, diana mccarthy, and suresh manandhar.
2011. an empirical study on compositionality in
compound nouns. in proceedings of 5th interna-
tional joint conference on natural language pro-
cessing, pages 210   218.

richard socher, brody huval, christopher d. man-
ning, and andrew y. ng. 2012. semantic compo-
sitionality through recursive matrix-vector spaces.
in proceedings of the 2012 joint conference on
empirical methods in natural language process-
ing and computational natural language learning,
pages 1201   1211.

ilya sutskever, oriol vinyals, and quoc v le. 2014.
sequence to sequence learning with neural net-
works. in advances in neural information process-
ing systems 27, pages 3104   3112.

kai sheng tai, richard socher, and christopher d.
manning. 2015.
improved semantic representa-
tions from tree-structured long short-term mem-
in proceedings of the 53rd annual
ory networks.
meeting of the association for computational lin-
guistics and the 7th international joint conference
on natural language processing (volume 1: long
papers), pages 1556   1566.

tim van de cruys. 2014. a neural network approach
to selectional preference acquisition. in proceed-
ings of the 2014 conference on empirical methods
in natural language processing (emnlp), pages
26   35.

sriram venkatapathy and aravind joshi. 2005. mea-
suring the relative compositionality of verb-noun

