a machine reading approach using memory network

dialog state tracking,

julien perez

xerox research centre europe

grenoble, france

fei liu    

the university of melbourne

victoria, australia

7
1
0
2

 
r
a

m
2

 

 
 
]
l
c
.
s
c
[
 
 

5
v
2
5
0
4
0

.

6
0
6
1
:
v
i
x
r
a

julien.perez@xrce.xerox.com

fliu3@student.unimelb.edu.au

abstract

in an end-to-end dialog system, the aim
of dialog state tracking is to accurately
estimate a compact representation of the
current dialog status from a sequence of
noisy observations produced by the speech
recognition and the natural language un-
derstanding modules. this paper intro-
duces a novel method of dialog state track-
ing based on the general paradigm of
machine reading and proposes to solve
it using an end-to-end memory net-
work, memn2n, a memory-enhanced neu-
ral network architecture. we evaluate the
proposed approach on the second dia-
log state tracking challenge (dstc-2)
dataset. the corpus has been converted
for the occasion in order to frame the hid-
den state variable id136 as a question-
answering task based on a sequence of ut-
terances extracted from a dialog. we show
that the proposed tracker gives encourag-
ing results. then, we propose to extend
the dstc-2 dataset and the de   nition of
this dialog state task with speci   c reason-
ing capabilities like counting, list mainte-
nance, yes-no id53 and in-
de   nite knowledge management. finally,
we present encouraging results using our
proposed memn2n based tracking model.
introduction

1
one of the core components of state-of-the-art and
industrially deployed id71 is a dialog
state tracker. its purpose is to provide a compact
representation of a dialog produced from past user
inputs and system outputs which is called the di-
alog state. the dialog state summarizes the infor-

   work carried out as an intern at xrce

mation needed to successfully maintain and    nish
a dialog, such as users    goals or requests. in the
simplest case of a so-called slot-   lling schema, the
state is composed of a prede   ned set of variables
with a prede   ned domain of expression for each
of them. as a matter of fact, in the recent con-
text of end-to-end trainable machine learnt dialog
systems, state tracking remains a central element
of such architectures (wen et al., 2016). current
models, mainly based on the principle of discrim-
inative learning, tend to share three common lim-
itations. first, the tracking task is perform using
a    xed window of the past dialog utterances as
support for decision. second, the possible correla-
tions between the set of tracked variables are not
leveraged and individual trackers tend to be learnt
independently. third, the tracking task is sum-
marized as the capability of infering values for a
prede   ned set of latent variables. starting from
these observations, we propose to formalize the
task of state tracking as a particular instance of
machine reading problem. indeed, these formal-
ization and the proposed resolution model called
memn2n (weston et al., 2015) allow to de   ne a
tracker that is be able to decide at the utterance
level on the basis on the current entire dialog. in-
deed, the model learns to focus its attention on the
meaningful parts of the dialog regarding the cur-
rently asked slot and can eventually capture possi-
ble correlation between slots. as far as our knowl-
edge goes, it is the    rst attempt to explicitly frame
the task of dialog state tracking as a machine read-
ing problem. finally, such formalization allows
for the implementation of approximate reasoning
capability that has been shown to be crucial for
any machine reading tasks (weston et al., 2015)
while extending the task from slot instantiation
to id53. this paper is structured
as follows, section 2 recalls the main de   nitions
associated to transactional dialogs and describes

the associated problem of statistical dialog state
tracking with both the generative and discrimina-
tive approaches. at the end of this section, the
limitations of the current models in terms of nec-
essary annotations and reasoning capabilities are
addressed. then, section 3 depicts the proposed
machine reading model for dialog state tracking
and proposes to extend a state of the art dialog
state tracking dataset, dstc-2, to several simple
reasoning capabilities. section 4 illustrates the ap-
proach with experimental results obtained using a
state of the art benchmark for dialog state track-
ing.

2 dialog state tracking
2.1 main de   nitions
a dialog state tracking task is formalized as fol-
lows: at each turn of a dyadic dialog, the dialog
agent chooses a dialog act d to express and the
user answers with an utterance u. in the simplest
case, the dialog state at each turn is de   ned as
a distribution over a set of prede   ned variables,
which de   ne the structure of the state (williams
et al., 2005). this classic state structure is com-
monly called slot    lling or semantic frame.
in
this context, the state tracking task consists of
estimating the value of a set of prede   ned vari-
ables in order to perform a procedure or trans-
action which is the purpose of the dialog. typ-
ically, a natural language understanding module
processes the user utterance and generates an n-
best list o = {(d1, f1), . . . , (dn, fn)}, where di is the
hypothesized user dialog act and fi is its con   -
dence score. various approaches have been pro-
posed to de   ne dialog state trackers. the tradi-
tional methods used in most commercial imple-
mentations use hand-crafted rules that typically
rely on the most likely result from an nlu module
(yeh et al., 2014) and hardly models uncertainty.
however, these rule-based systems are prone to
frequent errors as the most likely result is not al-
ways the correct one (williams, 2014).

more recent methods employ statistical ap-
proaches to estimate the posterior distribution over
the dialog states allowing them to leverage the un-
certainty of the results of the nlu module.
in
the simplest case where no asr and nlu mod-
ules are employed, as in a text based dialog system
(henderson et al., 2013), the utterance is taken as
the observation using a so-called bag of words rep-
resentation. if an nlu module is available, stan-

dardized dialog act schemas can be considered as
observations (bunt et al., 2010). furthermore, if
prosodic information is available from the asr
component of the dialog system (milone and ru-
bio, 2003), it can also be considered as part of the
observation de   nition. a statistical dialog state
tracker maintains, at each discrete time step t, the
id203 distribution over states, b(st), which
is the system   s belief over the state. the actual
slot    lling process is composed of the cyclic tasks
of information gathering and integration, in other
words     dialog state tracking. in such framework,
the purpose is to estimate as early as possible in
the course of a given dialog the correct instantia-
tion of each variable. in the following, we will as-
sume the state is represented as a set of variables
with a set of known possible values associated to
each of them. furthermore, in the context of this
paper, only the bag of words has been considered
as an observation at a given turn but dialog acts or
detected named entity provided by an slu mod-
ule could have also been incorporated.

two statistical approaches have been consid-
ered for maintaining the distribution over a state
given sequential nlu output. first, the discrimi-
native approach aims to model the posterior prob-
ability distribution of the state at time t + 1 with
regard to state at time t and observations z1:t. sec-
ond, the generative approach attempts to model the
transition id203 and the observation proba-
bility in order to exploit possible interdependen-
cies between hidden variables that comprise the
dialog state.

2.2 generative dialog state tracking

a generative approach to dialog state tracking
computes the belief over the state using bayes   
rule, using the belief from the last turn b(st   1)
as a prior and the likelihood given the user ut-
terance hypotheses p(zt|st), with zt the observa-
tion gathered at time t. in prior works (williams
et al., 2005),
the likelihood is factored and
some independence assumptions are made: bt    
   st   1,zt p(st|zt,st   1)p(zt|st   1)b(st   1). a typical
generative model uses a factorial hidden markov
model (ghahramani and jordan, 1997).
in this
family of approaches, scalability is considered as
one of the main issues. one way to reduce the
amount of computation is to group the states into
partitions, as proposed in the hidden information
state (his) model (gasic and young, 2011). other

approaches to cope with the scalability problem in
dialog state tracking is to adopt a factored dynamic
id110 by making conditional inde-
pendence assumptions among dialog state compo-
nents, and then using approximate id136 algo-
rithms such as loopy belief propagation (thom-
son and young, 2010) or a blocked gibbs sam-
pling as (raux and ma, 2011). to cope with such
limitations, discriminative methods of state track-
ing presented in the next part of this section aim
at directly model the posterior distribution of the
tracked state using a choosen parametric form.

t ,dm

1 ,s1, . . . ,du

2.3 discriminative dialog state tracking
the discriminative approach of dialog state track-
ing computes the belief over a state via a para-
metric model that directly represents the belief
b(st+1) = p(ss+1|st,zt). for example, maximum
id178 has been widely used in the discrimina-
tive approach (metallinou et al., 2013).
it for-
mulates the belief as follows: b(s) = p(s|x) =
  .ewt    (x,s), where    is the normalizing constant,
x = (du
1,dm
t ,st) is the history of user
i ,i     {1, . . . ,t}, the system dialog
dialog acts, du
i ,i     {1, . . . ,t}, and the sequence of states
acts, dm
leading to the current dialog turn at time t. then,
   (.) is a vector of feature functions on x and s.
finally, w is the set of model parameters to be
learned from annotated dialog data. finally, deep
neural models, performing on a sliding window of
features extracted from previous user turns, have
also been proposed in (henderson et al., 2014c;
mrksic et al., 2016). of the current litterature,
this family of approaches have proven to be the
most ef   cient for publicly available state tracking
datasets. recently, deep learning based models
implementing this strategy (mrksic et al., 2016;
henderson et al., 2014a; williams et al., 2016)
have shown state of the art results. this ap-
proaches tends to leverage unsupervised training
word representation (mikolov et al., 2013).

2.4 current limitations
using error analysis (henderson et al., 2014b),
three limitations can be observed in the application
of these id136 approaches. first, current mod-
els tend to fail at considering long-tail dependen-
cies that occurs on dialogs. for example, coref-
erences, inter-utterances informations and correla-
tions between slots have been shown to be dif   cult
to handle even with the usage of recurrent network
models (henderson et al., 2014a). to illustrate the

figure 1: id167 transformation of the    nal state
of dstc-2 train set.

inter-slot correlation, figure 1 depicted the id167
(van der maaten and hinton, 2008) projected    -
nal state of the dialog of the dstc-2 training set.
on the other hand, reasoning capabilities, as re-
quired in machine reading applications (poon and
domingos, 2010; etzioni et al., 2007; berant et
al., 2014; weston et al., 2015) remain absent in
these classic formalizations of dialog state track-
ing. finally, tracking de   nition is limited to the
capability to instantiate a prede   ned set of slots.
in the next section, we present a model of dialog
state tracking that aims at leveraging the current
advances of memn2n, a memory-enhanced neural
networks and their approximate reasoning capabil-
ities that seems particularly adapted to the sequen-
tial, long range dependency equipped and sparse
nature of complex dialog state tracking tasks. fur-
thermore, this model allows to relax the hypothe-
sis of strict utterance-level annotation that does not
corresponds to common pratices in industrial ap-
plications of transactional conversational user in-
terfaces where annotations tend to be placed at a
multi-utterance level or full-dialog level only.

3 machine reading formulation of

dialog state tracking

we propose to formalize the dialog state tracking
task as a machine reading problem (etzioni et al.,
2007; berant et al., 2014). in this section, we re-
call the main de   nitions of the task of machine
reading, then describes the memn2n, a memory-
enhanced neural network architectures proposed
to handle such tasks in the context of dialogs. fi-
nally, we formalize the task of dialog state track-
ing as a machine reading problem and propose to

solve it using a memory-enhanced neural architec-
ture of id136.

3.1 machine reading

the task of textual understanding has recently
been formulated as a supervised learning problem
(kumar et al., 2015; hermann et al., 2015). this
task consists in estimating the conditional prob-
ability p(a|d,q) of an answer a to a question q
where d is a document. such an approach requires
a large training corpus of {document - query -
answer} triples and until now such corpora have
been limited to hundreds of examples (richard-
son et al., 2013).
in the context of dialog state
tracking, it can be understood as the capability of
inferring a set of latent values l associated with
a set of variables v related to a given dyadic or
multi-party conversation d, from direct correlation
and/or reasoning, using the course of exchanges of
utterances, p(l|d,v).

state updates at an utterance-level are rarely
provided off-the-shelf from a production environ-
ment.
in these environments, annotation is of-
ten performed afterhand for the purpose of log-
ging, monitoring or quality assessment.
in the
limit cases, as in human-to-human id71,
dialog-level annotations remains a common prat-
ices of annotation especially in personal assis-
tance, customer care dialogs and, in a more gen-
eral sense, industrial application of transactional
conversational user interfaces. another frequent
setting consist of informing the state after a given
number of utterance exchange between the locu-
tors. so an additional effort of speci   c annota-
tion is often needed in order to train a state of
the art statistical state tracking model (henderson
et al., 2014b).
in that sense, formalizing dialog
state tracking at a subdialog level in order to in-
fer hidden state variables with respect to a list of
utterances started from the    rst one to any given
utterance of a given dialog seems particularly ap-
propriate.
in the context of dialog state track-
ing challenges, the dstc-4 dialog corpus have
been designed in such purpose but only consists
of 22 dialogs. concerning the dstc-2 corpus,
the training data contains 2207 dialogues (15611
turns) and the test set consists of 1117 dialogues
(williams et al., 2016). this dataset is more suit-
able for our experiments.
reasons,

reading
paradigm becomes a promising formulation for

the machine

these

for

the general problem of dialog state tracking.
furthermore, current approaches and available
datasets for state tracking do not explicitly cover
reasoning capabilities such as temporal and spatial
reasoning, couting, sorting and deduction. we
suggest that in the future dataset dialogs express-
ing such speci   c abilities should be developed. in
this last part, several reasoning enhancements are
suggested to the dstc-2 dataset.

3.2 end-to-end memory networks
the memn2n architecture, introduced by (weston
et al., 2015), consists of two main components:
supporting memories and    nal answer prediction.
supporting memories are in turn comprised of a
set of input and output memory representations
with memory cells. the input and output memory
cells, denoted by mi and ci, are obtained by trans-
forming the input context x1, . . . ,xn (i.e a set of ut-
terances) using two embedding matrices a and c
(both of size d  |v| where d is the embedding size
and |v| the vocabulary size) such that mi = a  (xi)
and ci =c  (xi) where   (  ) is a function that maps
the input into a bag of dimension |v|.
similarly, the question q is encoded using an-
other embedding matrix b     rd  |v|, resulting in a
question embedding u = b  (q). the input mem-
ories {mi}, together with the embedding of the
question u, are utilized to determine the relevance
of each of the stories in the context, yielding in a
vector of attention weights

pi = softmax(u(cid:62)mi)

(1)

where softmax(ai) =
. subsequently, the re-
sponse o from the output memory is constructed
by the weighted sum:

eai
   i eai

o =    

i

pici

(2)

other models of parametric encoding for the ques-
tion and the document have been proposed in (ku-
mar et al., 2015). for the purpose of this presenta-
tion, we will keep with de   nition of   .

for more dif   cult tasks requiring multiple sup-
porting memories, the model can be extended to
include more than one set of input/output memo-
ries by stacking a number of memory layers. in
this setting, each memory layer is named a hop
and the (k + 1)th hop takes as input the output of
the kth hop:

uk+1 = ok + uk

(3)

lastly, the    nal step, the prediction of the an-

swer to the question q, is performed by

  a = softmax(w (ok + uk))

(4)
where   a is the predicted answer distribution, w    
r|v|  d is a parameter matrix for the model to learn
and k the total number of hops.

two weight tying schemes of the embedding
matrices have been introduced in (weston et al.,
2015):

1. adjacent: the output embedding matrix in
the kth hop is shared with the input embed-
ding matrix in the (k + 1)th hop, i.e., ak+1 =
ck for k     {1,k     1}. also, the weight ma-
trix w in equation (4) is shared with the out-
put embedding matrix in the last memory hop
such that w (cid:62) = ck.

2. layer-wise: all the weight matrices ak and
ck are shared across different hops, i.e., a1 =
a2 = . . . = ak and c1 = c2 = . . . = ck.

in the next section, we show how the task of di-
alog state tracking can be formalized as machine
reading task and solved using such memory en-
hanced model.

3.3 dialog reading model for state tracking
in this section, we formalize dialog state tracking
using the paradigm of machine reading. as far as
our knowledge goes, it is the    rst attempt to ap-
ply this approach and develop a speci   c dataset
format, detailed in section 4, from an existing
and publicly available dialog state tracking chal-
lenge dataset to ful   ll this task. assuming (1)
a dyadic dialog d composed of a list of utter-
ances, (2) a state composed with (2a) a set of
variables vi with i = {1, . . . ,n}and (2b) a set of
corresponding assigned values li. one can de-
   ne a question qv that corresponds to the speci   c
querying of a variable in the context of a dialog
p(li|qvi,d). in such context, a dialog state track-
ing task consists in determining for each variable
v, l    = argmaxli   l p(li|qvi,d), with l the speci   c
domain of expression of a variable vi.

in addition to the actual dataset, we propose
to investigate four general reasoning tasks using
dstc-2 dataset as a starting point. in such way,
we leverage the dataset of dstc-2 to create more
complex reasoning task than the ones present in
the original dialogs of the dataset by performing
rule-based modi   cation over the corpus. obvi-
ously, the goal is to develop resolution algorithms

that are not dedicated to a speci   c reasoning task
but id136 models that will be as generic as pos-
sible. in the rest of the section, each of the reason-
ing tasks associated with dialog state tracking are
described and the generation protocol is explained
with examples.

factoid questions : this    rst task corresponds
to the current formulation of dialog state tracking.
it consists of questions where a previously given
a set of supporting facts, potentially amongst a set
of other irrelevant facts, provides the answer. this
kind of task was already employed in (weston et
al., 2014) in the context of a virtual world. in that
sense, the result obtained to such task are compa-
rable with the state of the art approaches.

yes/no questions : this task tests the ability
of a model to answer true/false type questions like
   is the food italian ?   . the conversion of a dialog
to such format is deterministic regarding the fact
that the utterances and corresponding true states
are known at each utterance of a given dialog.

inde   nite knowledge : this task tests a more
it tests
complex natural language construction.
if statements can be models in order to describe
possibilities rather than certainties, as proposed in
(weston et al., 2014). in our case, the answer will
be    maybe    to the question    is the price-range re-
quired moderate ?    if the slot hasn   t been men-
tioned yet throughout the current dialog.
in the
case of state tracking, it will allow to seaid113ssly
deal with unknown information about the dialog
state. concretly, this set of questions and answers
are generated has a super-set of the yes-no ques-
tions set. first, sub-dialog starting from the    rst
utterance of a given dialog are extracted under
the condition that a given slot is not informed in
the corresponding annotation. then, a question-
answering question is generated.

counting and lists/sets : this last task tests
the capacity of the model to perform simple count-
ing operations, by asking about the number of ob-
jects with a certain property, e.g.    how many area
are requested ?   . similarly, the ability to produce
a set of single word answers in the form of a list,
e.g.    what are the area requested ?    is inves-
tigated. table 1 give an example of each of the
question type presented below on a dialog sample
of dstc-2 corpus.

id136 procedure: concretely, the current
set of utterances of a dialog will be placed into the
memory using sentence based encoding and the

b

q
u
e
s
t
i
o
n
q

u1

  

o1

u2

  

o2

u3

  

w

o3

d
e
t
c
i
d
e
r
p

r
e
w
s
n
a

  a

a1

c1

a2

c2

a3

c3

utterances

{xi}

figure 2: illustration of the proposed memn2n based state dialog tracker model with 3 hops.

question will be encoded as the controller state at
t = 1. the answer will be produced using a soft-
max operation over the answer vocabulary that is
supposed    xed. we consider this hypothesis valid
in the case of factoid and list questions because
the set of value for a given variable is often con-
sidered known. in the cases of yes/no and indef-
inite knowledge question, {yes, no, maybe} are
added to the output vocabulary. following (we-
ston et al., 2014), a list-task answer will be consid-
ered as a single element in the answer set and the
count question. a possible alternative would be to
change the activation function used at the output of
the memn2n from softmax activation function to a
logistic one and to use a categorical cross id178
loss. a drawback of such alternative would be the
necessity of cross-validating a decision threshold
in order to select a eligible answers. concerning
the individual numbers for the count question set,
the numbers founded on the training set are added
into the vocabulary.

we believe more reasoning capabilities need to
be explore in the future, like spacial and tempo-
ral reasoning or deduction as suggested in (weston
et al., 2015). however, it will probably need the
development of a new dedicated ressource. an-
other alternative could be to develop a question-
answering annotation task based on a dialog cor-
pus where reasoning task are present. the closest
work to our proposal that can be cited is (bordes
and weston, 2016). in this paper, the authors de-
   nes a so-called end-to-end learnable dialog sys-
tem to infer an answer from a    nite set of eligible
answers w.r.t the current list of utterances of the di-
alog. the authors generate 5 arti   cial tasks of dia-
log. however the reasoning capabilities are not ex-
plicitly addressed and the author explicitly claim
that the resulting dialog system is not satisfactory

yet. indeed, we believe that having a proper di-
alog state tracker where a policy is built on top
can guarantee dialog achievement by properly op-
timizing a reward function throughout a explicitly
learnt dialog policy. in the case of proper end-to-
end systems, the objective function is still not ex-
plicitly de   ned (serban et al., 2015) and the result-
ing systems tend to be used in the context of chat-
oriented and non-goal oriented id71. in
the next section, we present experimental details
and results obtained on the basis of the dstc-2
dataset and its conversion to the four mentioned
reasoning tasks.
4 experiments
4.1 dataset and id174
in the dstc-2 dialog corpus, a user queries a
database of local restaurants by interacting with
a dialog system. a dialog proceeds as follows:
   rst, the user speci   es constraints concerning the
restaurant. then, the system offers the name of
a restaurant that satis   es the constraints. finally,
the user accepts the offer and requests additional
information about the accepted restaurant. in this
context, the dialog state tracker should be able to
track several types of information that compose
the state like the geographic area, the food type
and the price range slots. in order to make com-
parable experiments, subdialogs generated from
the    rst utterance to each utterance of each dia-
log of the corpus have been generated. the corre-
sponding question-answer pairs have been gener-
ated using the annotated state for each of the sub-
dialog. in the case of factoid question, this setting
allows for fair comparison at the utterance-level
state tracking gains with the prior art. the same
protocol has been adopted for the generated rea-
soning task. in that sense, the tracker task consists

im looking for a cheap restaurant in the west or east part of town.

index actor utterance
1
2
3
4
5
6
7
8
8

cust
agent thanh binh is a nice restaurant in the west of town in the cheap price range.
cust what is the address and post code.
agent thanh binh is on magdalene street city centre.
cust
factoid question what is the pricerange ? answer: {cheap}
yes/no question is the pricerange expensive ? answer: {no}
inde   nite knowledge is the foodtype chinese ? answer: {maybe}
listing task what are the areas ? answer: {west,east}

thank you goodbye.

table 1:

: dialog state tracking question-answering examples from dstc2 dataset

in    nding the value l    as de   ned in section 3.3. in
the overall dialog corpus, area slot counts 5 pos-
sible values, food slot counts 91 possible values
and pricerange slot counts 3 possible values. in or-
der to exhibit reasoning capability of the proposed
model in the context of dialog state tracking, three
other dataset have been automatically generated
from the dialog corpus in order to support 3 capa-
bilities of reasoning described in section 3.3. dia-
log modi   cation has been required for two reason-
ing tasks, list and count. two types of rules have
been developed to automatically produce modi   ed
dialogs. on a    rst hand, string matching has been
performed to determine the position of a slot val-
ues in a given utterance and an alternative state-
ment has been produced as a substitution. for ex-
ample, the utterance    i   m looking for a chinese
restaurant in the north    can be replaced by    i   m
looking for a chinese restaurant in the north or the
west of town   . a second type of modi   cation has
been performed in an inter-utterance fashion. for
example, assuming a given value    north    has been
informed in the current state of a given dialog, one
can add lately in the dialog a remark like    i would
also accept a place east side of town   . this kind
of statement tends to not affect the overall    ow
of the dialog and allows to add richer semantic
to the dialog.
in the future, we plan to develop
a richer set of generation procedures to augment
the dataset. nevertheless, we believe this simple
dialog augmentation strategy allows to exhibit the
competency of the proposed model beyond factoid
questions.

4.2 training details
as suggested in (sukhbaatar et al., 2015), 10% of
the set was held-out to form a validation set for
hyperparameter tuning. concerning the utterance
encoding, we use the so-called temporal encod-
ing technique. in fact, reading tasks require some
notion of temporal context. to enable the model

to address them, the memory vector is modi   ed
as such mi =     j axi j + ta(i), where ta(i) is the
ith row of a dedicated matrix ta that encodes tem-
poral information. the output embedding is aug-
mented in the same way with a matrix tc (e.g.
ci =     j cxi j + tc(i)). both ta and tc are learned
during training in an end-to-end fashion. they are
also subject to the same sharing constraints as a
and c. the embedding matrix a and b are ini-
tialized using googlenews id97 embedding
model (mikolov et al., 2013). also suggested on
(sukhbaatar et al., 2015), utterances are indexed
in reverse order, re   ecting their relative distance
from the question so that x1 is the last sentence
of the dialog. furthermore, adjacent weight tying
schema has been adopted. learning rate    is ini-
tially assigned a value of 0.005 with exponential
decay applied every 25 epochs by   /2 until 100
epochs are reached. then, linear start is used in
all our experiments as proposed by (sukhbaatar et
al., 2015). more precisely, the softmax function in
each memory layer is removed and re-inserted af-
ter 20 epochs. batch size is set to 16 and gradients
with an l2 norm larger than 40 are divided by a
scalar to have norm 40. all weights are initialized
randomly from a gaussian distribution with zero
mean and    = 0.1. in all our experiments, we have
tested a set of the embedding size d     {20,40,60}.
after validation, each model uses a 5-hops depth
con   guration.

4.3 experimental results
table 3 presents tracking accuracy obtained for
three variables of the dstc2 dataset formulated
as factoid question task. we compare with two
established utterance-level discriminative neural
trackers, a recurrent neural network (id56)
model (henderson et al., 2014a) and the neural
belief tracker (mrksic et al., 2016). as suggested
in this last work, the    rst id56 baseline model
uses no semantic (i.e. synonym) dictionary, while

locutor
cust
agent
cust
agent
cust
agent
cust
agent
cust
what is the area ? answer: dontcare

utterance
im looking for a cheap restaurant that serves chinese food
what part of town do you have in mind
i dont care
rice house serves chinese food in the cheap price range
what is the address and telephone number
sure rice house is on mill road city centre
phone number
the phone number of rice house is 765-239-09
thank you good bye

hop 1
0.00
0.33
0.00
0.01
0.58
0.03
0.00
0.02
0.02

hop 2
0.18
0.30
0.00
0.00
0.09
0.00
0.00
0.01
0.42

hop 3
0.11
0.00
0.17
0.00
0.01
0.00
0.00
0.00
0.71

hop 4
0.04
0.00
0.37
0.00
0.00
0.00
0.00
0.00
0.59

hop 5
0.00
0.00
1.00
0.00
0.00
0.00
0.00
0.00
0.00

table 2: attention shifting example for the area slot from dstc2 dataset, the values corresponds the pi
values affected to each memory block mi at each hop of the memn2n

the improved baseline uses a hand-crafted seman-
tic dictionary designed for the dstc2 ontology.
in this context, a memn2n model allows to ob-
tain competitive results with the most close, non-
memory enhanced, state of the art approach of re-
current neural network with id27 as
prior knowledge.

model
id56 - no dict.
id56 + sem. dict.
nbt-dnn
nbt-id98
memn2n(d = 40)

area
0.92
0.91
0.90
0.90
0.89

food
0.86
0.86
0.84
0.83
0.88

price
0.86
0.93
0.94
0.93
0.95

joint
0.69
0.73
0.72
0.72
0.74

table 3: one supporting fact task : acc. ob-
tained on dstc2 test set

as a second result, table 4 presents the perfor-
mance obtained for the four reasoning tasks. the
obtained results lead us to think that memn2n are
a competitive alternative for the task dialog state
tracking but also increase the spectrum of def-
inition of the general dialog state tracking task
to machine reading and reasoning. in the future,
we believe new reasoning capabilities like spacial
and temporal reasoning and deduction should be
exploited on the basis of a speci   cally designed
dataset.

5 conclusion and further work

this paper describes a novel method of dialog
state tracking based on the paradigm of machine
reading and solved using memn2n, a memory-
enhanced neural network architecture. in this con-
text, a dataset format inspired from the current
datasets of machine reading tasks has been devel-
oped for this task. it is the    rst attempt to solve
this classic sub-problem of dialog management in

variable

food

area

pricerange

d
20
40
60
20
40
60
20
40
60

yes-no
0.85
0.83
0.82
0.86
0.90
0.88
0.93
0.92
0.91

i.k. count. list.
0.41
0.79
0.42
0.84
0.82
0.39
0.79
0.83
0.75
0.89
0.90
0.78
0.86
0.83
0.80
0.85
0.85
0.81

0.89
0.88
0.90
0.94
0.96
0.95
0.93
0.90
0.91

table 4: reasoning tasks : acc. on dstc2 rea-
soning datasets

such way. beyond the experimental results pre-
sented in the experimental section, the proposed
approach offers several advantages compared to
state of the art methods of tracking. first, the pro-
posed method allows to perform tracking on the
basis of segment-dialog-level annotation instead
of utterance-level one that is commonly admitted
in academic datasets but tedious to produce in a
large scale industrial environment. second, we
propose to develop dialog corpus requiering rea-
soning capabilities to exibit the potential of the
proposed model. in future work, we plan to ad-
dress more complex tasks like spatial and tempo-
ral reasoning, sorting or deduction and experiment
with other memory enhanced id136 models.
indeed, we plan to experiment and compare the
same approach with stacked-augmented recur-
rent neural network (joulin and mikolov, 2015)
and id63 (graves et al., 2014)
that sounds also promising for these family of rea-
soning tasks.

references
[berant et al.2014] jonathan berant, vivek srikumar,
pei-chun chen, abby vander linden, brittany

harding, brad huang, peter clark, and christo-
pher d. manning. 2014. modeling biological pro-
cesses for reading comprehension.
in alessandro
moschitti, bo pang, and walter daelemans, editors,
proceedings of the 2014 conference on empirical
methods in natural language processing, emnlp
2014, october 25-29, 2014, doha, qatar, a meet-
ing of sigdat, a special interest group of the acl.
acl.

2015.

[joulin and mikolov2015] armand joulin and tomas
inferring algorithmic patterns
mikolov.
with stack-augmented recurrent nets.
in corinna
cortes, neil d. lawrence, daniel d. lee, masashi
sugiyama, and roman garnett, editors, advances in
neural information processing systems 28: annual
conference on neural information processing sys-
tems 2015, december 7-12, 2015, montreal, que-
bec, canada, pages 190   198.

[bordes and weston2016] antoine bordes and jason
weston. 2016. learning end-to-end goal-oriented
dialog. corr.

[bunt et al.2010] harry bunt, jan alexandersson, jean
carletta, jae-woong choe, alex chengyu fang,
koiti hasida, kiyong lee, volha petukhova, an-
drei popescu-belis, laurent romary, claudia soria,
and david traum. 2010. towards an iso standard
in proceedings of the
for dialogue act annotation.
seventh international conference on language re-
sources and evaluation (lrec   10). european lan-
guage resources association (elra), may.

[etzioni et al.2007] oren etzioni, michele banko, and
michael j. cafarella. 2007. machine reading.
in
aaai spring symposium: machine reading. aaai.

[gasic and young2011] milica gasic and steve young.
2011. effective handling of dialogue state in the hid-
den information state pomdp-based dialogue man-
ager. tslp, 7(3):4.

[ghahramani and jordan1997] zoubin ghahramani and
michael i. jordan. 1997. factorial hidden markov
models. machine learning, 29(2-3):245   273.

[graves et al.2014] alex graves, greg wayne, and ivo

danihelka. 2014. id63s. corr.

[henderson et al.2013] matthew henderson, blaise
thomson, and steve young, 2013. proceedings
of the sigdial 2013 conference, chapter deep
neural network approach for the dialog state
tracking challenge, pages 467   471. association
for computational linguistics.

[henderson et al.2014a] m. henderson, b. thomson,
and s. j. young. 2014a. robust dialosg state track-
ing using delexicalised recurrent neural networks
in proceedings of
and unsupervised adaptation.
ieee spoken language technology.

[henderson et al.2014b] matthew henderson, blaise
thomson, and jason d. williams. 2014b. the third
dialog state tracking challenge. in slt, pages 324   
329. ieee.

[henderson et al.2014c] matthew henderson, blaise
thomson, and steve young. 2014c. word-based
dialog state tracking with recurrent neural networks.
in proceedings of sigdial.

[kumar et al.2015] ankit kumar, ozan irsoy, jonathan
su, james bradbury, robert english, brian pierce,
peter ondruska,
ishaan gulrajani, and richard
socher. 2015. ask me anything: dynamic memory
networks for natural language processing. corr.

[metallinou et al.2013] angeliki metallinou, dan bo-
hus, and jason williams. 2013. discriminative state
tracking for spoken id71. in association
for computer linguistics, pages 466   475. the as-
sociation for computer linguistics.

[mikolov et al.2013] tomas mikolov, ilya sutskever,
kai chen, gregory s. corrado, and jeffrey dean.
2013. distributed representations of words and
phrases and their compositionality.
in christopher
j. c. burges, l  eon bottou, zoubin ghahramani, and
kilian q. weinberger, editors, advances in neural
information processing systems 26: 27th annual
conference on neural information processing sys-
tems 2013. proceedings of a meeting held december
5-8, 2013, lake tahoe, nevada, united states, pages
3111   3119.

[milone and rubio2003] diego h. milone and anto-
nio j. rubio. 2003. prosodic and accentual in-
ieee
formation for automatic id103.
transactions on speech and audio processing,
11(4):321   333.

[mrksic et al.2016] nikola mrksic,

  o
s  eaghdha, tsung-hsien wen, blaise thomson,
and steve j. young. 2016. neural belief tracker:
corr,
data-driven dialogue state tracking.
abs/1606.03777.

diarmuid

[poon and domingos2010] hoifung poon and pedro m.
domingos. 2010. machine reading: a    killer app   
for statistical relational ai. in statistical relational
arti   cial intelligence, volume ws-10-06 of aaai
workshops. aaai.

[raux and ma2011] antoine raux and yi ma. 2011.
ef   cient probabilistic tracking of user goal and di-
alog history for spoken id71. in inter-
speech, pages 801   804. isca.

[richardson et al.2013] matthew richardson, christo-
2013.
pher j. c. burges, and erin renshaw.
mctest: a challenge dataset for the open-domain
machine comprehension of text. in emnlp, pages
193   203. acl.

[hermann et al.2015] karl moritz hermann, tom  as
kocisk  y, edward grefenstette, lasse espeholt, will
kay, mustafa suleyman, and phil blunsom. 2015.
teaching machines to read and comprehend. corr.

[serban et al.2015] iulian vlad serban, ryan lowe,
laurent charlin, and joelle pineau. 2015. a sur-
vey of available corpora for building data-driven di-
alogue systems. corr.

[sukhbaatar et al.2015] sainbayar sukhbaatar, arthur
2015.
szlam, jason weston, and rob fergus.
end-to-end memory networks.
in corinna cortes,
neil d. lawrence, daniel d. lee, masashi
sugiyama, and roman garnett, editors, advances in
neural information processing systems 28: annual
conference on neural information processing sys-
tems 2015, december 7-12, 2015, montreal, que-
bec, canada, pages 2440   2448.

[thomson and young2010] blaise thomson and steve
young. 2010. bayesian update of dialogue state:
a pomdp framework for spoken dialogue systems.
computer speech & language, 24(4):562   588.

[van der maaten and hinton2008] laurens

der
maaten and geoffrey hinton. 2008. visualizing
journal of machine learning
data using id167.
research, 9:2579   2605, november.

van

[wen et al.2016] tsung-hsien wen, milica gasic,
nikola mrksic, lina maria rojas-barahona,
pei-hao su, stefan ultes, david vandyke, and
steve j. young. 2016. a network-based end-to-end
trainable task-oriented dialogue system. corr.

[weston et al.2014] jason weston, sumit chopra, and

antoine bordes. 2014. memory networks. corr.

[weston et al.2015] jason weston, antoine bordes,
sumit chopra, and tomas mikolov. 2015. towards
ai-complete id53: a set of prerequi-
site toy tasks. corr.

[williams et al.2005] jason d. williams,

pascal
poupart, and steve young. 2005. factored partially
observable id100 for dialogue
in in 4th workshop on knowledge
management.
and reasoning in practical id71, pages
76   82.

[williams et al.2016] jason d. williams, antoine
raux, and matthew henderson. 2016. the dialog
state tracking challenge series: a review. d&d,
7(3):4   33.

[williams2014] jason d. williams. 2014. web-style
ranking and slu combination for dialog state track-
ing. in proceedings of sigdial. acl association
for computational linguistics, june.

[yeh et al.2014] peter z. yeh, benjamin douglas,
william jarrold, adwait ratnaparkhi, deepak ra-
machandran, peter f. patel-schneider, stephen
laverty, nirvana tikku, sean brown, and jeremy
mendel. 2014. a speech-driven second screen ap-
plication for tv program discovery.
in carla e.
brodley and peter stone, editors, proceedings of the
twenty-eighth aaai conference on arti   cial intel-
ligence, july 27 -31, 2014, qu  ebec city, qu  ebec,
canada, pages 3010   3016. aaai press.

