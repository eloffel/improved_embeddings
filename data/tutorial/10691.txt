word prediction requiring a broad discourse context   

the lambada dataset:

denis paperno, germ  an kruszewski, angeliki lazaridou, quan ngoc pham   ,

raffaella bernardi, sandro pezzelle, marco baroni, gemma boleda, raquel fern  andez   

cimec - center for mind/brain sciences, university of trento

{firstname.lastname}@unitn.it,    quanpn90@gmail.com
   institute for logic, language & computation, university of amsterdam

raquel.fernandez@uva.nl

abstract

we introduce lambada, a dataset to
evaluate the capabilities of computational
models for text understanding by means
of a word prediction task. lambada
is a collection of narrative passages shar-
ing the characteristic that human subjects
are able to guess their last word if they
are exposed to the whole passage, but not
if they only see the last sentence preced-
ing the target word. to succeed on lam-
bada, computational models cannot sim-
ply rely on local context, but must be able
to keep track of information in the broader
discourse. we show that lambada ex-
empli   es a wide range of linguistic phe-
nomena, and that none of several state-of-
the-art language models reaches accuracy
above 1% on this novel benchmark. we
thus propose lambada as a challenging
test set, meant to encourage the develop-
ment of new models capable of genuine
understanding of broad context in natural
language text.

introduction

1
the recent spurt of powerful end-to-end-trained
neural networks for natural language processing
(hermann et al., 2015; rockt  aschel et al., 2016;
weston et al., 2015, a.o.) has sparked interest in
tasks to measure the progress they are bringing
about in genuine language understanding. spe-
cial care must be taken in evaluating such systems,
since their effectiveness at picking statistical gen-
eralizations from large corpora can lead to the il-
lusion that they are reaching a deeper degree of
understanding than they really are. for example,
    denis and germ  an share    rst authorship. marco,

gemma, and raquel share senior authorship.

the end-to-end system of vinyals and le (2015),
trained on large conversational datasets, produces
dialogues such as the following:

(1)

human: what is your job?
machine: i   m a lawyer
human: what do you do?
machine: i   m a doctor

separately, the system responses are appropriate
for the respective questions. however, when taken
together, they are incoherent. the system be-
haviour is somewhat parrot-like.
it can locally
produce perfectly sensible language fragments,
but it fails to take the meaning of the broader dis-
course context into account. much research ef-
fort has consequently focused on designing sys-
tems able to keep information from the broader
context into memory, and possibly even perform
simple forms of reasoning about it (hermann et
al., 2015; hochreiter and schmidhuber, 1997; ji
et al., 2015; mikolov et al., 2015; sordoni et al.,
2015; sukhbaatar et al., 2015; wang and cho,
2015, a.o.).

in this paper, we introduce the lambada
(id38 broadened to
dataset
account for discourse aspects). lambada pro-
poses a word prediction task where the target item
is dif   cult to guess (for english speakers) when
only the sentence in which it appears is available,
but becomes easy when a broader context is pre-
sented. consider example (1) in figure 1. the
sentence do you honestly think that i would want
you to have a
? has a multitude of possible con-
tinuations, but the broad context clearly indicates
that the missing word is miscarriage.

lambada casts language understanding in
the classic word prediction framework of language
modeling. we can thus use it to test several ex-
isting id38 architectures, including

6
1
0
2

 

n
u
j
 

0
2

 
 
]
l
c
.
s
c
[
 
 

1
v
1
3
0
6
0

.

6
0
6
1
:
v
i
x
r
a

systems with capacity to hold longer-term contex-
tual memories.
in our preliminary experiments,
none of these models came even remotely close to
human performance, con   rming that lambada
is a challenging benchmark for research on auto-
mated models of natural language understanding.

2 related datasets

the id98/daily mail (id98dm) benchmark re-
cently introduced by hermann et al. (2015) is
closely related to lambada. id98dm includes
a large set of online articles that are published to-
gether with short summaries of their main points.
the task is to guess a named entity that has been
removed from one such summary. although the
data are not normed by subjects, it is unlikely
that the missing named entity can be guessed from
the short summary alone, and thus, like in lam-
bada, models need to look at the broader con-
text (the article). differences between the two
datasets include text genres (news vs. novels; see
section 3.1) and the fact that missing items in cn-
ndm are limited to named entities. most im-
portantly, the two datasets require models to per-
form different kinds of id136s over broader
passages. for id98dm, models must be able to
summarize the articles, in order to make sense of
the sentence containing the missing word, whereas
in lambada the last sentence is not a summary
of the broader passage, but a continuation of the
same story. thus, in order to succeed, models
must instead understand what is a plausible devel-
opment of a narrative fragment or a dialogue.

another related benchmark, cbt, has been in-
troduced by hill et al. (2016). like lambada,
cbt is a collection of book excerpts, with one
word randomly removed from the last sentence
in a sequence of 21 sentences. while there are
other design differences, the crucial distinction be-
tween cbt and lambada is that the cbt pas-
sages were not    ltered to be human-guessable in
the broader context only. indeed, according to the
post-hoc analysis of a sample of cbt passages re-
ported by hill and colleagues, in a large proportion
of cases in which annotators could guess the miss-
ing word from the broader context, they could also
guess it from the last sentence alone. at the same
time, in about one    fth of the cases, the annotators
could not guess the word even when the broader
context was given. thus, only a small portion of
the cbt passages are really probing the model   s

ability to understand the broader context, which is
instead the focus of lambada.

the idea of a book excerpt completion task
was originally introduced in the msrcc dataset
(zweig and burges, 2011). however, the latter
limited context to single sentences, not attempting
to measure broader passage understanding.

of course,

text understanding can be tested
through other tasks, including entailment detec-
tion (bowman et al., 2015), answering questions
about a text (richardson et al., 2013; weston
et al., 2015) and measuring inter-clause coher-
ence (yin and sch  utze, 2015). while different
tasks can provide complementary insights into the
models    abilities, we    nd word prediction par-
ticularly attractive because of its naturalness (it   s
easy to norm the data with non-expert humans)
and simplicity. models just need to be trained
to predict the most likely word given the previ-
ous context, following the classic language mod-
eling paradigm, which is a much simpler setup
than the one required, say, to determine whether
two sentences entail each other. moreover, mod-
els can have access to virtually unlimited amounts
of training data, as all that is required to train a
language model is raw text. on a more general
methodological level, word prediction has the po-
tential to probe almost any aspect of text under-
standing, including but not limited to traditional
narrower tasks such as entailment, co-reference
resolution or id51.

3 the lambada dataset
3.1 data collection1
lambada consists of passages composed of a
context (on average 4.6 sentences) and a target
sentence. the context size is the minimum num-
ber of complete sentences before the target sen-
tence such that they cumulatively contain at least
50 tokens (this size was chosen in a pilot study).
the task is to guess the last word of the target sen-
tence (the target word). the constraint that the
target word be the last word of the sentence, while
not necessary for our research goal, makes the task
more natural for human subjects.

the lambada data come from the book cor-
pus (zhu et al., 2015). the fact that it con-
tains unpublished novels minimizes the potential

1further technical details are provided in the supplemen-
tary material (sm): http://clic.cimec.unitn.it/
lambada/

(1)

(2)

(3)

(4)

(5)

(6)

(7)

(8)

(9)

(10)

context:    yes, i thought i was going to lose the baby.       i was scared too,    he stated, sincerity    ooding his eyes.    you

were ?       yes, of course. why do you even ask?       this baby wasn   t exactly planned for.   

target sentence:    do you honestly think that i would want you to have a
target word: miscarriage

?   

context:    why?       i would have thought you   d    nd him rather dry,    she said.    i don   t know about that,    said gabriel.

   he was a great craftsman,    said heather.    that he was,    said flannery.

target sentence:    and polish, to boot,    said
target word: gabriel

.

context: preston had been the last person to wear those chains, and i knew what i   d see and feel if they were slipped
onto my skin-the reaper   s unending hatred of me. i   d felt enough of that emotion already in the amphitheater. i
didn   t want to feel anymore.    don   t put those on me,    i whispered.    please.   

target sentence: sergei looked at me, surprised by my low, raspy please, but he put down the
target word: chains

.

context: they tuned, discussed for a moment, then struck up a lively jig. everyone joined in, turning the courtyard into
an even more chaotic scene, people now dancing in circles, swinging and spinning in circles, everyone making
up their own dance steps. i felt my feet tapping, my body wanting to move.

target sentence: aside from writing, i    ve always loved
target word: dancing

.

context: he shook his head, took a step back and held his hands up as he tried to smile without losing a cigarette.    yes
you can,    julia said in a reassuring voice.    i    ve already focused on my friend. you just have to click the shutter,
on top, here.   

target sentence: he nodded sheepishly, through his cigarette away and took the
target word: camera

.

context: in my palm is a clear stone, and inside it is a small ivory statuette. a guardian angel.    figured if you   re going
to be out at night getting hit by cars, you might as well have some backup.    i look at him, feeling stunned. like
this is some sort of sign.

target sentence: but as i stare at harlin, his mouth curved in a con   dent grin, i don   t care about
target word: signs

.

context: both its sun-speckled shade and the cool grass beneath were a welcome respite after the sti   ing kitchen, and
i was glad to relax against the tree   s rough, brittle bark and begin my breakfast of buttery, toasted bread and fresh
fruit. even the water was tasty, it was so clean and cold.

target sentence: it almost made up for the lack of
target word: coffee

.

context: my wife refused to allow me to come to hong kong when the plague was at its height and           your wife,
johanne? you are married at last ?    johanne grinned.    well, when a man gets to my age, he starts to need a few
home comforts.

target sentence: after my dear mother passed away ten years ago now, i became
target word: lonely

.

context:    again, he left that up to you. however, he was adamant in his desire that it remain a private ceremony. he
asked me to make sure, for instance, that no information be given to the newspaper regarding his death, not even
an obituary.

target sentence: i got the sense that he didn   t want anyone, aside from the three of us, to know that he   d even
target word: died

.

context: the battery on logan   s radio must have been on the way out. so he told himself. there was no other
explanation beyond cygan and the staff at the white house having been overrun. lizzie opened her eyes with
a    utter. they had been on the icy road for an hour without incident.

target sentence: jack was happy to do all of the
target word: driving

.

figure 1: examples of lambada passages. underlined words highlight when the target word (or its
lemma) occurs in the context.

usefulness of general world knowledge and ex-
ternal resources for the task, in contrast to other
kinds of texts like news data, wikipedia text, or
famous novels. the corpus, after duplicate re-
moval and    ltering out of potentially offensive ma-
terial with a stop word list, contains 5,325 nov-
els and 465 million words. we randomly divided
the novels into equally-sized training and devel-
opment+testing partitions. we built the lam-
bada dataset from the latter, with the idea that
models tackling lambada should be trained on
raw text from the training partition, composed of
2662 novels and encompassing more than 200m
words. because novels are pre-assigned to one of
the two partitions only, lambada passages are
self-contained and cannot be solved by exploiting
the knowledge in the remainder of the novels, for
example background information about the char-
acters involved or the properties of the    ctional
world in a given novel. the same novel-based di-
vision method is used to further split lambada
data between development and testing.

to reduce time and cost of dataset collection,
we    ltered out passages that are relatively easy
for standard language models, since such cases
are likely to be guessable based on local context
alone. we used a combination of four language
models, chosen by availability and/or ease of train-
ing: a pre-trained recurrent neural network (id56)
(mikolov et al., 2011) and three models trained
on the book corpus (a standard 4-gram model, a
id56 and a feed-forward model; see sm for de-
tails, and note that these are different from the
models we evaluated on lambada as described
in section 4 below). any passage whose target
word had id203    0.00175 according to any
of the language models was excluded.

a random sample of the remaining passages
were then evaluated by human subjects through
the crowdflower id104 service2 in three
steps. for a given passage,

1. one human subject guessed the target word
based on the whole passage (comprising the
context and the target sentence); if the guess
was right,

2. a second subject guessed the target word
based on the whole passage; if that guess was
also right,

3. more subjects tried to guess the target word
based on the target sentence only, until the

2http://www.crowdflower.com

word was guessed or the number of unsuc-
cessful guesses reached 10; if no subject was
able to guess the target word, the passage was
added to the lambada dataset.

the subjects in step 3 were allowed 3 guesses
per sentence, to maximize the chances of catch-
ing cases where the target words were guessable
from the sentence alone. step 2 was added based
on a pilot study that revealed that, while step 3
was enough to ensure that the data could not be
guessed with the local context only, step 1 alone
did not ensure that the data were easy given the
discourse context (its output includes a mix of
cases ranging from obvious to relatively dif   cult,
guessed by an especially able or lucky step-1 sub-
ject). we made sure that it was not possible for
the same subject to judge the same item in both
passage and sentence conditions (details in sm).
in the id104 pipeline, 84   86% items
were discarded at step 1, an additional 6   7% at
step 2 and another 3   5% at step 3. only about one
in 25 input examples passed all the selection steps.
subjects were paid $0.22 per page in steps 1
and 2 (with 10 passages per page) and $0.15 per
page in step 3 (with 20 sentences per page). over-
all, each item in the resulting dataset costed $1.24
on average. alternative designs, such as having
step 3 before step 2 or before step 1, were found
to be more expensive. cost considerations also
precluded us from using more subjects at stage 1,
which could in principle improve the quality of    l-
tering at this step.

note that the criteria for passage inclusion were
very strict: we required two consecutive subjects
to exactly match the missing word, and we made
sure that no subject (out of ten) was able to provide
it based on local context only, even when given 3
guesses. an alternative to this perfect-match ap-
proach would have been to include passages where
broad-context subjects provided other plausible or
synonymous continuations. however, it is very
challenging, both practically and methodologi-
cally, to determine which answers other than the
original    t the passage well, especially when the
goal is to distinguish between items that are solv-
able in broad-discourse context and those where
the local context is enough. theoretically, substi-
tutability in context could be tested with manual
annotation by multiple additional raters, but this
would not be    nancially or practically feasible for
a dataset of this scale (human annotators received

over 200,000 passages at stage 1). for this reason
we went for the strict hit-or-miss approach, keep-
ing only items that can be unambiguously deter-
mined by human subjects.

3.2 dataset statistics
the lambada dataset consists of 10,022 pas-
sages, divided into 4,869 development and 5,153
test passages (extracted from 1,331 and 1,332 dis-
joint novels, respectively). the average passage
consists of 4.6 sentences in the context plus 1 tar-
get sentence, for a total length of 75.4 tokens (dev)
/ 75 tokens (test). examples of passages in the
dataset are given in figure 1.

the training data for language models to be
tested on lambada include the full text of 2,662
novels (disjoint from those in dev+test), compris-
ing 203 million words. note that the training
data consists of text from the same domain as the
dev+test passages, in large amounts but not    l-
tered in the same way. this is partially motivated
by economic considerations (recall that each data
point costs $1.24 on average), but, more impor-
tantly, it is justi   ed by the intended use of lam-
bada as a tool to evaluate general-purpose mod-
els in terms of how they fare on broad-context un-
derstanding (just like our subjects could predict
the missing words using their more general text
understanding abilities), not as a resource to de-
velop ad-hoc models only meant to predict the    -
nal word in the sort of passages encountered in
lambada. the development data can be used
to    ne-tune models to the speci   cs of the lam-
bada passages.

3.3 dataset analysis
our analysis of the lambada data suggests that,
in order for the target word to be predictable in a
broad context only, it must be strongly cued in the
broader discourse. indeed, it is typical for lam-
bada items that the target word (or its lemma)
occurs in the context. figure 2(a) compares the
lambada items to a random 5000-item sam-
ple from the input data, that is, the passages that
were presented to human subjects in the    ltering
phase (we sampled from all passages passing the
automated    lters described in section 3.1 above,
including those that made it to lambada). the
   gure shows that when subjects guessed the word
(only) in the broad context, often the word it-
self occurred in the context: more than 80% of
lambada passages include the target word in

the context, while in the input data that was the
case for less than 15% of the passages. to guess
the right word, however, subjects must still put
their linguistic and general cognitive skills to good
use, as shown by the examples featuring the target
word in the context reported in figure 1.

figure 2(b) shows that most target words in
lambada are proper nouns (48%), followed by
common nouns (37%) and, at a distance, verbs
(7.7%).
in fact, proper nouns are hugely over-
represented in lambada, while the other cat-
egories are under-represented, compared to the
pos distribution in the input. a variety of factors
converges in making proper nouns easy for sub-
jects in the lambada task. in particular, when
the context clearly demands a referential expres-
sion, the constraint that the blank be    lled by a
single word excludes other possibilities such as
noun phrases with articles, and there are reasons to
suspect that co-reference is easier than other dis-
course phenomena in our task (see below). how-
ever, although co-reference seems to play a big
role, only 0.3% of target words are pronouns.
common nouns are still pretty frequent

in
lambada, constituting over one third of the
data. qualitative analysis reveals a mixture of
phenomena. co-reference is again quite common
(see example (3) in figure 1), sometimes as    par-
tial    co-reference facilitated by bridging mecha-
nisms (shutter   camera; example (5)) or through
the presence of a near synonym (   lose the baby      
miscarriage; example (1)). however, we also of-
ten    nd other phenomena, such as the id136 of
prototypical participants in an event. for instance,
if the passage describes someone having breakfast
together with typical food and beverages (see ex-
ample (7)), subjects can guess the target word cof-
fee without it having been explicitly mentioned.

in contrast, verbs, adjectives, and adverbs are
rare in lambada. many of those items can be
guessed with local sentence context only, as shown
in figure 2(b), which also reports the pos dis-
tribution of the set of items that were guessed by
subjects based on the target-sentence context only
(step 3 in section 3.1). note a higher proportion
of verbs, adjectives and adverbs in the latter set in
figure 2(b). while end-of-sentence context skews
input distribution in favour of nouns, subject    lter-
ing does show a clear differential effect for nouns
vs. other poss. manual inspection reveals that
broad context is not necessary to guess items like

(a)

(b)

(c)

figure 2: (a) target word in or not in context; (b) target word pos distribution in lambada vs.
data presented to human subjects (input) and items guessed with sentence context only (pn=proper
noun, cn=common noun, v=verb, j=adjective, r=adverb, o=other); (c) target word pos distribution
of lambada passages where the lemma of the target word is not in the context (categories as in (b)).

frequent verbs (ask, answer, call), adjectives, and
closed-class adverbs (now, too, well), as well as
time-related adverbs (quickly, recently). in these
cases, the sentence context suf   ces, so few of them
end up in lambada (although of course there
are exceptions, such as example (8), where the tar-
get word is an adjective). this contrasts with other
types of open-class adverbs (e.g., innocently, con-
   dently), which are generally hard to guess with
both local and broad context. the low propor-
tion of these kinds of adverbs and of verbs among
guessed items in general suggests that tracking
event-related phenomena (such as script-like se-
quences of events) is harder for subjects than co-
referential phenomena, at least as framed in the
lambada task. further research is needed to
probe this hypothesis.

furthermore, we observe that, while explicit
mention in the preceding discourse context is criti-
cal for proper nouns, the other categories can often
be guessed without having been explicitly intro-
duced. this is shown in figure 2(c), which de-
picts the pos distribution of lambada items
for which the lemma of the target word is not
in the context (corresponding to about 16% of
lambada in total).3 qualitative analysis of
items with verbs and adjectives as targets sug-
gests that the target word, although not present in
the passage, is still strongly implied by the con-

3the apparent 1% of out-of-context proper nouns shown
in figure 2(c) is due to lemmatization mistakes (   ctional
characters for which the lemmatizer did not recognize a link
between singular and plural forms, e.g., wynn     wynns). a
manual check con   rmed that all proper noun target words in
lambada are indeed also present in the context.

text.
in about one third of the cases examined,
the missing word is    almost there   . for instance,
the passage contains a word with the same root
but a different part of speech (e.g., death   died
in example (6)), or a synonymous expression (as
mentioned above for    miscarriage   ; we    nd the
same phenomenon for verbs, e.g.,    deprived you
of water      dehydrated).

in other cases, correct prediction requires more
complex discourse id136, including guessing
prototypical participants of a scene (as in the cof-
fee example above), actions or events strongly sug-
gested by the discourse (see examples (1) and
(10), where the mention of an icy road helps
in predicting the target driving), or qualitative
properties of participants or situations (see exam-
ple (8)). of course, the same kind of discourse
reasoning takes place when the target word is al-
ready present in the context (cf. examples (3) and
(4)). the presence of the word in context does not
make the reasoning unnecessary (the task remains
challenging), but facilitates the id136.

as a    nal observation, intriguingly, the lam-
bada items contain (quoted) direct speech sig-
ni   cantly more often than the input items overall
(71% of lambada items vs. 61% of items in
the input sample), see, e.g., examples (1) and (2).
further analysis is needed to investigate in what
way more dialogic discourse might facilitate the
prediction of the    nal target word.

in sum, lambada contains a myriad of phe-
nomena that, besides making it challenging from
the text understanding perspective, are of great
interest to the broad computational linguistics

lambadainputtarget wordin contextnot in context0.00.20.40.60.81.0pncnvjrolambadainputsentence0.00.10.20.30.40.5pncnvjro0.00.10.20.30.40.5community. to return to example (1), solving it
requires a combination of linguistic skills rang-
ing from (morpho)phonology (the plausible target
word abortion is ruled out by the inde   nite deter-
miner a) through morphosyntax (the slot should be
   lled by a common singular noun) to pragmatics
(understanding what the male participant is infer-
ring from the female participant   s words), in addi-
tion to general reasoning skills. it is not surprising,
thus, that lambada is so challenging for current
models, as we show next.

4 modeling experiments

computational methods we tested several ex-
isting language models and baselines on lam-
bada. we implemented a simple id56 (el-
man, 1990), a long short-term memory network
(lstm) (hochreiter and schmidhuber, 1997),
a traditional statistical id165 language model
(stolcke, 2002) with and without cache, and a
memory network (sukhbaatar et al., 2015). we
remark that at least lstm, memory network and,
to a certain extent, the cache id165 model have,
among their supposed bene   ts, the ability to take
broader contexts into account. note moreover that
variants of id56s and lstms are at the state of
the art when tested on standard language model-
ing benchmarks (mikolov, 2014). our memory
network implementation is similar to the one with
which hill et al. (2016) reached the best results
on the cbt data set (see section 2 above). while
we could not re-implement the models that per-
formed best on id98dm (see again section 2),
our lstm is architecturally similar to the deep
lstm reader of hermann et al. (2015), which
achieved respectable performance on that data set.
most importantly, we will show below that most
of our models reach impressive performance when
tested on a more standard id38 data
set sourced from the same corpus used to build
lambada. this control set was constructed by
randomly sampling 5k passages of the same shape
and size as the ones used to build lambada
from the same test novels, but without    ltering
them in any way. based on the control set re-
sults, to be discussed below, we can reasonably
claim that the models we are testing on lam-
bada are very good at standard language model-
ing, and their low performance on the latter cannot
be attributed to poor quality.

in order to test for strong biases in the data,

we constructed sup-cbow, a baseline model
weakly tailored to the task at hand, consisting of a
simple neural network that takes as input a bag-of-
word representation of the passage and attempts
to predict the    nal word. the input representa-
tion comes from adding pre-trained cbow vec-
tors (mikolov et al., 2013) of the words in the pas-
sage.4 we also considered an unsupervised vari-
ant (unsup-cbow) where the target word is pre-
dicted by cosine similarity between the passage
vector and the target word vector. finally, we
evaluated several variations of a random guess-
ing baseline differing in terms of the word pool to
sample from. the guessed word could be picked
from: the full vocabulary, the words that appear
in the current passage and a random uppercased
word from the passage. the latter baseline aims at
exploiting the potential bias that proper names ac-
count for a consistent portion of the lambada
data (see figure 2 above).

note that lambada was designed to chal-
lenge language models with harder-than-average
examples where broad context understanding is
crucial. however, the average case should not be
disregarded either, since we want language mod-
els to be able to handle both cases. for this rea-
son, we trained the models entirely on unsuper-
vised data and expect future work to follow sim-
ilar principles. concretely, we trained the mod-
els, as is standard practice, on predicting each up-
coming word given the previous context, using the
lambada training data (see section 3.2 above)
as input corpus. the only exception to this proce-
dure was sup-cbow where we extracted from the
training novels similar-shaped passages to those in
lambada and trained the model on them (about
9m passages). again, the goal of this model was
only to test for potential biases in the data and not
to provide a full account for the phenomena we are
testing. we restricted the vocabulary of the mod-
els to the 60k most frequent words in the training
set (covering 95% of the target words in the de-
velopment set). the model hyperparameters were
tuned on their accuracy in the development set.
the same trained models were tested on the lam-
bada and the control sets. see sm for the tuning
details.

results results of models and baselines are re-
ported in table 1. note that the measure of interest

4http://clic.cimec.unitn.it/composes/

semantic-vectors.html

data

method

acc.

ppl.

rank

baselines

random vocabulary word
random word from passage
random capitalized word from passage
unsup-cbow
sup-cbow

models

lambada

id165
id165 w/cache
id56
lstm
memory network

baselines

random vocabulary word
random word from passage
random capitalized word from passage
unsup-cbow
sup-cbow

models

control

id165
id165 w/cache
id56
lstm
memory network

0
1.6
7.3
0
0

0.1
0.1
0
0
0

0
0
0
0
3.5

60000

30026

-
-

-
-

57040
47587

16352
4660

3125
768
14725
5357
16318

993
87
7831
324
846

60000

30453

-
-

-
-

55190
2344

12950
259

19.1
19.1
15.4
21.9
8.5

285
270
277
149
566

17
18
24
12
46

table 1: results of computational methods. accuracy is expressed in percentage.

for lambada is the average success of a model
at predicting the target word, i.e., accuracy (unlike
in standard id38, we know that the
missing lambada words can be precisely pre-
dicted by humans, so good models should be able
to accomplish the same feat, rather than just as-
signing a high id203 to them). however, as
we observe a bottoming effect with accuracy, we
also report perplexity and median rank of correct
word, to better compare the models.

as anticipated above, and in line with what we
expected, all our models have very good perfor-
mance when called to perform a standard language
modeling task on the control set.
indeed, 3 of
the models (the id165 models and lstm) can
guess the right word in about 1/5 of the cases.

the situation drastically changes if we look at
the lambada results, where all models are per-
forming very badly.
indeed, no model is even
able to compete with the simple heuristics of pick-
ing a random word from the passage, and, espe-
cially, a random capitalized word (easily a proper
noun). at the same time, the low performance of

the latter heuristic in absolute terms (7% accuracy)
shows that, despite the bias in favour of names in
the passage, simply relying on this will not suf   ce
to obtain good performance on lambada, and
models should rather pursue deeper forms of anal-
ysis of the broader context (the sup-cbow base-
line, attempting to directly exploit the passage in
a shallow way, performs very poorly). this con-
   rms again that the dif   culty of lambada relies
mainly on accounting for the information available
in a broader context and not on the task of predict-
ing the exact word missing.

in comparative terms (and focusing on perplex-
ity and rank, given the uniformly low accuracy
results) we observe a stronger performance of
the traditional id165 models over the neural-
network-based ones, possibly pointing to the dif-
   culty of tuning the latter properly.
in particu-
lar, the best relative performance on lambada
is achieved by id165 w/cache, which takes pas-
sage statistics into account. while even this model
is effectively unable to guess the right word, it
achieves a respectable perplexity of 768.

we recognize, of course, that the evaluation we
performed is very preliminary, and it must only be
taken as a proof-of-concept study of the dif   culty
of lambada. better results might be obtained
simply by performing more extensive tuning, by
adding more sophisticated mechanisms such as at-
tention (bahdanau et al., 2014), and so forth. still,
we would be surprised if minor modi   cations of
the models we tested led to human-level perfor-
mance on the task.

we also note that, because of the way we have
constructed lambada, standard language mod-
els are bound to fail on it by design: one of our
   rst    lters (see section 3.1) was to choose pas-
sages where a number of simple language models
were failing to predict the upcoming word. how-
ever, future research should    nd ways around this
inherent dif   culty. after all, humans were still
able to solve this task, so a model that claims to
have good language understanding ability should
be able to succeed on it as well.

5 conclusion
this paper
introduced the new lambada
dataset, aimed at testing language models on their
ability to take a broad discourse context into ac-
count when predicting a word. a number of
linguistic phenomena make the target words in
lambada easy to guess by human subjects
when they can look at the whole passages they
come from, but nearly impossible if only the last
sentence is considered. our preliminary experi-
ments suggest that even some cutting-edge neural
network approaches that are in principle able to
track long-distance effects are far from passing the
lambada challenge.

we hope the computational community will be
stimulated to develop novel language models that
are genuinely capturing the non-local phenomena
that lambada re   ects. to promote research in
this direction, we plan to announce a public com-
petition based on the lambada data.5

our own hunch is that, despite the initially dis-
appointing results of the    vanilla    memory net-
work we tested, the ability to store information in
a longer-term memory will be a crucial compo-
nent of successful models, coupled with the ability
to perform some kind of reasoning about what   s

5the development set of lambada, along with the
training corpus, can be downloaded at http://clic.
cimec.unitn.it/lambada/. the test set will be made
available at the time of the competition.

stored in memory, in order to retrieve the right in-
formation from it.

on a more general note, we believe that lever-
aging human performance on word prediction is a
very promising strategy to construct benchmarks
for computational models that are supposed to
capture various aspects of human text understand-
ing. the in   uence of broad context as explored by
lambada is only one example of this idea.

acknowledgments
we are grateful to aurelie herbelot, tal linzen,
nghia the pham and, especially, roberto zam-
parelli for ideas and feedback. this project has
received funding from the european union   s hori-
zon 2020 research and innovation programme un-
der the marie sklodowska-curie grant agreement
no 655577 (love); erc 2011 starting indepen-
dent research grant n. 283554 (composes);
nwo vidi grant n. 276-89-008 (asymmetry in
conversation). we gratefully acknowledge the
support of nvidia corporation with the donation
of the gpus used in our research.

references
dzmitry bahdanau, kyunghyun cho, and yoshua ben-
gio. 2014. id4 by jointly
learning to align and translate. in iclr.

samuel bowman, gabor angeli, christopher potts, and
christopher manning. 2015. a large annotated cor-
pus for learning natural language id136. in pro-
ceedings of emnlp, pages 632   642, lisbon, portu-
gal.

jeffrey l elman. 1990. finding structure in time.

cognitive science, 14(2):179   211.

karl moritz hermann, tom  a  s ko  cisk  y, edward
grefenstette, lasse espeholt, will kay, mustafa
suleyman, and phil blunsom.
2015. teaching
in proceed-
machines to read and comprehend.
ings of nips, montreal, canada.
published
online:
https://papers.nips.cc/book/
advances-in-neural-information-
processing-systems-28-2015.

felix hill, antoine bordes, sumit chopra, and jason
weston. 2016. the goldilocks principle: read-
ing children   s books with explicit memory repre-
in proceedings of iclr conference
sentations.
track, san juan, puerto rico.
published on-
line: http://www.iclr.cc/doku.php?id=
iclr2016:main.

sepp hochreiter and j  urgen schmidhuber.

1997.
long short-term memory. neural computation,
9(8):1735   178   .

tian wang and kyunghyun cho.

larger-
context language modelling. http://arxiv.
org/abs/1511.03729.

2015.

jason weston, antoine bordes, sumit chopra, and
tomas mikolov. 2015. towards ai-complete ques-
tion answering: a set of prerequisite toy tasks.
http://arxiv.org/abs/1502.05698.

wenpeng yin and hinrich sch  utze.

2015. multi-
granid98: an architecture for general matching of
text chunks on multiple levels of granularity. in pro-
ceedings of acl, pages 63   73, beijing, china.

yukun zhu, ryan kiros, richard zemel, ruslan
salakhutdinov, raquel urtasun, antonio torralba,
and sanja fidler. 2015. aligning books and movies:
towards story-like visual explanations by watching
in iccv 2015, pages
movies and reading books.
19   27.

geoffrey zweig and christopher burges.

2011.
the microsoft research sentence completion chal-
lenge. technical report msr-tr-2011-129, mi-
crosoft research.

yangfeng ji, trevor cohn, lingpeng kong, chris dyer,
and jacob eisenstein.
2015. document context
language models. http://arxiv.org/abs/
1511.03962.

tomas mikolov, stefan kombrink, anoop deoras,
lukar burget, and jan honza cernocky.
2011.
id56lm - recurrent neural network language. in pro-
ceedings of asru. ieee automatic speech recog-
nition and understanding workshop.

tomas mikolov, kai chen, greg corrado, and jeffrey
dean. 2013. ef   cient estimation of word represen-
tations in vector space. http://arxiv.org/
abs/1301.3781/.

tomas mikolov, armand joulin, sumit chopra,
michael mathieu, and marc   aurelio ranzato. 2015.
learning longer memory in recurrent neural net-
in proceedings of iclr workshop track,
works.
san diego, ca. published online: http://www.
iclr.cc/doku.php?id=iclr2015:main.

tomas mikolov.

2014.

for modelling

using neural net-
representing
nat-
slides presented at col-
http://www.coling-

works
ural
ing,
2014.org/coling\2014\tutorial-
fix\-\tomasmikolov.pdf.

languages.
online

and

at

matthew richardson, christopher burges, and erin
renshaw. 2013. mctest: a challenge dataset for
the open-domain machine comprehension of text.
in proceedings of emnlp, pages 193   203, seattle,
wa.

tim rockt  aschel, edward grefenstette, karl moritz
hermann, tom  a  s ko  cisk  y, and phil blunsom. 2016.
reasoning about entailment with neural attention.
in proceedings of iclr conference track, san juan,
puerto rico. published online: http://www.
iclr.cc/doku.php?id=iclr2016:main.

alessandro sordoni, michel galley, michael auli,
chris brockett, yangfeng ji, margaret mitchell,
jian-yun nie, jianfeng gao, and bill dolan. 2015.
a neural network approach to context-sensitive gen-
eration of conversational responses. in proceedings
of naacl, pages 196   205, denver, co.

andreas stolcke. 2002. srilm-an extensible language
modeling toolkit. in interspeech, volume 2002,
page 2002.

sainbayar sukhbaatar, arthur szlam, jason weston,
end-to-end memory
http://arxiv.org/abs/1503.

2015.

and rob fergus.
networks.
08895.

oriol vinyals and quoc le. 2015. a neural conver-
sational model. in proceedings of the icml deep
learning workshop, lille, france. published on-
line: https://sites.google.com/site/
deeplearning2015/accepted-papers.

