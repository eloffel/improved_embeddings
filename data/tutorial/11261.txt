embracing data abundance:

booktest dataset for reading comprehension

ondrej bajgar   , rudolf kadlec    & jan kleindienst

ibm watson

v parku 4, 140 00 prague, czech republic

{obajgar,rudolf kadlec,jankle}@cz.ibm.com

6
1
0
2

 
t
c
o
4

 

 
 
]
l
c
.
s
c
[
 
 

1
v
6
5
9
0
0

.

0
1
6
1
:
v
i
x
r
a

abstract

there is a practically unlimited amount of
natural language data available. still, re-
cent work in text comprehension has fo-
cused on datasets which are small relative
to current computing possibilities. this ar-
ticle is making a case for the community to
move to larger data and as a step in that di-
rection it is proposing the booktest, a new
dataset similar to the popular children   s
book test (cbt), however more than 60
times larger.
we show that training on the new data im-
proves the accuracy of our attention-sum
reader model on the original cbt test data
by a much larger margin than many recent
attempts to improve the model architecture.
on one version of the dataset our ensemble
even exceeds the human baseline provided
by facebook. we then show in our own
human study that there is still space for
further improvement.

1

introduction

since humans amass more and more generally
available data in the form of unstructured text it
would be very useful to teach machines to read and
comprehend such data and then use this understand-
ing to answer our questions. a signi   cant amount
of research has recently focused on answering one
particular kind of questions the answer to which de-
pends on understanding a context document. these
are cloze-style questions (taylor, 1953) which re-
quire the reader to    ll in a missing word in a sen-
tence. an important advantage of such questions
is that they can be generated automatically from a
suitable text corpus which allows us to produce a

   these authors contributed equally to this work.

practically unlimited amount of them. that opens
the task to notoriously data-hungry deep-learning
techniques which now seem to outperform all alter-
native approaches.

two such large-scale datasets have recently been
proposed by researchers from google deepmind
and facebook ai: the id98/daily mail dataset
(hermann et al., 2015) and the children   s book
test (cbt) (hill et al., 2015) respectively. these
have attracted a lot of attention from the research
community (kobayashi et al., 2016; kadlec et al.,
2016; chen et al., 2016; sordoni et al., 2016;
dhingra et al., 2016; trischler et al., 2016b; weis-
senborn, 2016; cui et al., 2016b; cui et al., 2016a;
li et al., 2016) with a new state-of-the-art model
coming out every few weeks.

however if our goal is a production-level system
actually capable of helping humans, we want the
model to use all available resources as ef   ciently
as possible. given that

1. there is an almost unlimited amount of data
that can be used for generating cloze-style
question-answering datasets;

2. it is widely accepted that more data can signif-
icantly improve performance of most mod-
els (banko and brill, 2001; halevy et al.,
2009);

3. training a model takes only about two hours on
the cbt or about two days on the daily mail
dataset, the largest of the three sets, therefore
these datasets are not allowing us to fully use
current computing potential;

we believe that if the community is striving to bring
the performance as far as possible, it should move
its work to larger data.

this thinking goes in line with recent develop-
ments in the area of language modelling. for a long

time models were being compared on several    stan-
dard    datasets with publications often presenting
minuscule improvements in performance. then
the large-scale one billion word corpus dataset
appeared (chelba et al., 2014) and it allowed joze-
fowicz et al.
to train much larger lstm mod-
els (jozefowicz et al., 2016) that almost halved the
state-of-the-art perplexity on this dataset.

we think it is time to make a similar step in the
area of text comprehension. hence we are intro-
ducing the booktest, a new dataset very similar to
the children   s book test but more than 60 times
larger1 to enable training larger models even in the
domain of text comprehension. furthermore the
methodology used to create our data can later be
used to create even larger datasets when the need
arises thanks to further technological progress.

we show that if we evaluate a model trained on
the new dataset on the now standard children   s
book test dataset, we see an improvement in ac-
curacy much larger than other research groups
achieved by enhancing the model architecture it-
self (while still using the original cbt training
data). by training on the new dataset, we reduce
the prediction error by almost one third. on the
named-entity version of cbt this brings the ensem-
ble of our models to the level of human baseline
as reported by facebook (hill et al., 2015). how-
ever in the    nal section we show in our own human
study that there is still room for improvement on
the cbt beyond the performance of our model.

2 task description

a natural way of testing a reader   s comprehension
of a text is to ask her a question the answer to which
can be deduced from the text. hence the task we
are trying to solve consists of answering a cloze-
style question, the answer to which depends on the
understanding of a context document provided with
the question. the model is also provided with a set
of possible answers from which the correct one is
to be selected2. this can be formalized as follows:
the training data consist of tuples (q, d, a, a),
where q is a question, d is a document that contains
the answer to question q, a is a set of possible an-
swers and a     a is the ground-truth answer. both
q and d are sequences of words from vocabulary

1therefore more than 16 times larger than the daily mail

dataset.

2to get open-domain id53 we can provide

the whole vocabulary as a candidate list.

w 3. we also assume that all possible answers are
words from the vocabulary, that is a     w . in the
cbt and id98/daily mail datasets it is also true
that the ground-truth answer a appears in the docu-
ment. this is exploited by many machine learning
models (hill et al., 2015; kadlec et al., 2016; sor-
doni et al., 2016; dhingra et al., 2016; trischler et
al., 2016b; cui et al., 2016b; cui et al., 2016a; li et
al., 2016), however some do not explicitly depend
on this property (hermann et al., 2015; kobayashi
et al., 2016; chen et al., 2016; weissenborn, 2016)

3 current landscape

we will now brie   y review what datasets for text
comprehension have been published up to date and
look at models which have been recently applied
to solving the task we have just described.

3.1 datasets
a crucial condition for applying deep-learning tech-
niques is to have a huge amount of data available
for training. for id53 this speci   -
cally means having a large number of document-
question-answer triples available. while there is
an unlimited amount of text available, coming up
with relevant questions and the corresponding an-
swers can be extremely labour-intensive if done by
human annotators. there were efforts to provide
such human-generated datasets, e.g. microsoft   s
mctest (richardson et al., 2013), however their
scale is not suitable for deep learning without pre-
training on other data (trischler et al., 2016a) (such
as using pre-trained id27 vectors).

google deepmind managed to avoid this scale
issue with their way of generating document-
question-answer triples automatically, closely fol-
lowed by facebook with a similar method. let
us now brie   y introduce the two resulting datasets
whose properties are summarized in table 1.

3.1.1 id98 & daily mail datasets
these two datasets (hermann et al., 2015) exploit
a useful feature of online news articles     many
articles include a short summarizing sentence near
the top of the page. since all information in the
summary sentence is also presented in the article
body, we get a nice cloze-style question about the

3note that this vocabulary can be distinct from the model   s
own dictionary. for instance the model may replace certain
rare words by generic unknown-word tags hence reducing its
own dictionary size.

# queries
max # options
avg # options
avg # tokens
vocab. size

id98 daily mail cbt cn cbt ne
108,719
10
10
433
53,063

879,450
371
26.5
813
208,045

120,769
10
10
470
53,185

380,298
527
26.4
762
118,497

booktest
14,140,825
10
10
522
1,860,394

table 1: statistics on the 4 standard text comprehension datasets and our new booktest dataset introduced
in this paper. cbt cn stands for cbt common nouns and cbt ne stands for cbt named entites.
statistics were taken from (hermann et al., 2015) and the statistics provided with the cbt data set.

article contents by removing a word from the short
summary.

the dataset   s authors also replaced all named
entities in the dataset by anonymous tokens which
are further shuf   ed for each new batch. this forces
the model to rely solely on information from the
context document, not being able to transfer any
meaning of the named entities between documents.
this restricts the task to one speci   c aspect of
context-dependent id53 which may
be useful however it moves the task further from
the real application scenario, where we would like
the model to use all information available to an-
swer questions. furthermore chen et al. (chen et
al., 2016) have suggested that this can make about
17% of the questions unanswerable even by hu-
mans. they also claim that more than a half of
the question sentences are mere paraphrases or ex-
act matches of a single sentence from the context
document. this raises a question to what extent
the dataset can test deeper understanding of the
articles.

3.1.2 children   s book test
the children   s book test (hill et al., 2015) uses
a different source - books freely available thanks
to project gutenberg4. since no summary is avail-
able, each example consists of a context document
formed from 20 consecutive sentences from the
story together with a question formed from the sub-
sequent sentence.

the dataset comes in four    avours depending
on what type of word is omitted from the question
sentence. based on human evaluation done in (hill
et al., 2015) it seems that named entities (nes) and
common nouns (cns) are more context dependent
than the other two types     prepositions and verbs.
therefore we (and all of the recent publications)

4https://www.gutenberg.org/

focus only on these two word types.

3.1.3 recent additions
several new datasets related to the (now almost
standard) ones above emerged recently. we will
now brie   y present them and explain how the
dataset we are introducing in this article differs
from them.

the lambada dataset (paperno et al., 2016)
is designed to measure progress in understanding
common-sense questions about short stories that
can be easily answered by humans but cannot be
answered by current standard machine-learning
models (e.g. plain lstm language models). this
dataset is useful for measuring the gap between
humans and machine learning algorithms. how-
ever, by contrast to our booktest dataset, it will
not allow us to track progress towards the per-
formance of the baseline systems or on examples
where machine learning may show super-human
performance. also lambada is just a diagnostic
dataset and does not provide ready-to-use question-
answering training data, just a plain-text corpus
which may moreover include copyrighted books
making its use potentially problematic for some
purposes. we are providing ready training data
consisting of copyright-free books only.

the squad dataset (rajpurkar et al., 2016)
based on wikipedia and the who-did-what
dataset (onishi et al., 2016) based on giga-
word news articles are factoid question-answering
datasets where a multi-word answer should be ex-
tracted from a context document. this is in contrast
to the previous datasets, including id98/dm, cbt,
lambada and our new dataset, which require
only single-word answers. both these datasets how-
ever provide less than 130,000 training questions,
two orders of magnitude less than our dataset does.
the story cloze test (mostafazadeh et al., 2016)

provides a crowd-sourced corpus of 49,255 com-
monsense stories for training and 3,744 testing
stories with right and wrong endings. hence the
dataset is again rather small. similarly to lam-
bada, the story cloze test was designed to be
easily answerable by humans.

in the wikireading (hewlett et al., 2016) dataset
the context document is formed from a wikipedia
article and the question-answer pair is taken from
the corresponding wikidata page. for each en-
tity (e.g. hillary clinton), wikidata contain a
number of property-value pairs (e.g. place of
birth: chicago) which form the datasets   s question-
answer pairs. the dataset is certainly relevant to
the community, however the questions are of very
limited variety with only 20 properties (and hence
unique questions) covering 75% of the dataset. fur-
thermore many of the frequent properties are men-
tioned at a set spot within the article (e.g. the date
of birth is almost always in brackets behind the
name of a person) which may make the task eas-
ier for machines. we are trying to provide a more
varied dataset.

although there are several datasets related to
task we are aiming to solve, they differ suf   ciently
for our dataset to bring new value to the community.
its biggest advantage is its size which can further-
more be easily upscaled without expensive human
annotation. finally while we are emphasizing the
differences, models could certainly bene   t from as
diverse a collection of datasets as possible.

3.2 machine learning models

a    rst major work applying deep-learning tech-
niques to text comprehension was hermann et
al. (hermann et al., 2015). this work was fol-
lowed by the application of memory networks to
the same task (hill et al., 2015). later three mod-
els emerged around the same time (kobayashi et
al., 2016; kadlec et al., 2016; chen et al., 2016)
including our attention sum reader (as reader)
model (kadlec et al., 2016). the as reader in-
spired several subsequent models that use it as a
sub-component in a diverse ensemble (trischler
et al., 2016b); extend it with a hierarchical struc-
ture (sordoni et al., 2016; shen et al., 2016; dhin-
gra et al., 2016); compute attention over the con-
text document for every word in the query (cui
et al., 2016b) or use two-way context-query atten-
tion mechanism for every word in the context and
the query (cui et al., 2016a) that is similar in its

spirit to models recently proposed in different do-
mains, e.g. (dos santos et al., 2016) in information
retrieval. other neural approaches to text compre-
hension are explored in (weissenborn, 2016; li et
al., 2016).

3.3 possible directions for improvements
accuracy in any machine learning tasks can be
enhanced either by improving a machine learning
model or by using more in-domain training data.
current state of the art models (sordoni et al., 2016;
dhingra et al., 2016; trischler et al., 2016b; cui
et al., 2016a) improve over as reader   s accuracy
on cbt ne and cn datasets by 1-2 percent ab-
solute. this suggests that with current techniques
there is only limited room for improvement on the
algorithmic side.

the other possibility to improve performance
is simply to use more training data. the impor-
tance of training data was highlighted by the fre-
quently quoted mercer   s statement that    there is
no data like more data.   5 the observation that hav-
ing more data is often more important than having
better algorithms has been frequently stressed since
then (banko and brill, 2001; halevy et al., 2009).
as a step in the direction of exploiting the po-
tential of more data in the domain of text compre-
hension, we created a new dataset called booktest
similar to, but much larger than the widely used
cbt and id98/dm datasets.

4 booktest
similarly to the cbt, our booktest dataset6 is de-
rived from books available through project guten-
berg. we used 3555 copyright-free books to extract
cn examples and 10507 books for ne examples,
for comparison the cbt dataset was extracted from
just 108 books.

when creating our dataset we follow the
same procedure as was used to create the cbt
dataset (hill et al., 2015). that is, we detect
whether each sentence contains either a named
entity or a common noun that already appeared
in one of the preceding twenty sentences. this
word is then replaced by a gap tag (xxxxx) in
this sentence which is hence turned into a cloze-
style question. the preceding 20 sentences are
used as the context document. for common noun
5quote attributed to robert mercer by fred jelinek (je-

linek, 2004)

6booktest dataset can be downloaded from https://

ibm.biz/booktest-v1.

and named entity detection we use the stanford
pos tagger (toutanova et al., 2003) and stanford
ner (finkel et al., 2005)7.

the training dataset consists of the original
cbt ne and cn data extended with new ne
and cn examples. the new booktest dataset
hence contains 14, 140, 825 training examples and
7, 917, 523, 807 tokens.

the validation dataset consists of 10, 000 ne
and 10, 000 cn questions. we have one test set for
nes and one for cns, each containing 10, 000 ex-
amples. the training, validation and test sets were
generated from non-overlapping sets of books.

when generating the dataset we removed all edi-
tions of books used to create cbt validation and
test sets from our training dataset. therefore the
models trained on the booktest corpus can be eval-
uated on the original cbt data and they can be
compared with recent text-comprehension models
utilizing this dataset (hill et al., 2015; kadlec et
al., 2016; chen et al., 2016; sordoni et al., 2016;
dhingra et al., 2016; trischler et al., 2016b; weis-
senborn, 2016; cui et al., 2016b; cui et al., 2016a).
5 baselines
we will now use our as reader model to evaluate
the performance gain from increasing the dataset
size.

5.1 as reader
in (kadlec et al., 2016) we introduced the as
reader8, which at the time of publication signi   -
cantly outperformed all other architectures on the
id98, dm and cbt datasets. this model is built
to leverage the fact that the answer is a single word
from the context document. similarly to many
other models it uses attention over the document
    intuitively a measure of how relevant each word
is to answering the question. however while most
previous models used this attention as weights to
calculate a blended representation of the answer
word, we simply sum the attention across all occur-
rences of each unique words and then simply select
the word with the highest sum as the    nal answer.
while simple, this trick seems both to improve ac-
curacy and to speed-up training. it was adopted by
7we use version 3.6.0 of both ner and pos tag-
for id52 we use the model stanford-

gers.
postagger-full-2015-12-09/wsj-0-18-bidirectional-
distsim.tagger and for ner we use stanford-ner-2015-
12-09/english.all.3class.distsim.crf.ser.gz.

8as reader is available at https://github.com/

rkadlec/asreader

many subsequent models (trischler et al., 2016b;
sordoni et al., 2016; dhingra et al., 2016; cui et
al., 2016b; cui et al., 2016a; shen et al., 2016).

let us now describe the model in more detail.
figure 1 may help you in understanding the follow-
ing paragraphs.

5.1.1 basic structure
the words from the document and the question
are    rst converted into vector embeddings using a
look-up matrix v. the document is then read by
a bidirectional gru network (cho et al., 2014). a
concatenation of the hidden states of the forward
and backward grus at each word is then used as
a contextual embedding of this word, intuitively
representing the context in which the word is ap-
pearing. we can also understand it as representing
the set of questions to which this word may be an
answer.

similarly the question is read by a bidirectional
gru but in this case only the    nal hidden states
are concatenated to form the question embedding.
the attention over each word in the context is
then calculated as the dot product of its contextual
embedding with the question embedding. this at-
tention is then normalized by the softmax function
and summed across all occurrences of each answer
candidate. the candidate with most accumulated
attention is selected as the    nal answer.

for a more detailed description of the model
including equations check (kadlec et al., 2016).
more details about the training setup and model
hyperparameters can be found in the appendix.

5.1.2 out-of-vocabulary words
during our past experiments on the id98, dm and
cbt datasets (kadlec et al., 2016) each unique
word from the training, validation and test datasets
had its row in the look-up matrix v. however as
we radically increased the dataset size, this would
result in an extremely large number of model pa-
rameters so we decided to limit the vocabulary size
to 200, 000 most frequent words. for each exam-
ple, each unique out-of-vocabulary word is now
mapped on one of 1000 anonymous tokens which
are randomly initialized and untrained. fixing the
embeddings of these anonymous tags proved to
signi   cantly improve the performance.

5.1.3 query-initiated encoder
while mostly using the original as reader model,
we have also tried introducing a minor tweak in

figure 1: structure of the as reader model.

some instances of the model. we tried initializing
the context encoder gru   s hidden state by letting
the encoder read the question    rst before proceed-
ing to read the context document. intuitively this
allows the encoder to know in advance what to look
for when reading over the context document.

including models of this kind in the ensemble

helped to improve the performance.

5.2 results

table 2 shows the accuracy of the as reader and
other architectures on the cbt validation and test
data. the last two rows show the performance of
the as reader trained on the booktest dataset; all
the other models have been trained on the original
cbt training data.

if we take the best as reader ensemble trained
on cbt as a baseline, improving the model archi-
tecture as in (sordoni et al., 2016; dhingra et al.,
2016; trischler et al., 2016b; weissenborn, 2016;
cui et al., 2016b; cui et al., 2016a), continuing
to use the original cbt training data, lead to im-
provements of 1% and 2.1% absolute on named
entities and common nouns respectively. by con-
trast, in   ating the training dataset provided a boost
of 7.4     14.8% while using the same model. the
ensemble of our models even exceeded the human
baseline provided by facebook (hill et al., 2015)
on the common noun dataset.

our model takes approximately two weeks to
converge when trained on the booktest dataset on
a single nvidia tesla k40 gpu.

6 discussion

embracing the abundance of data may mean focus-
ing on other aspects of system design than with
smaller data. here are some of the challenges that
we need to face in this situation.

firstly, since the amount of data is practically un-
limited     we could even generate them on the    y re-
sulting in continuous learning similar to the never-
ending language learning by carnegie mellon
university (mitchell et al., 2015)     it is now the
speed of training that determines how much data
the model is able to see. since more training data
signi   cantly help the model performance, focus-
ing on speeding up the algorithm may be more
important than ever before. this may for instance
in   uence the decision whether to use regulariza-
tion such as dropout which does seem to somewhat
improve the model performance, however usually
at a cost of slowing down training.

thanks to its simplicity, the as reader seems to
be training fast - for example around seven times
faster than the models proposed by chen et al.
(chen et al., 2016). hence the as reader may be
particularly suitable for training on large datasets.
the second challenge is how to generalize the
performance gains from large data to a speci   c tar-
get domain. while there are huge amounts of natu-
ral language data in general, it may not be the case
in the domain where we may want to ultimately
apply our model.

hence we are usually not facing a scenario of
simply using a larger amount of the same training
data, but rather extending training to a related do-
main of data, hoping that some of what the model

documentquestionsoftmax        over words in the documentpobamaq,d=            (                    ,d)        =        +        +5   ..   obama    and     putin                  said   obama    in      praguexxxxx  visited  prague id203 of the answer                        1    |    |    |    |    1   ..   .........recurrentneural networksdot products                      |    |    |    |            probtembeddingsinput text   ..     (obama)    and    (putin)   ..          (said)    (obama)    (in)    (prague)    (xxxxx)    visited    (prague)named entity
test
valid
52.0
na
humans (query) (hill et al., 2015)
81.6
na
humans (context+query) (hill et al., 2015)
41.8
51.2
lstms (context+query) (hill et al., 2015)
66.6
70.4
memory networks (hill et al., 2015)
73.8
68.6
as reader (single model)
as reader (avg ensemble)
70.6
74.5
71.0
as reader (greedy ensemble)
76.2
75.5
71.9
ga reader (ensemble) (dhingra et al., 2016)
71.8
epireader (ensemble) (trischler et al., 2016b) 76.6
72.0
ia reader (ensemble) (sordoni et al., 2016)
76.9
aoa reader (single model) (cui et al., 2016a) 77.8
72.0

common noun
test
valid
64.4
na
81.6
na
62.6
64.2
68.8
71.1
72.4
72.1
73.6
74.1
72.2

63.0
63.4
68.9
67.5
69.4
70.6
71.0
69.4

56.0                                                                                              

as reader (single model)
as reader (greedy ensemble)

80.5
82.3

76.2
78.4

83.2
85.7

table 2: results of various architectures on the cbt test datasets.

cbt
training data

80.8 (cid:27)booktest

83.7

training data

learns on the new data will still help it on the origi-
nal task.

this is highlighted by our observations from
applying a model trained on the booktest to chil-
dren   s book test test data. if we move model train-
ing from joint cbt ne+cn training data9 to a
subset of the booktest of the same size (230k ex-
amples), we see a drop in accuracy of around 10%
on the cbt test datasets.

hence even though the children   s book test
and booktest datasets are almost as close as two
disjoint datasets can get, the transfer is still very
imperfect 10. rightly choosing data to augment
the in-domain training data is certainly a problem
worth exploring in future work.

our results show that given enough data the as
reader was able to exceed the human performance
on cbt cn reported by facebook. however we
hypothesized that the system is still not achieving
its full potential so we decided to examine the room
for improvement in our own small human study.

9note that while here we are using joint cbt ne+cn data
to create an equivalent of a 230k subset of our booktest, for
most experiments on the cbt we and some other teams have
used ne and cn as two separate training datasests.

10this also suggests that the increase in accuracy when
using more data that are strictly in the same domain as the
original training data results in a performance increase even
larger that the one we are reporting on cbt. however the
scenario of having to look for additional data elsewhere is
more realistic, so we are focusing this article in that direction.

7 human study
after adding more data we have the performance
on the cbt validation and test datasets soaring.
however is there still potential for much further
growth beyond the results we have observed?

we decided to explore the remaining space for
improvement on the cbt by testing humans on a
random subset of 50 named entity and 50 common
noun validation questions that the as reader en-
semble could not answer correctly. these questions
were answered by 10 non-native english speakers
from our research laboratory, each on a disjoint
subset of questions.. participants had unlimited
time to answer the questions and were told that
these questions were not correctly answered by a
machine, providing additional motivation to prove
they are better than computers. the results of the
human study are summarized in table 3. they
show that a majority of questions that our system
could not answer so far are in fact answerable. this
suggests that 1) the original human baselines might
have been underestimated, however, it might also
be the case that there are some examples that can
be answered by machines and not by humans; 2)
there is still space for improvement.

a system that would answer correctly every time
when either our ensemble or human answered cor-
rectly would achieve accuracy over 92% percent on
both validation and test ne datasets and over 96%
on both cn datasets. hence it still makes sense to

dataset
named entities
common nouns

% correct answers

66%
82%

table 3: accuracy of human participants on ex-
amples from validation set that were previously
incorrectly answered by our system trained only on
the booktest data.

use cbt dataset to study further improvements of
text-comprehension systems.

8 conclusion

few ways of improving model performance are
as solidly established as using more training data.
yet we believe this principle has been somewhat
neglected by recent research in text comprehen-
sion. while there is a practically unlimited amount
of data available in this    eld, most research was
performed on unnecessarily small datasets.

as a gentle reminder to the community we have
shown that simply infusing a model with more
data can yield performance improvements of up to
14.8% where several attempts to improve the model
architecture on the same training data have given
gains of at most 2.1% compared to our best en-
semble result. yes, experiments on small datasets
certainly can bring useful insights. however we
believe that the community should also embrace
the real-world scenario of data abundance.

the booktest dataset we are proposing gives the
reading-comprehension community an opportunity
to make a step in that direction.

references
[banko and brill2001] michele banko and eric brill.
2001. scaling to very very large corpora for nat-
ural language disambiguation. acl    01 proceed-
ings of the 39th annual meeting on association for
computational linguistics, pages 26   33.

ference of the international speech communication
association, interspeech, pages 2635   2639.

[chen et al.2016] danqi chen,

jason bolton,

and
christopher d. manning. 2016. a thorough ex-
amination of the id98 / daily mail reading com-
prehension task. in association for computational
linguistics (acl).

[cho et al.2014] kyunghyun cho, bart van merrien-
boer, caglar gulcehre, dzmitry bahdanau, fethi
bougares, holger schwenk, and yoshua bengio.
2014. learning phrase representations using id56
encoder-decoder for statistical machine transla-
tion. empirical methods in natural language pro-
cessing (emnlp).

[cui et al.2016a] yiming cui, zhipeng chen, si wei,
shijin wang, ting liu, and guoping hu. 2016a.
attention-over-attention neural networks for read-
ing comprehension.

[cui et al.2016b] yiming cui, ting liu, zhipeng chen,
shijin wang, and guoping hu. 2016b. consensus
attention-based neural networks for chinese read-
ing comprehension.

[dhingra et al.2016] bhuwan dhingra, hanxiao liu,
william w. cohen, and ruslan salakhutdinov. 2016.
gated-attention readers for text comprehension.

[dos santos et al.2016] cicero dos santos, ming tan,
bing xiang, and bowen zhou. 2016. attentive
pooling networks. (cv).

[finkel et al.2005] jenny rose finkel, trond grenager,
and christopher manning. 2005. incorporating non-
local information into information extraction sys-
tems by id150. proceedings of the 43rd
annual meeting on association for computational
linguistics acl 05, 43(june):363   370.

[halevy et al.2009] alon halevy, peter norvig, and fer-
nando pereira. 2009. the unreasonable effective-
ness of data. ieee intelligent systems, 24(2):8   12.

[hermann et al.2015] karl moritz hermann, tomas ko-
cisky, edward grefenstette, lasse espeholt, will
kay, mustafa suleyman, and phil blunsom. 2015.
teaching machines to read and comprehend. in ad-
vances in neural information processing systems,
pages 1684   1692.

[bastien et al.2012] fr  ed  eric bastien, pascal lamblin,
razvan pascanu, james bergstra, ian j. goodfellow,
arnaud bergeron, nicolas bouchard, and yoshua
bengio. 2012. theano: new features and speed im-
provements. deep learning and unsupervised fea-
ture learning nips 2012 workshop.

[hewlett et al.2016] daniel hewlett, alexandre la-
coste, llion jones, illia polosukhin, andrew fan-
drianto, jay han, matthew kelcey, and david berth-
elot. 2016. wiki reading : a novel large-scale
language understanding task over wikipedia. acl
2016, pages 1535   1545.

[chelba et al.2014] ciprian chelba, tomas mikolov,
mike schuster, qi ge, thorsten brants, phillipp
koehn, and tony robinson. 2014. one billion word
benchmark for measuring progress in statistical lan-
guage modeling. proceedings of the annual con-

[hill et al.2015] felix hill, antoine bordes, sumit
chopra, and jason weston. 2015. the goldilocks
reading children   s books with ex-
principle:
arxiv preprint
plicit memory representations.
arxiv:1511.02301.

[jelinek2004] frederick jelinek. 2004. some of my
best friends are linguists applying information
theoretic methods : evaluation of grammar qual-
ity.

[jozefowicz et al.2016] rafal

vinyals, mike schuster, noam shazeer,
yonghui wu.
id38.
machine learning (icml).

oriol
and
exploring the limits of
international conference on

jozefowicz,

2016.

[kadlec et al.2016] rudolf kadlec, martin schmid, on-
dej bajgar, and jan kleindienst. 2016. neural text
understanding with attention sum reader. pro-
ceedings of acl.

[kingma and ba2015] diederik

and
jimmy lei ba.
a method for
stochastic optimization. international conference
on learning representations, pages 1   13.

2015. adam:

p. kingma

[kobayashi et al.2016] sosuke kobayashi, ran tian,
naoaki okazaki, and kentaro inui.
2016. dy-
namic entity representation with max-pooling im-
proves machine reading. proceedings of the north
american chapter of the association for computa-
tional linguistics and human language technolo-
gies (naacl-hlt).

[li et al.2016] peng li, wei li, zhengyan he, xuguang
wang, ying cao, jie zhou, and wei xu.
2016.
dataset and neural recurrent sequence labeling
model for open-domain factoid question answer-
ing.

[mitchell et al.2015] t. mitchell, w. cohen, e. hr-
uschka, p. talukdar, j. betteridge, a. carlson,
b. dalvi, m. gardner, b. kisiel, j. krishnamurthy,
n. lao, k. mazaitis, t. mohamed, n. nakashole,
e. platanios, a. ritter, m. samadi, b. settles,
r. wang, d. wijaya, a. gupta, x. chen, a. saparov,
m. greaves, and j. welling. 2015. never-ending
learning. in proceedings of the twenty-ninth aaai
conference on arti   cial intelligence (aaai-15).

[mostafazadeh et al.2016] nasrin

mostafazadeh,
nathanael chambers, xiaodong he, devi parikh,
dhruv batra, lucy vanderwende, pushmeet kohli,
and james allen.
2016. a corpus and evalu-
ation framework for deeper understanding of
commonsense stories. proceedings of naacl.

[onishi et al.2016] takeshi onishi, hai wang, mohit
bansal, kevin gimpel, and david mcallester. 2016.
who did what: a large-scale person-centered
cloze dataset. (3).

[paperno et al.2016] denis paperno, angeliki lazari-
dou, quan ngoc pham, raffaella bernardi, san-
dro pezzelle, marco baroni, gemma boleda, and
raquel fern. 2016. the lambada dataset : word
prediction requiring a broad discourse context. pro-
ceedings of acl.

[pascanu et al.2012] razvan pascanu, tomas mikolov,
and yoshua bengio. 2012. on the dif   culty of train-
ing recurrent neural networks. proceedings of the
30th international conference on machine learning,
pages 1310   1318.

[rajpurkar et al.2016] pranav rajpurkar, jian zhang,
konstantin lopyrev, and percy liang.
2016.
squad: 100,000+ questions for machine compre-
hension of text. (ii).

[richardson et al.2013] matthew richardson, christo-
pher j c burges, and erin renshaw. 2013. mctest:
a challenge dataset for the open-domain machine
comprehension of text. empirical methods in nat-
ural language processing (emnlp), pages 193   
203.

[saxe et al.2014] andrew m saxe, james l mcclelland,
and surya ganguli. 2014. exact solutions to the
nonlinear dynamics of learning in deep linear neu-
ral networks. international conference on learning
representations.

[shen et al.2016] yelong shen, po-sen huang, jian-
feng gao, and weizhu chen.
2016. reasonet:
learning to stop reading in machine comprehen-
sion.

[sordoni et al.2016] alessandro sordoni, phillip bach-
man, and yoshua bengio. 2016. iterative alternat-
ing neural attention for machine reading.

[taylor1953] wilson l taylor. 1953. cloze procedure:
a new tool for measuring readability. journalism
and mass communication quarterly, 30(4):415.

[toutanova et al.2003] kristina toutanova, dan klein,
and christopher d manning. 2003. feature-rich
part-of-speech tagging with a cyclic dependency net-
work. in proceedings of the 2003 conference of the
north american chapter of the association for com-
putational linguistics on human language technol-
ogy - volume 1 (naacl    03),, pages 252   259.

[trischler et al.2016a] adam trischler, zheng ye,
xingdi yuan,
jing he, phillip bachman, and
kaheer suleman. 2016a. a parallel-hierarchical
model for machine comprehension on sparse data.
proceedings of acl.

[trischler et al.2016b] adam trischler, zheng ye,
xingdi yuan, and kaheer suleman. 2016b. natural
language comprehension with the epireader.

[van merrienboer et al.2015] bart

van merrienboer,
dzmitry bahdanau, vincent dumoulin, dmitriy
serdyuk, david warde-farley,
jan chorowski,
and yoshua bengio.
2015. blocks and fuel :
frameworks for deep learning. pages 1   5.

[weissenborn2016] dirk weissenborn. 2016. separat-
ing answers from queries for neural reading com-
prehension.

dataset
booktest

rec. hid. layer
min max
768
64

best min max
512
384

64

embedding

batch size

rec. layers

best min max
256
128

32

best min max
128

1

3

best
2

table 4: the best hyperparameters and range of values that we tested on the booktest train dataset. we
report number of hidden units of the unidirectional gru; the bidirectional gru has twice as many hidden
units.

eters of the model with best validation accuracy are
summarized in table 4.
our model was

using
theano (bastien et al., 2012) and blocks (van
merrienboer et al., 2015).

implemented

the ensembles were formed by simply averaging
the predictions from the constituent single models.
these single models were selected using the fol-
lowing algorithm.

we started with the best performing model ac-
cording to validation performance. then in each
step we tried adding the best performing model that
had not been previously tried. we kept it in the en-
semble if it did improve its validation performance
and discarded it otherwise. this way we gradually
tried each model once. we call the resulting model
a greedy ensemble. we used the 20, 000 booktest
validation dataset for this procedure.

the algorithm was offered 10 models and se-

lected 5 of them for the    nal ensemble.

appendix a training details

the training details are similar to those in (kadlec
et al., 2016) however we are including them here
for completeness.

to train the model we used stochastic gradient
descent with the adam update rule (kingma and
ba, 2015) and learning rates of 0.0005, 0.0002 and
0.0001. the best learning rate in our experiments
was 0.0005. we minimized negative log-likelihood
as the training objective.

the initial weights in the word-embedding ma-
trix were drawn randomly uniformly from the inter-
val [   0.1, 0.1]. weights in the gru networks were
initialized by random orthogonal matrices (saxe
et al., 2014) and biases were initialized to zero.
we also used a gradient clipping (pascanu et al.,
2012) threshold of 10 and batches of sizes between
32 or 256. increasing the batch from 32 to 128
seems to signi   cantly improve performance on the
large dataset - something we did not observe on the
original cbt data. increasing the batch size much
above 128 is currently dif   cult due to memory con-
straints of the gpu.

during training we randomly shuf   ed all exam-
ples at the beginning of each epoch. to speed up
training, we always pre-fetched 10 batches worth of
examples and sorted them according to document
length. hence each batch contained documents of
roughly the same length.

we also did not use pre-trained word embed-

dings.

we did not perform any text pre-processing since

the datasets were already tokenized.

during training we evaluated the model perfor-
mance every 12 hours and at the end of each epoch
and stopped training when the error on the 20k
booktest validation set started increasing.

we explored the hyperparameter space by train-
ing 67 different models11 the region of the parame-
ter space that we explored together with the param-

11some of these models were trained on data other than the

booktest which were however very similar.

