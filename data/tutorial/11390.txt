using human brain activity to guide machine learning

ruth c. fong,1

3

,

,    walter j. scheirer,2

,

3    david d. cox3   

1department of engineering science, university of oxford

information engineering building, oxford ox1 3pj, united kingdom

2department of computer science and engineering, university of notre dame

fitzpatrick hall of engineering, notre dame, in, 46556, usa

3department of molecular and cellular biology, school of engineering and applied sciences

and center for brain science, harvard university.

52 oxford st., cambridge, ma, 02138, usa

   to whom correspondence should be addressed; e-mail: davidcox@fas.harvard.edu.

   r.c. fong and w.j. scheirer contributed equally to this work.

7
1
0
2

 

p
e
s
9
1

 

 
 
]

v
c
.
s
c
[
 
 

2
v
3
6
4
5
0

.

3
0
7
1
:
v
i
x
r
a

1

abstract

machine learning is a    eld of computer science that builds algorithms that

learn. in many cases, machine learning algorithms are used to recreate a hu-

man ability like adding a caption to a photo, driving a car, or playing a game.

while the human brain has long served as a source of inspiration for machine

learning, little effort has been made to directly use data collected from work-

ing brains as a guide for machine learning algorithms. here we demonstrate

a new paradigm of    neurally-weighted    machine learning, which takes fmri

measurements of human brain activity from subjects viewing images, and in-

fuses these data into the training process of an object recognition learning al-

gorithm to make it more consistent with the human brain. after training, these

neurally-weighted classi   ers are able to classify images without requiring any

additional neural data. we show that our neural-weighting approach can lead

to large performance gains when used with traditional machine vision features,

as well as to signi   cant improvements with already high-performing convolu-

tional neural network features. the effectiveness of this approach points to

a path forward for a new class of hybrid machine learning algorithms which

take both inspiration and direct constraints from neuronal data.

2

introduction

recent years have seen a renaissance in machine learning and machine vision, led by neural

network algorithms that now achieve impressive performance on a variety of challenging object

recognition and image understanding tasks [1, 2, 3]. despite this rapid progress, the perfor-

mance of machine vision algorithms continues to trail humans in many key domains, and tasks

that require operating with limited training data or in highly cluttered scenes are particularly

dif   cult for current algorithms [4, 5, 6, 7]. moreover, the patterns of errors made by today   s

algorithms differ dramatically from those of humans performing the same tasks [8, 9], and cur-

rent algorithms can be    fooled    by subtly altering images in ways that are imperceptible to

humans, but which lead to arbitrary misclassi   cations of objects [10, 11, 12]. thus, even when

algorithms do well on a particular task, they do so in a way that differs from how humans do it

and that is arguably more brittle.

the human brain is a natural frame of reference for machine learning, because it has evolved

to operate with extraordinary ef   ciency and accuracy in complicated and ambiguous environ-

ments. indeed, today   s best algorithms for learning structure in data are arti   cial neural net-

works [13, 14, 15], and strategies for decision making that incorporate cognitive models of

bayesian reasoning [16] and exemplar learning [17] are prevalent. there is also growing over-

lap between machine learning and the    elds of neuroscience and psychology: in one direc-

tion, learning algorithms are used for fmri decoding [18, 19, 20, 21], neural response pre-

diction [22, 23, 24, 25, 26], and hierarchical modeling [27, 28, 29]. concurrently, machine

learning algorithms are also leveraging biological concepts like working memory [30], experi-

ence replay [31], and attention [32, 33] and are being encouraged to borrow more insights from

the inner workings of the human brain [34]. here we propose an even more direct connection

between these    elds: we ask if we can improve machine learning algorithms by explicitly guid-

3

ing their training with measurements of brain activity, with the goal of making the algorithms

more human-like.

phase i:  derive per-stimulus    activity weights    from fmri data

phase ii: 

train image classi   ers 

a.

collect per-stimulus activity
vectors

b.

train classi   er on fmri activity vectors

d. conventional image classi   er training

  stimulus does not 
contain an animal

1

decision boundary

2

.0

0

9

3

4

...
1.4
-0.2
1.1
0.3
-0.9
0.6
...

.9

7

7

5

6

   stimulus contains
a person   

c.

activity weights derived from distance 
to decision boundary

7

3

8

1

2

m

a

r

g

i

n

4

5

6

4

.005

1

.969

5

.009

e.

2

6

.977

8

margins reweighted by activity data

8

3

8

5

1

2

7

.009

4

5

6

m
a
r
g

i

n

.977

stimulus

fmri images

...
1.4
-0.2
1.1
0.3

-0.9
0.6
...

 activity vector

figure 1: experimental work   ow for biologically-informed machine learning using fmri data.
(a) fmri was used to record bold voxel responses of one subject viewing 1, 386 color images
of natural scenes, providing labelled voxels in several conventional, functional rois (i.e., eba,
ffa, lo, ofa, ppa, rsc, and tos) [35]. (b) for a given binary classi   cation task category
(e.g., whether a stimulus contains a person), the visual stimuli and voxel activity data were split
into training and test sets. an id166 classi   er was trained and tested on voxel activity alone. (c)
to generate activity weights, classi   cation scores, which roughly correspond to the distance of
a sample from the decision boundary in (b), were transformed into a id203 value via a
logistic function [36]. (d, e) the effects of using activity weights were assessed by training
and testing two classi   cation models on image features of the visual stimuli: (d) one id166
classi   er used a id168 (e.g., hinge loss [hl]) that equally weights the misclassi   cation
of all samples as a function of distance from the id166   s own decision boundary. (e) another
id166 classi   er used a modi   ed id168 (e.g., activity weighted loss [awl]) that penalizes
more aggressively the misclassi   cation of samples with large activity weights. in training, these
classi   ers in (d) and (e) only had access to activity weights generated in (c); in testing, the
classi   ers used no neural data and made predictions based on image features alone.

4

our strategy is to bias the solution of a machine learning algorithm so that it more closely

matches the internal representations found in visual cortex. previous studies have constrained

learned models via human behavior [8, 37], and one work introduced a method to determine

a mapping from images to    brain-like    features extracted from eeg recordings [38]. further-

more, recent advances in machine learning have focused on improving feature representation,

often in a biologically-consistent way [26], of different kinds of data. however, no study to date

has taken advantage of measurements of brain activity to guide the decision making process of

machine learning. while our understanding of human cognition and decision making is still

limited, we describe a method with which we can leverage the human brain   s robust represen-

tations to guide a machine learning algorithm   s decision boundary. our approach weights how

much an algorithm learns from each training exemplar, roughly based on the    ease    with which

the human brain appears to recognize the example as a member of a class (i.e., an image in a

given object category). this work builds on previous machine learning approaches that weight

training [39, 8], but here we propose to do such weighting using a separate stream of data,

derived from human brain activity.

below, we describe our biologically-informed machine learning paradigm in detail, outline

an implementation of the technique, and present results that demonstrate its potential to learn

more accurate, biologically-consistent decision-making boundaries. we trained supervised clas-

si   cation models in visual object categorization, weighting individual training images by values

derived from fmri recordings in human visual cortex viewing those same images; once trained,

these models classify images without the bene   t of neural data. these models were then evalu-

ated for improvement in baseline performance as well as analyzed to understand which regions

of interest (rois) in the brain had greater impact on performance.

5

results

visual cortical fmri data were taken from a previous study conducted by the gallant lab at

berkeley [35]. one adult subject viewed 1, 386 color 500    500 pixel images of natural scenes,

while being scanned in a 3.0 tesla (3t) magnetic resonance imaging (mri) machine. after

fmri id174, response amplitude values for 67, 600 voxels were available for each

image. from this set of voxels, 3, 569 were labeled as being part of one of thirteen visual rois,

including those in the early visual cortex. seven of these regions associated with higher-level

visual processing were chosen for use in object classi   cation tasks probing the semantic under-

standing of visual information: extrastriate body area (eba), fusiform face area (ffa), lateral

occipital cortex (lo), occiptal face area (ofa), parahippocampal place area (ppa), retrosple-

nial cortex (rsc), transverse occipital sulcus (tos). 1, 427 voxels belonged to these regions.

in machine learning, id168s are used to assign penalties for misclassifying data; then,

the objective of the algorithm is to minimize loss. typically, a hinge id168 (equation 1)

is used for classic maximum-margin binary classi   ers like support vector machine (id166)

models [40]:

  h(z) = max(0, 1     z)

(1)

where z = y   f (x), y     n is the true label, and f (x)     r is the predicted output; thus, z denotes

the correctness of a prediction. the hl function assigns a penalty to all misclassi   ed data that

is proportional to how erroneous the prediction is.

however, incorporating brain data into a machine learning model relies on the assumption

that the intensity of a pattern of activation in a region represents the neuronal response to a

visual stimulus. a strong response signals that a stimulus is easy for a subject to recognize,

while a weaker response indicates that the stimulus is more dif   cult to recognize [41]. here,

the proposed activity weighted loss (awl) function (equation 2) embodies this strategy by

6

proportionally penalizing misclassi   ed training samples based on any inconsistency with the

evidence of human decision making found in the fmri measurements, in addition to using the

typical hl penalty:

where

    (x, z) = max(0, (1     z)    m(x, z))

m(x, z) =(1 + cx,

1,

if z < 1

otherwise

(2)

(3)

and cx     0 is an activity weight derived from fmri data corresponding to x.

a large activity weight cx corresponds to a strong neuronal response pattern to visual stim-

ulus x; thus, awl penalizes more aggressively the misclassi   cation of stimuli that humans

recognize consistently with ease. with this formulation, not all training samples require an

fmri-generated activity weight. note that cx = 0 reduces the awl function to a hl function

and can be assigned to samples for which fmri data is unavailable. awl is inspired by previ-

ous work [8], which introduced a id168 that additively scaled misclassi   cation penalty

by information derived from behavioral data. awl replaces the standard hl function (equa-

tion 1) in the objective of the id166 algorithm, which does not have access to any information

other than a feature vector and an arbitrary class label for each training sample in its original

form.

experiments were conducted for the 127 ways that the seven higher-level visual cortical

regions could be combined. in each experiment, for a given combination of rois and a given

object category, the following procedure was carried out (figure 1): 1. generate activity weights

by calibrating the scores of a radial basis function (rbf) kernel id166 classi   er, trained on the

training voxel data for the combination, into probabilities via a logistic transformation (fig-

ures 1a-1c)

[36]. 2. create    ve balanced classi   cation problems (figure s1). for each

balanced problem and a set of image descriptors, train and test two id166 classi   cation models

with an rbf-kernel     one that used the hl function and another that used an awl function

7

conditioned on the activity weights from the    rst step (figures 1d and 1e). two image fea-

tures were considered: the histogram of oriented gradients (hog) is a handcrafted feature

that is approximately v1-like [42, 43]; convolutional neural networks (id98) are learned fea-

ture representations that approximate several additional layers of the ventral stream [22, 14].

experiments were performed for four object categories: humans, animals, buildings, and foods.

we demonstrate that using activity weights derived from all of the higher visual cortical re-

gions signi   cantly improves classi   cation accuracy across all four object categories via paired,

one-tailed testing (figures 2a and 2b). a substantial amount of fmri decoding literature fo-

cuses on three rois: eba, ffa, and ppa [44, 45, 46]. this is in part because these three regions

are thought to respond to visual cues of interest for the study of object recognition: body parts,

faces, and places respectively. given the overlap between these visual cues and the four ob-

ject categories used, we hypothesized that activity weights derived from brain activity in these

three regions would signi   cantly improve classi   cation accuracy for the humans, animals, and

buildings categories only in instances where a response would be expected. for example, ppa

was expected to improve the buildings category but to have little, if any, effect on the humans

category (figure 2e). a comparison of models that used activity weights based on brain activity

from these three regions and models that used no activity weights aligns with the neuroimag-

ing literature (figures 2c- 2e). classi   cation accuracy signi   cantly improved not only when

activity weights were derived from voxels in all seven rois or from voxels in the individual

eba, ffa, and ppa regions but also when activity weights were derived from voxels in most

of the 127 roi combinations (see figure s2). we observed that adding fmri-derived activity

weights provided a large improvement to models using hog features compared to those using

id98 features (figures 2a and 2b). these results suggest that improvements in decision mak-

ing (e.g., the use of salient activity weights based on brain activity) may be able to compensate

for poor feature representation (e.g., hog features). they also imply that some of the infor-

8

a histogram of gradients (hog) features

b

convolutional neural network (id98) features

 

y
c
a
r
u
c
c
a
n
o
i
t
a
c
   
i
s
s
a
c

l

100%

90%

80%

70%

60%

50%
50%

hinge loss (baseline)

activity weighted loss

**

**

**

**

people

animals

buildings

foods

 

y
c
a
r
u
c
c
a
n
o
i
t
a
c
   
i
s
s
a
c

l

100%

90%

80%

70%

60%

50%
50%

hinge loss (baseline)

activity weighted
loss

**

**

**

**

people

animals

buildings

foods

c eba only

d ffa only

e ppa only

n
o
i
t
c
u
d
e
r
 
r
o
r
r
e
n

 

i
 
t
n
e
c
r
e
p
n
a
e
m

 

40%

30%

20%

10%

0%

-10%

-20%

-30%

**

**

*

people

animals

buildings

foods

n
o
i
t
c
u
d
e
r
 
r
o
r
r
e
n

 

i
 
t
n
e
c
r
e
p
n
a
e
m

 

40%

30%

20%

10%

0%

-10%

-20%

-30%

**

people

animals

buildings

foods

n
o
i
t
c
u
d
e
r
 
r
o
r
r
e
n

 

i
 
t
n
e
c
r
e
p
n
a
e
m

 

40%

30%

20%

10%

0%

-10%

-20%

-30%

**

people

animals

buildings

foods

figure 2: results showing the effect of conditioning classi   cation models for four visual classes
on fmri data during supervised training (see figure 1). (a,b) side-by-side comparisons of the
mean classi   cation accuracy between models that were trained using either (a) hog features
or (b) id98 features and either a hinge loss (hl) or activity weighted loss (awl) function.
these graphs show results of experiments that generated activity weights from seven higher-
level visual rois (i.e., eba, ffa, lo, ofa, ppa, rsc, tos). in all cases, models trained using
awl were signi   cantly better (p < 0.01 via paired, one-tailed t-testing). while using awl loss
reduces misclassi   cation error using both features, it particularly improves the performance of
handcrafted hog features. (c-e) mean error reductions gained by switching from hl to awl
loss when using conditioning classi   es on brain activity from individual rois (i.e., eba, ffa,
or ppa) show that certain areas produce signi   cantly better results for the speci   c categories
they are selective for. error bars are standard error over 20 trials in all cases.

9

mation carried by activity weights may already be latently captured in id98 features. despite

their relatively smaller performance gains, activity weighted classi   ers for id98 features still

demonstrate that the state-of-the-art representation, which is often praised as being inspired by

the mammalian ventral steam, does not fully capture all the salient information embedded in

internal representations of objects in the human brain.

additionally, statistical analysis by permutation was carried out to test whether the above-

average accuracy rates observed in classi   cation experiments for the humans and animals cate-

gories that included eba, as well as in the experiments for the buildings and foods categories

that included ppa, were statistically signi   cant or products of random chance. for each object

category and set of image features, a null distribution with 1, 000, 000 samples was generated.

each sample in the null distribution re   ects how often a random set of 64 roi combinations

would have an above-average classi   cation accuracy. the aim is to test the signi   cance of

individual rois in generating salient activity weights that yield above-average classi   cation

accuracy rates. thus, these samples simulate randomly assigning roi labels to the 127 combi-

nations. if individual rois did not signi   cantly contribute to the above-average accuracy rates

observed, above-average accuracy rates of combinations that include speci   c rois falling near

the mean of the null distribution should be observed. to generate each of the 1, 000, 000 sam-

ples, 64 roi combinations were randomly selected. then, a count was taken of how many of

those 64 randomly selected combinations have a mean classi   cation accuracy that is greater

than that of all 127 sets of experiments corresponding to the 127 total roi combinations. a

sample is normalized by dividing this count by 64. figure 3 and figure s3 show which rois

signi   cantly differed from the respective null distributions for each object category. this analy-

sis more rigorously con   rms the signi   cance of the eba region in improving the classi   cation

accuracy of the humans and animals categories and of the ppa region in improving the accuracy

of the buildings and foods categories. most notably, the eba region dramatically exceeds the

10

analysis of rois (hog)

tos

**
eba

100%

80%

60%

40%

20%

ffa

tos

**
eba

100%

80%

60%

40%

20%

ffa

rsc

lo

rsc

lo

ppa

ofa

ppa

ofa

**
eba

100%

80%

60%

40%

20%

tos

rsc

ffa

tos

*
eba

100%

80%

60%

40%

20%

lo

rsc

lo

humans

animals

buildings

foods

*
ffa

95% conf. interval

ppa
**

ofa
**

ppa
**

ofa
*

figure 3: statistical in   uence of each roi in object classi   cation models using awl and hog
features. in each graph, the fraction of the 64 roi combinations containing a speci   c roi that
had a mean classi   cation accuracy greater than that of all 127 sets of experiments is plotted.
the threshold for the 95% con   dence interval (p < 0.0004) is overlaid, showing which rois
signi   cantly differed from the respective null distribution for each object category. permutation
tests and bonferroni correction (   = 127) were used.

signi   cance thresholds of the null distributions for humans and animals.

discussion

our results provide strong evidence that information measured directly from the human brain

can help a machine learning algorithm make better, more human-like decisions. as such, this

11

work adds to a growing body to literature that suggests that it is possible to leverage addi-

tional    side-stream    data sources to improve machine learning algorithms [8, 47]. however,

while measures of human behavior have been used extensively to guide machine learning via

active learning [48, 49, 50, 51], structured domain knowledge [52], and discriminative feature

identi   cation [53], this study suggests that one can harness measures of the internal represen-

tations employed by the brain to guide machine learning. we argue that this approach opens a

new wealth of opportunities for    ne-grained interaction between machine learning and neuro-

science.

while this work focused on visual object recognition and fmri data, the framework de-

scribed here need not be speci   c to any one sensory modality, neuroimaging technique or su-

pervised machine learning algorithm. indeed, the approach can be applied generally to any

sensory modality, and could even potentially be used to study multisensory integration, with

appropriate data collection. similarly, while fmri has the advantage of measuring patterns of

activity over large regions of the brain, one could also imagine applying our paradigm to neural

data collected using other imaging methods in animals, including techniques that allow single

cell resolution over cortical populations, such as two-photon imaging [54]. such approaches

may allow more    ne-grained constraints to be placed on machine learning, albeit at the expense

of allowing the integration of data from smaller fractions of the brain.

there are several limitations with this    rst instantiation of the paradigm. first, we de-

rived a scalar activity weight from high-dimensional fmri voxel activity. this simple method

yielded impressive performance gains and corresponded well to the notion of ease of recogni-

tion; however, much more meaningful information captured by the human brain is inevitably

being ignored. future biologically-informed machine learning research should focus on the

development and infusion of low-dimensional activity weights, which may not only preserve

more useful data but also reveal other dimensions that are important for various tasks, but are

12

not yet learned by machine learning algorithms or captured in traditional datasets.

similarly, while we demonstrated our biologically-informed paradigm using support vector

machines, there is also    exibility in the choice of the learning algorithm itself. our method can

be applied to any learning algorithm with a loss formulation as well as extended to other tasks

in regression and bayesian id136. an analysis of different algorithms and their baseline

and activity weighted performance could elucidate which algorithms are relatively better at

capturing salient information encoded in the internal representations of the human brain [24].

our paradigm currently requires access to biological data during training time that corre-

sponds to the input data for a given task. for instance, in this work, we used fmri recordings

of human subjects viewing images to guide learning of object categories. extending this work

to new problem domains will require speci   c data from those problem domains, and this will in

turn require either increased sharing of raw neuroimaging data, or close collaboration between

neuroscientists and machine learning researchers. while this investigation used preexisting data

to inform a decision boundary, one could imagine even more targeted collaborations between

neuroscientists and machine learning researchers that tailor data collection to the needs of the

machine learning algorithm. we argue that approaches such as ours provide a framework of

common ground for such collaborations, from which both    elds stand to bene   t.

methods

fmri data acquisition

the fmri data used for the machine learning experiments presented in this paper are a subset

of the overall data from a published study on scene categorization [35]. all fmri data were

collected using a 3t siemens tim trio mr scanner. for the functional data collection for

one subject, a gradient-echo planar imaging sequence, combined with a custom fat saturation

rf pulse, was used. twenty-   ve axial slices covered occipital, occipitoparietal, and occipi-

13

totemporal cortex. each slice had a 234    234mm2    eld of view, 2.60mm slice thickness, and

0.39mm slice gap (matrix size = 104    104; tr = 2, 009.9ms; te = 35ms;    ip angle = 74   ;

voxel size = 2.25    2.25    2.99mm3). the experimental protocol was approved by the uc

berkeley committee for the protection of human subjects. all methods were performed in

accordance with the relevant guidelines and regulations.

data set

the data set consisted of 1, 386 500    500 color images of natural scenes, which the subject

viewed while his brain activity was being recorded. these images were used as both stimuli

for the fmri data collection, and as training data for the machine learning experiments. within

this collection, the training set consisted of 1, 260 images and the testing set of 126 images.

per-pixel object labels in the form of object outlines and semantically meaningful tags were

available for each image. a subset of these labels were mapped to one of    ve object categories:

humans, animals, buildings, foods, and vehicles. for each image and for each of the    ve object

categories, if at least 20% of an image   s original pixel labels were part of a given object category,

that image was tentatively labeled as a positive sample for that category. we sampled 646

images that were labelled with a single object category. there were 219 humans images, 180

animals images, 151 buildings images, 59 foods images, and 37 vehicles images (a category,

due to its small size, that only contributed negative examples).

fmri id174

to perform motion correction, coregistration, and reslicing of functional images, the spm8

package [55] was used. custom matlab [56] software was used to perform all other prepro-

cessing of functional data. to constrain the dimensionality of the fmri data, the time series

recordings for each voxel were reduced to a single response amplitude per image by deconvolv-

14

ing each time course from the stimulus design matrix. see stansbury et al. [35] for additional

details about the fmri data acquisition and preparation that are not directly related to the ma-

chine learning experiments we describe in this work.

fmri activity weight calculation

all of the fmri data were scaled to bring the value of each dimension within the range of [0, 1]

for rbf id166 training. for each voxel, we calculated the minimum and maximum response

amplitude across all 1, 260 original training samples. all voxels for the 646 images used in

our experiments were then scaled using equation 4, where xij is the j-th sample   s response

amplitude for voxel i, ~xi is a 646-dimensional vector with the response amplitudes of all samples

for voxel i, and x   

ij is the j-th sample   s rescaled amplitude for voxel i.

x   
ij =

xij     min ( ~xi)

max ( ~xi)     min ( ~xi)

(4)

the main challenge of generating weights from brain activity (i.e., activity weights) lies in

reducing high-dimensional, nonlinear data to a salient, lower-dimensional signal of    learnabil-

ity.    the supervised machine learning formulation used in this work requires a single real

valued weight per training sample for a id168 (described below). activity weights were

computed by using a logistic transformation [36] to calibrate the scores from id166s with rbf

kernels trained on brain activity. for each object category and for all voxels from a given com-

bination of rois, we made use of all the positive samples for that object category as well as all

the samples that are negative for all object categories; together, these are the aforementioned

646 samples (i.e., clear sample set). only activity weights for this subset of a partition   s training

set, as opposed to annotations for all 1, 386 stimuli were generated. this constraint maximized

the signal-to-noise ratio in the activity weights and improved the saliency of activity weights

for a speci   c object category by only weighting clear positive and negative samples.

15

activity weights for training were generated using a modi   cation of the k-fold cross valida-

tion technique. for a given training set that is a subset of the whole 1, 386 set, the collection of

voxel data for the training set   s images in the 646-stimuli clear sample set was randomly split

into    ve folds. for each of these folds, we held out the current fold as test data and combined

the other four folds as training data. with this newly formed training set, a grid search was

performed to tune the soft margin penalty parameter c and rbf parameter    for an rbf id166

classi   er using the libid166 package [57]. finally, activity weights were generated by testing

the classi   er on the held-out fold to produce platt id203 scores [36] of class inclusion.

this process was repeated for all    ve folds to generate activity weights for the collection of

stimuli in the training set that are part of the clear sample set.

experimental design

each of the original 500    500 colored images were down sampled to 250    250 grayscale

images, with pixel values in the interval [0, 1]. a layer of gaussian noise with a mean of 0 and

variance of 0.01 was added to each of these images. for each image, two feature descriptor types

were independently generated. histogram of oriented gradients (hog) descriptors with a cell

size of 32 were generated using the vlfeat library   s vl hog function [43], which computes

uoctti hog features [58]. convolutional neural network (id98) features were generated

using the caffe library   s blvc reference caffenet model [14], which is alexnet trained on

ilsvrc 2012 [1], with minor differences from the version described by krizhevsky et al. [13].

four partitions of training and test data were created. in each partition, 80% of the data was

randomly designated as training data and the remaining 20% was designated as test data.

for each partition, experiments were conducted for the 127 ways that the seven higher-level

visual cortical regions (i.e., eba, ffa, lo, ofa, ppa, rsc, and tos) could be combined. in

each experiment, for a given combination of higher-level visual cortical regions and for a given

16

object category, two training steps were followed:

1. activity weights were generated for a sampling of training stimuli, ones that are part

of the 646-stimuli clear sample set, using an rbf-kernel id166 classi   er trained on the train-

ing voxel data for that combination, following the fmri activity weight calculation procedure

described above.

2. five balanced classi   cation problems were created from the given partition   s training

data. for each balanced classi   cation problem and each set of image descriptors (hog and

id98 features), two id166 classi   ers were trained and tested     one that uses a standard hinge

loss (hl) function [59] and another that uses a activity weighted loss (awl) function described

by equations 2 & 3. both classi   ers used an rbf-kernel.

the hinge id168 in equation 1 is solved via sequential minimal optimization [60].

it is not necessary to assign an activity weight cx     c derived from fmri data to every training

sample; cx can be 0 to preserve the output of the original hinge id168. in our experiments,

cx     [0, 1], where cx corresponds to the id203 that x is in the object category in question;

this results in penalizing more aggressively the misclassi   cation of strong positive samples. the

libid166 package was used to train and test id166 classi   ers using a hinge id168 [57]. to

train classi   ers using a activity weighted id168, we modi   ed publicly available code for

an alternative additive loss formulation [8].

for each object category, combination of higher visual cortical regions, and set of image

descriptors, we created    ve balanced classi   cation problems. for each problem, we created a

balanced training set with an equal number of positive and negative examples. for all object

categories, because there were more negative than positive samples, all positive samples were

used in the balanced problem and the same number of negative samples were randomly selected.

the balanced problems only balanced the training data; each balanced problem used the same

test set: the partition   s held-out test set.

17

for both id168s, binary id166 classi   ers with rbf kernels were trained without

any parameter tuning, using parameters c = 1 and    = (1/number of features). the activity

weighted id168 incorporates the calibrated id203 scores from the    rst stage voxel

classi   ers as activity weights. we assigned these activity weights to the training samples that

are members of the 646-stimuli clear samples set. for samples without fmri-derived activity

weights, activity weights of 0.0 are used. finally, classi   ers were tested on the partition   s test

set. in experiments using id98 features, rbf-kernel id166 classi   ers converged during training,

even though the vectors consisted of high-dimensional data.

statistics for roi analysis

because our analysis of the in   uence of speci   c rois involves comparing 127 quantities, to

avoid multiple comparisons and to control for the family-wise error rate, bonferroni correction

was applied to adjust all con   dence intervals. to create m individual con   dence intervals with

a collective con   dence interval of 1       , the adjusted con   dence intervals were calculated

calculated via 1     (  /m). with these adjusted con   dence intervals (m = 127,    = 0.05

and    = 0.01), we compared the outputs of the empirical cdf function fx (x) for each null

distribution x that corresponded to an object category and set of image features as well as each

roi.

acknowledgements

the authors would like to thank j. gallant and d. stansbury for providing the fmri data used

in this study, as well as for helpful discussions regarding this work. this work was supported in

part by nsf iis award #1409097, iarpa contract #d16pc00002, and an equipment donation

from the nvidia corporation. r. c. f. was supported in part by the harvard college research

program.

18

author contributions statement

r.c.f., w.j.s., and d.d.c. designed research and wrote the manuscript text; r.c.f. performed

research and prepared all    gures.

additional information

the authors declare no competing    nancial interests.

references and notes

[1] russakovsky, o. et al. id163 large scale visual recognition challenge. ijcv 115, 1   42

(2014).

[2] karpathy, a. et al. large-scale video classi   cation with convolutional neural networks. in

ieee cvpr (2014).

[3] karpathy, a. & fei-fei, l. deep visual-semantic alignments for generating image de-

scriptions. in ieee cvpr (2015).

[4] borji, a., sihite, d. n. & itti, l. quantitative analysis of human-model agreement in

visual saliency modeling: a comparative study. ieee t-ip 22, 55   69 (2013).

[5] borji, a. & itti, l. human vs. computer in scene and object recognition. in ieee cvpr

(2014).

[6] bendale, a. & boult, t. towards open world recognition. in ieee cvpr (2015).

[7] hoiem, d., chodpathumwan, y. & dai, q. diagnosing error in object detectors. in eccv

(2012).

19

[8] scheirer, w. j. & et al. perceptual annotation: measuring human vision to improve com-

puter vision. ieee t-pami 36, 1679   1686 (2014).

[9] pramod, r. & arun, s. do computational models differ systematically from human object

perception? in ieee cvpr (2016).

[10] szegedy, c. & et al. intriguing properties of neural networks. in iclr (2014).

[11] goodfellow, i., shlens, j. & szegedy, c. explaining and harnessing adversarial examples.

in iclr (2015).

[12] nguyen, a., yosinski, j. & clune, j. deep neural networks are easily fooled: high con   -

dence predictions for unrecognizable images. in ieee cvpr (2015).

[13] krizhevsky, a., sutskever, i. & hinton, g. e. id163 classi   cation with deep convolu-

tional neural networks. in nips (2012).

[14] jia, y. & et al. caffe: convolutional architecture for fast feature embedding. corr

abs/1408.5093 (2014). url http://arxiv.org/abs/1408.5093.

[15] mnih, v. & et al. human-level control through deep id23. nature 518,

529   533 (2015).

[16] tenenbaum, j. b., grif   ths, t. l. & kemp, c. theory-based bayesian models of inductive

learning and reasoning. trends in cog. sci. 10, 309   318 (2006).

[17] j  akel, f. & et al. does cognitive science need kernels? trends in cog. sci. 13, 381   388

(2009).

[18] kay, k. & et al. identifying natural images from human brain activity. nature 452, 352   

355 (2008).

20

[19] mitchell, t. m. & et al. predicting human brain activity associated with the meanings of

nouns. science 320, 1191   1195 (2008).

[20] naselaris, t. & et al. bayesian reconstruction of natural images from human brain activity.

neuron 63, 902   915 (2009).

[21] reddy, l., tsuchiya, n. & serre, t. reading the mind   s eye: decoding category informa-

tion during mental imagery. neuroimage 50, 818   825 (2010).

[22] yamins, d. & et al. hierarchical modular optimization of convolutional networks achieves

representations similar to macaque it and human ventral stream.

in nips, 3093   3101

(2013).

[23] yamins, d. & et al. performance-optimized id187 predict neural responses

in higher visual cortex. pnas 111, 8619   8624 (2014).

[24] kriegeskorte, n., mur, m. & bandettini, p. representational similarity analysis   

connecting the branches of systems neuroscience. front. in sys. neuro. 2 (2008).

[25] agrawal, p. & et al. pixels to voxels: modeling visual representation in the human brain.

arxiv:1407.5104 (2014).

[26] cichy, r. m., khosla, a., pantazis, d., torralba, a. & oliva, a. deep neural networks

predict hierarchical spatio-temporal cortical dynamics of human visual object recognition.

arxiv preprint arxiv:1601.02970 (2016).

[27] riesenhuber, m. & poggio, t. id187 of object recognition in cortex. nature

neuroscience 2, 1019   1025 (1999).

[28] serre, t., oliva, a. & poggio, t. a feedforward architecture accounts for rapid catego-

rization. pnas 104, 6424   6429 (2007).

21

[29] pinto, n. & et al. a high-throughput screening approach to discovering good forms of

biologically inspired visual representation. plos computational biology 5 (2009).

[30] graves, a. et al. hybrid computing using a neural network with dynamic external memory.

nature 538, 471   476 (2016).

[31] mnih, v. et al. human-level control through deep id23. nature 518,

529   533 (2015).

[32] gregor, k., danihelka, i., graves, a., rezende, d. j. & wierstra, d. draw: a recurrent

neural network for image generation. arxiv preprint arxiv:1502.04623 (2015).

[33] xu, k. et al. show, attend and tell: neural image id134 with visual attention.

arxiv preprint arxiv:1502.03044 2, 5 (2015).

[34] lake, b. m., ullman, t. d., tenenbaum, j. b. & gershman, s. j. building machines that

learn and think like people. arxiv preprint arxiv:1604.00289 (2016).

[35] stansbury, d., naselaris, t. & gallant, j. l. natural scene statistics account for the repre-

sentation of scene categories in human visual cortex. neuron 79, 1025   1034 (2013).

[36] platt, j. probabilistic outputs for support vector machines and comparison to regularized

likelihood methods. in smola, a., bartlett, p. & sch  olkopf, b. (eds.) advances in large

margin classi   ers (mit press, 2000).

[37] chen, d., li, s., kourtzi, z. & wu, s. behavior-constrained support vector machines for

fmri data analysis. ieee t-nn 21, 1680   1685 (2010).

[38] spampinato, c. et al. deep learning human mind for automated visual classi   cation. arxiv

preprint arxiv:1609.00344 (2016).

22

[39] bengio, y., louradour, j., collobert, r. & weston, j. curriculum learning. in proceedings

of the 26th annual international conference on machine learning, 41   48 (acm, 2009).

[40] cortes, c. & vapnik, v. support-vector networks. machine learning 20, 273   297 (1995).

[41] gauthier, i. & et al. expertise for cars and birds recruits brain areas involved in face

recognition. nature neuroscience 3, 191   197 (2000).

[42] dalal, n. & triggs, b. histograms of oriented gradients for human detection. in ieee

cvpr (2005).

[43] vedaldi, a. & fulkerson, b. vlfeat: an open and portable library of id161

algorithms. http://www.vlfeat.org/ (2008).

[44] cox, d. d. & savoy, r. l. functional magnetic resonance imaging (fmri) brain reading:

detecting and classifying distributed patterns of fmri activity in human visual cortex.

neuroimage 19, 261   270 (2003).

[45] kriegeskorte, n. & et al. individual faces elicit distinct response patterns in human anterior

temporal cortex. pnas 104, 20600   20605 (2007).

[46] spiridon, m., fischl, b. & kanwisher., n. location and spatial pro   le of category-speci   c

regions in human extrastriate cortex. hum. brain mapp. 27, 77   89 (2006).

[47] vondrick, c., pirsiavash, h., oliva, a. & torralba, a. acquiring visual classi   ers from

human imagination. arxiv preprint arxiv:1410.4627 (2014).

[48] cohn, d. a., ghahramani, z. & jordan, m. i. active learning with statistical models.

journal of arti   cial intelligence research 4 (1996).

23

[49] kapoor, a., grauman, k., urtasun, r. & darrell, t. active learning with gaussian pro-

cesses for object categorization. in ieee iccv (2007).

[50] jain, p. & kapoor, a. active learning for large multi-class problems.

in ieee cvpr

(2009).

[51] settles, b. active learning literature survey. university of wisconsin, madison 52, 11

(2010).

[52] kunapuli, g., maclin, r. & shavlik, j. w. advice re   nement in knowledge-based id166s.

in nips, 1728   1736 (2011).

[53] deng, j., krause, j., stark, m. & fei-fei, l. leveraging the wisdom of the crowd for

   ne-grained recognition. ieee t-pami 38, 666   676 (2016).

[54] ohki, k. & reid, r. c. in vivo two-photon calcium imaging in the visual system. cold

spring harbor protocols 2014, pdb   prot081455 (2014).

[55] university college, london, uk.

statistical parametric mapping (spm) version 8.

http://www.fil.ion.ucl.ac.uk/spm/software/spm8/ (2009).

[56] mathworks. matlab, r2010a (2010).

[57] chang, c.-c. & lin, c.-j. libid166: a library for support vector machines. acm trans-

actions on intelligent systems and technology 2, 27:1   27:27 (2011). software available

at http://www.csie.ntu.edu.tw/  cjlin/libid166.

[58] felzenszwalb, p. f. & et al. id164 with discriminatively trained part-based

models. ieee t-pami 32, 1627   1645 (2010).

24

[59] evgeniou, t., pontil, m. & poggio, t. id173 networks and support vector ma-

chines. in smola, a., bartlett, p. & sch  olkopf, b. (eds.) advances in large margin clas-

si   ers (mit press, 2000).

[60] platt, j. fast training of support vector machines using sequential minimal optimization.

in advances in kernel methods - support vector learning (mit press, 1998).

25

