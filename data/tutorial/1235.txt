notes on id203

peter j. cameron

ii

preface

here are the course lecture notes for the course mas108, id203 i, at queen
mary, university of london, taken by most mathematics students and some others
in the    rst semester.

the description of the course is as follows:

this course introduces the basic notions of id203 theory and de-
velops them to the stage where one can begin to use probabilistic
ideas in statistical id136 and modelling, and the study of stochastic
processes. id203 axioms. id155 and indepen-
dence. discrete random variables and their distributions. continuous
distributions. joint distributions. independence. expectations. mean,
variance, covariance, correlation. limiting distributions.

the syllabus is as follows:

1. basic notions of id203. sample spaces, events, relative frequency,

id203 axioms.

2. finite sample spaces. methods of enumeration. combinatorial id203.

3. id155. theorem of total id203. id47.

4. independence of two events. mutual independence of n events. sampling

with and without replacement.

5. random variables. univariate distributions - discrete, continuous, mixed.
standard distributions - hypergeometric, binomial, geometric, poisson, uni-
form, normal, exponential. id203 mass function, density function, dis-
tribution function. probabilities of events in terms of random variables.

6. transformations of a single random variable. mean, variance, median,

quantiles.

7. joint distribution of two random variables. marginal and conditional distri-

butions. independence.

iii

iv

8. covariance, correlation. means and variances of linear functions of random

variables.

9. limiting distributions in the binomial case.

these course notes explain the naterial in the syllabus. they have been       eld-
tested    on the class of 2000. many of the examples are taken from the course
homework sheets or past exam papers.

set books the notes cover only material in the id203 i course. the text-
books listed below will be useful for other courses on id203 and statistics.
you need at most one of the three textbooks listed below, but you will need the
statistical tables.

    id203 and statistics for engineering and the sciences by jay l. de-

vore (   fth edition), published by wadsworth.

chapters 2   5 of this book are very close to the material in the notes, both in
order and notation. however, the lectures go into more detail at several points,
especially proofs.
if you    nd the course dif   cult then you are advised to buy
this book, read the corresponding sections straight after the lectures, and do extra
exercises from it.

other books which you can use instead are:
    id203 and statistics in engineering and management science by w. w.

hines and d. c. montgomery, published by wiley, chapters 2   8.

    mathematical statistics and data analysis by john a. rice, published by

wadsworth, chapters 1   4.

you should also buy a copy of
    new cambridge statistical tables by d. v. lindley and w. f. scott, pub-

lished by cambridge university press.

you need to become familiar with the tables in this book, which will be provided
for you in examinations. all of these books will also be useful to you in the
courses statistics i and statistical id136.

the next book is not compulsory but introduces the ideas in a friendly way:
    taking chances: winning with id203, by john haigh, published by

oxford university press.

v

web resources course material for the mas108 course is kept on the web at
the address

http://www.maths.qmw.ac.uk/  pjc/mas108/

this includes a preliminary version of these notes, together with coursework
sheets, test and past exam papers, and some solutions.

other web pages of interest include

http://www.dartmouth.edu/  chance/teaching aids/
books articles/id203 book/pdf.html

a textbook introduction to id203, by charles m. grinstead and j. laurie
snell, available free, with many exercises.

http://www.math.uah.edu/stat/

the virtual laboratories in id203 and statistics, a set of web-based resources
for students and teachers of id203 and statistics, where you can run simula-
tions etc.

http://www.newton.cam.ac.uk/wmy2kposters/july/

the birthday paradox (poster in the london underground, july 2000).

http://www.combinatorics.org/surveys/ds5/vennejc.html

an article on venn diagrams by frank ruskey, with history and many nice pic-
tures.

web pages for other queen mary maths courses can be found from the on-line

version of the maths undergraduate handbook.

peter j. cameron
december 2000

vi

contents

1 basic ideas

. . . . . . . . . . . . . . . . . . . . . . .
1.1 sample space, events .
. . . . . . . . . . . . . . . . . . . . . .
.
1.2 what is id203? .
.
.
. . . . . . . . . . . . . . . . . . . . . .
1.3 kolmogorov   s axioms
1.4 proving things from the axioms . . . . . . . . . . . . . . . . . . .
1.5
inclusion-exclusion principle . . . . . . . . . . . . . . . . . . . .
1.6 other results about sets . . . . . . . . . . . . . . . . . . . . . . .
.
1.7 sampling .
. . . . . . . . . . . . . . . . . . . . . . .
.
.
1.8 stopping rules .
. . . . . . . . . . . . . . . . . . . . . .
.
. . . . . . . . . . . . . . . . . . . . . . .
1.9 questionnaire results .
1.10 independence .
.
.
. . . . . . . . . . . . . . . . . . . . . .
1.11 mutual independence .
. . . . . . . . . . . . . . . . . . . . . . .
1.12 properties of independence . . . . . . . . . . . . . . . . . . . . .
1.13 worked examples .
. . . . . . . . . . . . . . . . . . . . . .

. .

.
.

.
.

.
.

.

.

.

.

.

2 id155

.

.

.

. .

. .

2.1 what is id155? . . . . . . . . . . . . . . . . . .
2.2 genetics . .
. . . . . . . . . . . . . . . . . . . . . .
2.3 the theorem of total id203 . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . .
2.4 sampling revisited .
2.5 bayes    theorem . .
.
. . . . . . . . . . . . . . . . . . . . . .
iterated id155 . . . . . . . . . . . . . . . . . . .
2.6
. . . . . . . . . . . . . . . . . . . . . .
2.7 worked examples .

.
.

.
.

.

.

.

3 random variables

3.1 what are random variables?
. . . . . . . . . . . . . . . . . . . .
3.2 id203 mass function . . . . . . . . . . . . . . . . . . . . . .
3.3 expected value and variance . . . . . . . . . . . . . . . . . . . .
3.4
joint p.m.f. of two random variables . . . . . . . . . . . . . . . .
3.5 some discrete random variables
. . . . . . . . . . . . . . . . . .
3.6 continuous random variables . . . . . . . . . . . . . . . . . . . .

vii

1
1
3
3
4
6
7
8
12
13
14
16
17
20

23
23
25
26
28
29
31
34

39
39
40
41
43
47
55

viii

contents

3.7 median, quartiles, percentiles . . . . . . . . . . . . . . . . . . . .
3.8 some continuous random variables . . . . . . . . . . . . . . . . .
3.9 on using tables . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.10 worked examples . . . . . . . . . . . . . . . . . . . . . . . . . .

4 more on joint distribution

4.1 covariance and correlation . . . . . . . . . . . . . . . . . . . . .
4.2 conditional random variables . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . .
4.3
joint distribution of continuous r.v.s
4.4 transformation of random variables
. . . . . . . . . . . . . . . .
4.5 worked examples . . . . . . . . . . . . . . . . . . . . . . . . . .

a mathematical notation

b id203 and random variables

57
58
61
63

67
67
70
73
74
77

79

83

chapter 1

basic ideas

in this chapter, we don   t really answer the question    what is id203?    no-
body has a really good answer to this question. we take a mathematical approach,
writing down some basic axioms which id203 must satisfy, and making de-
ductions from these. we also look at different kinds of sampling, and examine
what it means for events to be independent.

1.1 sample space, events

the general setting is: we perform an experiment which can have a number of
different outcomes. the sample space is the set of all possible outcomes of the
experiment. we usually call it s.

it is important to be able to list the outcomes clearly. for example, if i plant

ten bean seeds and count the number that germinate, the sample space is

s = {0,1,2,3,4,5,6,7,8,9,10}.

if i toss a coin three times and record the result, the sample space is
s = {hhh,hht,ht h,ht t,t hh,t ht,t t h,t t t},

where (for example) ht h means    heads on the    rst toss, then tails, then heads
again   .

in the beans example, it is most unlikely.

sometimes we can assume that all the outcomes are equally likely. (don   t
assume this unless either you are told to, or there is some physical reason for
assuming it.
in the coins example,
the assumption will hold if the coin is    fair   : this means that there is no physical
reason for it to favour one side over the other.) if all outcomes are equally likely,
then each has id203 1/|s|. (remember that |s| is the number of elements in
the set s).

1

2

chapter 1. basic ideas

on this point, albert einstein wrote, in his 1905 paper on a heuristic point
of view concerning the production and transformation of light (for which he was
awarded the nobel prize),

in calculating id178 by molecular-theoretic methods, the word    prob-
ability    is often used in a sense differing from the way the word is
de   ned in id203 theory. in particular,    cases of equal probabil-
ity    are often hypothetically stipulated when the theoretical methods
employed are de   nite enough to permit a deduction rather than a stip-
ulation.

in other words: don   t just assume that all outcomes are equally likely, especially
when you are given enough information to calculate their probabilities!

an event is a subset of s. we can specify an event by listing all the outcomes
that make it up. in the above example, let a be the event    more heads than tails   
and b the event    heads on last throw   . then

a = {hhh,hht,ht h,t hh},
b = {hhh,ht h,t hh,t t h}.

the id203 of an event is calculated by adding up the probabilities of all
the outcomes comprising that event. so, if all outcomes are equally likely, we
have

p(a) =

|a|
|s|.

in our example, both a and b have id203 4/8 = 1/2.

an event is simple if it consists of just a single outcome, and is compound
otherwise. in the example, a and b are compound events, while the event    heads
on every throw    is simple (as a set, it is {hhh}). if a = {a} is a simple event,
then the id203 of a is just the id203 of the outcome a, and we usually
write p(a), which is simpler to write than p({a}). (note that a is an outcome,
while {a} is an event, indeed a simple event.)
we can build new events from old ones:
    a    b (read    a union b   ) consists of all the outcomes in a or in b (or both!)
    a    b (read    a intersection b   ) consists of all the outcomes in both a and b;
    a\ b (read    a minus b   ) consists of all the outcomes in a but not in b;
    a0 (read    a complement   ) consists of all outcomes not in a (that is, s \ a);
    /0 (read    empty set   ) for the event which doesn   t contain any outcomes.

1.2. what is id203?

3

note the backward-sloping slash; this is not the same as either a vertical slash | or
a forward slash /.
in the example, a0 is the event    more tails than heads   , and a    b is the event
{hhh,t hh,ht h}. note that p(a    b) = 3/8; this is not equal to p(a)   p(b),
despite what you read in some books!

1.2 what is id203?

there is really no answer to this question.

some people think of it as    limiting frequency   . that is, to say that the proba-
bility of getting heads when a coin is tossed means that, if the coin is tossed many
times, it is likely to come down heads about half the time. but if you toss a coin
1000 times, you are not likely to get exactly 500 heads. you wouldn   t be surprised
to get only 495. but what about 450, or 100?

some people would say that you can work out id203 by physical argu-
ments, like the one we used for a fair coin. but this argument doesn   t work in all
cases, and it doesn   t explain what id203 means.

some people say it is subjective. you say that the id203 of heads in a
coin toss is 1/2 because you have no reason for thinking either heads or tails more
likely; you might change your view if you knew that the owner of the coin was a
magician or a con man. but we can   t build a theory on something subjective.

we regard id203 as a mathematical construction satisfying some axioms
(devised by the russian mathematician a. n. kolmogorov). we develop ways of
doing calculations with id203, so that (for example) we can calculate how
unlikely it is to get 480 or fewer heads in 1000 tosses of a fair coin. the answer
agrees well with experiment.

1.3 kolmogorov   s axioms

remember that an event is a subset of the sample space s. a number of events,
say a1,a2, . . ., are called mutually disjoint or pairwise disjoint if ai     a j = /0 for
any two of the events ai and a j; that is, no two of the events overlap.

according to kolmogorov   s axioms, each event a has a id203 p(a),

which is a number. these numbers satisfy three axioms:
axiom 1: for any event a, we have p(a)     0.

axiom 2: p(s) = 1.

4

chapter 1. basic ideas

axiom 3: if the events a1,a2, . . . are pairwise disjoint, then

p(a1     a2          ) = p(a1) + p(a2) +      

note that in axiom 3, we have the union of events and the sum of numbers.
don   t mix these up; never write p(a1)    p(a2), for example. sometimes we sep-
arate axiom 3 into two parts: axiom 3a if there are only    nitely many events
a1,a2, . . . ,an, so that we have

p(a1              an) =

n

   

i=1

p(ai),

and axiom 3b for in   nitely many. we will only use axiom 3a, but 3b is important
later on.

notice that we write

n

   

i=1

p(ai)

for

p(a1) + p(a2) +       + p(an).

1.4 proving things from the axioms

you can prove simple properties of id203 from the axioms. that means,
every step must be justi   ed by appealing to an axiom. these properties seem
obvious, just as obvious as the axioms; but the point of this game is that we assume
only the axioms, and build everything else from that.

here are some examples of things proved from the axioms. there is really no
difference between a theorem, a proposition, and a corollary; they all have to be
proved. usually, a theorem is a big, important statement; a proposition a rather
smaller statement; and a corollary is something that follows quite easily from a
theorem or proposition that came before.

proposition 1.1 if the event a contains only a    nite number of outcomes, say
a = {a1,a2, . . . ,an}, then

p(a) = p(a1) + p(a2) +       + p(an).

to prove the proposition, we de   ne a new event ai containing only the out-
come ai, that is, ai = {ai}, for i = 1, . . . ,n. then a1, . . . ,an are mutually disjoint

1.4. proving things from the axioms
5
(each contains only one element which is in none of the others), and a1     a2    
          an = a; so by axiom 3a, we have

p(a) = p(a1) + p(a2) +       + p(an).

corollary 1.2 if the sample space s is    nite, say s = {a1, . . . ,an}, then

p(a1) + p(a2) +       + p(an) = 1.

for p(a1) + p(a2) +       + p(an) = p(s) by proposition 1.1, and p(s) = 1 by
axiom 2. notice that once we have proved something, we can use it on the same
basis as an axiom to prove further facts.

now we see that, if all the n outcomes are equally likely, and their probabil-
ities sum to 1, then each has id203 1/n, that is, 1/|s|. now going back to
proposition 1.1, we see that, if all outcomes are equally likely, then

p(a) =

|a|
|s|

for any event a, justifying the principle we used earlier.
proposition 1.3 p(a0) = 1    p(a) for any event a.

let a1 = a and a2 = a0 (the complement of a). then a1     a2 = /0 (that is, the

events a1 and a2 are disjoint), and a1     a2 = s. so
p(a1) + p(a2) = p(a1     a2)

= p(s)
= 1

(axiom 3)

(axiom 2).

so p(a) = p(a1) = 1    p(a2).
corollary 1.4 p(a)     1 for any event a.

for 1    p(a) = p(a0) by proposition 1.3, and p(a0)     0 by axiom 1; so 1   

p(a)     0, from which we get p(a)     1.

remember that if you ever calculate a id203 to be less than 0 or more

than 1, you have made a mistake!

corollary 1.5 p(/0) = 0.

for /0 = s0, so p(/0) = 1    p(s) by proposition 1.3; and p(s) = 1 by axiom 2,

so p(/0) = 0.

6

chapter 1. basic ideas

here is another result. the notation a     b means that a is contained in b, that

is, every outcome in a also belongs to b.
proposition 1.6 if a     b, then p(a)     p(b).

this time, take a1 = a, a2 = b\ a. again we have a1     a2 = /0 (since the
elements of b\ a are, by de   nition, not in a), and a1     a2 = b. so by axiom 3,

p(a1) + p(a2) = p(a1     a2) = p(b).

in other words, p(a) + p(b\ a) = p(b). now p(b\ a)     0 by axiom 1; so

p(a)     p(b),

as we had to show.

1.5

inclusion-exclusion principle 
 
 
 
 
 
 
 a

b

a venn diagram for two sets a and b suggests that, to    nd the size of a    b,
we add the size of a and the size of b, but then we have included the size of a    b
twice, so we have to take it off. in terms of id203:

proposition 1.7

p(a    b) = p(a) + p(b)    p(a    b).

we now prove this from the axioms, using the venn diagram as a guide. we

see that a    b is made up of three parts, namely
a2 = a\ b,

a1 = a    b,

a3 = b\ a.

indeed we do have a    b = a1     a2     a3, since anything in a    b is in both these
sets or just the    rst or just the second. similarly we have a1   a2 = a and a1   a3 =
b.
the sets a1,a2,a3 are mutually disjoint. (we have three pairs of sets to check.
now a1     a2 = /0, since all elements of a1 belong to b but no elements of a2 do.
the arguments for the other two pairs are similar     you should do them yourself.)

1.6. other results about sets

7

so, by axiom 3, we have

p(a) = p(a1) + p(a2),
p(b) = p(a1) + p(a3),

p(a    b) = p(a1) + p(a2) + p(a3).

from this we obtain

p(a) + p(b)    p(a    b) = (p(a1) + p(a2)) + (p(a1) + p(a3))    p(a1)

= p(a1) + p(a2) + p(a3)
= p(a    b)

as required.

the inclusion-exclusion principle extends to more than two events, but gets

more complicated. here it is for three events; try to prove it yourself.

 
 
 
 
 
 
 
 
 
 
 
 

c

a

b

to calculate p(a    b   c), we    rst add up p(a), p(b), and p(c). the parts in
common have been counted twice, so we subtract p(a   b), p(a   c) and p(b   c).
but then we    nd that the outcomes lying in all three sets have been taken off
completely, so must be put back, that is, we add p(a    b   c).
proposition 1.8 for any three events a,b,c, we have
p(a   b   c) = p(a)+p(b)+p(c)   p(a   b)   p(a   c)   p(b   c)+p(a   b   c).

can you extend this to any number of events?

1.6 other results about sets

there are other standard results about sets which are often useful in id203
theory. here are some examples.
proposition 1.9 let a,b,c be subsets of s.
distributive laws: (a    b)   c = (a   c)    (b   c) and

(a    b)   c = (a   c)    (b   c).

de morgan   s laws: (a    b)0 = a0     b0 and (a    b)0 = a0     b0.

we will not give formal proofs of these. you should draw venn diagrams and

convince yourself that they work.

8
1.7 sampling

chapter 1. basic ideas

i have four pens in my desk drawer; they are red, green, blue, and purple. i draw a
pen; each pen has the same chance of being selected. in this case, s ={r,g,b,p},
where r means    red pen chosen    and so on. in this case, if a is the event    red or
green pen chosen   , then

p(a) =

|a|
|s| =

2
4

=

1
2

.

more generally, if i have a set of n objects and choose one, with each one
equally likely to be chosen, then each of the n outcomes has id203 1/n, and
an event consisting of m of the outcomes has id203 m/n.

what if we choose more than one pen? we have to be more careful to specify

the sample space.

first, we have to say whether we are
    sampling with replacement, or
    sampling without replacement.

sampling with replacement means that we choose a pen, note its colour, put
it back and shake the drawer, then choose a pen again (which may be the same
pen as before or a different one), and so on until the required number of pens have
been chosen. if we choose two pens with replacement, the sample space is

{rr, rg, rb, rp,
gr, gg, gb, gp,
br, bg, bb, bp,
pr, pg, pb, pp}

the event    at least one red pen    is {rr,rg,rb,rp,gr,br,pr}, and has proba-
bility 7/16.

sampling without replacement means that we choose a pen but do not put it
back, so that our    nal selection cannot include two pens of the same colour. in
this case, the sample space for choosing two pens is

{
gr,
br, bg,
pr, pg, pb

rg, rb, rp,
gb, gp,
bp,
}

and the event    at least one red pen    is {rg,rb,rp,gr,br,pr}, with id203
6/12 = 1/2.

1.7. sampling

9

now there is another issue, depending on whether we care about the order in
which the pens are chosen. we will only consider this in the case of sampling
without replacement. it doesn   t really matter in this case whether we choose the
pens one at a time or simply take two pens out of the drawer; and we are not
interested in which pen was chosen    rst. so in this case the sample space is

{{r,g},{r,b},{r,p},{g,b},{g,p},{b,p}},

containing six elements. (each element is written as a set since, in a set, we don   t
care which element is    rst, only which elements are actually present. so the sam-
ple space is a set of sets!) the event    at least one red pen    is {{r,g},{r,b},{r,p}},
with id203 3/6 = 1/2. we should not be surprised that this is the same as in
the previous case.

there are formulae for the sample space size in these three cases. these in-

volve the following functions:

n! = n(n    1)(n    2)      1
npk = n(n    1)(n    2)      (n    k + 1)
nck = npk/k!

note that n! is the product of all the whole numbers from 1 to n; and

so that

npk =

n!

(n    k)!

,

nck =

n!

k!(n    k)!

.

theorem 1.10 the number of selections of k objects from a set of n objects is
given in the following table.

with replacement without replacement

ordered sample
unordered sample
in fact the number that goes in the empty box is n+k   1ck, but this is much

npk
nck

nk

harder to prove than the others, and you are very unlikely to need it.

here are the proofs of the other three cases. first, for sampling with replace-
ment and ordered sample, there are n choices for the    rst object, and n choices
for the second, and so on; we multiply the choices for different objects. (think of
the choices as being described by a branching tree.) the product of k factors each
equal to n is nk.

10

chapter 1. basic ideas

for sampling without replacement and ordered sample, there are still n choices
for the    rst object, but now only n    1 choices for the second (since we do not
replace the    rst), and n    2 for the third, and so on; there are n    k + 1 choices for
the kth object, since k    1 have previously been removed and n    (k    1) remain.
as before, we multiply. this product is the formula for npk.

for sampling without replacement and unordered sample, think    rst of choos-
ing an ordered sample, which we can do in npk ways. but each unordered sample
could be obtained by drawing it in k! different orders. so we divide by k!, obtain-
ing npk/k! = nck choices.

in our example with the pens, the numbers in the three boxes are 42 = 16,
4p2 = 12, and 4c2 = 6, in agreement with what we got when we wrote them all
out.

note that, if we use the phrase    sampling without replacement, ordered sam-
ple   , or any other combination, we are assuming that all outcomes are equally
likely.

example the names of the seven days of the week are placed in a hat. three
names are drawn out; these will be the days of the id203 i lectures. what is
the id203 that no lecture is scheduled at the weekend?

here the sampling is without replacement, and we can take it to be either
ordered or unordered; the answers will be the same. for ordered samples, the
size of the sample space is 7p3 = 7   6   5 = 210. if a is the event    no lectures at
weekends   , then a occurs precisely when all three days drawn are weekdays; so
|a| = 5p3 = 5   4   3 = 60. thus, p(a) = 60/210 = 2/7.

if we decided to use unordered samples instead, the answer would be 5c3/7c3,

which is once again 2/7.

example a six-sided die is rolled twice. what is the id203 that the sum of
the numbers is at least 10?

this time we are sampling with replacement, since the two numbers may be
the same or different. so the number of elements in the sample space is 62 = 36.
to obtain a sum of 10 or more, the possibilities for the two numbers are (4,6),
(5,5), (6,4), (5,6), (6,5) or (6,6). so the id203 of the event is 6/36 = 1/6.

example a box contains 20 balls, of which 10 are red and 10 are blue. we draw
ten balls from the box, and we are interested in the event that exactly 5 of the balls
are red and 5 are blue. do you think that this is more likely to occur if the draws
are made with or without replacement?

let s be the sample space, and a the event that    ve balls are red and    ve are

blue.

1.7. sampling

11
consider sampling with replacement. then |s| = 2010. what is |a|? the
number of ways in which we can choose    rst    ve red balls and then    ve blue ones
(that is, rrrrrbbbbb), is 105  105 = 1010. but there are many other ways to get
   ve red and    ve blue balls. in fact, the    ve red balls could appear in any    ve of
the ten draws. this means that there are 10c5 = 252 different patterns of    ve rs
and    ve bs. so we have

|a| = 252   1010,

and so

p(a) =

252   1010

2010 = 0.246 . . .

now consider sampling without replacement. if we regard the sample as being
ordered, then |s| = 20p10. there are 10p5 ways of choosing    ve of the ten red
balls, and the same for the ten blue balls, and as in the previous case there are
10c5 patterns of red and blue balls. so

|a| = (10p5)2    10c5,

and

p(a) =

(10p5)2    10c5

20p10

= 0.343 . . .

if we regard the sample as being unordered, then |s| = 20c10. there are 10c5
choices of the    ve red balls and the same for the blue balls. we no longer have to
count patterns since we don   t care about the order of the selection. so

and

|a| = (10c5)2,

p(a) =

(10c5)2
20c10

= 0.343 . . .

this is the same answer as in the case before, as it should be; the question doesn   t
care about order of choices!

so the event is more likely if we sample with replacement.

example
i have 6 gold coins, 4 silver coins and 3 bronze coins in my pocket. i
take out three coins at random. what is the id203 that they are all of different
material? what is the id203 that they are all of the same material?

in this case the sampling is without replacement and the sample is unordered.
so |s| = 13c3 = 286. the event that the three coins are all of different material
can occur in 6   4   3 = 72 ways, since we must have one of the six gold coins, and
so on. so the id203 is 72/286 = 0.252 . . .

12

chapter 1. basic ideas

the event that the three coins are of the same material can occur in

6c3 + 4c3 + 3c3 = 20 + 4 + 1 = 25

ways, and the id203 is 25/286 = 0.087 . . .

in a sampling problem, you should    rst read the question carefully and decide
whether the sampling is with or without replacement. if it is without replacement,
decide whether the sample is ordered (e.g. does the question say anything about
the    rst object drawn?). if so, then use the formula for ordered samples. if not,
then you can use either ordered or unordered samples, whichever is convenient;
they should give the same answer.
if the sample is with replacement, or if it
involves throwing a die or coin several times, then use the formula for sampling
with replacement.

1.8 stopping rules

suppose that you take a typing pro   ciency test. you are allowed to take the test
up to three times. of course, if you pass the test, you don   t need to take it again.
so the sample space is

s = {p, f p, f f p, f f f},

where for example f f p denotes the outcome that you fail twice and pass on your
third attempt.

if all outcomes were equally likely, then your chance of eventually passing the

test and getting the certi   cate would be 3/4.

but it is unreasonable here to assume that all the outcomes are equally likely.
for example, you may be very likely to pass on the    rst attempt. let us assume
that the id203 that you pass the test is 0.8. (by proposition 3, your chance
of failing is 0.2.) let us further assume that, no matter how many times you have
failed, your chance of passing at the next attempt is still 0.8. then we have

p(p) = 0.8,
p( f p) = 0.2   0.8 = 0.16,
p( f f p) = 0.22    0.8 = 0.032,
p( f f f ) = 0.23 = 0.008.

thus the id203 that you eventually get the certi   cate is p({p, f p, f f p}) =
0.8+0.16+0.032 = 0.992. alternatively, you eventually get the certi   cate unless
you fail three times, so the id203 is 1    0.008 = 0.992.

a stopping rule is a rule of the type described here, namely, continue the exper-
iment until some speci   ed occurrence happens. the experiment may potentially
be in   nite.

1.9. questionnaire results

13

for example, if you toss a coin repeatedly until you obtain heads, the sample

space is

s = {h,t h,t t h,t t t h, . . .}

since in principle you may get arbitrarily large numbers of tails before the    rst
head. (we have to allow all possible outcomes.)

in the typing test, the rule is    stop if either you pass or you have taken the test

three times   . this ensures that the sample space is    nite.

in the next chapter, we will have more to say about the    multiplication rule    we
used for calculating the probabilities. in the meantime you might like to consider
whether it is a reasonable assumption for tossing a coin, or for someone taking a
series of tests.

other kinds of stopping rules are possible. for example, the number of coin
tosses might be determined by some other random process such as the roll of a
die; or we might toss a coin until we have obtained heads twice; and so on. we
will not deal with these.

1.9 questionnaire results

the students in the id203 i class in autumn 2000    lled in the following
questionnaire:

1. i have a hat containing 20 balls, 10 red and 10 blue. i draw 10 balls
from the hat. i am interested in the event that i draw exactly    ve red and
   ve blue balls. do you think that this is more likely if i note the colour of
each ball i draw and replace it in the hat, or if i don   t replace the balls in
the hat after drawing?

more likely with replacement 2 more likely without replacement 2

2. what colour are your eyes?

blue 2 brown 2 green 2 other 2

3. do you own a mobile phone?
after discarding incomplete questionnaires, the results were as follows:

yes 2 no 2

answer to

   more likely

   more likely

question with replacement    without replacement   

eyes brown

other

brown

other

mobile phone
no mobile phone

35
10

4
3

35
7

9
1

14

chapter 1. basic ideas

what can we conclude?
half the class thought that, in the experiment with the coloured balls, sampling
with replacement make the result more likely. in fact, as we saw in chapter 1,
actually it is more likely if we sample without replacement. (this doesn   t matter,
since the students were instructed not to think too hard about it!)

you might expect that eye colour and mobile phone ownership would have no
in   uence on your answer. let   s test this. if true, then of the 87 people with brown
eyes, half of them (i.e. 43 or 44) would answer    with replacement   , whereas in
fact 45 did. also, of the 83 people with mobile phones, we would expect half (that
is, 41 or 42) would answer    with replacement   , whereas in fact 39 of them did. so
perhaps we have demonstrated that people who own mobile phones are slightly
smarter than average, whereas people with brown eyes are slightly less smart!

in fact we have shown no such thing, since our results refer only to the peo-
ple who    lled out the questionnaire. but they do show that these events are not
independent, in a sense we will come to soon.

on the other hand, since 83 out of 104 people have mobile phones, if we
think that phone ownership and eye colour are independent, we would expect
that the same fraction 83/104 of the 87 brown-eyed people would have phones,
i.e. (83   87)/104 = 69.4 people. in fact the number is 70, or as near as we can
expect. so indeed it seems that eye colour and phone ownership are more-or-less
independent.

1.10

independence

two events a and b are said to be independent if

p(a    b) = p(a)   p(b).

this is the de   nition of independence of events. if you are asked in an exam
to de   ne independence of events, this is the correct answer. do not say that two
events are independent if one has no in   uence on the other; and under no circum-
stances say that a and b are independent if a    b = /0 (this is the statement that
a and b are disjoint, which is quite a different thing!) also, do not ever say that
p(a    b) = p(a)   p(b) unless you have some good reason for assuming that a
and b are independent (either because this is given in the question, or as in the
next-but-one paragraph).

let us return to the questionnaire example. suppose that a student is chosen
at random from those who    lled out the questionnaire. let a be the event that this
student thought that the event was more likely if we sample with replacement; b
the event that the student has brown eyes; and c the event that the student has a

1.10. independence

mobile phone. then

15

p(a) = 52/104 = 0.5,
p(b) = 87/104 = 0.8365,
p(c) = 83/104 = 0.7981.

furthermore,

p(a    b) = 45/104 = 0.4327,
p(a   c) = 39/104 = 0.375,
p(b   c) = 70/104 = 0.6731,

p(a)   p(b) = 0.4183,
p(a)   p(c) = 0.3990,
p(b)    p(c) = 0.6676.

so none of the three pairs is independent, but in a sense b and c    come closer   
than either of the others, as we noted.

in practice, if it is the case that the event a has no effect on the outcome
of event b, then a and b are independent. but this does not apply in the other
direction. there might be a very de   nite connection between a and b, but still it
could happen that p(a    b) = p(a)   p(b), so that a and b are independent. we
will see an example shortly.

example
if we toss a coin more than once, or roll a die more than once, then
you may assume that different tosses or rolls are independent. more precisely,
if we roll a fair six-sided die twice, then the id203 of getting 4 on the    rst
throw and 5 on the second is 1/36, since we assume that all 36 combinations of
the two throws are equally likely. but (1/36) = (1/6)   (1/6), and the separate
probabilities of getting 4 on the    rst throw and of getting 5 on the second are both
equal to 1/6. so the two events are independent. this would work just as well for
any other combination.

in general, it is always ok to assume that the outcomes of different tosses of a
coin, or different throws of a die, are independent. this holds even if the examples
are not all equally likely. we will see an example later.

example
i have two red pens, one green pen, and one blue pen. i choose two
pens without replacement. let a be the event that i choose exactly one red pen,
and b the event that i choose exactly one green pen.

if the pens are called r1,r2,g,b, then

s = {r1r2,r1g,r1b,r2g,r2b,gb},
a = {r1g,r1b,r2g,r2b},
b = {r1g,r2g,gb}

16

chapter 1. basic ideas

we have p(a) = 4/6 = 2/3, p(b) = 3/6 = 1/2, p(a   b) = 2/6 = 1/3 = p(a)p(b),
so a and b are independent.

but before you say    that   s obvious   , suppose that i have also a purple pen,
and i do the same experiment. this time, if you write down the sample space
and the two events and do the calculations, you will    nd that p(a) = 6/10 = 3/5,
p(b) = 4/10 = 2/5, p(a    b) = 2/10 = 1/5 6= p(a)p(b), so adding one more
pen has made the events non-independent!

we see that it is very dif   cult to tell whether events are independent or not. in
practice, assume that events are independent only if either you are told to assume
it, or the events are the outcomes of different throws of a coin or die. (there is
one other case where you can assume independence: this is the result of different
draws, with replacement, from a set of objects.)

example consider the experiment where we toss a fair coin three times and
note the results. each of the eight possible outcomes has id203 1/8. let a
be the event    there are more heads than tails   , and b the event    the results of the
   rst two tosses are the same   . then

    a = {hhh,hht,ht h,t hh}, p(a) = 1/2,
    b = {hhh,hht,t t h,t t t}, p(b) = 1/2,
    a    b = {hhh,hht}, p(a    b) = 1/4;

so a and b are independent. however, both a and b clearly involve the results of
the    rst two tosses and it is not possible to make a convincing argument that one
of these events has no in   uence or effect on the other. for example, let c be the
event    heads on the last toss   . then, as we saw in part 1,

    c = {hhh,ht h,t hh,t t h}, p(c) = 1/2,
    a   c = {hhh,ht h,t hh}, p(a   c) = 3/8;

so a and c are not independent.

are b and c independent?

1.11 mutual independence

this section is a bit technical. you will need to know the conclusions, though the
arguments we use to reach them are not so important.

we saw in the coin-tossing example above that it is possible to have three
events a,b,c so that a and b are independent, b and c are independent, but a and
c are not independent.

1.12. properties of independence

17

if all three pairs of events happen to be independent, can we then conclude
that p(a    b   c) = p(a)   p(b)   p(c)? at    rst sight this seems very reasonable;
in axiom 3, we only required all pairs of events to be exclusive in order to justify
our conclusion. unfortunately it is not true. . .

example
in the coin-tossing example, let a be the event       rst and second tosses
have same result   , b the event       rst and third tosses have the same result, and
c the event    second and third tosses have same result   . you should check that
p(a) = p(b) = p(c) = 1/2, and that the events a    b, b   c, a   c, and a    b   c
are all equal to {hhh,t t t}, with id203 1/4. thus any pair of the three
events are independent, but

p(a    b   c) = 1/4,
p(a)   p(b)   p(c) = 1/8.

so a,b,c are not mutually independent.

the correct de   nition and proposition run as follows.
let a1, . . . ,an be events. we say that these events are mutually independent if,

given any distinct indices i1,i2, . . . ,ik with k     1, the events

ai1     ai2              aik   1

and aik

are independent.
intersection of any number of the other events in the set.

in other words, any one of the events is independent of the

proposition 1.11 let a1, . . . ,an be mutually independent. then
p(a1     a2              an) = p(a1)   p(a2)      p(an).

now all you really need to know is that the same    physical    arguments that
justify that two events (such as two tosses of a coin, or two throws of a die) are
independent, also justify that any number of such events are mutually independent.
so, for example, if we toss a fair coin six times, the id203 of getting the
sequence hht hht is (1/2)6 = 1/64, and the same would apply for any other
sequence. in other words, all 64 possible outcomes are equally likely.

1.12 properties of independence
proposition 1.12 if a and b are independent, then a and b0 are independent.

18

chapter 1. basic ideas

we are given that p(a    b) = p(a)   p(b), and asked to prove that p(a    b0) =
p(a)   p(b0).
from corollary 4, we know that p(b0) = 1    p(b). also, the events a    b and
a    b0 are disjoint (since no outcome can be both in b and b0), and their union
is a (since every event in a is either in b or in b0); so by axiom 3, we have that
p(a) = p(a    b) + p(a    b0). thus,

p(a    b0) = p(a)    p(a    b)

= p(a)    p(a)   p(b)
= p(a)(1    p(b))
= p(a)   p(b0),

(since a and b are independent)

which is what we were required to prove.
corollary 1.13 if a and b are independent, so are a0 and b0.

apply the proposition twice,    rst to a and b (to show that a and b0 are inde-

pendent), and then to b0 and a (to show that b0 and a0 are independent).

more generally, if events a1, . . . ,an are mutually independent, and we replace
some of them by their complements, then the resulting events are mutually inde-
pendent. we have to be a bit careful though. for example, a and a0 are not usually
independent!

results like the following are also true.

proposition 1.14 let events a, b, c be mutually independent. then a and b   c
are independent, and a and b   c are independent.

example consider the example of the typing pro   ciency test that we looked at
earlier. you are allowed up to three attempts to pass the test.

suppose that your chance of passing the test is 0.8. suppose also that the
events of passing the test on any number of different occasions are mutually inde-
pendent. then, by proposition 1.11, the id203 of any sequence of passes and
fails is the product of the probabilities of the terms in the sequence. that is,
p(p) = 0.8, p( f p) = (0.2)   (0.8), p( f f p) = (0.2)2    (0.8), p( f f f ) = (0.2)3,

as we claimed in the earlier example.

in other words, mutual independence is the condition we need to justify the

argument we used in that example.

1.12. properties of independence

example
the electrical apparatus in the diagram
works so long as current can    ow from left
to right. the three components are inde-
pendent. the id203 that component a
works is 0.8;
the id203 that compo-
nent b works is 0.9; and the id203 that
component c works is 0.75.
find the id203 that the apparatus works.

19

b

  
  
a   
  
  
  

c

at risk of some confusion, we use the letters a, b and c for the events    com-
ponent a works   ,    component b works   , and    component c works   , respectively.
now the apparatus will work if either a and b are working, or c is working (or
possibly both). thus the event we are interested in is (a    b)   c.

now

p((a    b)   c)) = p(a    b) + p(c)    p(a    b   c)
(by inclusion   exclusion)

= p(a)   p(b) + p(c)    p(a)   p(b)   p(c)
= (0.8)   (0.9) + (0.75)    (0.8)   (0.9)   (0.75)
= 0.93.

(by mutual independence)

the problem can also be analysed in a different way. the apparatus will not
work if both paths are blocked, that is, if c is not working and one of a and b is
also not working. thus, the event that the apparatus does not work is (a0   b0)   c0.
by the distributive law, this is equal to (a0    c0)    (b0    c0). we have
p((a0    c0)    (b0    c0) = p(a0    c0) + p(b0    c0)    p(a0     b0    c0)

(by inclusion   exclusion)
(by mutual independence of a0,b0,c0)

= p(a0)   p(c0) + p(b0)   p(c0)    p(a0)   p(b0)   p(c0)
= (0.2)   (0.25) + (0.1)   (0.25)    (0.2)   (0.1)   (0.25)
= 0.07,

so the apparatus works with id203 1    0.07 = 0.93.

there is a trap here which you should take care to avoid. you might be tempted
to say p(a0    c0) = (0.2)   (0.25) = 0.05, and p(b0    c0) = (0.1)   (0.25) = 0.025;
and conclude that

p((a0    c0)    (b0    c0)) = 0.05 + 0.025    (0.05)   (0.025) = 0.07375

by the principle of inclusion and exclusion. but this is not correct, since the
events a0    c0 and b0    c0 are not independent!

20

chapter 1. basic ideas

example we can always assume that successive tosses of a coin are mutually
independent, even if it is not a fair coin. suppose that i have a coin which has
id203 0.6 of coming down heads. i toss the coin three times. what are the
probabilities of getting three heads, two heads, one head, or no heads?

bility is (0.6)3 = 0.216.

for three heads, since successive tosses are mutually independent, the proba-
the id203 of tails on any toss is 1     0.6 = 0.4. now the event    two
heads    can occur in three possible ways, as hht , ht h, or t hh. each outcome
has id203 (0.6)    (0.6)    (0.4) = 0.144. so the id203 of two heads is
3   (0.144) = 0.432.
similarly the id203 of one head is 3  (0.6)  (0.4)2 = 0.288, and the prob-

ability of no heads is (0.4)3 = 0.064.

as a check, we have

0.216 + 0.432 + 0.288 + 0.064 = 1.

1.13 worked examples
question

(a) you go to the shop to buy a toothbrush. the toothbrushes there are red, blue,
green, purple and white. the id203 that you buy a red toothbrush is
three times the id203 that you buy a green one; the id203 that you
buy a blue one is twice the id203 that you buy a green one; the proba-
bilities of buying green, purple, and white are all equal. you are certain to
buy exactly one toothbrush. for each colour,    nd the id203 that you
buy a toothbrush of that colour.

(b) james and simon share a    at, so it would be confusing if their toothbrushes
were the same colour. on the    rst day of term they both go to the shop to
buy a toothbrush. for each of james and simon, the id203 of buying
various colours of toothbrush is as calculated in (a), and their choices are
independent. find the id203 that they buy toothbrushes of the same
colour.

(c) james and simon live together for three terms. on the    rst day of each term
they buy new toothbrushes, with probabilities as in (b), independently of
what they had bought before. this is the only time that they change their
toothbrushes. find the probablity that james and simon have differently
coloured toothbrushes from each other for all three terms. is it more likely
that they will have differently coloured toothbrushes from each other for

1.13. worked examples

21

all three terms or that they will sometimes have toothbrushes of the same
colour?

solution
(a) let r,b,g,p,w be the events that you buy a red, blue, green, purple and

white toothbrush respectively. let x = p(g). we are given that

p(r) = 3x, p(b) = 2x, p(p) = p(w ) = x.

since these outcomes comprise the whole sample space, corollary 2 gives

3x + 2x + x + x + x = 1,

so x = 1/8. thus, the probabilities are 3/8, 1/4, 1/8, 1/8, 1/8 respectively.

(b) let rb denote the event    james buys a red toothbrush and simon buys a blue

toothbrush   , etc. by independence (given), we have, for example,

p(rr) = (3/8)   (3/8) = 9/64.

the event that the toothbrushes have the same colour consists of the    ve
outcomes rr, bb, gg, pp, ww , so its id203 is

p(rr) + p(bb) + p(gg) + p(pp) + p(ww )
9
64

1
16

1
64

1
64

1
64

1
4

+

+

+

+

=

.

=

(c) the event    different coloured toothbrushes in the ith term    has id203 3/4
(from part (b)), and these events are independent. so the event    different
coloured toothbrushes in all three terms    has id203

3
4

   3
4

   3
4

=

27
64

.

the event    same coloured toothbrushes in at least one term    is the comple-
ment of the above, so has id203 1     (27/64) = (37)/(64). so it is
more likely that they will have the same colour in at least one term.

question there are 24 elephants in a game reserve. the warden tags six of the
elephants with small radio transmitters and returns them to the reserve. the next
month, he randomly selects    ve elephants from the reserve. he counts how many
of these elephants are tagged. assume that no elephants leave or enter the reserve,
or die or give birth, between the tagging and the selection; and that all outcomes
of the selection are equally likely. find the id203 that exactly two of the
selected elephants are tagged, giving the answer correct to 3 decimal places.

22

chapter 1. basic ideas

solution the experiment consists of picking the    ve elephants, not the original
choice of six elephants for tagging. let s be the sample space. then |s| = 24c5.
let a be the event that two of the selected elephants are tagged. this involves
choosing two of the six tagged elephants and three of the eighteen untagged ones,
so |a| = 6c2    18c3. thus

p(a) =

6c2    18c3

24c5

= 0.288

to 3 d.p.

note: should the sample should be ordered or unordered? since the answer
doesn   t depend on the order in which the elephants are caught, an unordered sam-
ple is preferable. if you want to use an ordered sample, the calculation is

p(a) =

6p2    18p3    5c2

24p5

= 0.288,

since it is necessary to multiply by the 5c2 possible patterns of tagged and un-
tagged elephants in a sample of    ve with two tagged.

question a couple are planning to have a family. they decide to stop having
children either when they have two boys or when they have four children. sup-
pose that they are successful in their plan.

(a) write down the sample space.

(b) assume that, each time that they have a child, the id203 that it is a
boy is 1/2, independent of all other times. find p(e) and p(f) where
e =    there are at least two girls   , f =    there are more girls than boys   .

solution (a) s = {bb,bgb,gbb,bggb,gbgb,ggbb,bggg,gbgg,
(b) e = {bggb,gbgb,ggbb,bggg,gbgg,ggbg,gggb,gggg},

ggbg,gggb,gggg}.

f = {bggg,gbgg,ggbg,gggb,gggg}.

now we have p(bb) = 1/4, p(bgb) = 1/8, p(bggb) = 1/16, and similarly

for the other outcomes. so p(e) = 8/16 = 1/2, p(f) = 5/16.

chapter 2

id155

in this chapter we develop the technique of id155 to deal with
cases where events are not independent.

2.1 what is id155?

alice and bob are going out to dinner. they toss a fair coin    best of three    to
decide who pays: if there are more heads than tails in the three tosses then alice
pays, otherwise bob pays.

clearly each has a 50% chance of paying. the sample space is

s = {hhh,hht,ht h,ht t,t hh,t ht,t t h,t t t},

and the events    alice pays    and    bob pays    are respectively
a = {hhh,hht,ht h,t hh},
b = {ht t,t ht,t t h,t t t}.

they toss the coin once and the result is heads; call this event e. how should

we now reassess their chances? we have

e = {hhh,hht,ht h,ht t},

and if we are given the information that the result of the    rst toss is heads, then e
now becomes the sample space of the experiment, since the outcomes not in e are
no longer possible. in the new experiment, the outcomes    alice pays    and    bob
pays    are

a    e = {hhh,hht,ht h},
b    e = {ht t}.

23

24

chapter 2. id155

thus the new probabilities that alice and bob pay for dinner are 3/4 and 1/4
respectively.

in general, suppose that we are given that an event e has occurred, and we
want to compute the id203 that another event a occurs. in general, we can no
longer count, since the outcomes may not be equally likely. the correct de   nition
is as follows.

let e be an event with non-zero id203, and let a be any event. the

id155 of a given e is de   ned as
p(a    e)
p(e)

p(a | e) =

.

again i emphasise that this is the de   nition. if you are asked for the de   nition
of id155, it is not enough to say    the id203 of a given that
e has occurred   , although this is the best way to understand it. there is no reason
why event e should occur before event a!
note the vertical bar in the notation. this is p(a | e), not p(a/e) or p(a\e).
note also that the de   nition only applies in the case where p(e) is not equal
to zero, since we have to divide by it, and this would make no sense if p(e) = 0.

to check the formula in our example:

p(a | e) =

p(b | e) =

p(a    e)
p(e)
p(b    e)
p(e)

=

=

3/8
1/2
1/8
1/2

=

=

3
4
1
4

,

.

it may seem like a small matter, but you should be familiar enough with this
formula that you can write it down without stopping to think about the names of
the events. thus, for example,

p(a | b) =

p(a    b)
p(b)

if p(b) 6= 0.

example a random car is chosen among all those passing through trafalgar
square on a certain day. the id203 that the car is yellow is 3/100:
the
id203 that the driver is blonde is 1/5; and the id203 that the car is
yellow and the driver is blonde is 1/50.

find the id155 that the driver is blonde given that the car is

yellow.

2.2. genetics

25

solution: if y is the event    the car is yellow    and b the event    the driver is blonde   ,
then we are given that p(y ) = 0.03, p(b) = 0.2, and p(y     b) = 0.02. so

p(b | y ) =

p(b   y )
p(y )

=

0.02
0.03

= 0.667

to 3 d.p. note that we haven   t used all the information given.

there is a connection between id155 and independence:

proposition 2.1 let a and b be events with p(b) 6= 0. then a and b are indepen-
dent if and only if p(a | b) = p(a).

proof the words    if and only if    tell us that we have two jobs to do: we have to
show that if a and b are independent, then p(a | b) = p(a); and that if p(a | b) =
p(a), then a and b are independent.
p(a    b) = p(a)   p(b). then
p(a | b) =

so    rst suppose that a and b are independent. remember that this means that

p(a)   p(b)

= p(a),

=

p(a    b)
p(b)

p(b)

that is, p(a | b) = p(a), as we had to prove.

now suppose that p(a | b) = p(a). in other words,

p(a    b)
p(b)

= p(a),

using the de   nition of id155. now clearing fractions gives

p(a    b) = p(a)   p(b),

which is just what the statement    a and b are independent    means.

this proposition is most likely what people have in mind when they say    a

and b are independent means that b has no effect on a   .

2.2 genetics

here is a simpli   ed version of how genes code eye colour, assuming only two
colours of eyes.

each person has two genes for eye colour. each gene is either b or b. a child
receives one gene from each of its parents. the gene it receives from its father
is one of its father   s two genes, each with id203 1/2; and similarly for its
mother. the genes received from father and mother are independent.

if your genes are bb or bb or bb, you have brown eyes; if your genes are bb,

you have blue eyes.

26

chapter 2. id155

example suppose that john has brown eyes. so do both of john   s parents. his
sister has blue eyes. what is the id203 that john   s genes are bb?

solution john   s sister has genes bb, so one b must have come from each parent.
thus each of john   s parents is bb or bb; we may assume bb. so the possibilities
for john are (writing the gene from his father    rst)

bb,bb,bb,bb

each with id203 1/4. (for example, john gets his father   s b gene with prob-
ability 1/2 and his mother   s b gene with id203 1/2, and these are indepen-
dent, so the id203 that he gets bb is 1/4. similarly for the other combina-
tions.)
let x be the event    john has bb genes    and y the event    john has brown
eyes   . then x = {bb} and y = {bb,bb,bb}. the question asks us to calculate
p(x | y ). this is given by

p(x | y ) =

p(x    y )
p(y )

=

1/4
3/4

= 1/3.

2.3 the theorem of total id203

sometimes we are faced with a situation where we do not know the id203 of
an event b, but we know what its id203 would be if we were sure that some
other event had occurred.

example an ice-cream seller has to decide whether to order more stock for the
bank holiday weekend. he estimates that, if the weather is sunny, he has a 90%
chance of selling all his stock; if it is cloudy, his chance is 60%; and if it rains, his
chance is only 20%. according to the weather forecast, the id203 of sunshine
is 30%, the id203 of cloud is 45%, and the id203 of rain is 25%. (we
assume that these are all the possible outcomes, so that their probabilities must
add up to 100%.) what is the overall id203 that the salesman will sell all his
stock?

this problem is answered by the theorem of total id203, which we now
state. first we need a de   nition. the events a1,a2, . . . ,an form a partition of the
sample space if the following two conditions hold:
(a) the events are pairwise disjoint, that is, ai     a j = /0 for any pair of events ai

and a j;

(b) a1     a2              an = s.

2.3. the theorem of total id203

27

another way of saying the same thing is that every outcome in the sample space
lies in exactly one of the events a1,a2, . . . ,an. the picture shows the idea of a
partition.

a1 a2

. . . an

now we state and prove the theorem of total id203.

theorem 2.2 let a1,a2, . . . ,an form a partition of the sample space with p(ai) 6=
0 for all i, and let b be any event. then

p(b) =

n

   

i=1

p(b | ai)   p(ai).

proof by de   nition, p(b | ai) = p(b    ai)/p(ai). multiplying up, we    nd that

p(b    ai) = p(b | ai)   p(ai).

now consider the events b     a1,b     a2, . . . ,b     an. these events are pairwise
disjoint; for any outcome lying in both b    ai and b    a j would lie in both ai and
a j, and by assumption there are no such outcomes. moreover, the union of all
these events is b, since every outcome lies in one of the ai. so, by axiom 3, we
conclude that

n

i=1

   

p(b    ai) = p(b).
substituting our expression for p(b    ai) gives the result.
 
 
 
 b

a1 a2

. . . an

consider the ice-cream salesman at the start of this section. let a1 be the
event    it is sunny   , a2 the event    it is cloudy   , and a3 the event    it is rainy   . then
a1, a2 and a3 form a partition of the sample space, and we are given that

p(a1) = 0.3, p(a2) = 0.45, p(a3) = 0.25.

28

chapter 2. id155

let b be the event    the salesman sells all his stock   . the other information we are
given is that

p(b | a1) = 0.9, p(b | a2) = 0.6, p(b | a3) = 0.2.

by the theorem of total id203,

p(b) = (0.9   0.3) + (0.6   0.45) + (0.2   0.25) = 0.59.

you will now realise that the theorem of total id203 is really being used
when you calculate probabilities by tree diagrams. it is better to get into the habit
of using it directly, since it avoids any accidental assumptions of independence.
one special case of the theorem of total id203 is very commonly used,
and is worth stating in its own right. for any event a, the events a and a0 form a
partition of s. to say that both a and a0 have non-zero id203 is just to say
that p(a) 6= 0,1. thus we have the following corollary:
corollary 2.3 let a and b be events, and suppose that p(a) 6= 0,1. then

p(b) = p(b | a)   p(a) + p(b | a0)   p(a0).

2.4 sampling revisited

we can use the notion of id155 to treat sampling problems in-
volving ordered samples.

example
pens without replacement.

i have two red pens, one green pen, and one blue pen. i select two

(a) what is the id203 that the    rst pen chosen is red?

(b) what is the id203 that the second pen chosen is red?

for the    rst pen, there are four pens of which two are red, so the chance of

selecting a red pen is 2/4 = 1/2.

for the second pen, we must separate cases. let a1 be the event       rst pen red   ,
a2 the event       rst pen green    and a3 the event       rst pen blue   . then p(a1) = 1/2,
p(a2) = p(a3) = 1/4 (arguing as above). let b be the event    second pen red   .
if the    rst pen is red, then only one of the three remaining pens is red, so that
p(b | a1) = 1/3. on the other hand, if the    rst pen is green or blue, then two of
the remaining pens are red, so p(b | a2) = p(b | a3) = 2/3.

2.5. bayes    theorem

29

by the theorem of total id203,

p(b) = p(b | a1)p(a1) + p(b | a2)p(a2) + p(b | a3)p(a3)

= (1/3)   (1/2) + (2/3)   (1/4) + (2/3)   (1/4)
= 1/2.

we have reached by a roundabout argument a conclusion which you might
think to be obvious. if we have no information about the    rst pen, then the second
pen is equally likely to be any one of the four, and the id203 should be 1/2,
just as for the    rst pen. this argument happens to be correct. but, until your
ability to distinguish between correct arguments and plausible-looking false ones
is very well developed, you may be safer to stick to the calculation that we did.
beware of obvious-looking arguments in id203! many clever people have
been caught out.

2.5 bayes    theorem
there is a very big difference between p(a | b) and p(b | a).

suppose that a new test is developed to identify people who are liable to suffer
from some genetic disease in later life. of course, no test is perfect; there will be
some carriers of the defective gene who test negative, and some non-carriers who
test positive. so, for example, let a be the event    the patient is a carrier   , and b
the event    the test result is positive   .
the scientists who develop the test are concerned with the probabilities that
the test result is wrong, that is, with p(b | a0) and p(b0 | a). however, a patient
who has taken the test has different concerns.
if i tested positive, what is the
chance that i have the disease? if i tested negative, how sure can i be that i am not
a carrier? in other words, p(a | b) and p(a0 | b0).

these conditional probabilities are related by bayes    theorem:

theorem 2.4 let a and b be events with non-zero id203. then

p(a | b) =

p(b | a)   p(a)

p(b)

.

the proof is not hard. we have

p(a | b)   p(b) = p(a    b) = p(b | a)   p(a),

using the de   nition of id155 twice. (note that we need both a
and b to have non-zero id203 here.) now divide this equation by p(b) to get
the result.

30

chapter 2. id155

if p(a) 6= 0,1 and p(b) 6= 0, then we can use corollary 17 to write this as

p(a | b) =

p(b | a)   p(a)

p(b | a)   p(a) + p(b | a0)   p(a0).

bayes    theorem is often stated in this form.

example consider the ice-cream salesman from section 2.3. given that he sold
all his stock of ice-cream, what is the id203 that the weather was sunny?
(this question might be asked by the warehouse manager who doesn   t know what
the weather was actually like.) using the same notation that we used before, a1
is the event    it is sunny    and b the event    the salesman sells all his stock   . we are
asked for p(a1 | b). we were given that p(b | a1) = 0.9 and that p(a1) = 0.3, and
we calculated that p(b) = 0.59. so by bayes    theorem,
0.9   0.3

p(b | a1)p(a1)

p(a1 | b) =

p(b)

=

0.59

= 0.46

to 2 d.p.

example consider the clinical test described at the start of this section. suppose
that 1 in 1000 of the population is a carrier of the disease. suppose also that the
id203 that a carrier tests negative is 1%, while the id203 that a non-
carrier tests positive is 5%. (a test achieving these values would be regarded as
very successful.) let a be the event    the patient is a carrier   , and b the event    the
test result is positive   . we are given that p(a) = 0.001 (so that p(a0) = 0.999),
and that

p(b | a) = 0.99,

p(b | a0) = 0.05.

(a) a patient has just had a positive test result. what is the id203 that the

patient is a carrier? the answer is

p(a | b) =

=

=

p(b | a)p(a) + p(b | a0)p(a0)

p(b | a)p(a)

0.99   0.001

(0.99   0.001) + (0.05   0.999)
0.00099
0.05094

= 0.0194.

(b) a patient has just had a negative test result. what is the id203 that the

patient is a carrier? the answer is

p(a | b0) =

p(b0 | a)p(a)

p(b0 | a)p(a) + p(b0 | a0)p(a0)

2.6. iterated id155

31

=

=

0.01   0.001

(0.01   0.001) + (0.95   0.999)
0.00001
0.94095

= 0.00001.

so a patient with a negative test result can be reassured; but a patient with a posi-
tive test result still has less than 2% chance of being a carrier, so is likely to worry
unnecessarily.

of course, these calculations assume that the patient has been selected at ran-
dom from the population. if the patient has a family history of the disease, the
calculations would be quite different.

example 2% of the population have a certain blood disease in a serious form;
10% have it in a mild form; and 88% don   t have it at all. a new blood test is
developed; the id203 of testing positive is 9/10 if the subject has the serious
form, 6/10 if the subject has the mild form, and 1/10 if the subject doesn   t have
the disease.

i have just tested positive. what is the id203 that i have the serious form

of the disease?

let a1 be    has disease in serious form   , a2 be    has disease in mild form   , and
a3 be    doesn   t have disease   . let b be    test positive   . then we are given that a1,
a2, a3 form a partition and

p(a1) = 0.02
p(a3) = 0.88
p(b | a1) = 0.9 p(b | a2) = 0.6 p(b | a3) = 0.1

p(a2) = 0.1

thus, by the theorem of total id203,

p(b) = 0.9   0.02 + 0.6   0.1 + 0.1   0.88 = 0.166,

and then by bayes    theorem,

p(a1 | b) =

to 3 d.p.

p(b | a1)p(a1)

p(b)

0.9   0.02

0.166

=

= 0.108

2.6

iterated id155

the id155 of c, given that both a and b have occurred, is just
p(c | a    b). sometimes instead we just write p(c | a,b). it is given by

p(c | a,b) =

p(c    a    b)
p(a    b)

,

32

so

now we also have

chapter 2. id155

p(a    b   c) = p(c | a,b)p(a    b).

so    nally (assuming that p(a    b) 6= 0), we have

p(a    b) = p(b | a)p(a),

p(a    b   c) = p(c | a,b)p(b | a)p(a).

this generalises to any number of events:

proposition 2.5 let a1, . . . ,an be events. suppose that p(a1              an   1) 6= 0.
then

p(a1     a2              an) = p(an | a1, . . . ,an   1)      p(a2 | a1)p(a1).

we apply this to the birthday paradox.
the birthday paradox is the following statement:

if there are 23 or more people in a room, then the chances are better
than even that two of them have the same birthday.

to simplify the analysis, we ignore 29 february, and assume that the other 365
days are all equally likely as birthdays of a random person. (this is not quite true
but not inaccurate enough to have much effect on the conclusion.) suppose that
we have n people p1, p2, . . . , pn. let a2 be the event    p2 has a different birthday
from p1   . then p(a2) = 1    1
365, since whatever p1   s birthday is, there is a 1 in
365 chance that p2 will have the same birthday.

let a3 be the event    p3 has a different birthday from p1 and p2   . it is not
straightforward to evaluate p(a3), since we have to consider whether p1 and p2
have the same birthday or not. (see below). but we can calculate that p(a3 |
a2) = 1    2
365, since if a2 occurs then p1 and p2 have birthdays on different days,
and a3 will occur only if p3   s birthday is on neither of these days. so

p(a2     a3) = p(a2)p(a3 | a2) = (1    1

365)(1    2

365).

what is a2     a3? it is simply the event that all three people have birthdays on
different days.

now this process extends. if ai denotes the event    pi   s birthday is not on the

same day as any of p1, . . . , pi   1   , then

p(ai | a1, . . . ,ai   1) = 1    i   1
365 ,

2.6. iterated id155

33

and so by proposition 2.5,

p(a1              ai) = (1    1

365)(1    2

365)      (1    i   1
365).

call this number qi; it is the id203 that all of the people p1, . . . , pi have

their birthdays on different days.

the numbers qi decrease, since at each step we multiply by a factor less than 1.

so there will be some value of n such that

qn   1 > 0.5,

qn     0.5,

that is, n is the smallest number of people for which the id203 that they all
have different birthdays is less than 1/2, that is, the id203 of at least one
coincidence is greater than 1/2.

by calculation, we    nd that q22 = 0.5243, q23 = 0.4927 (to 4 d.p.); so 23

people are enough for the id203 of coincidence to be greater than 1/2.

now return to a question we left open before. what is the id203 of the
event a3? (this is the event that p3 has a different birthday from both p1 and p2.)
if p1 and p2 have different birthdays, the id203 is 1     2
365: this is the
calculation we already did. on the other hand, if p1 and p2 have the same birthday,
then the id203 is 1    1
365. these two numbers are p(a3 | a2) and p(a3 | a0
2)
respectively. so, by the theorem of total id203,

p(a3) = p(a3 | a2)p(a2) + p(a3 | a0
365) + (1    1

365)(1    1

2)p(a0
2)
365) 1
365

= (1    2
= 0.9945

to 4 d.p.

problem how many people would you need to pick at random to ensure that
the chance of two of them being born in the same month are better than even?

assuming all months equally likely, if bi is the event that pi is born in a dif-

ferent month from any of p1, . . . , pi   1, then as before we    nd that

p(bi | b1,       ,bi   1) = 1    i   1
12 ,

so

p(b1              bi) = (1    1

12)(1    2

12)(1    i   1
12 ).

we calculate that this id203 is

(11/12)   (10/12)   (9/12) = 0.5729

34

for i = 4 and

chapter 2. id155

(11/12)   (10/12)   (9/12)   (8/12) = 0.3819

for i = 5. so, with    ve people, it is more likely that two will have the same birth
month.

a true story. some years ago, in a id203 class with only ten students, the
lecturer started discussing the birthday paradox. he said to the class,    i bet that
no two people in the room have the same birthday   . he should have been on safe
ground, since q11 = 0.859. (remember that there are eleven people in the room!)
however, a student in the back said    i   ll take the bet   , and after a moment all the
other students realised that the lecturer would certainly lose his wager. why?

(answer in the next chapter.)

2.7 worked examples
question each person has two genes for cystic    brosis. each gene is either n
or c. each child receives one gene from each parent. if your genes are nn or nc
or cn then you are normal; if they are cc then you have cystic    brosis.

(a) neither of sally   s parents has cystic    brosis. nor does she. however, sally   s
sister hannah does have cystic    brosis. find the id203 that sally has
at least one c gene (given that she does not have cystic    brosis).

(b) in the general population the ratio of n genes to c genes is about 49 to 1.
you can assume that the two genes in a person are independent. harry does
not have cystic    brosis. find the id203 that he has at least one c gene
(given that he does not have cystic    brosis).

(c) harry and sally plan to have a child. find the id203 that the child will

have cystic    brosis (given that neither harry nor sally has it).

solution during this solution, we will use a number of times the following prin-
ciple. let a and b be events with a     b. then a    b = a, and so

p(a | b) =

p(a    b)
p(b)

=

p(a)
p(b).

(a) this is the same as the eye colour example discussed earlier. we are given
that sally   s sister has genes cc, and one gene must come from each parent. but

2.7. worked examples

35

neither parent is cc, so each parent is cn or nc. now by the basic rules of
genetics, all the four combinations of genes for a child of these parents, namely
cc,cn,nc,nn, will have id203 1/4.
if s1 is the event    sally has at least one c gene   , then s1 = {cn,nc,cc}; and
if s2 is the event    sally does not have cystic    brosis   , then s2 = {cn,nc,nn}.
then

p(s1 | s2) =

p(s1     s2)

p(s2)

=

2/4
3/4

=

2
3

.

(b) we know nothing speci   c about harry, so we assume that his genes are
randomly and independently selected from the population. we are given that the
id203 of a random gene being c or n is 1/50 and 49/50 respectively. then
the probabilities of harry having genes cc, cn, nc, nn are respectively (1/50)2,
(1/50)   (49/50), (49/50)   (1/50), and (49/50)2, respectively. so, if h1 is the
event    harry has at least one c gene   , and h2 is the event    harry does not have
cystic    brosis   , then

p(h1 | h2) =

p(h1     h2)

p(h2)

=

(49/2500) + (49/2500)

(49/2500) + (49/2500) + (2401/2500)

=

2
51

.

(c) let x be the event that harry   s and sally   s child has cystic    brosis. as in
(a), this can only occur if harry and sally both have cn or nc genes. that is,
x     s3     h3, where s3 = s1     s2 and h3 = h1     h2. now if harry and sally are
both cn or nc, these genes pass independently to the baby, and so

p(x | s3     h3) =

p(x)

p(s3     h3)

=

1
4

.

we are asked to    nd p(x | s2     h2), in other words (since x     s3     h3    

(remember the principle that we started with!)
s2     h2),

p(x)

p(s2     h2).

now harry   s and sally   s genes are independent, so

p(s3     h3) = p(s3)   p(h3),
p(s2     h2) = p(s2)   p(h2).

thus,

p(x)

p(s2     h2)

=

p(x)

p(s3     h3)

   p(s3     h3)
p(s2     h2)

36

chapter 2. id155

=

=

=

=

   p(s1     s2)
   p(h1     h2)
1
p(h2)
p(s2)
4
1
   p(s1 | s2)   p(h1 | h2)
4
1
   2
4
3
1
153

   2
51

.

i thank eduardo mendes for pointing out a mistake in my previous solution to

this problem.

question the land of nod lies in the monsoon zone, and has just two seasons,
wet and dry. the wet season lasts for 1/3 of the year, and the dry season for 2/3
of the year. during the wet season, the id203 that it is raining is 3/4; during
the dry season, the id203 that it is raining is 1/6.

(a) i visit the capital city, oneirabad, on a random day of the year. what is the

id203 that it is raining when i arrive?

(b) i visit oneirabad on a random day, and it is raining when i arrive. given this
information, what is the id203 that my visit is during the wet season?

(c) i visit oneirabad on a random day, and it is raining when i arrive. given this
information, what is the id203 that it will be raining when i return to
oneirabad in a year   s time?

(you may assume that in a year   s time the season will be the same as today but,
given the season, whether or not it is raining is independent of today   s weather.)

solution (a) let w be the event    it is the wet season   , d the event    it is the dry
season   , and r the event    it is raining when i arrive   . we are given that p(w ) =
1/3, p(d) = 2/3, p(r | w ) = 3/4, p(r | d) = 1/6. by the totp,

p(r) = p(r | w )p(w ) + p(r | d)p(d)

= (3/4)   (1/3) + (1/6)   (2/3) = 13/36.

(b) by bayes    theorem,

p(w | r) =

p(r | w )p(w )

p(r)

(3/4)   (1/3)

13/36

=

9
13

.

=

2.7. worked examples

37

(c) let r0 be the event    it is raining in a year   s time   . the information we are

given is that p(r    r0 | w ) = p(r | w )p(r0 | w ) and similarly for d. thus

p(r    r0) = p(r    r0 | w )p(w ) + p(r    r0 | d)p(d)

= (3/4)2    (1/3) + (1/6)2    (2/3) =

89
432

,

and so

p(r0 | r) =

p(r    r0)

p(r)

=

89/432
13/36

=

89
156

.

38

chapter 2. id155

chapter 3

random variables

in this chapter we de   ne random variables and some related concepts such as
id203 mass function, expected value, variance, and median; and look at some
particularly important types of random variables including the binomial, poisson,
and normal.

3.1 what are random variables?

the holy roman empire was, in the words of the historian voltaire,    neither holy,
nor roman, nor an empire   . similarly, a random variable is neither random nor a
variable:

a random variable is a function de   ned on a sample space.

the values of the function can be anything at all, but for us they will always be
numbers. the standard abbreviation for    random variable    is r.v.

example
height in centimetres.

i select at random a student from the class and measure his or her

here, the sample space is the set of students; the random variable is    height   ,
which is a function from the set of students to the real numbers: h(s) is the height
of student s in centimetres. (remember that a function is nothing but a rule for
associating with each element of its domain set an element of its target or range
set. here the domain set is the sample space s, the set of students in the class, and
the target space is the set of real numbers.)

example
numbers. here the sample space is

i throw a six-sided die twice; i am interested in the sum of the two

s = {(i, j) : 1     i, j     6},

39

40

chapter 3. random variables

and the random variable f is given by f(i, j) = i + j. the target set is the set
{2,3, . . . ,12}.

the two random variables in the above examples are representatives of the two
types of random variables that we will consider. these de   nitions are not quite
precise, but more examples should make the idea clearer.

a random variable f is discrete if the values it can take are separated by gaps.
for example, f is discrete if it can take only    nitely many values (as in the second
example above, where the values are the integers from 2 to 12), or if the values of
f are integers (for example, the number of nuclear decays which take place in a
second in a sample of radioactive material     the number is an integer but we can   t
easily put an upper limit on it.)

a random variable is continuous if there are no gaps between its possible
values. in the    rst example, the height of a student could in principle be any real
number between certain extreme limits. a random variable whose values range
over an interval of real numbers, or even over all real numbers, is continuous.

one could concoct random variables which are neither discrete nor continuous
(e.g. the possible, values could be 1, 2, 3, or any real number between 4 and 5),
but we will not consider such random variables.

we begin by considering discrete random variables.

3.2 id203 mass function

let f be a discrete random variable. the most basic question we can ask is: given
any value a in the target set of f, what is the id203 that f takes the value a?
in other words, if we consider the event

a = {x     s : f(x) = a}

what is p(a)? (remember that an event is a subset of the sample space.) since
events of this kind are so important, we simplify the notation: we write

in place of

p(f = a)

p({x     s : f(x) = a}).

(there is a fairly common convention in id203 and statistics that random
variables are denoted by capital letters and their values by lower-case letters. in
fact, it is quite common to use the same letter in lower case for a value of the
random variable; thus, we would write p(f = f ) in the above example. but
remember that this is only a convention, and you are not bound to it.)

3.3. expected value and variance

41

the id203 mass function of a discrete random variable f is the function,
formula or table which gives the value of p(f = a) for each element a in the target
set of f. if f takes only a few values, it is convenient to list it in a table; otherwise
we should give a formula if possible. the standard abbreviation for    id203
mass function    is p.m.f.

example
of heads recorded. the possible values of x are 0,1,2,3, and its p.m.f. is

i toss a fair coin three times. the random variable x gives the number

p(x = a)

a 0 1 2 3
1
8

1
8

3
8

3
8

for the sample space is {hhh,hht,ht h,ht t,t hh,t ht,t t h,t t t}, and
each outcome is equally likely. the event x = 1, for example, when written as a
set of outcomes, is equal to {ht t,t ht,t t h}, and has id203 3/8.

two random variables x and y are said to have the same distribution if the
values they take and their id203 mass functions are equal. we write x     y
in this case.

in the above example, if y is the number of tails recorded during the experi-
ment, then x and y have the same distribution, even though their actual values are
different (indeed, y = 3    x).

3.3 expected value and variance

let x be a discrete random variable which takes the values a1, . . . ,an. the ex-
pected value or mean of x is the number e(x) given by the formula

e(x) =

n

   

i=1

aip(x = ai).

that is, we multiply each value of x by the id203 that x takes that value,
and sum these terms. the expected value is a kind of    generalised average   : if
each of the values is equally likely, so that each has id203 1/n, then e(x) =
(a1 +       + an)/n, which is just the average of the values.

there is an interpretation of the expected value in terms of mechanics. if we
put a mass pi on the axis at position ai for i = 1, . . . ,n, where pi = p(x = ai), then
the centre of mass of all these masses is at the point e(x).

if the random variable x takes in   nitely many values, say a1,a2,a3, . . ., then

we de   ne the expected value of x to be the in   nite sum

e(x) =

   
   

i=1

aip(x = ai).

42

chapter 3. random variables

of course, now we have to worry about whether this means anything, that is,
whether this in   nite series is convergent. this is a question which is discussed
at great length in analysis. we won   t worry about it too much. usually, discrete
random variables will only have    nitely many values; in the few examples we
consider where there are in   nitely many values, the series will usually be a ge-
ometric series or something similar, which we know how to sum. in the proofs
below, we assume that the number of values is    nite.
the variance of x is the number var(x) given by
var(x) = e(x 2)    e(x)2.

here, x 2 is just the random variable whose values are the squares of the values of
x. thus

e(x 2) =

a2
i p(x = ai)

n

   

i=1

(or an in   nite sum, if necessary). the next theorem shows that, if e(x) is a kind
of average of the values of x, then var(x) is a measure of how spread-out the
values are around their average.
proposition 3.1 let x be a discrete random variable with e(x) =   . then

var(x) = e((x       )2) =

(ai       )2p(x = ai).

n

   

i=1

for the second term is equal to the third by de   nition, and the third is

(ai       )2p(x = ai)

n

   

i=1
n

   

  n

i=1

   

i=1

=

=

i     2  ai +   2)p(x = ai)
(a2

!

  n

   

i=1

!

aip(x = ai)

+   2

!

p(x = ai)

.

  n

   

i=1

a2
i p(x = ai)

    2  

(what is happening here is that the entire sum consists of n rows with three terms
in each row. we add it up by columns instead of by rows, getting three parts with
n terms in each part.) continuing, we    nd

e((x       )2) = e(x 2)    2  e(x) +   2

= e(x 2)    e(x)2,

and we are done. (remember that e(x) =   , and that    n
the events x = ai form a partition.)

i=1 p(x = ai) = 1 since

3.4. joint p.m.f. of two random variables

43

some people take the conclusion of this proposition as the de   nition of vari-

ance.

i toss a fair coin three times; x is the number of heads. what are the

example
expected value and variance of x?
e(x) = 0   (1/8) + 1   (3/8) + 2   (3/8) + 3   (1/8) = 3/2,
var(x) = 02    (1/8) + 12    (3/8) + 22    (3/8) + 32    (1/8)    (3/2)2 = 3/4.

if we calculate the variance using proposition 3.1, we get

(cid:18)

   3
2

(cid:19)2    1

(cid:18)

+

8

   1
2

(cid:19)2    3

+

8

(cid:19)2    3

(cid:18)1

2

+

8

(cid:18)3

2

(cid:19)2    1

8

=

3
4

.

var(x) =

two properties of expected value and variance can be used as a check on your

calculations.

    the expected value of x always lies between the smallest and largest values

of x.

    the variance of x is never negative. (for the formula in proposition 3.1 is
a sum of terms, each of the form (ai       )2 (a square, hence non-negative)
times p(x = ai) (a id203, hence non-negative).

3.4

joint p.m.f. of two random variables

let x be a random variable taking the values a1, . . . ,an, and let y be a random
variable taking the values b1, . . . ,bm. we say that x and y are independent if, for
any possible values i and j, we have

p(x = ai,y = b j) = p(x = ai)   p(y = b j).

here p(x = ai,y = b j) means the id203 of the event that x takes the value
ai and y takes the value b j. so we could re-state the de   nition as follows:

the random variables x and y are independent if, for any value ai of
x and any value b j of y , the events x = ai and y = b j are independent
(events).

note the difference between    independent events    and    independent random vari-
ables   .

44

chapter 3. random variables

example
in chapter 2, we saw the following: i have two red pens, one green
pen, and one blue pen. i select two pens without replacement. then the events
   exactly one red pen selected    and    exactly one green pen selected    turned out to
be independent. let x be the number of red pens selected, and y the number of
green pens selected. then

p(x = 1,y = 1) = p(x = 1)   p(y = 1).

are x and y independent random variables?

no, because p(x = 2) = 1/6, p(y = 1) = 1/2, but p(x = 2,y = 1) = 0 (it is

impossible to have two red and one green in a sample of two).

on the other hand, if i roll a die twice, and x and y are the numbers that come
up on the    rst and second throws, then x and y will be independent, even if the
die is not fair (so that the outcomes are not all equally likely).

if we have more than two random variables (for example x,y,z), we say that
they are mutually independent if the events that the random variables take speci   c
values (for example, x = a, y = b, z = c) are mutually independent. (you may
want to revise the material on mutually independent events.)

what about the expected values of random variables? for expected value, it is

easy, but for variance it helps if the variables are independent:

theorem 3.2 let x and y be random variables.

(a) e(x +y ) = e(x) + e(y ).

(b) if x and y are independent, then var(x +y ) = var(x) + var(y ).

we will see the proof later.

if two random variables x and y are not independent, then knowing the p.m.f.
of each variable does not tell the whole story. the joint id203 mass function
(or joint p.m.f.) of x and y is the table giving, for each value ai of x and each
value b j of y , the id203 that x = ai and y = b j. we arrange the table so
that the rows correspond to the values of x and the columns to the values of y .
note that summing the entries in the row corresponding to the value ai gives the
id203 that x = ai; that is, the row sums form the p.m.f. of x. similarly the
column sums form the p.m.f. of y . (the row and column sums are sometimes
called the marginal distributions or marginals.)

in particular, x and y are independent r.v.s if and only if each entry of the

table is equal to the product of its row sum and its column sum.

3.4. joint p.m.f. of two random variables

45

example
i have two red pens, one green pen, and one blue pen, and i choose
two pens without replacement. let x be the number of red pens that i choose and
y the number of green pens. then the joint p.m.f. of x and y is given by the
following table:

y
0 1
0 0 1
6
x 1 1
1
3
3
2 1
6 0

the row and column sums give us the p.m.f.s for x and y :

a 0 1 2
1
6

2
3

1
6

p(x = a)

b 0 1
1
2

1
2

p(y = b)

now we give the proof of theorem 3.2.
we consider the joint p.m.f. of x and y . the random variable x +y takes the
values ai + b j for i = 1, . . . ,n and j = 1, . . . ,m. now the id203 that it takes
a given value ck is the sum of the probabilities p(x = ai,y = b j) over all i and j
such that ai + b j = ck. thus,
e(x +y ) =    

ckp(x +y = ck)

k
n

   

  n

i=1

m

   

j=1

ai

m

   

j=1

   

i=1

=

=

(ai + b j)p(x = ai,y = b j)

p(x = ai,y = b j)

+

!

  m

   

j=1

!

p(x = ai,y = b j)

.

b j

n

   

i=1

now    m
p(x = ai), and similarly    n
p(y = b j). so

j=1 p(x = ai,y = b j) is a row sum of the joint p.m.f. table, so is equal to
i=1 p(x = ai,y = b j) is a column sum and is equal to

e(x +y ) =

n

   

i=1

aip(x = ai) +

m

   

j=1

b jp(y = b j)

= e(x) + e(y ).

the variance is a bit trickier. first we calculate

e((x +y )2) = e(x 2 + 2xy +y 2) = e(x 2) + 2e(xy ) + e(y 2),

46

chapter 3. random variables

using part (a) of the theorem. we have to consider the term e(xy ). for this, we
have to make the assumption that x and y are independent, that is,

p(x = a1,y = b j) = p(x = ai)   p(y = b j).

as before, we have

e(xy ) =

=

m

   

j=1
n

   

j=1

n

   

i=1
n

   

  n

i=1

aib jp(x = ai,y = b j)

aib jp(x = ai)p(y = b j)

!

  m

  

   

j=1

!

b jp(y = b j)

   

aip(x = ai)

=
= e(x)   e(y ).

i=1

so
var(x +y ) = e((x +y )2)    (e(x +y ))2

= (e(x 2) + 2e(xy ) + e(y 2))    (e(x)2 + 2e(x)e(y ) + e(y )2)
= (e(x 2)    e(x)2) + 2(e(xy )    e(x)e(y )) + (e(y 2)    e(y )2)
= var(x) + var(y ).

to    nish this section, we consider constant random variables. (if the thought
of a    constant variable    worries you, remember that a random variable is not a
variable at all but a function, and there is nothing amiss with a constant function.)

proposition 3.3 let c be a constant random variable with value c. let x be any
random variable.

(a) e(c) = c, var(c) = 0.

(b) e(x + c) = e(x) + c, var(x + c) = var(x).

(c) e(cx) = ce(x), var(cx) = c2 var(x).

(a) the random variable c takes the single value c with p(c = c) = 1. so

proof
e(c) = c   1 = c. also,

var(c) = e(c2)    e(c)2 = c2     c2 = 0.

(for c2 is a constant random variable with value c2.)

3.5. some discrete random variables

47

(b) this follows immediately from theorem 3.2, once we observe that the
constant random variable c and any random variable x are independent. (this is
true because p(x = a,c = c) = p(x = a)   1.) then

e(x + c) = e(x) + e(c) = e(x) + c,
var(x + c) = var(x) + var(c) = var(x).

(c) if a1, . . . ,an are the values of x, then ca1, . . . ,can are the values of cx, and

p(cx = cai) = p(x = ai). so

e(cx) =

caip(cx = cai)

= c

aip(x = ai)

n

   

i=1
n

   

i=1

then

= ce(x).

var(cx) = e(c2x 2)    e(cx)2
= c2e(x 2)    (ce(x))2
= c2(e(x 2)    e(x)2)
= c2 var(x).

3.5 some discrete random variables

we now look at    ve types of discrete random variables, each depending on one or
more parameters. we describe for each type the situations in which it arises, and
give the p.m.f., the expected value, and the variance. if the variable is tabulated
in the new cambridge statistical tables, we give the table number, and some
examples of using the tables. you should have a copy of the tables to follow the
examples.

a summary of this information is given in appendix b.
before we begin, a comment on the new cambridge statistical tables. they
don   t give the id203 mass function (or p.m.f.), but a closely related function
called the cumulative distribution function. it is de   ned for a discrete random
variable as follows.
let x be a random variable taking values a1,a2, . . . ,an. we assume that these
are arranged in ascending order: a1 < a2 <        < an. the cumulative distribution
function, or c.d.f., of x is given by

fx(ai) = p(x     ai).

48

chapter 3. random variables

we see that it can be expressed in terms of the p.m.f. of x as follows:

fx(ai) = p(x = a1) +       + p(x = ai) =

i

   

j=1

p(x = a j).

in the other direction, we cn recover the p.m.f. from the c.d.f.:

p(x = ai) = fx(ai)    fx(ai   1).

we won   t use the c.d.f. of a discrete random variable except for looking up

the tables. it is much more important for continuous random variables!

bernoulli random variable bernoulli(p)
a bernoulli random variable is the simplest type of all. it only takes two values,
0 and 1. so its p.m.f. looks as follows:

x 0 1
p(x = x) q p

here, p is the id203 that x = 1; it can be any number between 0 and 1.
necessarily q (the id203 that x = 0) is equal to 1     p. so p determines
everything.

for a bernoulli random variable x, we sometimes describe the experiment as

a    trial   , the event x = 1 as   success   , and the event x = 0 as    failure   .

for example, if a biased coin has id203 p of coming down heads, then
the number of heads that we get when we toss the coin once is a bernoulli(p)
random variable.

more generally, let a be any event in a id203 space s. with a, we asso-
ciate a random variable ia (remember that a random variable is just a function on
s) by the rule

n1

0

if s     a;
if s /    a.

ia(s) =

the random variable ia is called the indicator variable of a, because its value
indicates whether or not a occurred. it is a bernoulli(p) random variable, where
p = p(a). (the event ia = 1 is just the event a.) some people write 11a instead of
ia.
calculation of the expected value and variance of a bernoulli random variable
is easy. let x     bernoulli(p). (remember that     means    has the same p.m.f.
as   .)
e(x) = 0   q + 1   p = p;
var(x) = 02    q + 12    p    p2 = p    p2 = pq.
(remember that q = 1    p.)

3.5. some discrete random variables

49

binomial random variable bin(n, p)
remember that for a bernoulli random variable, we describe the event x = 1 as a
   success   . now a binomial random variable counts the number of successes in n
independent trials each associated with a bernoulli(p) random variable.

for example, suppose that we have a biased coin for which the id203 of
heads is p. we toss the coin n times and count the number of heads obtained. this
number is a bin(n, p) random variable.

a bin(n, p) random variable x takes the values 0,1,2, . . . ,n, and the p.m.f. of

x is given by

p(x = k) = nckqn   k pk

for k = 0,1,2, . . . ,n, where q = 1    p. this is because there are nck different ways
of obtaining k heads in a sequence of n throws (the number of choices of the k
positions in which the heads occur), and the id203 of getting k heads and
n    k tails in a particular order is qn   k pk.

note that we have given a formula rather than a table here. for small values

we could tabulate the results; for example, for bin(4, p):

k

4
p(x = k) q4 4q3p 6q2p2 4qp3 p4

0

1

2

3

note: when we add up all the probabilities in the table, we get

nckqn   k pk = (q + p)n = 1,

n

   

k=0

as it should be: here we used the binomial theorem

(x + y)n =

nckxn   kyk.

n

   

k=0

(this argument explains the name of the binomial random variable!)

if x     bin(n, p), then

e(x) = np,

var(x) = npq.

there are two ways to prove this, an easy way and a harder way. the easy way
only works for the binomial, but the harder way is useful for many random vari-
ables. however, you can skip it if you wish: i have set it in smaller type for this
reason.

here is the easy method. we have a coin with id203 p of coming down
heads, and we toss it n times and count the number x of heads. then x is our
bin(n, p) random variable. let xk be the random variable de   ned by

(cid:26)1

0

xk =

if we get heads on the kth toss,
if we get tails on the kth toss.

50

chapter 3. random variables

in other words, xi is the indicator variable of the event    heads on the kth toss   .
now we have

x = x1 + x2 +       + xn

(can you see why?), and x1, . . . ,xn are independent bernoulli(p) random variables
(since they are de   ned by different tosses of a coin). so, as we saw earlier, e(xi) =
p, var(xi) = pq. then, by theorem 21, since the variables are independent, we
have

e(x) = p + p +       + p = np,
var(x) = pq + pq +       + pq = npq.

the other method uses a gadget called the id203 generating function. we only use it
here for calculating expected values and variances, but if you learn more id203 theory you
will see other uses for it. let x be a random variable whose values are non-negative integers. (we
don   t insist that it takes all possible values; this method is    ne for the binomial bin(n, p), which
takes values between 0 and n. to save space, we write pk for the id203 p(x = k). now the
id203 generating function of x is the power series
gx(x) =     pkxk.

(the sum is over all values k taken by x.)

we use the notation [f(x)]x=1 for the result of substituting x = 1 in the series f(x).

proposition 3.4 let gx(x) be the id203 generating function of a random variable x. then
(a) [gx(x)]x=1 = 1;

(b) e(x) =(cid:2) d
dx gx(x)(cid:3)
h d2

(c) var(x) =

dx2 gx(x)

i

x=1;

x=1

+ e(x)    e(x)2.

part (a) is just the statement that probabilities add up to 1: when we substitute x = 1 in the

for part (b), when we differentiate the series term-by-term (you will learn later in analysis

power series for gx(x) we just get     pk.

that this is ok), we get

d
dx
now putting x = 1 in this series we get

gx(x) =    kpkxk   1.

   kpk = e(x).

for part (c), differentiating twice gives

d2
dx2 gx(x) =    k(k    1)pkxk   2.

now putting x = 1 in this series we get

   k(k    1)pk =    k2 pk       kpk = e(x 2)    e(x).

adding e(x) and subtracting e(x)2 gives e(x 2)    e(x)2, which by de   nition is var(x).

3.5. some discrete random variables

51

now let us appply this to the binomial random variable x     bin(n, p). we have

pk = p(x = k) = nckqn   k pk,

so the id203 generating function is

nckqn   k pkxk = (q + px)n,

n

   

k=0

by the binomial theorem. putting x = 1 gives (q + p)n = 1, in agreement with proposition 3.4(a).
differentiating once, using the chain rule, we get np(q + px)n   1. putting x = 1 we    nd that

e(x) = np.

differentiating again, we get n(n    1)p2(q + px)n   2. putting x = 1 gives n(n    1)p2. now adding
e(x)    e(x)2, we get

var(x) = n(n    1)p2 + np    n2 p2 = np    np2 = npq.

the binomial random variable is tabulated in table 1 of the cambridge statis-
tical tables [1]. as explained earlier, the tables give the cumulative distribution
function.

for example, suppose that the id203 that a certain coin comes down
heads is 0.45. if the coin is tossed 15 times, what is the id203 of    ve or
fewer heads? turning to the page n = 15 in table 1 and looking at the row 0.45,
you read off the answer 0.2608. what is the id203 of exactly    ve heads? this
is p(5 or fewer)   p(4 or fewer), and from tables the answer is 0.2608   0.1204 =
0.1404.
the tables only go up to p = 0.5. for larger values of p, use the fact that the
number of failures in bin(n, p) is equal to the number of successes in bin(n,1   
p). so the id203 of    ve heads in 15 tosses of a coin with p = 0.55 is 0.9745   
0.9231 = 0.0514.

another interpretation of the binomial random variable concerns sampling.
suppose that we have n balls in a box, of which m are red. we sample n balls
from the box with replacement; let the random variable x be the number of red
balls in the sample. what is the distribution of x? since each ball has id203
m/n of being red, and different choices are independent, x     bin(n, p), where
p = m/n is the proportion of red balls in the sample.

what about sampling without replacement? this leads us to our next random

variable:

hypergeometric random variable hg(n,m,n)
suppose that we have n balls in a box, of which m are red. we sample n balls
from the box without replacement. let the random variable x be the number of

52

chapter 3. random variables

red balls in the sample. such an x is called a hypergeometric random variable
hg(n,m,n).

the random variable x can take any of the values 0,1,2, . . . ,n. its p.m.f. is

given by the formula

p(x = k) =

mck    n   mcn   k

ncn

.

for the number of samples of n balls from n is ncn; the number of ways of
choosing k of the m red balls and n   k of the n    m others is mck    n   mcn   k; and
all choices are equally likely.

the expected value and variance of a hypergeometric random variable are as

follows (we won   t go into the proofs):

(cid:18)m

(cid:19)

n

(cid:18)m

(cid:19)(cid:18)n     m

(cid:19)(cid:18)n     n

(cid:19)

n

n

n     1

.

e(x) = n

,

var(x) = n

you should compare these to the values for a binomial random variable. if we
let p = m/n be the proportion of red balls in the hat, then e(x) = np, and var(x)
is equal to npq multiplied by a    correction factor    (n     n)/(n     1).
in particular, if the numbers m and n     m of red and non-red balls in the
hat are both very large compared to the size n of the sample, then the difference
between sampling with and without replacement is very small, and indeed the
   correction factor    is close to 1. so we can say that hg(n,m,n) is approximately
bin(n,m/n) if n is small compared to m and n     m.

consider our example of choosing two pens from four, where two pens are
red, one green, and one blue. the number x of red pens is a hg(2,2,4) random
variable. we calculated earlier that p(x = 0) = 1/6, p(x = 1) = 2/3 and p(x =
2) = 1/6. from this we    nd by direct calculation that e(x) = 1 and var(x) = 1/3.
these agree with the formulae above.

geometric random variable geom(p)
the geometric random variable is like the binomial but with a different stopping
rule. we have again a coin whose id203 of heads is p. now, instead of
tossing it a    xed number of times and counting the heads, we toss it until it comes
down heads for the    rst time, and count the number of times we have tossed
the coin. thus, the values of the variable are the positive integers 1, ,2,3, . . . (in
theory we might never get a head and toss the coin in   nitely often, but if p > 0
this possibility is    in   nitely unlikely   , i.e. has id203 zero, as we will see.)
we always assume that 0 < p < 1.

more generally, the number of independent bernoulli trials required until the

   rst success is obtained is a geometric random variable.

3.5. some discrete random variables

53

the p.m.f of a geom(p) random variable is given by

p(x = k) = qk   1p,

where q = 1    p. for the event x = id116 that we get tails on the    rst k     1
tosses and heads on the kth, and this event has id203 qk   1p, since    tails    has
id203 q and different tosses are independent.

let   s add up these probabilities:

   
   

k=1

qk   1p = p + qp + q2p +       =

p
1    q

= 1,

since the series is a geometric progression with    rst term p and common ratio
q, where q < 1. (just as the binomial theorem shows that probabilities sum to 1
for a binomial random variable, and gives its name to the random variable, so the
geometric progression does for the geometric random variable.)

we calculate the expected value and the variance using the id203 gener-

ating function. if x     geom(p), the result will be that

we have

e(x) = 1/p,

var(x) = q/p2.

gx(x) =

   
   

k=1

qk   1 pxk =

px
1    qx ,

again by summing a geometric progression. differentiating, we get

d
dx

gx(x) =

(1    qx)p + pxq

(1    qx)2

=

p

(1    qx)2 .

putting x = 1, we obtain

e(x) =

p

(1    q)2 =

1
p .

differentiating again gives 2pq/(1    qx)3, so

var(x) =

2pq
p3 +

1
p

    1

p2 =

q
p2 .

for example, if we toss a fair coin until heads is obtained, the expected number
of tosses until the    rst head is 2 (so the expected number of tails is 1); and the
variance of this number is also 2.

54

chapter 3. random variables

poisson random variable poisson(  )
the poisson random variable, unlike the ones we have seen before, is very closely
connected with continuous things.

suppose that    incidents    occur at random times, but at a steady rate overall.
the best example is radioactive decay: atomic nuclei decay randomly, but the
average number    which will decay in a given interval is constant. the poisson
random variabe x counts the number of    incidents    which occur in a given interval.
so if, on average, there are 2.4 nuclear decays per second, then the number of
decays in one second starting now is a poisson(2.4) random variable.

another example might be the number of telephone calls a minute to a busy

although we will not prove it, the p.m.f. for a poisson(  ) variable x is given

telephone number.

by the formula

let   s check that these probabilities add up to one. we get

p(x = k) =

e     .

  k
k!

!

     

  k
k!

   

k=0

e      = e      e      = 1,

since the expression in brackets is the sum of the exponential series.

by analogy with what happened for the binomial and geometric random vari-
ables, you might have expected that this random variable would be called    expo-
nential   . unfortunately, this name has been given to a closely-related continuous
random variable which we will meet later. however, if you speak a little french,
you might use as a mnemonic the fact that if i go    shing, and the    sh are biting at
the rate of    per hour on average, then the number of    sh i will catch in the next
hour is a poisson(  ) random variable.

the expected value and variance of a poisson(  ) random variable x are given

by

again we use the id203 generating function. if x     poisson(  ), then

e(x) = var(x) =   .

gx(x) =

   
   

k=0

(  x)k
k!

e      = e  (x   1),

again using the series for the exponential function.

differentiation gives   e  (x   1), so e(x) =   . differentiating again gives   2e  (x   1), so

var(x) =   2 +         2 =   .

3.6. continuous random variables

55

the cumulative distribution function of a poisson random variable is tabulated
in table 2 of the new cambridge statistical tables. so, for example, we    nd from
the tables that, if 2.4    sh bite per hour on average, then the id203 that i will
catch no    sh in the next hour is 0.0907, while the id203 that i catch at    ve or
fewer is 0.9643 (so that the id203 that i catch six or more is 0.0357).

there is another situation in which the poisson distribution arises. suppose i
am looking for some very rare event which only occurs once in 1000 trials on av-
erage. so i conduct 1000 independent trials. how many occurrences of the event
do i see? this number is really a binomial random variable bin(1000,1/1000).
but it turns out to be poisson(1), to a very good approximation. so, for example,
the id203 that the event doesn   t occur is about 1/e.

the general rule is:

if n is large, p is small, and np =   , then bin(n, p) can be approxi-
mated by poisson(  ).

3.6 continuous random variables

we haven   t so far really explained what a continuous random variable is. its target
set is the set of real numbers, or perhaps the non-negative real numbers or just an
interval. the crucial property is that, for any real number a, we have (x = a) = 0;
that is, the id203 that the height of a random student, or the time i have to
wait for a bus, is precisely a, is zero. so we can   t use the id203 mass function
for continuous random variables; it would always be zero and give no information.
we use the cumulative distribution function or c.d.f. instead. remember from

last week that the c.d.f. of the random variable x is the function fx de   ned by

fx(x) = p(x     x).

note: the name of the function is fx; the lower case x refers to the argument
of the function, the number which is substituted into the function. it is common
but not universal to use as the argument the lower-case version of the name of the
random variable, as here. note that fx(y) is the same function written in terms of
the variable y instead of x, whereas fy (x) is the c.d.f. of the random variable y
(which might be a completely different function.)
now let x be a continuous random variable. then, since the id203 that
x takes the precise value x is zero, there is no difference between p(x     x) and
p(x < x).

proposition 3.5 the c.d.f.
fx(y) if x < y), and approaches the limits 0 as x            and 1 as x        .

is an increasing function (this means that fx(x)    

56

chapter 3. random variables

the function is increasing because, if x < y, then

fx(y)    fx(x) = p(x     y)    p(x     x) = p(x < x     y)     0.

also fx(   ) = 1 because x must certainly take some    nite value; and fx(      ) = 0
because no value is smaller than       !

another important function is the id203 density function fx. it is ob-

tained by differentiating the c.d.f.:

fx(x) =

d
dx

fx(x).

now fx(x) is non-negative, since it is the derivative of an increasing function. if
we know fx(x), then fx is obtained by integrating. because fx(      ) = 0, we
have

z x

      

fx(x) =

fx(t)dt.

note the use of the    dummy variable    t in this integral. note also that

p(a     x     b) = fx(b)    fx(a) =

fx(t)dt.

z b

a

you can think of the p.d.f. like this: the id203 that the value of x lies in a
very small interval from x to x + h is approximately fx(x)   h. so, although the
id203 of getting exactly the value x is zero, the id203 of being close to
x is proportional to fx(x).

there is a mechanical analogy which you may    nd helpful. remember that
we modelled a discrete random variable x by placing at each value a of x a mass
equal to p(x = a). then the total mass is one, and the expected value of x is
the centre of mass. for a continuous random variable, imagine instead a wire of
variable thickness, so that the density of the wire (mass per unit length) at the
point x is equal to fx(x). then again the total mass is one; the mass to the left of
x is fx(x); and again it will hold that the centre of mass is at e(x).

most facts about continuous random variables are obtained by replacing the
p.m.f. by the p.d.f. and replacing sums by integrals. thus, the expected value of
x is given by

e(x) =

and the variance is (as before)

x fx(x)dx,

var(x) = e(x 2)    e(x)2,

where

e(x 2) =

x2 fx(x)dx.

it is also true that var(x) = e((x       )2), where    = e(x).

z    

      

z    

      

3.7. median, quartiles, percentiles

57

we will see examples of these calculations shortly. but here is a small example
to show the ideas. the support of a continuous random variable is the smallest
interval containing all values of x where fx(x) > 0.

suppose that the random variable x has p.d.f. given by

n2x
z 1

0

0

if 0     x     1,
otherwise.

2x dx =(cid:2)x2(cid:3)x=1
(0

the support of xis the interval [0,1]. we check the integral:

fx(x)dx =

x=0 = 1.

the cumulative distribution function of x is

fx(x) =

fx(t)dt =

(study this carefully to see how it works.) we have

z    

      

fx(x) =

      

z x
z    
z    

      

x2
1

if x < 0,
if 0     x     1,
if x > 1.
z 1
z 1

2
3
1
2x3dx =
2

2x2dx =

0

,

0

,

e(x) =

x fx(x)dx =

e(x 2) =

x2 fx(x)dx =

(cid:18)2

(cid:19)2

3

      
1
   
2

=

1
18

.

var(x) =

3.7 median, quartiles, percentiles

another measure commonly used for continuous random variables is the median;
this is the value m such that    half of the distribution lies to the left of m and half to
the right   . more formally, m should satisfy fx(m) = 1/2. it is not the same as the
mean or expected value. in the example at the end of the last section, we saw that
e(x) = 2/3. the median of x is the value of m for which fx(m) = 1/2. since
fx(x) = x2 for 0     x     1, we see that m = 1/

if there is a value m such that the graph of y = fx(x) is symmetric about x = m,

   

2.

then both the expected value and the median of x are equal to m.

the lower quartile l and the upper quartile u are similarly de   ned by

fx(l) = 1/4,

fx(u) = 3/4.

thus, the id203 that x lies between l and u is 3/4    1/4 = 1/2, so the quar-
tiles give an estimate of how spread-out the distribution is. more generally, we
de   ne the nth percentile of x to be the value of xn such that

fx(xn) = n/100,

58

chapter 3. random variables

that is, the id203 that x is smaller than xn is n%.

reminder

if the c.d.f. of x is fx(x) and the p.d.f. is fx(x), then

    differentiate fx to get fx, and integrate fx to get fx;
    use fx to calculate e(x) and var(x);
    use fx to calculate p(a     x     b) (this is fx(b)    fx(a)), and the median

and percentiles of x.

3.8 some continuous random variables

in this section we examine three important continuous random variables: the uni-
form, exponential, and normal. the details are summarised in appendix b.

uniform random variable u(a,b)
let a and b be real numbers with a < b. a uniform random variable on the interval
[a,b] is, roughly speaking,    equally likely to be anywhere in the interval   . in other
words, its id203 density function is constant on the interval [a,b] (and zero
outside the interval). what should the constant value c be? the integral of the
is the area of a rectangle of height c and base b     a; this must be 1, so
p.d.f.
c = 1/(b    a). thus, the p.d.f. of the random variable x     u(a,b) is given by

by integration, we    nd that the c.d.f. is

fx(x) =

n1/(b    a)
(0

0

if a     x     b,
otherwise.

fx(x) =

(x    a)/(b    a)
1

if x < a,
if a     x     b,
if x > b.

further calculation (or the symmetry of the p.d.f.) shows that the expected value
and the median of x are both given by (a + b)/2 (the midpoint of the interval),
while var(x) = (b    a)2/12.

the uniform random variable doesn   t really arise in practical situations. how-
ever, it is very useful for simulations. most computer systems include a random
number generator, which apparently produces independent values of a uniform
random variable on the interval [0,1]. of course, they are not really random, since
the computer is a deterministic machine; but there should be no obvious pattern to

3.8. some continuous random variables

59

the numbers produced, and in a large number of trials they should be distributed
uniformly over the interval.

you will learn in the statistics course how to use a uniform random variable
to construct values of other types of discrete or continuous random variables. its
great simplicity makes it the best choice for this purpose.

exponential random variable exp(  )
the exponential random variable arises in the same situation as the poisson: be
careful not to confuse them! we have events which occur randomly but at a con-
stant average rate of    per unit time (e.g. radioactive decays,    sh biting). the
poisson random variable, which is discrete, counts how many events will occur
in the next unit of time. the exponential random variable, which is continuous,
measures exactly how long from now it is until the next event occurs. not that it
takes non-negative real numbers as values.

if x     exp(  ), the p.d.f. of x is

fx(x) =

  e     x

(cid:26)0
(cid:26)0

if x < 0,
if x     0.

if x < 0,
if x     0.

by integration, we    nd the c.d.f. to be

fx(x) =

further calculation gives

1    e     x

e(x) = 1/  ,

var(x) = 1/  2.

the median m satis   es 1    e     m = 1/2, so that m = log2/  . (the logarithm is to
base e, so that log2 = 0.69314718056 approximately.

normal random variable n(  ,  2)
the normal random variable is the commonest of all in applications, and the most
important. there is a theorem called the central limit theorem which says that, for
virtually any random variable x which is not too bizarre, if you take the sum (or
the average) of n independent random variables with the same distribution as x,
the result will be approximately normal, and will become more and more like a
normal variable as n grows. this partly explains why a random variable affected
by many independent factors, like a man   s height, has an approximately normal
distribution.

60

chapter 3. random variables

more precisely, if n is large, then a bin(n, p) random variable is well approx-
imated by a normal random variable with the same expected value np and the
same variance npq. (if you are approximating any discrete random variable by a
continuous one, you should make a    continuity correction        see the next section
for details and an example.)

the p.d.f. of the random variable x     n(  ,  2) is given by the formula

fx(x) =

1
   
2  
  

e   (x     )2/2  2

.

we have e(x) =    and var(x) =   2. the picture below shows the graph of this
function for    = 0, the familiar    bell-shaped curve   .

.........
.........
..........
..........
..........
..........
...........
...........
..........
..........
............
............
......
......
........
........
...........
...........
..........................
..........................
..........................
..........................
..............
.........................
...........
............
............
...........
...........
...........
...........
...........
...........
.....................
.....................
..........
..........
.........
..........
.........
..........
..................

..................
.

....................
.........
..........
.........
..........
..................

..................

the c.d.f. of x is obtained as usual by integrating the p.d.f. however, it is not
possible to write the integral of this function (which, stripped of its constants, is
e   x2) in terms of    standard    functions. so there is no alternative but to make tables
of its values.

the crucial fact that means that we don   t have to tabulate the function for all

values of    and    is the following:
proposition 3.6 if x     n(  ,  2), and y = (x       )/  , then y     n(0,1).

so we only need tables of the c.d.f. for n(0,1)     this is the so-called standard
normal random variable     and we can    nd the c.d.f. of any normal random vari-
able. the c.d.f. of the standard normal is given in table 4 of the new cambridge
statistical tables [1]. the function is called    in the tables.
for example, suppose that x     n(6,25).what is the id203 that x     8?
putting y = (x     6)/5, so that y     n(0,1), we    nd that x     8 if and only if
y     (8    6)/5 = 0.4. from the tables, the id203 of this is   (0.4) = 0.6554.
the p.d.f. of a standard normal r.v. y is symmetric about zero. this means

that, for any positive number c,

  (   c) = p(y        c) = p(y     c) = 1    p(y     c) = 1      (c).

so it is only necessary to tabulate the function for positive values of its argument.

so, if x     n(6,25) and y = (x     6)/5 as before, then

p(x     3) = p(y        0.6) = 1    p(y     0.6) = 1    0.7257 = 0.2743.

3.9. on using tables
3.9 on using tables

61

we end this section with a few comments about using tables, not tied particularly
to the normal distribution (though most of the examples will come from there).

interpolation
any table is limited in the number of entries it contains. tabulating something
with the input given to one extra decimal place would make the table ten times as
bulky! interpolation can be used to extend the range of values tabulated.

suppose that some function f is tabulated with the input given to three places
it is probably true that f is changing at a roughly constant rate
of decimals.
between, say, 0.28 and 0.29. so f(0.283) will be about three-tenths of the way
between f(0.28) and f(0.29).

for example, if    is the c.d.f. of the normal distribution, then   (0.28) =
0.6103 and   (0.29) = 0.6141, so   (0.283) = 0.6114. (three-tenths of 0.0038 is
0.0011.)

using tables in reverse
this means, if you have a table of values of f, use it to    nd x such that f(x) is a
given value c. usually, c won   t be in the table and we have to interpolate between
values x1 and x2, where f(x1) is just less than c and f(x2) is just greater.

for example, if    is the c.d.f. of the normal distribution, and we want the
upper quartile, then we    nd from tables   (0.67) = 0.7486 and   (0.68) = 0.7517,
so the required value is about 0.6745 (since 0.0014/0.0031 = 0.45).

in this case, the percentile points of the standard normal r.v. are given in table
5 of the new cambridge statistical tables [1], so you don   t need to do this. but
you will    nd it necessary in other cases.

continuity correction
suppose we know that a discrete random variable x is well approximated by a
continuous random variable y . we are given a table of the c.d.f. of y and want to
   nd information about x. for example, suppose that x takes integer values and
we want to    nd p(a     x     b), where a and b are integers. this id203 is
equal to

p(x = a) + p(x = a + 1) +       + p(x = b).

to say that x can be approximated by y means that, for example, p(x = a) is
approximately equal to fy (a), where fy is the p.d.f. of y . this is equal to the area

62
chapter 3. random variables
of a rectangle of height fy (a) and base 1 (from a    0.5 to a + 0.5). this in turn is,
to a good approximation, the area under the curve y = fy (x) from x = a    0.5 to
x = a + 0.5, since the pieces of the curve above and below the rectangle on either
side of x = a will approximately cancel. similarly for the other values.

.

.................................

................................

y= fy (x)up(x=a)

................................

...............................

..............................

.............................

.............................

............................

a   0.5

a

a+0.5

adding all these pieces. we    nd that p(a     x     b) is approximately equal to
the area under the curve y = fy (x) from x = a    0.5 to x = b + 0.5. this area is
given by fy (b + 0.5)    fy (a    0.5), since fy is the integral of fy . said otherwise,
this is p(a    0.5     y     b + 0.5).

we summarise the continuity correction:

suppose that the discrete random variable x, taking integer values, is
approximated by the continuous random variable y . then
p(a    x     b)    p(a   0.5    y     b+0.5) = fy (b+0.5)   fy (a   0.5).

(here,     means    approximately equal   .) similarly, for example, p(x     b)    

p(y     b + 0.5), and p(x     a)     p(y     a    0.5).

example the id203 that a light bulb will fail in a year is 0.75, and light
bulbs fail independently. if 192 bulbs are installed, what is the id203 that the
number which fail in a year lies between 140 and 150 inclusive?

solution let x be the number of light bulbs which fail in a year. then x    
bin(192,3/4), and so e(x) = 144, var(x) = 36. so x is approximated by y    
n(144,36), and

p(140     x     150)     p(139.5     y     150.5)

by the continuity correction.

3.10. worked examples

let z = (y     144)/6. then z     n(0,1), and

p(139.5     y     150.5) = p

(cid:18)139.5    144

6

    z     150.5    144

6

= p(   0.75     z     1.083)
= 0.8606    0.2268
= 0.6338.

(from tables)

63

(cid:19)

3.10 worked examples
question i roll a fair die twice. let the random variable x be the maximum of
the two numbers obtained, and let y be the modulus of their difference (that is,
the value of y is the larger number minus the smaller number).

(a) write down the joint p.m.f. of (x,y ).

(b) write down the p.m.f. of x, and calculate its expected value and its variance.

(c) write down the p.m.f. of y , and calculate its expected value and its variance.

(d) are the random variables x and y independent?

solution (a)

y

1
2
3
x 4
5
6

0
1
36
1
36
1
36
1
36
1
36
1
36

1
0
2
36
2
36
2
36
2
36
2
36

2
0
0
2
36
2
36
2
36
2
36

3
0
0
0
2
36
2
36
2
36

4
0
0
0
0
2
36
2
36

5
0
0
0
0
0
2
36

the best way to produce this is to write out a 6   6 table giving all possible values
for the two throws, work out for each cell what the values of x and y are, and
then count the number of occurrences of each pair. for example: x = 5, y = 2
can occur in two ways: the numbers thrown must be (5,3) or (3,5).

(b) take row sums:

x
p(x = x)

1
1
36

2
3
36

3
5
36

4
7
36

5
9
36

6
11
36

64

chapter 3. random variables

hence in the usual way

e(x) =

161
36

,

var(x) =

2555
1296

.

(c) take column sums:

y
p(y = y)

0
6
36

1
10
36

2
8
36

3
6
36

4
4
36

5
2
36

.

665
324

and so

e(y ) =

35
18

,

var(y ) =

(d) no: e.g. p(x = 1,y = 2) = 0 but p(x = 1)   p(y = 2) = 8

1296.

question an archer shoots an arrow at a target. the distance of the arrow from
the centre of the target is a random variable x whose p.d.f. is given by

(cid:26)(3 + 2x    x2)/9

fx(x) =

0

if x     3,
if x > 3.

the archer   s score is determined as follows:

distance x < 0.5 0.5     x < 1 1     x < 1.5 1.5     x < 2 x     2
score

10

7

4

1

0

construct the id203 mass function for the archer   s score, and    nd the archer   s
expected score.

solution first we work out the id203 of the arrow being in each of the
given bands:

p(x < 0.5) = fx(0.5)    fx(0) =

=

=

3 + 2x    x2

z 0.5
(cid:20)9x + 3x2     x3

9

0

dx

(cid:21)1/2

27

0

.

41
216

similarly we    nd that p(0.5     x < 1) = 47/216, p(1     x < 1.5) = 47/216,
p(1.5     x < 2) = 41/216, and p(x     2) = 40/216. so the p.m.f. fot the archer   s
score s is

s
p(s = s)

0
40
216

1
41
216

4
47
216

7
47
216

10
41
216

3.10. worked examples

65

hence

e(s) =

41 + 47   4 + 47   7 + 41   10

216

=

121
27

.

question let t be the lifetime in years of new bus engines. suppose that t is
continuous with id203 density function

               0

d
x3

ft (x) =

for x < 1

for x > 1

for some constant d.

(a) find the value of d.

(b) find the mean and median of t .

(c) suppose that 240 new bus engines are installed at the same time, and that
their lifetimes are independent. by making an appropriate approximation,
   nd the id203 that at most 10 of the engines last for 4 years or more.

solution (a) the integral of ft (x), over the support of t , must be 1. that is,

1 =

z    
(cid:20)   d

1

(cid:21)   
d
x3 dx

=

2x2
= d/2,

1

so d = 2.

(b) the c.d.f. of t is obtained by integrating the p.d.f.; that is, it is

               0

ft (x) =

1    1
x2
z    

for x < 1

for x > 1

2
x2 dx = 2.

x ft (x) dx =

1

the mean of t is

z    

1

the median is the value m such that ft (m) = 1/2. that is, 1    1/m2 = 1/2,

   
2.

or m =

66

chapter 3. random variables

(c) the id203 that an engine lasts for four years or more is

 

(cid:19)2!

(cid:18)1

4

=

1
16

.

1    ft (4) = 1   

1   

so, if 240 engines are installed, the number which last for four years or more
is a binomial random variable x     bin(240,1/16), with expected value 240   
(1/16) = 15 and variance 240   (1/16)   (15/16) = 225/16.
we approximate x by y     n(15,(15/4)2). using the continuity correction,
p(x     10)     p(y     10.5).
now, if z = (y     15)/(15/4), then z     n(0,1), and
p(y     10.5) = p(z        1.2)
= 1    p(z     1.2)
= 0.1151

using the table of the standard normal distribution.

note that we start with the continuous random variable t , move to the discrete
random variable x, and then move on to the continuous random variables y and
z, where    nally z is standard normal and so is in the tables.

a true story the answer to the question at the end of the last chapter: as the
students in the class obviously knew, the class included a pair of twins! (the twins
were leo and willy moser, who both had successful careers as mathematicians.)
but what went wrong with our argument for the birthday paradox? we as-
sumed (without saying so) that the birthdays of the people in the room were inde-
pendent; but of course the birthdays of twins are clearly not independent!

chapter 4

more on joint distribution

we have seen the joint p.m.f. of two discrete random variables x and y , and we
have learned what it means for x and y to be independent. now we examine
this further to see measures of non-independence and conditional distributions of
random variables.

4.1 covariance and correlation

in this section we consider a pair of discrete random variables x and y . remember
that x and y are independent if

p(x = ai,y = b j) = p(x = ai)   p(y = b j)

holds for any pair (ai,b j) of values of x and y . we introduce a number (called
the covariance of x and y ) which gives a measure of how far they are from being
independent.

look back at the proof of theorem 21(b), where we showed that if x and y
are independent then var(x +y ) = var(x) + var(y ). we found that, in any case,

var(x +y ) = var(x) + var(y ) + 2(e(xy )    e(x)e(y )),

and then proved that if x and y are independent then e(xy ) = e(x)e(y ), so that
the last term is zero.
now we de   ne the covariance of x and y to be e(xy )     e(x)e(y ). we
write cov(x,y ) for this quantity. then the argument we had earlier shows the
following:

theorem 4.1 (a) var(x +y ) = var(x) + var(y ) + 2cov(x,y ).

(b) if x and y are independent, then cov(x,y ) = 0.

67

68

chapter 4. more on joint distribution

in fact, a more general version of (a), proved by the same argument, says that

var(ax + by ) = a2 var(x) + b2 var(y ) + 2abcov(x,y ).

(4.1)

another quantity closely related to covariance is the correlation coef   cient,
corr(x,y ), which is just a    normalised    version of the covariance. it is de   ned as
follows:

corr(x,y ) =

pvar(x)var(y )

cov(x,y )

.

the point of this is the    rst part of the following theorem.

theorem 4.2 let x and y be random variables. then
(a)    1     corr(x,y )     1;
(b) if x and y are independent, then corr(x,y ) = 0;
(c) if y = mx + c for some constants m 6= 0 and c, then corr(x,y ) = 1 if m > 0,

and corr(x,y ) =    1 if m < 0.

the proof of the    rst part is optional: see the end of this section. but note that
this is another check on your calculations: if you calculate a correlation coef   cient
which is bigger than 1 or smaller than    1, then you have made a mistake. part (b)
follows immediately from part (b) of the preceding theorem.

for part (c), suppose that y = mx +c. let e(x) =    and var(x) =   , so that e(x 2) =   2 +  .

now we just calculate everything in sight.

e(y ) = e(mx + c) = me(x) + c = m   + c

e(y 2) = e(m2x 2 + 2mcx + c2) = m2(  2 +   ) + 2mc   + c2
var(y ) = e(y 2)    e(y )2 = m2  
e(xy ) = e(mx 2 + cx) = m(  2 +   ) + c  ;

cov(x,y ) = e(xy )    e(x)e(y ) = m  

corr(x,y ) = cov(x,y )/pvar(x)var(y ) = m  /

   
m2  2

n+1

   1

=

if m > 0,
if m < 0.

thus the correlation coef   cient is a measure of the extent to which the two
variables are related. it is +1 if y increases linearly with x; 0 if there is no relation
between them; and    1 if y decreases linearly as x increases. more generally, a
positive correlation indicates a tendency for larger x values to be associated with
larger y values; a negative value, for smaller x values to be associated with larger
y values.

4.1. covariance and correlation

69

example
i have two red pens, one green pen, and one blue pen, and i choose
two pens without replacement. let x be the number of red pens that i choose and
y the number of green pens. then the joint p.m.f. of x and y is given by the
following table:

y
0 1
0 0 1
6
x 1 1
1
3
3
2 1
6 0

from this we can calculate the marginal p.m.f. of x and of y and hence    nd

their expected values and variances:

e(x) = 1,
e(y ) = 1/2,

var(x) = 1/3,
var(y ) = 1/4.

also, e(xy ) = 1/3, since the sum
e(xy ) =    

i, j

aib jp(x = ai,y = b j)

contains only one term where all three factors are non-zero. hence

and

cov(x,y ) = 1/3    1/2 =    1/6,

corr(x,y ) =

   1/6p1/12

=     1   
3

.

the negative correlation means that small values of x tend to be associated with
larger values of y . indeed, if x = 0 then y must be 1, and if x = 2 then y must
be 0, but if x = 1 then y can be either 0 or 1.

example we have seen that if x and y are independent then cov(x,y ) = 0.
however, it doesn   t work the other way around. consider the following joint
p.m.f.

y

   1 0 1
0 1
1
5
5
1
5 0
0
0 1
1
5
5

   1
0
1

x

70

chapter 4. more on joint distribution

now calculation shows that e(x) = e(y ) = e(xy ) = 0, so cov(x,y ) = 0. but
x and y are not independent: for p(x =    1) = 2/5, p(y = 0) = 1/5, but p(x =
   1,y = 0) = 0.

we call two random variables x and y uncorrelated if cov(x,y ) = 0 (in other

words, if corr(x,y ) = 0). so we can say:

independent random variables are uncorrelated, but uncorrelated ran-
dom variables need not be independent.

here is the proof that the correlation coef   cient lies between    1 and 1. clearly this is exactly

equivalent to proving that its square is at most 1, that is, that

cov(x,y )2     var(x)   var(y ).

this depends on the following fact:

let p,q,r be real numbers with p > 0. suppose that px2 + 2qx + r     0 for all real
numbers x. then q2     pr.

for, when we plot the graph y = px2 + 2qx + r, we get a parabola; the hypothesis means that this
parabola never goes below the x-axis, so that either it lies entirely above the axis, or it touches it
in one point. this means that the quadratic equation px2 + 2qx + r = 0 either has no real roots, or
has two equal real roots. from high-school algebra, we know that this means that q2     pr.

now let p = var(x), q = cov(x,y ), and r = var(y ). equation (4.1) shows that

px2 + 2qx + r = var(xx +y ).

(note that x is an arbitrary real number here and has no connection with the random variable x!)
since the variance of a random variable is never negative, we see that px2 +2qx+r     0 for all
choices of x. now our argument above shows that q2     pr, that is, cov(x,y )2     var(x)   var(y ),
as required.

4.2 conditional random variables
remember that the id155 of event b given event a is p(b | a) =
p(a    b)/p(a).

suppose that x is a discrete random variable. then the id155

that x takes a certain value ai, given a, is just

p(x = ai | a) =

p(a holds and x = ai)

p(a)

.

this de   nes the id203 mass function of the conditional random variable
x | a.

so we can, for example, talk about the conditional expectation

e(x | a) =    

i

aip(x = ai | a).

4.2. conditional random variables

71

now the event a might itself be de   ned by a random variable; for example, a

might be the event that y takes the value b j. in this case, we have

p(x = ai | y = b j) =

p(x = ai,y = b j)

p(y = b j)

.

table of x and y
in other words, we have taken the column of the joint p.m.f.
corresponding to the value y = b j. the sum of the entries in this column is just
p(y = b j), the marginal distribution of y . we divide the entries in the column by
this value to obtain a new distribution of x (whose probabilities add up to 1).

in particular, we have

e(x | y = b j) =    

i

aip(x = ai | y = b j).

example
i have two red pens, one green pen, and one blue pen, and i choose
two pens without replacement. let x be the number of red pens that i choose and
y the number of green pens. then the joint p.m.f. of x and y is given by the
following table:

y
0 1
0 0 1
6
x 1 1
1
3
3
2 1
6 0

in this case, the conditional distributions of x corresponding to the two values

of y are as follows:

p(x = a | y = 0) 0 2
3

a 0 1 2
1
3

p(x = a | y = 1)

a 0 1 2
2
3 0

1
3

we have

e(x | y = 0) =

4
3

,

e(x | y = 1) =

2
3

.

if we know the conditional expectation of x for all values of y , we can    nd

the expected value of x:
proposition 4.3 e(x) =    

j

e(x | y = b j)p(y = b j).

proof:

e(x) =    

i

aip(x = ai)

72

chapter 4. more on joint distribution

p(x = ai | y = b j)p(y = b j)

!

j

 
ai   
aip(x = ai | y = b j
   
e(x | y = b j)p(y = b j).

i

p(y = b j)

=    

i

=    
=    

j

j

in the above example, we have

e(x) = e(x | y = 0)p(y = 0) + e(x | y = 1)p(y = 1)

= (4/3)   (1/2) + (2/3)   (1/2)
= 1.

example let us revisit the geometric random variable and calculate its expected
value. recall the situation: i have a coin with id203 p of showing heads; i
toss it repeatedly until heads appears for the    rst time; x is the number of tosses.
let y be the bernoulli random variable whose value is 1 if the result of the
   rst toss is heads, 0 if it is tails. if y = 1, then we stop the experiment then and
there; so if y = 1, then necessarily x = 1, and we have e(x | y = 1) = 1. on
the other hand, if y = 0, then the sequence of tosses from that point on has the
same distribution as the original experiment; so e(x | y = 0) = 1 + e(x) (the 1
counting the    rst toss). so

e(x) = e(x | y = 0)p(y = 0) + e(x | y = 1)p(y = 1)

= (1 + e(x))   q + 1   p
= e(x)(1    p) + 1;

rearranging this equation, we    nd that e(x) = 1/p, con   rming our earlier value.

in proposition 2.1, we saw that independence of events can be characterised
in terms of conditional probabilities: a and b are independent if and only if they
satisfy p(a | b) = p(a). a similar result holds for independence of random vari-
ables:

proposition 4.4 let x and y be discrete random variables. then x and y are
independent if and only if, for any values ai and b j of x and y respectively, we
have

p(x = ai | y = b j) = p(x = ai).

this is obtained by applying proposition 15 to the events x = ai and y = b j.
it can be stated in the following way: x and y are independent if the conditional
p.m.f. of x | (y = b j) is equal to the p.m.f. of x, for any value b j of y .

4.3. joint distribution of continuous r.v.s
4.3 joint distribution of continuous r.v.s

73

for continuous random variables, the covariance and correlation can be de   ned
by the same formulae as in the discrete case; and equation (4.1) remains valid.
but we have to examine what is meant by independence for continuous random
variables. the formalism here needs even more concepts from calculus than we
have used before: functions of two variables, partial derivatives, double integrals.
i assume that this is unfamiliar to you, so this section will be brief and can mostly
be skipped.

let x and y be continuous random variables. the joint cumulative distribution

function of x and y is the function fx,y of two real variables given by

fx,y (x,y) = p(x     x,y     y).

we de   ne x and y to be independent if p(x     x,y     y) = p(x     x)   p(y     y),
for any x and y, that is, fx,y (x,y) = fx(x)   fy (y). (note that, just as in the one-
variable case, x is part of the name of the function, while x is the argument of the
function.)

the joint id203 density function of x and y is

fx,y (x,y) =

   2
   x   y

fx,y (x,y).

in other words, differentiate with respect to x keeping y constant, and then differ-
entiate with respect to y keeping x constant (or the other way round: the answer is
the same for all functions we consider.)

the id203 that the pair of values of (x,y ) corresponds to a point in some
region of the plane is obtained by taking the double integral of fx,y over that
region. for example,

p(a     x     b,c     y     d) =

fx,y (x,y)dx dy

z d

z b

c

a

(the right hand side means, integrate with respect to x between a and b keeping y
   xed; the result is a function of y; integrate this function with respect to y from c
to d.)

the marginal p.d.f. of x is given by

      
and the marginal p.d.f. of y is similarly

fx(x) =

z    
z    

      

fx,y (x,y)dy,

fx,y (x,y)dx.

fy (y) =

74

chapter 4. more on joint distribution

then the conditional p.d.f. of x | (y = b) is

fx|(y =b)(x) =

fx,y (x,b)

fy (b)

.

the expected value of xy is, not surprisingly,

z    

z    

      

      

xy fx,y (x,y)dx dy,

e(xy ) =

and then as in the discrete case

cov(x,y ) = e(xy )    e(x)e(y ),

corr(x,y ) =

finally, and importantly,

pvar(x)var(y )

cov(x,y )

.

the continuous random variables x and y are independent if and only
if

fx,y (x,y) = fx(x)   fy (y).

as usual this holds if and only if the conditional p.d.f. of x | (y = b) is equal to
the marginal p.d.f. of x, for any value b. also, if x and y are independent, then
cov(x,y ) = corr(x,y ) = 0 (but not conversely!).

4.4 transformation of random variables

if a continuous random variable y is a function of another r.v. x, we can    nd the
distribution of y in terms of that of x.

example let x and y be random variables. suppose that x     u[0,4] (uniform
   
on [0,4]) and y =
x. what is the support of y ? find the cumulative distribution
function and the id203 density function of y .
   
x, so the support of y is [0,2].

solution (a) the support of x is [0,4], and y =
(b) we have fx(x) = x/4 for 0     x     4. now
fy (y) = p(y     y)
= p(x     y2)
= fx(y2)
= y2/4

4.4. transformation of random variables
75
for 0     y     2; of course fy (y) = 0 for y < 0 and fy (y) = 1 for y > 2. (note that
y     y if and only if x     y2, since y =

   
x.)

(c) we have

fy (y) =

d
dy

fy (y) =

ny/2

0

if 0     y     2,
otherwise.

the argument in (b) is the key. if we know y as a function of x, say y = g(x),
where g is an increasing function, then the event y     y is the same as the event
x     h(y ), where h is the inverse function of g. this means that y = g(x) if and
only if x = h(y). (in our example, g(x) =

x, and so h(y) = y2.) thus

   

and so, by the chain rule,

fy (y) = fx(h(y)),

fy (y) = fx(h(y))h0(y),

where h0 is the derivative of h. (this is because fx(x) is the derivative of fx(x)
with respect to its argument x, and the chain rule says that if x = h(y) we must
multiply by h0(y) to    nd the derivative with respect to y.)

applying this formula in our example we have

fy (y) =

   2y =

1
4

y
2

for 0     y     2, since the p.d.f. of x is fx(x) = 1/4 for 0     x     4.

here is a formal statement of the result.

theorem 4.5 let x be a continuous random variable. let g be a real function
which is either strictly increasing or strictly decreasing on the support of x, and
which is differentiable there. let y = g(x). then

(a) the support of y is the image of the support of x under g;
(b) the p.d.f. of y is given by fy (y) = fx(h(y))|h0(y)|, where h is the inverse

function of g.

for example, here is the proof of proposition 3.6: if x     n(  ,  2) and y =

(x       )/  , then y     n(0,1). recall that
1
   
  
2  

fx(x) =

e   (x     )2/2  2

.

76

chapter 4. more on joint distribution

we have y = g(x), where g(x) = (x      )/  ; this function is everywhere strictly
increasing (the graph is a straight line with slope 1/  ), and the inverse function is
x = h(y) =   y +   . thus, h0(y) =   , and

fy (y) = fx(  y +   )      =

1   
2  

e   y2/2,

the p.d.f. of a standard normal variable.

however, rather than remember this formula, together with the conditions for

its validity, i recommend going back to the argument we used in the example.

if the transforming function g is not monotonic (that is, not either increasing
or decreasing), then life is a bit more complicated. for example, if x is a random
variable taking both positive and negative values, and y = x 2, then a given value
y of x, so we must work
y of y could arise from either of the values
out the two contributions and add them up.

   
y and       

example x     n(0,1) and y = x 2. find the p.d.f. of y .

   
2  )e   x2/2. let   (x) be its c.d.f., so that p(x     x) =

the p.d.f. of x is (1/

  (x), and

fy (y) = p(y     y)

1   
  0(x) =
e   x2/2.
2  
y     x        
now y = x 2, so y     y if and only if       
= p(   py     x    py)
=   (py)      (   py)
=   (py    (1      (py))
= 2  (py)    1.

y. thus

(by symmetry of n(0,1))

so

fy (y) =

d
fy (y)
dy
   
y)   1
   
= 2  0(
y
2
1   
e   y/2.
2  y

=

(by the chain rule)

of course, this is valid for y > 0; for y < 0, the p.d.f. is zero.

4.5. worked examples

77

   
note the 2 in the line labelled    by the chain rule   . if you blindly applied
the formula of theorem 4.5, using h(y) =
y, you would not get this 2; it arises
from the fact that, since y = x 2, each value of y corresponds to two values of x
(one positive, one negative), and each value gives the same contribution, by the
symmetry of the p.d.f. of x.

4.5 worked examples
question two numbers x and y are chosen independently from the uniform
distribution on the unit interval [0,1]. let z be the maximum of the two numbers.
find the p.d.f. of z, and hence    nd its expected value, variance and median.

solution the c.d.f.s of x and y are identical, that is,
if x < 0,
if 0 < x < 1,
if x > 1.

fx(x) = fy (x) =

x
1

(0

(the variable can be called x in both cases; its name doesn   t matter.)

the key to the argument is to notice that

z = max(x,y )     x

if and only if x     x and y     x.

(for, if both x and y are smaller than a given value x, then so is their maximum;
but if at least one of them is greater than x, then again so is their maximum.) for
0     x     1, we have p(x     x) = p(y     x) = x; by independence,

p(x     x and y     x) = x   x = x2.

thus p(z     x) = x2. of course this id203 is 0 if x < 0 and is 1 if x > 1. so
the c.d.f. of z is

fz(x) =

if x < 0,
if 0 < x < 1,
if x > 1.

the median of z is the value of m such that fz(m) = 1/2, that is m2 = 1/2, or

   
2.

m = 1/

we obtain the p.d.f. of z by differentiating:

if 0 < x < 1,
otherwise.
then we can    nd e(z) and var(z) in the usual way:

fz(x) =

0

e(z) =

2x2dx =

2
3

,

var(z) =

2x3dx   

z 1

0

(cid:18)2

(cid:19)2

3

=

1
18

.

z 1

0

(0

x2
1

n2x

78

chapter 4. more on joint distribution

question i roll a fair die bearing the numbers 1 to 6. if n is the number showing
on the die, i then toss a fair coin n times. let x be the number of heads i obtain.

(a) write down the p.m.f. for x.

(b) calculate e(x) without using this information.

solution (a) if we were given that n = n, say, then x would be a binomial
bin(n,1/2) random variable. so p(x = k | n = n) = nck(1/2)n.

by the totp,

p(x = k) =

6

   

n=1

p(x = k | n = n)p(n = n).

clearly p(n = n) = 1/6 for n = 1, . . . ,6. so to    nd p(x = k), we add up the
id203 that x = k for a bin(n,1/2) r.v. for n = k, . . . ,6 and divide by 6. (we
start at k because you can   t get k heads with fewer than k coin tosses!) the answer
comes to

k
p(x = k)

0
63
384

1
120
384

2
99
384

3
64
384

4
29
384

5
8
384

6
1
384

for example,

p(x = 4) =

4c4(1/2)4 + 5c4(1/2)5 + 6c4(1/2)6

6

=

4 + 10 + 15

384

.

(b) by proposition 4.3,

e(x) =

e(x | (n = n))p(n = n).

6

   

n=1

now if we are given that n = n then, as we remarked, x has a binomial bin(n,1/2)
distribution, with expected value n/2. so

e(x) =

6

   

n=1

(n/2)   (1/6) =

1 + 2 + 3 + 4 + 5 + 6

2   6

=

7
4

.

try working it out from the p.m.f. to check that the answer is the same!

capital lowercase

appendix a

mathematical notation

the greek alphabet

name
alpha
beta
gamma
delta
epsilon
zeta
eta
theta
iota
kappa
lambda
mu
nu
xi
omicron
pi
rho
sigma
tau
upsilon
phi
chi
psi
omega

mathematicians use the greek alpha-
bet for an extra supply of symbols.
some, like   , have standard meanings.
you don   t need to learn this; keep it
for reference. apologies to greek stu-
dents: you may not recognise this, but
it is the greek alphabet that mathe-
maticians use!
pairs that are often confused are zeta
and xi, or nu and upsilon, which look
alike; and chi and xi, or epsilon and
upsilon, which sound alike.

79

a
b
  
   
e
z
h
  
i
k
  
m
n
  
o
  
p
  
t
  
  
x
  
   

  
  
  
  
  
  
  
  
  
  
  
  
  
  
o
  
  
  
  
  
  
  
  
  

80

numbers
notation
n

a
b

(cid:18)m
(cid:19)

n

z
r
|x|
a/b or
a | b
mcn or
n!
b
   

xi

i=a
x     y

sets

notation
{. . .}
x     a
{x : . . .}
or {x | . . .}
|a|
a    b
a    b
a\ b
a     b
a0
/0
(x,y)
a   b

appendix a. mathematical notation

meaning
natural numbers

integers
real numbers
modulus
a over b
a divides b
m choose n
n factorial
xa + xa+1 +       + xb
(see section on summation below)
x is approximately equal to y

   
2,  , . . .

example
1,2,3, . . .
(some people include 0)
. . . ,   2,   1,0,1,2, . . .
1
2,
|2| = 2,|   3| = 3
12/3 = 4, 2/4 = 0.5
4 | 12
5c2 = 10
5! = 120
3
   

i2 = 12 + 22 + 32 = 14

i=1

meaning
a set

x is an element of the set a
the set of all x such that . . .

example
{1,2,3}
note: {1,2} = {2,1}
2     {1,2,3}
{x : x2 = 4} = {   2,2}
|{1,2,3}| = 3
{1,2,3}   {2,4} = {1,2,3,4}
{1,2,3}   {2,4} = {2}
{1,2,3}\{2,4} = {1,3}

cardinality of a
(number of elements in a)
a union b
(elements in either a or b)
a intersection b
(elements in both a and b)
set difference
(elements in a but not b)
a is a subset of b (or equal) {1,3}     {1,2,3}
complement of a
everything not in a
{1,2}   {3,4} = /0
empty set (no elements)
note: (1,2) 6= (2,1)
ordered pair
{1,2}  {1,3} =
cartesian product
{(1,1),(2,1),(1,3),(2,3)}
(set of all ordered pairs)

n

the notation

   
j=1
a    dummy variable   .
   

the notation

m

i=1

summation
what is it?
let a1,a2,a3, . . . be numbers. the notation

81

n

   

i=1

ai

(read    sum, from i equals 1 to n, of ai   ), means: add up the numbers a1,a2, . . . ,an;
that is,

ai = a1 + a2 +       + an.

n

   

i=1

a j means exactly the same thing. the variable i or j is called

ai is not the same, since (if m and n are different) it is telling

us to add up a different number of terms.

the sum doesn   t have to start at 1. for example,

ai = a10 + a11 +       + a20.

20

   

i=10

sometimes i get lazy and don   t bother to write out the values: i just say    
ai
to mean: add up all the relevant values. for example, if x is a discrete random
variable, then we say that

i

e(x) =    

i

aip(x = ai)

where the sum is over all i such that ai is a value of the random variable x.

manipulation
the following three rules hold.

n

   

i=1

(ai + bi) =

n

   

i=1

ai +

n

   

i=1

bi.

(a.1)

imagine the as and bs written out with a1 + b1 on the    rst line, a2 + b2 on the
second line, and so on. the left-hand side says: add the two terms in each line,

82

appendix a. mathematical notation

and then add up all the results. the right-hand side says: add the    rst column (all
the as) and the second column (all the bs), and then add the results. the answers
must be the same.

  n

ai

   

i=1

!

  m

  

   

j=1

!

b j

=

n

   

i=1

m

   

j=1

aib j.

(a.2)

the double sum says add up all these products, for all values of i and j. a simple
example shows how it works: (a1 + a2)(b1 + b2) = a1b1 + a1b2 + a2b1 + a2b2.

if in place of numbers, we have functions of x, then we can    differentiate

term-by-term   :

d
dx

n

   

i+1

fi(x) =

n

   

i+1

d
dx

fi(x).

(a.3)

the left-hand side says: add up the functions and differentiate the sum. the right
says: differentiate each function and add up the derivatives.

another useful result is the binomial theorem:

(x + y)n =

in   nite sums

nckxn   kyk.

n

   

k=0

sometimes we meet in   nite sums, which we write as

ai for example. this
doesn   t just mean    add up in   nitely many values   , since that is not possible. we
need analysis to give us a de   nition in general. but sometimes we know the
answer another way: for example, if ai = ari   1, where    1 < r < 1, then

i=1

   
   

   
   

i=1

ai = a + ar + ar2 +       =

a
1    r ,

using the formula for the sum of the    geometric series   . you also need to know
the sum of the    exponential series   

   
   

i=0

xi
i!

= 1 + x +

x2
2

+

x3
6

+

x4
24

+       = ex.

do the three rules of the preceding section hold? sometimes yes, sometimes

no. in analysis you will see some answers to this question.

in all the examples you meet in this book, the rules will be valid.

appendix b

id203 and random variables

notation
in the table, a and b are events, x and y are random variables.

notation
p(a)
p(a | b)
x = y
x     y

e(x)
var(x)
cov(x,y )
corr(x,y )
x | b
x | (y = b)

meaning
id203 of a
id155 of a given b
the values of x and y are equal
x and y have the same distribution
(that is, same p.m.f. or same p.d.f.)
expected value of x
variance of x
covariance of x and y
correlation coef   cient of x and y
conditional random variable

page
3
24

41

41
42
67
68
70
71

bernoulli random variable bernoulli(p) (p. 48)

    occurs when there is a single trial with a    xed id203 p of success.
    takes only the values 0 and 1.
    p.m.f. p(x = 0) = q, p(x = 1) = p, where q = 1    p.
    e(x) = p, var(x) = pq.

83

84

appendix b. id203 and random variables

binomial random variable bin(n, p) (p. 49)

    occurs when we are counting the number of successes in n independent
trials with    xed id203 p of success in each trial, e.g. the number of
heads in n coin tosses. also, sampling with replacement from a population
with a proportion p of distinguished elements.

    the sum of n independent bernoulli(p) random variables.
    values 0,1,2, . . . ,n.
    p.m.f. p(x = k) = nckqn   k pk for 0     k     n, where q = 1    p.
    e(x) = np, var(x) = npq.

hypergeometric random variable hg(n,m,n) (p. 51)

    occurs when we are sampling n elements without replacement from a pop-

ulation of n elements of which m are distinguished.

    values 0,1,2, . . . ,n.
    p.m.f. p(x = k) = (mck    n   mcn   k)/ncn.

(cid:18)m

(cid:19)

n

(cid:18)m

(cid:19)(cid:18)n     m

n

n

(cid:19)(cid:18)n     n

n     1

(cid:19)

.

    e(x) = n

, var(x) = n

    approximately bin(n,m/n) if n is small compared to n,m,n     m.

geometric random variable geom(p) (p. 52)

    describes the number of trials up to and including the    rst success in a
sequence of independent bernoulli trials, e.g. number of tosses until the
   rst head when tossing a coin.

    values 1,2, . . . (any positive integer).
    p.m.f. p(x = k) = qk   1p, where q = 1    p.
    e(x) = 1/p, var(x) = q/p2.

85

poisson random variable poisson(  ) (p. 54)

    describes the number of occurrences of a random event in a    xed time

interval, e.g. the number of    sh caught in a day.

    values 0,1,2, . . . (any non-negative integer)
    p.m.f. p(x = k) = e       k/k! .
    e(x) =   , var(x) =   .
    if n is large, p is small, and np =   , then bin(n, p) is approximately equal

to poisson(  ) (in the sense that the p.m.f.s are approximately equal).

uniform random variable u[a,b] (p. 58)

    occurs when a number is chosen at random from the interval [a,b], with all

values equally likely.

    p.d.f. f (x) =

1/(b    a)
0

if x < a,
if a     x     b,
if x > b.

    c.d.f. f(x) =

if x < a,
if a     x     b,
if x > b.
    e(x) = (a + b)/2, var(x) = (b    a)2/12.

(x    a)/(b    a)
1

exponential random variable exp(  ) (p. 59)

    occurs in the same situations as the poisson random variable, but measures

the time from now until the    rst occurrence of the event.

    p.d.f. f (x) =

    c.d.f. f(x) =

   e     x

1    e     x

if x < 0,
if x     0.

if x < 0,
if x     0.

    e(x) = 1/  , var(x) = 1/  2.
    however long you wait, the time until the next occurrence has the same

distribution.

(0
(0

(cid:26)0
(cid:26)0

86

appendix b. id203 and random variables

normal random variable n(  ,  2) (p. 59)

    the limit of the sum (or average) of many independent bernoulli random
variables. this also works for many other types of random variables: this
statement is known as the central limit theorem.

1
   
  
2  

e   (x     )2/2  2.

    p.d.f. f (x) =
    no simple formula for c.d.f.; use tables.
    e(x) =   , var(x) =   2.
    for large n, bin(n, p) is approximately n(np,npq).
    standard normal n(0,1) is given in the table. if x     n(  ,  2), then (x    

  )/       n(0,1).

the c.d.f.s of the binomial, poisson, and standard normal random variables

are tabulated in the new cambridge statistical tables, tables 1, 2 and 4.

