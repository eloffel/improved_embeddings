the matrix cookbook

[ http://matrixcookbook.com ]

kaare brandt petersen

michael syskind pedersen

version: november 15, 2012

1

introduction

what is this? these pages are a collection of facts (identities, approxima-
tions, inequalities, relations, ...) about matrices and matters relating to them.
it is collected in this form for the convenience of anyone who wants a quick
desktop reference .

disclaimer: the identities, approximations and relations presented here were
obviously not invented but collected, borrowed and copied from a large amount
of sources. these sources include similar but shorter notes found on the internet
and appendices in books - see the references for a full list.

errors: very likely there are errors, typos, and mistakes for which we apolo-
gize and would be grateful to receive corrections at cookbook@2302.dk.

its ongoing: the project of keeping a large repository of relations involving
matrices is naturally ongoing and the version will be apparent from the date in
the header.

suggestions: your suggestion for additional content or elaboration of some
topics is most welcome acookbook@2302.dk.

keywords: matrix algebra, matrix relations, matrix identities, derivative of
determinant, derivative of inverse matrix, di   erentiate a matrix.

acknowledgements: we would like to thank the following for contributions
and suggestions: bill baxter, brian templeton, christian rish  j, christian
schr  oppel, dan boley, douglas l. theobald, esben hoegh-rasmussen, evripidis
karseras, georg martius, glynne casteel, jan larsen, jun bin gao, j  urgen
struckmeier, kamil dedecius, karim t. abou-moustafa, korbinian strimmer,
lars christiansen, lars kai hansen, leland wilkinson, liguo he, loic thibaut,
markus froeb, michael hubatka, miguel bar  ao, ole winther, pavel sakov,
stephan hattinger, troels pedersen, vasile sima, vincent rabaud, zhaoshui
he. we would also like thank the oticon foundation for funding our phd
studies.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 2

contents

contents

contents

1 basics

1.1 trace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 determinant . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3 the special case 2x2 . . . . . . . . . . . . . . . . . . . . . . . . .

2 derivatives

2.1 derivatives of a determinant
. . . . . . . . . . . . . . . . . . . .
2.2 derivatives of an inverse . . . . . . . . . . . . . . . . . . . . . . .
2.3 derivatives of eigenvalues . . . . . . . . . . . . . . . . . . . . . .
2.4 derivatives of matrices, vectors and scalar forms
. . . . . . . .
2.5 derivatives of traces . . . . . . . . . . . . . . . . . . . . . . . . .
2.6 derivatives of vector norms . . . . . . . . . . . . . . . . . . . . .
2.7 derivatives of matrix norms . . . . . . . . . . . . . . . . . . . . .
2.8 derivatives of structured matrices
. . . . . . . . . . . . . . . . .

3 inverses

3.1 basic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2 exact relations . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.3
implication on inverses . . . . . . . . . . . . . . . . . . . . . . . .
3.4 approximations . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.5 generalized inverse . . . . . . . . . . . . . . . . . . . . . . . . . .
3.6 pseudo inverse . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 complex matrices

4.1 complex derivatives . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 higher order and non-linear derivatives . . . . . . . . . . . . . . .
4.3
inverse of complex sum . . . . . . . . . . . . . . . . . . . . . . .

5 solutions and decompositions

5.1 solutions to linear equations . . . . . . . . . . . . . . . . . . . . .
5.2 eigenvalues and eigenvectors . . . . . . . . . . . . . . . . . . . .
5.3 singular value decomposition . . . . . . . . . . . . . . . . . . . .
5.4 triangular decomposition . . . . . . . . . . . . . . . . . . . . . .
5.5 lu decomposition . . . . . . . . . . . . . . . . . . . . . . . . . .
5.6 ldm decomposition . . . . . . . . . . . . . . . . . . . . . . . . .
5.7 ldl decompositions . . . . . . . . . . . . . . . . . . . . . . . . .

6 statistics and id203

6.1 de   nition of moments . . . . . . . . . . . . . . . . . . . . . . . .
6.2 expectation of linear combinations . . . . . . . . . . . . . . . .
6.3 weighted scalar variable
. . . . . . . . . . . . . . . . . . . . . .

7 multivariate distributions

7.1 cauchy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.2 dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.3 normal
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.4 normal-inverse gamma . . . . . . . . . . . . . . . . . . . . . . .
7.5 gaussian . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.6 multinomial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6
6
6
7

8
8
9
10
10
12
14
14
14

17
17
18
20
20
21
21

24
24
26
27

28
28
30
31
32
32
33
33

34
34
35
36

37
37
37
37
37
37
37

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 3

contents

contents

7.7 student   s t
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.8 wishart . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.9 wishart, inverse
. . . . . . . . . . . . . . . . . . . . . . . . . . .

8 gaussians

8.1 basics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8.2 moments
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8.3 miscellaneous . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8.4 mixture of gaussians . . . . . . . . . . . . . . . . . . . . . . . . .

9 special matrices
9.1 block matrices
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
9.2 discrete fourier transform matrix, the . . . . . . . . . . . . . .
9.3 hermitian matrices and skew-hermitian . . . . . . . . . . . . . .
9.4
idempotent matrices . . . . . . . . . . . . . . . . . . . . . . . . .
9.5 orthogonal matrices . . . . . . . . . . . . . . . . . . . . . . . . .
9.6 positive de   nite and semi-de   nite matrices . . . . . . . . . . . .
9.7 singleentry matrix, the . . . . . . . . . . . . . . . . . . . . . . .
9.8 symmetric, skew-symmetric/antisymmetric . . . . . . . . . . . .
9.9 toeplitz matrices . . . . . . . . . . . . . . . . . . . . . . . . . . .
9.10 transition matrices . . . . . . . . . . . . . . . . . . . . . . . . . .
9.11 units, permutation and shift . . . . . . . . . . . . . . . . . . . .
9.12 vandermonde matrices . . . . . . . . . . . . . . . . . . . . . . . .

10 functions and operators

10.1 functions and series . . . . . . . . . . . . . . . . . . . . . . . . .
10.2 kronecker and vec operator
. . . . . . . . . . . . . . . . . . . .
10.3 vector norms . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10.4 matrix norms . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10.5 rank . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10.6 integral involving dirac delta functions . . . . . . . . . . . . . .
10.7 miscellaneous . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

a one-dimensional results

a.1 gaussian . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
a.2 one dimensional mixture of gaussians . . . . . . . . . . . . . . .

b proofs and details

b.1 misc proofs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

37
38
39

40
40
42
44
44

46
46
47
48
49
49
50
52
54
54
55
56
57

58
58
59
61
61
62
62
63

64
64
65

66
66

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 4

contents

contents

notation and nomenclature

a
aij
ai
aij
an
a   1
a+
a1/2
(a)ij
aij
[a]ij

a
ai
ai
a
(cid:60)z
(cid:60)z
(cid:60)z
(cid:61)z
(cid:61)z
(cid:61)z

matrix
matrix indexed for some purpose
matrix indexed for some purpose
matrix indexed for some purpose
matrix indexed for some purpose or
the n.th power of a square matrix
the inverse matrix of the matrix a
the pseudo inverse matrix of the matrix a (see sec. 3.6)
the square root of a matrix (if unique), not elementwise
the (i, j).th entry of the matrix a
the (i, j).th entry of the matrix a
the ij-submatrix, i.e. a with i.th row and j.th column deleted
vector (column-vector)
vector indexed for some purpose
the i.th element of the vector a
scalar

real part of a scalar
real part of a vector
real part of a matrix
imaginary part of a scalar
imaginary part of a vector
imaginary part of a matrix

trace of the matrix a

eigenvalues of the matrix a

det(a) determinant of a
tr(a)
diag(a) diagonal matrix of the matrix a, i.e. (diag(a))ij =   ijaij
eig(a)
vec(a) the vector-version of the matrix a (see sec. 10.2.2)
sup
||a||
at
a   t
a   
ah
a     b hadamard (elementwise) product
a     b kronecker product

supremum of a set
matrix norm (subscript if any denotes what norm)
transposed matrix
the inverse of the transposed and vice versa, a   t = (a   1)t = (at )   1.
complex conjugated matrix
transposed and complex conjugated matrix (hermitian)

0
i
jij
  
  

the null matrix. zero in all entries.
the identity matrix
the single-entry matrix, 1 at (i, j) and zero elsewhere
a positive de   nite matrix
a diagonal matrix

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 5

1 basics

1.1 trace

(ab)   1 = b   1a   1

(abc...)   1 = ...c   1b   1a   1

(at )   1 = (a   1)t
(a + b)t = at + bt

(ab)t = bt at

(abc...)t = ...ct bt at

(ah )   1 = (a   1)h

(a + b)h = ah + bh

(ab)h = bh ah

(abc...)h = ...ch bh ah

tr(a) = (cid:80)
tr(a) = (cid:80)

iaii
i  i,

tr(a) = tr(at )
tr(ab) = tr(ba)

  i = eig(a)

tr(a + b) = tr(a) + tr(b)

tr(abc) = tr(bca) = tr(cab)

at a = tr(aat )

1.2 determinant
let a be an n    n matrix.

det(a) = (cid:81)

i  i

  i = eig(a)

if a     rn  n

det(ca) = cn det(a),
det(at ) = det(a)
det(ab) = det(a) det(b)
det(a   1) = 1/ det(a)
det(an) = det(a)n
det(i + uvt ) = 1 + ut v

for n = 2:

for n = 3:

det(i + a) = 1 + det(a) + tr(a)

1 basics

(1)

(2)

(3)

(4)

(5)

(6)

(7)
(8)

(9)

(10)

(11)

(12)

(13)

(14)

(15)

(16)

(17)

(18)

(19)

(20)

(21)

(22)

(23)

(24)

(25)

det(i + a) = 1 + det(a) + tr(a) +

1
2

tr(a)2     1
2

tr(a2)

(26)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 6

1.3 the special case 2x2

1 basics

for n = 4:

det(i + a) = 1 + det(a) + tr(a) +

1
2

tr(a2)

+tr(a)2     1
2
tr(a)3     1
2

1
6

+

tr(a)tr(a2) +

1
3

tr(a3)

(27)

for small   , the following approximation holds

det(i +   a)    = 1 + det(a) +   tr(a) +

1
2

  2tr(a)2     1
2

  2tr(a2)

(28)

1.3 the special case 2x2

consider the matrix a

a =

determinant and trace

(cid:20) a11 a12

a21 a22

(cid:21)

det(a) = a11a22     a12a21

tr(a) = a11 + a22

(29)

(30)

  2           tr(a) + det(a) = 0

  2 =

tr(a)    (cid:112)tr(a)2     4 det(a)
(cid:20)

(cid:21)

2

  1  2 = det(a)

eigenvalues

  1 =

tr(a) +(cid:112)tr(a)2     4 det(a)
(cid:21)

2
  1 +   2 = tr(a)

(cid:20)

v1    

a12

  1     a11

eigenvectors

inverse

a   1 =

1

det(a)

a12

  2     a11

v2    

(cid:20) a22    a12

   a21 a11

(cid:21)

(31)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 7

2 derivatives

2 derivatives

this section is covering di   erentiation of a number of expressions with respect to
a matrix x. note that it is always assumed that x has no special structure, i.e.
that the elements of x are independent (e.g. not symmetric, toeplitz, positive
de   nite). see section 2.8 for di   erentiation of structured matrices. the basic
assumptions can be written in a formula as

=   ik  lj

(32)

that is for e.g. vector forms,

(cid:20)    x

(cid:21)

   y

i

=

   xi
   y

(cid:20)    x

(cid:21)

   y

ij

=

   xi
   yj

=

   x
   yi

   xkl
   xij

(cid:20)    x

(cid:21)

   y

i

the following rules are general and very useful when deriving the di   erential of
an expression ([19]):

   a = 0

   (  x) =      x

(a is a constant)

   (xy) = (   x)y + x(   y)

   (x + y) =    x +    y
   (tr(x)) = tr(   x)
   (x     y) = (   x)     y + x     (   y)
   (x     y) = (   x)     y + x     (   y)
   (x   1) =    x   1(   x)x   1
   (det(x)) = tr(adj(x)   x)
   (det(x)) = det(x)tr(x   1   x)

   (ln(det(x))) = tr(x   1   x)

   xt = (   x)t
   xh = (   x)h

2.1 derivatives of a determinant

2.1.1 general form

    det(y)

(cid:88)

k

   x
    det(x)

   xik

   2 det(y)

   x2

(cid:21)

(cid:20)

y   1    y
   x

= det(y)tr

xjk =   ij det(x)

= det(y)

tr

(cid:34)

(cid:20)
(cid:20)(cid:18)

(cid:35)

(cid:34)
y   1        y
(cid:20)
(cid:21)
   x
   x
y   1    y
(cid:19)(cid:18)
   x
y   1    y
   x

tr

y   1    y
   x

y   1    y
   x

(cid:21)
(cid:19)(cid:21)(cid:35)

+tr

   tr

(33)
(34)
(35)
(36)
(37)
(38)
(39)
(40)
(41)
(42)
(43)
(44)
(45)

(46)

(47)

(48)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 8

2.2 derivatives of an inverse

2 derivatives

2.1.2 linear forms

(cid:88)

k

    det(x)

   x

= det(x)(x   1)t

    det(x)

   xik

xjk =   ij det(x)

    det(axb)

   x

= det(axb)(x   1)t = det(axb)(xt )   1

2.1.3 square forms

if x is square and invertible, then

    det(xt ax)

   x

= 2 det(xt ax)x   t

if x is not square but a is symmetric, then

    det(xt ax)

   x

= 2 det(xt ax)ax(xt ax)   1

if x is not square and a is not symmetric, then

(49)

(50)

(51)

(52)

(53)

    det(xt ax)

   x

= det(xt ax)(ax(xt ax)   1 + at x(xt at x)   1)

(54)

2.1.4 other nonlinear forms

some special cases are (see [9, 7])
    ln det(xt x)|

   x

    ln det(xt x)
    ln| det(x)|

   x+

   x

    det(xk)

   x

= 2(x+)t

=    2xt
= (x   1)t = (xt )   1

= k det(xk)x   t

2.2 derivatives of an inverse

from [27] we have the basic identity

   y   1
   x

=    y   1    y
   x

y   1

(55)

(56)

(57)

(58)

(59)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 9

(cid:88)
(cid:89)

   
   x
   
   x

2.3 derivatives of eigenvalues

2 derivatives

from which it follows

   (x   1)kl

   xij

   at x   1b

   x

    det(x   1)

   x

   tr(ax   1b)

   x

   tr((x + a)   1)

=    (x   1)ki(x   1)jl

=    x   t abt x   t
=     det(x   1)(x   1)t
=    (x   1bax   1)t
=    ((x + a)   1(x + a)   1)t

   x

(64)
from [32] we have the following result: let a be an n    n invertible square
matrix, w be the inverse of a, and j(a) is an n   n -variate and di   erentiable
function with respect to a, then the partial di   erentials of j with respect to a
and w satisfy

(60)

(61)

(62)

(63)

   j
   a

=    a   t    j
   w

a   t

2.3 derivatives of eigenvalues

eig(x) =

eig(x) =

   
   x
   
   x

tr(x) = i
det(x) = det(x)x   t

(65)

(66)

if a is real and symmetric,   i and vi are distinct eigenvalues and eigenvectors
of a (see (276)) with vt

i vi = 1, then [33]

     i = vt
   vi = (  ii     a)+   (a)vi

i    (a)vi

(67)

(68)

2.4 derivatives of matrices, vectors and scalar forms

2.4.1 first order

   xt a

   x

   at xb

   x

   at xt b

   x
   at xa

   x

   x
   xij
   (xa)ij
   xmn
   (xt a)ij

   xmn

= a

=

   at x

   x

= abt

= bat

=

   at xt a

   x

= jij

= aat

=   im(a)nj = (jmna)ij

=   in(a)mj = (jnma)ij

(69)

(70)

(71)

(72)

(73)

(74)

(75)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 10

2.4 derivatives of matrices, vectors and scalar forms

2 derivatives

2.4.2 second order

(cid:88)

   

   xij

xklxmn = 2

klmn

   bt xt xc

   x

(cid:88)

kl

xkl

   (bx + b)t c(dx + d)

   x
   (xt bx)kl

   xij

   (xt bx)

   xij

= x(bct + cbt )

= bt c(dx + d) + dt ct (bx + b)

=   lj(xt b)ki +   kj(bx)il

= xt bjij + jjibx

(jij)kl =   ik  jl (80)

see sec 9.7 for useful properties of the single-entry matrix jij

   xt bx

   x

   bt xt dxc

   x

= (b + bt )x

= dt xbct + dxcbt

   
   x

(xb + c)t d(xb + c) = (d + dt )(xb + c)bt

assume w is symmetric, then

(x     as)t w(x     as) =    2at w(x     as)
(x     s)t w(x     s) = 2w(x     s)
   
   x
(x     s)t w(x     s) =    2w(x     s)
   
   s
(x     as)t w(x     as) = 2w(x     as)
(x     as)t w(x     as) =    2w(x     as)st

   
   s

   
   x
   
   a

as a case with complex values the following holds

   (a     xh b)2

   x

=    2b(a     xh b)   

this formula is also known from the lms algorithm [14]

2.4.3 higher-order and non-linear

   (xn)kl

   xij

=

(xrjijxn   1   r)kl

for proof of the above, see b.1.3.

   
   x

at xnb =

(xr)t abt (xn   1   r)t

n   1(cid:88)
n   1(cid:88)

r=0

r=0

(76)

(77)

(78)

(79)

(81)

(82)

(83)

(84)

(85)

(86)

(87)

(88)

(89)

(90)

(91)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 11

(93)

(94)

(95)

(96)

(97)

(98)

2.5 derivatives of traces

2 derivatives

   
   x

at (xn)t xnb =

n   1(cid:88)

r=0

(cid:104)
+(xr)t xnabt (xn   1   r)t(cid:105)

xn   1   rabt (xn)t xr

(92)

see b.1.3 for a proof.
assume s and r are functions of x, i.e. s = s(x), r = r(x), and that a is a
constant, then

   
   x

st ar =

   
   x

(ax)t (ax)
(bx)t (bx)

=

   x

   
   x

(cid:20)    s

(cid:21)t

(cid:20)    r

(cid:21)t

   x

ar +

at s

xt at ax
xt bt bx
    2

at ax
xt bbx

= 2

xt at axbt bx

(xt bt bx)2

2.4.4 gradient and hessian

using the above we have for the gradient and the hessian

f = xt ax + bt x

= (a + at )x + b

   f
   x

   xf =
   2f
   x   xt = a + at

2.5 derivatives of traces

assume f (x) to be a di   erentiable function of each of the elements of x. it
then holds that

   tr(f (x))
where f (  ) is the scalar derivative of f (  ).

   x

= f (x)t

2.5.1 first order

   
   x
   
   x
   
   x
   
   x
   
   x
   
   x
   
   x

tr(x) = i

tr(xa) = at

tr(axb) = at bt

tr(axt b) = ba

tr(xt a) = a

tr(axt ) = a
tr(a     x) = tr(a)i

(99)

(100)

(101)

(102)

(103)

(104)

(105)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 12

2.5 derivatives of traces

2 derivatives

2.5.2 second order

   
   x
   
   x

tr(x2) = 2xt

tr(x2b) = (xb + bx)t

tr(xt bx) = bx + bt x

tr(bxxt ) = bx + bt x

tr(xxt b) = bx + bt x

tr(xbxt ) = xbt + xb

tr(bxt x) = xbt + xb

tr(xt xb) = xbt + xb

   
   x
   
   x
   
   x
   
   x
   
   x
   
   x
   
   x

tr(axbx) = at xt bt + bt xt at

   
   x

tr(xt x) =

   
   x

tr(xxt ) = 2x (115)

   
   x

tr(bt xt cxb) = ct xbbt + cxbbt

tr(cid:2)xt bxc(cid:3) = bxc + bt xct

tr(axbxt c) = at ct xbt + caxb

   
   x
   
   x

(cid:104)
(axb + c)(axb + c)t(cid:105)

tr

= 2at (axb + c)bt

tr(x     x) =

   
   x

   
   x

tr(x)tr(x) = 2tr(x)i(120)

   
   x

see [7].

2.5.3 higher order

   
   x

tr(xk) = k(xk   1)t

k   1(cid:88)

   
   x

   x tr(cid:2)bt xt cxxt cxb(cid:3) = cxxt cxbbt

tr(axk) =

(xraxk   r   1)t

r=0

   

+ct xbbt xt ct x
+cxbbt xt cx
+ct xxt ct xbbt

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 13

(106)

(107)

(108)

(109)

(110)

(111)

(112)

(113)

(114)

(116)

(117)

(118)

(119)

(121)

(122)

(123)

2.6 derivatives of vector norms

2 derivatives

2.5.4 other

tr(ax   1b) =    (x   1bax   1)t =    x   t at bt x   t

(124)

   
   x

assume b and c to be symmetric, then

(cid:104)

(cid:104)

tr

tr

(xt cx)   1a
   
   x
(xt cx)   1(xt bx)

(cid:105)
(cid:105)
(cid:105)

   
   x

(cid:104)

(a + xt cx)   1(xt bx)

tr

   
   x

=    (cx(xt cx)   1)(a + at )(xt cx)   1 (125)
=    2cx(xt cx)   1xt bx(xt cx)   1

+2bx(xt cx)   1

(126)
=    2cx(a + xt cx)   1xt bx(a + xt cx)   1

+2bx(a + xt cx)   1

(127)

see [7].

   tr(sin(x))

   x

= cos(x)t

2.6 derivatives of vector norms

2.6.1 two-norm

||x     a||2 =

   
   x

x     a
||x     a||2
    (x     a)(x     a)t

(cid:107)x     a(cid:107)3

2

x     a
(cid:107)x     a(cid:107)2

   
   x

=
   ||x||2
   x

2

i

(cid:107)x     a(cid:107)2

   ||xt x||2

   x

=

= 2x

(128)

(129)

(130)

(131)

2.7 derivatives of matrix norms

for more on matrix norms, see sec. 10.4.

2.7.1 frobenius norm
   
   x

||x||2

f =

   
   x

tr(xxh ) = 2x

(132)

see (248). note that this is also a special case of the result in equation 119.

2.8 derivatives of structured matrices

assume that the matrix a has some structure, i.e. symmetric, toeplitz, etc.
in that case the derivatives of the previous section does not apply in general.
instead, consider the following general rule for di   erentiating a scalar function
f (a)

(cid:88)

kl

df
daij

=

   f
   akl

   akl
   aij

= tr

(cid:34)(cid:20)    f

(cid:21)t    a

(cid:35)

   a

   aij

(133)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 14

2.8 derivatives of structured matrices

2 derivatives

the matrix di   erentiated with respect to itself is in this document referred to
as the structure matrix of a and is de   ned simply by

   a
   aij

= sij

(134)

if a has no special structure we have simply sij = jij, that is, the structure
matrix is simply the single-entry matrix. many structures have a representation
in singleentry matrices, see sec. 9.7.6 for more examples of structure matrices.

2.8.1 the chain rule

sometimes the objective is to    nd the derivative of a matrix which is a function
of another matrix. let u = f (x), the goal is to    nd the derivative of the
function g(u) with respect to x:

then the chain rule can then be written the following way:

   g(u)

   x

=

   g(f (x))

   x

   g(u)

   x

=

   g(u)
   xij

=

   g(u)
   ukl

   ukl
   xij

m(cid:88)

n(cid:88)

k=1

l=1

(cid:104)

(cid:105)

.

   g(u)
   xij

= tr

(

   g(u)

   u

)t    u
   xij

using matrix notation, this can be written as:

2.8.2 symmetric
if a is symmetric, then sij = jij + jji     jijjij and therefore

(cid:20)    f

(cid:21)

   a

+

(cid:20)    f

   a

(cid:21)t     diag

(cid:20)    f

(cid:21)

   a

df
da

=

that is, e.g., ([5]):

   tr(ax)

   x

    det(x)

   x

    ln det(x)

   x

= a + at     (a     i), see (142)
= det(x)(2x   1     (x   1     i))
= 2x   1     (x   1     i)

2.8.3 diagonal

if x is diagonal, then ([19]):

   tr(ax)

   x

= a     i

(135)

(136)

(137)

(138)

(139)

(140)

(141)

(142)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 15

2.8 derivatives of structured matrices

2 derivatives

2.8.4 toeplitz

like symmetric matrices and diagonal matrices also toeplitz matrices has a
special structure which should be taken into account when the derivative with
respect to a matrix with toeplitz structure.

   tr(at)

   t

   tr(ta)

=

=

                     

      (a)

   t

tr(a)

tr([at ]n1)

tr([[at ]1n ]n   1,2)

tr([at ]1n ))

tr(a)

tr([[at ]1n ]2,n   1)

.
.
.

a1n

.

.

.

.

.
.
        

.

.

.

.

.

.

.

.

.

        

.

.

.

.

.

.

.

.

.

tr([[at ]1n ]2,n   1)

tr([at ]1n ))

(143)

                     

an1

.
.
.

tr([[at ]1n ]n   1,2)

tr([at ]n1)

tr(a)

as it can be seen, the derivative   (a) also has a toeplitz structure. each value
in the diagonal is the sum of all the diagonal valued in a, the values in the
diagonals next to the main diagonal equal the sum of the diagonal next to the
main diagonal in at . this result is only valid for the unconstrained toeplitz
matrix. if the toeplitz matrix also is symmetric, the same derivative yields

   tr(at)

   t

=

   tr(ta)

   t

=   (a) +   (a)t       (a)     i

(144)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 16

                     

3

inverses

3

inverses

3.1 basic

3.1.1 de   nition
the inverse a   1 of a matrix a     cn  n is de   ned such that

(145)
where i is the n   n identity matrix. if a   1 exists, a is said to be nonsingular.
otherwise, a is said to be singular (see e.g. [12]).

aa   1 = a   1a = i,

3.1.2 cofactors and adjoint
the submatrix of a matrix a, denoted by [a]ij is a (n     1)    (n     1) matrix
obtained by deleting the ith row and the jth column of a. the (i, j) cofactor
of a matrix is de   ned as

cof(a, i, j) = (   1)i+j det([a]ij),

the matrix of cofactors can be created from the cofactors

cof(a, 1, 1)

      

cof(a, 1, n)

cof(a) =

...

...

cof(a, i, j)

      

cof(a, n, 1)

cof(a, n, n)

the adjoint matrix is the transpose of the cofactor matrix

adj(a) = (cof(a))t ,

(148)

3.1.3 determinant
the determinant of a matrix a     cn  n is de   ned as (see [12])

n(cid:88)
n(cid:88)

j=1

det(a) =

=

(   1)j+1a1j det ([a]1j)

a1jcof(a, 1, j).

3.1.4 construction

j=1

the inverse matrix can be constructed, using the adjoint matrix, by

a   1 =

1

det(a)

   adj(a)

for the case of 2    2 matrices, see section 1.3.

(149)

(150)

(151)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 17

(146)

(147)

                     

3.2 exact relations

3

inverses

3.1.5 condition number

the condition number of a matrix c(a) is the ratio between the largest and the
smallest singular value of a matrix (see section 5.3 on singular values),

c(a) =

d+
d   

(152)

the condition number can be used to measure how singular a matrix is. if the
condition number is large, it indicates that the matrix is nearly singular. the
condition number can also be estimated from the matrix norms. here

c(a) = (cid:107)a(cid:107)    (cid:107)a   1(cid:107),

the 2-norm of a equals (cid:112)(max(eig(ah a))) [12, p.57]. for a symmetric

(153)
where (cid:107)    (cid:107) is a norm such as e.g the 1-norm, the 2-norm, the    -norm or the
frobenius norm (see sec 10.4 for more on matrix norms).
matrix, this reduces to ||a||2 = max(|eig(a)|) [12, p.394].
if the matrix is
symmetric and positive de   nite, ||a||2 = max(eig(a)). the condition number
based on the 2-norm thus reduces to

(cid:107)a(cid:107)2(cid:107)a   1(cid:107)2 = max(eig(a)) max(eig(a   1)) =

max(eig(a))
min(eig(a))

.

(154)

3.2 exact relations

3.2.1 basic

(ab)   1 = b   1a   1

(155)

3.2.2 the woodbury identity

the woodbury identity comes in many variants. the latter of the two can be
found in [12]

(a + cbct )   1 = a   1     a   1c(b   1 + ct a   1c)   1ct a   1
(a + ubv)   1 = a   1     a   1u(b   1 + va   1u)   1va   1

(156)

(157)

if p, r are positive de   nite, then (see [30])

(p   1 + bt r   1b)   1bt r   1 = pbt (bpbt + r)   1

(158)

3.2.3 the kailath variant

(a + bc)   1 = a   1     a   1b(i + ca   1b)   1ca   1

(159)

see [4, page 153].

3.2.4 sherman-morrison

(a + bct )   1 = a   1     a   1bct a   1
1 + ct a   1b

(160)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 18

3.2 exact relations

3

inverses

3.2.5 the searle set of identities

the following set of identities, can be found in [25, page 151],

(i + a   1)   1 = a(a + i)   1

(a + bbt )   1b = a   1b(i + bt a   1b)   1
(a   1 + b   1)   1 = a(a + b)   1b = b(a + b)   1a

a     a(a + b)   1a = b     b(a + b)   1b

a   1 + b   1 = a   1(a + b)b   1
(i + ab)   1 = i     a(i + ba)   1b

(i + ab)   1a = a(i + ba)   1

(161)

(162)

(163)

(164)

(165)

(166)

(167)

3.2.6 rank-1 update of inverse of inner product
denote a = (xt x)   1 and that x is extended to include a new column vector
in the end   x = [x v]. then [34]

(cid:34)

(cid:35)

(   xt   x)   1 =

a + axt vvt xat
vt v   vt xaxt v
   vt xat
vt v   vt xaxt v

   axt v

vt v   vt xaxt v
vt v   vt xaxt v

1

3.2.7 rank-1 update of moore-penrose inverse

the following is a rank-1 update for the moore-penrose pseudo-inverse of real
valued matrices and proof can be found in [18]. the matrix g is de   ned below:

(a + cdt )+ = a+ + g

using the the notation

   = 1 + dt a+c
v = a+c
n = (a+)t d
w = (i     aa+)c
m = (i     a+a)t d

(173)
the solution is given as six di   erent cases, depending on the entities ||w||,
||m||, and   . please note, that for any (column) vector v it holds that v+ =
vt (vt v)   1 = vt

||v||2 . the solution is:

case 1 of 6: if ||w|| (cid:54)= 0 and ||m|| (cid:54)= 0. then

g =    vw+     (m+)t nt +   (m+)t w+

=     1

||w||2 vwt     1

||m||2 mnt +

  

||m||2||w||2 mwt

case 2 of 6: if ||w|| = 0 and ||m|| (cid:54)= 0 and    = 0. then

g =    vv+a+     (m+)t nt
||v||2 vvt a+     1

=     1

||m||2 mnt

(174)

(175)

(176)

(177)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 19

(168)

(169)

(170)

(171)

(172)

3.3

implication on inverses

3

inverses

case 3 of 6: if ||w|| = 0 and    (cid:54)= 0. then

g =

1
  

mvt a+    

  

||v||2||m||2 + |  |2

(cid:18)||v||2

  

(cid:19)(cid:18)||m||2

  

m + v

(cid:19)t

(a+)t v + n

case 4 of 6: if ||w|| (cid:54)= 0 and ||m|| = 0 and    = 0. then

g =    a+nn+     vw+

=     1

||n||2 a+nnt     1

||w||2 vwt

(178)

(179)

(180)

case 5 of 6: if ||m|| = 0 and    (cid:54)= 0. then

g =

a+nwt    

1
  

  

||n||2||w||2 + |  |2

(cid:18)||w||2

  

(cid:19)(cid:18)||n||2

  

a+n + v

(cid:19)t

w + n

(181)

case 6 of 6: if ||w|| = 0 and ||m|| = 0 and    = 0. then
g =    vv+a+     a+nn+ + v+a+nvn+

=     1

||v||2 vvt a+     1

||n||2 a+nnt +

vt a+n
||v||2||n||2 vnt

(182)

(183)

3.3

implication on inverses

if

(a + b)   1 = a   1 + b   1

then

ab   1a = ba   1b

(184)

see [25].

3.3.1 a posdef identity

assume p, r to be positive de   nite and invertible, then

(p   1 + bt r   1b)   1bt r   1 = pbt (bpbt + r)   1

(185)

see [30].

3.4 approximations

the following identity is known as the neuman series of a matrix, which holds
when |  i| < 1 for all eigenvalues   i

(i     a)   1 =

an

(186)

which is equivalent to

(i + a)   1 =

(   1)nan

(187)
when |  i| < 1 for all eigenvalues   i, it holds that a     0 for n        , and the
following approximations holds

n=0

(i     a)   1    = i + a + a2
(i + a)   1    = i     a + a2

(188)

(189)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 20

   (cid:88)
   (cid:88)

n=0

3.5 generalized inverse

3

inverses

the following approximation is from [22] and holds when a large and symmetric

a     a(i + a)   1a    = i     a   1

if   2 is small compared to q and m then

(q +   2m)   1    = q   1       2q   1mq   1

proof:

(q +   2m)   1 =
(qq   1q +   2mq   1q)   1 =
((i +   2mq   1)q)   1 =
q   1(i +   2mq   1)   1

(190)

(191)

(192)

(193)

(194)

(195)

this can be rewritten using the taylor expansion:
q   1(i +   2mq   1)   1 =

q   1(i       2mq   1 + (  2mq   1)2     ...)    = q   1       2q   1mq   1 (197)

(196)

3.5 generalized inverse

3.5.1 de   nition
a generalized inverse matrix of the matrix a is any matrix a    such that (see
[26])

aa   a = a

(198)

the matrix a    is not unique.

3.6 pseudo inverse

3.6.1 de   nition

the pseudo inverse (or moore-penrose inverse) of a matrix a is the matrix a+
that ful   ls

i

ii

iii

iv

aa+a = a
a+aa+ = a+
aa+ symmetric
a+a symmetric

the matrix a+ is unique and does always exist. note that in case of com-
plex matrices, the symmetric condition is substituted by a condition of being
hermitian.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 21

3.6 pseudo inverse

3

inverses

3.6.2 properties

assume a+ to be the pseudo-inverse of a, then (see [3] for some of them)

(a+)+ = a
(at )+ = (a+)t
(ah )+ = (a+)h
(a   )+ = (a+)   

(a+a)ah = ah
(cid:54)= at
(a+a)at

(ca)+ = (1/c)a+

a+ = (at a)+at
a+ = at (aat )+

(at a)+ = a+(at )+
(aat )+ = (at )+a+

a+ = (ah a)+ah
a+ = ah (aah )+

(ah a)+ = a+(ah )+
(aah )+ = (ah )+a+

(ab)+ = (a+ab)+(abb+)+

f (ah a)     f (0)i = a+[f (aah )     f (0)i]a
f (aah )     f (0)i = a[f (ah a)     f (0)i]a+

where a     cn  m.

assume a to have full rank, then

(aa+)(aa+) = aa+
(a+a)(a+a) = a+a

tr(aa+) = rank(aa+)
tr(a+a) = rank(a+a)

(see [26])

(see [26])

for two matrices it hold that

(ab)+ = (a+ab)+(abb+)+

(a     b)+ = a+     b+

(199)

(200)

(201)

(202)

(203)

(204)

(205)

(206)

(207)

(208)

(209)

(210)

(211)

(212)

(213)

(214)

(215)

(216)

(217)

(218)

(219)

(220)

(221)

(222)

3.6.3 construction

assume that a has full rank, then

a n    n
square
a n    m broad
a n    m tall

rank(a) = n     a+ = a   1
rank(a) = n     a+ = at (aat )   1
rank(a) = m     a+ = (at a)   1at

the so-called    broad version    is also known as right inverse and the    tall ver-
sion    as the left inverse.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 22

3.6 pseudo inverse

3

inverses

assume a does not have full rank, i.e. a is n    m and rank(a) = r <
min(n, m). the pseudo inverse a+ can be constructed from the singular value
decomposition a = udvt , by

a+ = vrd   1

r ut
r

(223)

where ur, dr, and vr are the matrices with the degenerated rows and columns
deleted. a di   erent way is this: there do always exist two matrices c n    r
and d r    m of rank r, such that a = cd. using these matrices it holds that

a+ = dt (ddt )   1(ct c)   1ct

(224)

see [3].

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 23

4 complex matrices

4 complex matrices

the complex scalar product r = pq can be written as

(cid:21)

(cid:20) (cid:60)r(cid:61)r

(cid:20) (cid:60)p    (cid:61)p

(cid:61)p (cid:60)p

(cid:21)(cid:20) (cid:60)q(cid:61)q

=

(cid:21)

(225)

4.1 complex derivatives

in order to di   erentiate an expression f (z) with respect to a complex z, the
cauchy-riemann equations have to be satis   ed ([7]):

df (z)

dz

=

+ i

   (cid:60)(f (z))

   (cid:60)z
   (cid:60)(f (z))

   (cid:61)z

   (cid:61)(f (z))

   (cid:60)z
   (cid:61)(f (z))

   (cid:61)z

+

and

df (z)

dz
or in a more compact form:

=    i

   f (z)
   (cid:61)z

= i

   f (z)
   (cid:60)z

.

(226)

(227)

(228)

a complex function that satis   es the cauchy-riemann equations for points in a
region r is said yo be analytic in this region r. in general, expressions involving
complex conjugate or conjugate transpose do not satisfy the cauchy-riemann
equations.
in order to avoid this problem, a more generalized de   nition of
complex derivative is used ([24], [6]):
    generalized complex derivative:

1
2
    conjugate complex derivative

df (z)

dz

=

df (z)
dz    =

1
2

   (cid:60)z

(cid:16)    f (z)
(cid:16)    f (z)

   (cid:60)z

(cid:17)
(cid:17)

    i

   f (z)
   (cid:61)z

+ i

   f (z)
   (cid:61)z

.

.

(229)

(230)

the generalized complex derivative equals the normal derivative, when f is an
analytic function. for a non-analytic function such as f (z) = z   , the derivative
equals zero. the conjugate complex derivative equals zero, when f is an
analytic function. the conjugate complex derivative has e.g been used by [21]
when deriving a complex gradient.
notice:

(231)
    complex gradient vector: if f is a real function of a complex vector z,

+ i

dz

.

df (z)

(cid:54)=

   f (z)
   (cid:60)z

   f (z)
   (cid:61)z

then the complex gradient vector is given by ([14, p. 798])

   f (z) = 2

df (z)
dz   
   f (z)
   (cid:60)z

=

(232)

+ i

   f (z)
   (cid:61)z

.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 24

4.1 complex derivatives

4 complex matrices

    complex gradient matrix: if f is a real function of a complex matrix z,

then the complex gradient matrix is given by ([2])

   f (z) = 2

df (z)
dz   
   f (z)
   (cid:60)z

=

(233)

+ i

   f (z)
   (cid:61)z

.

these expressions can be used for id119 algorithms.

4.1.1 the chain rule for complex numbers

the chain rule is a little more complicated when the function of a complex
u = f (x) is non-analytic. for a non-analytic function, the following chain rule
can be applied ([7])

   g(u)

   x

=

=

   g
   u
   g
   u

   u
   x
   u
   x

+

+

   g
   u   

(cid:16)    g   

   u   
   x

(cid:17)       u   

   u

   x

(234)

notice, if the function is analytic, the second term reduces to zero, and the func-
tion is reduced to the normal well-known chain rule. for the matrix derivative
of a scalar function g(u), the chain rule can be written the following way:

   g(u)

   x

=

tr((    g(u)
   u )t    u)
   x

+

   u    )t    u   )
tr((    g(u)
   x

.

(235)

4.1.2 complex derivatives of traces

if the derivatives involve complex numbers, the conjugate transpose is often in-
volved. the most useful way to show complex derivative is to show the derivative
with respect to the real and the imaginary part separately. an easy example is:

   tr(x   )
   (cid:60)x
   tr(x   )
   (cid:61)x

i

=

= i

   tr(xh )

   (cid:60)x

   tr(xh )

   (cid:61)x

= i

= i

(236)

(237)

since the two results have the same sign, the conjugate complex derivative (230)
should be used.

   tr(x)
   (cid:60)x
   tr(x)
   (cid:61)x

i

=

= i

   tr(xt )
   (cid:60)x
   tr(xt )
   (cid:61)x

= i

=    i

(238)

(239)

here, the two results have di   erent signs, and the generalized complex derivative
(229) should be used. hereby, it can be seen that (100) holds even if x is a
complex number.

   tr(axh )

   (cid:60)x

   tr(axh )

   (cid:61)x

i

= a

= a

(240)

(241)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 25

4.2 higher order and non-linear derivatives

4 complex matrices

   tr(ax   )
   tr(ax   )

   (cid:60)x
   (cid:61)x

i

= at

= at

   tr(xxh )

   (cid:60)x

=

   tr(xh x)

   (cid:60)x

   tr(xxh )

   (cid:61)x

i

= i

   tr(xh x)

   (cid:61)x

= 2(cid:60)x

= i2(cid:61)x

by inserting (244) and (245) in (229) and (230), it can be seen that

   tr(xxh )

   x

= x   

   tr(xxh )

   x   

= x

(242)

(243)

(244)

(245)

(246)

(247)

since the function tr(xxh ) is a real function of the complex matrix x, the
complex gradient matrix (233) is given by

   tr(xxh ) = 2

   tr(xxh )

   x   

= 2x

(248)

4.1.3 complex derivative involving determinants

here, a calculation example is provided. the objective is to    nd the derivative of
det(xh ax) with respect to x     cm  n. the derivative is found with respect to
the real part and the imaginary part of x, by use of (42) and (37), det(xh ax)
can be calculated as (see app. b.1.4 for details)

(cid:16)     det(xh ax)

(cid:16)     det(xh ax)

    det(xh ax)

   x

=

1
2

= det(xh ax)(cid:0)(xh ax)   1xh a(cid:1)t

   (cid:60)x

   (cid:61)x

    det(xh ax)

    i

and the complex conjugate derivative yields

    det(xh ax)

   x   

1
2

=
= det(xh ax)ax(xh ax)   1

   (cid:60)x

+ i

   (cid:61)x

    det(xh ax)

4.2 higher order and non-linear derivatives

   
   x

(ax)h (ax)
(bx)h (bx)

=

   
   x

xh ah ax
xh bh bx
    2

ah ax
xh bbx

= 2

xh ah axbh bx

(xh bh bx)2

(cid:17)

(cid:17)

(249)

(250)

(251)

(252)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 26

4.3

inverse of complex sum

4 complex matrices

4.3

inverse of complex sum

given real matrices a, b    nd the inverse of the complex sum a + ib. form
the auxiliary matrices

e = a + tb
f = b     ta,
and    nd a value of t such that e   1 exists. then

(253)

(254)

(a + ib)   1 = (1     it)(e + if)   1

(255)
= (1     it)((e + fe   1f)   1     i(e + fe   1f)   1fe   1)(256)
= (1     it)(e + fe   1f)   1(i     ife   1)
(257)
= (e + fe   1f)   1((i     tfe   1)     i(ti + fe   1))
= (e + fe   1f)   1(i     tfe   1)

(258)

   i(e + fe   1f)   1(ti + fe   1)

(259)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 27

5 solutions and decompositions

5 solutions and decompositions

5.1 solutions to linear equations

5.1.1 simple id75

assume we have data (xn, yn) for n = 1, ..., n and are seeking the parameters
   = axi + b. with a least squares error function, the optimal
a, b     r such that yi
values for a, b can be expressed using the notation

x = (x1, ..., xn )t

y = (y1, ..., yn )t

1 = (1, ..., 1)t     rn  1

and

as

rxx = xt x rx1 = xt 1 r11 = 1t 1
ryx = yt x ry1 = yt 1

(cid:21)

(cid:20) a

b

=

(cid:20) rxx rx1

(cid:21)   1(cid:20) rx,y

rx1 r11

ry1

(cid:21)

(260)

5.1.2 existence in linear systems
assume a is n    m and consider the linear system

construct the augmented matrix b = [a b] then

ax = b

(261)

condition
rank(a) = rank(b) = m unique solution x
rank(a) = rank(b) < m many solutions x
rank(a) < rank(b)

no solutions x

solution

5.1.3 standard square

assume a is square and invertible, then
   

ax = b

x = a   1b

(262)

5.1.4 degenerated square
assume a is n   n but of rank r < n. in that case, the system ax = b is solved
by

x = a+b

where a+ is the pseudo-inverse of the rank-de   cient matrix, constructed as
described in section 3.6.3.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 28

5.1 solutions to linear equations5 solutions and decompositions

5.1.5 cramer   s rule

the equation

ax = b,

(263)

where a is square has exactly one solution x if the ith element in x can be
found as

xi =

det b
det a

,

(264)

where b equals a, but the ith column in a has been substituted by b.

5.1.6 over-determined rectangular
assume a to be n    m, n > m (tall) and rank(a) = m, then
x = (at a)   1at b = a+b

ax = b

   

(265)

that is if there exists a solution x at all! if there is no solution the following
can be useful:

(266)
now xmin is the vector x which minimizes ||ax     b||2, i.e. the vector which is
   least wrong   . the matrix a+ is the pseudo-inverse of a. see [3].

ax = b

xmin = a+b

   

5.1.7 under-determined rectangular
assume a is n    m and n < m (   broad   ) and rank(a) = n.
xmin = at (aat )   1b

ax = b

   

(267)

the equation have many solutions x. but xmin is the solution which minimizes
||ax    b||2 and also the solution with the smallest norm ||x||2. the same holds
for a matrix version: assume a is n    m, x is m    n and b is n    n, then

ax = b

   

xmin = a+b

(268)

the equation have many solutions x. but xmin is the solution which minimizes
||ax     b||2 and also the solution with the smallest norm ||x||2. see [3].
similar but di   erent: assume a is square n    n and the matrices b0, b1
are n    n , where n > n, then if b0 has maximal rank
amin = b1bt

ab0 = b1

(269)

   

0 (b0bt

0 )   1

where amin denotes the matrix which is optimal in a least square sense. an
interpretation is that a is the linear approximation which maps the columns
vectors of b0 into the columns vectors of b1.

5.1.8 linear form and zeros

ax = 0,

   x

   

a = 0

5.1.9 square form and zeros

if a is symmetric, then

xt ax = 0,

   x

   

a = 0

(270)

(271)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 29

5.2 eigenvalues and eigenvectors5 solutions and decompositions

5.1.10 the lyapunov equation

ax + xb = c

vec(x) = (i     a + bt     i)   1vec(c)

(272)

(273)

sec 10.2.1 and 10.2.2 for details on the kronecker product and the vec op-

erator.

5.1.11 encapsulating sum

(cid:80)

nanxbn = c

vec(x) = (cid:0)(cid:80)

n     an

nbt

(cid:1)   1

vec(c)

(274)

(275)

see sec 10.2.1 and 10.2.2 for details on the kronecker product and the vec
operator.

5.2 eigenvalues and eigenvectors

5.2.1 de   nition

the eigenvectors vi and eigenvalues   i are the ones satisfying

avi =   ivi

(276)

5.2.2 decompositions

for matrices a with as many distinct eigenvalues as dimensions, the following
holds, where the columns of v are the eigenvectors and (d)ij =   ij  i,

av = vd

(277)

for defective matrices a, which is matrices which has fewer distinct eigenvalues
than dimensions, the following decomposition called jordan canonical form,
holds

av = vj

(278)

where j is a block diagonal matrix with the blocks ji =   ii + n. the matrices
ji have dimensionality as the number of identical eigenvalues equal to   i, and n
is square matrix of same size with 1 on the super diagonal and zero elsewhere.
it also holds that for all matrices a there exists matrices v and r such that

av = vr

(279)

where r is upper triangular with the eigenvalues   i on its diagonal.

5.2.3 general properties
assume that a     rn  m and b     rm  n,

eig(ab) = eig(ba)

rank(a) = r     at most r non-zero   i

(280)

(281)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 30

5.3 singular value decomposition5 solutions and decompositions

5.2.4 symmetric

assume a is symmetric, then

(i.e. v is orthogonal)
(i.e.   i is real)

vvt = i
  i     r

tr(ap) = (cid:80)

i  p
eig(i + ca) = 1 + c  i
eig(a     ci) =   i     c

i

eig(a   1) =      1

i

for a symmetric, positive matrix a,

eig(at a) = eig(aat ) = eig(a)     eig(a)

5.2.5 characteristic polynomial

the characteristic polynomial for the matrix a is

0 = det(a       i)

=   n     g1  n   1 + g2  n   2     ... + (   1)ngn

(282)

(283)

(284)

(285)

(286)

(287)

(288)

(289)

(290)

note that the coe   cients gj for j = 1, ..., n are the n invariants under rotation
of a. thus, gj is the sum of the determinants of all the sub-matrices of a taken
j rows and columns at a time. that is, g1 is the trace of a, and g2 is the sum
of the determinants of the n(n     1)/2 sub-matrices that can be formed from a
by deleting all but two rows and columns, and so on     see [17].

5.3 singular value decomposition
any n    m matrix a can be written as

where

a = udvt ,

d = (cid:112)diag(eig(aat ))

n    n
u = eigenvectors of aat
n    m
v = eigenvectors of at a m    m

5.3.1 symmetric square decomposed into squares
assume a to be n    n and symmetric. then

(cid:2) a (cid:3) =(cid:2) v (cid:3)(cid:2) d (cid:3)(cid:2) vt (cid:3) ,

(291)

(292)

(293)

where d is diagonal with the eigenvalues of a, and v is orthogonal and the
eigenvectors of a.

5.3.2 square decomposed into squares

assume a     rn  n. then(cid:2) a (cid:3) =(cid:2) v (cid:3)(cid:2) d (cid:3)(cid:2) ut (cid:3) ,

(294)

where d is diagonal with the square root of the eigenvalues of aat , v is the
eigenvectors of aat and ut is the eigenvectors of at a.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 31

5.4 triangular decomposition

5 solutions and decompositions

5.3.3 square decomposed into rectangular

assume v   d   ut    = 0 then we can expand the svd of a into

(cid:2) a (cid:3) =(cid:2) v v    (cid:3)(cid:20) d 0

0 d   

(cid:21)

(cid:21)(cid:20) ut

ut   

where the svd of a is a = vdut .

5.3.4 rectangular decomposition i
assume a is n    m, v is n    n, d is n    n, ut is n    m

(cid:2) a (cid:3) =(cid:2) v (cid:3)(cid:2) d (cid:3)(cid:2) ut

(cid:3) ,

,

(295)

(296)

where d is diagonal with the square root of the eigenvalues of aat , v is the
eigenvectors of aat and ut is the eigenvectors of at a.

5.3.5 rectangular decomposition ii
assume a is n    m, v is n    m, d is m    m, ut is m    m

(cid:2) a (cid:3) =(cid:2) v (cid:3)       d

             ut

5.3.6 rectangular decomposition iii
assume a is n    m, v is n    n, d is n    m, ut is m    m

(cid:2) a (cid:3) =(cid:2) v (cid:3)(cid:2) d (cid:3)       ut

       ,

      

(297)

(298)

where d is diagonal with the square root of the eigenvalues of aat , v is the
eigenvectors of aat and ut is the eigenvectors of at a.

5.4 triangular decomposition

5.5 lu decomposition

assume a is a square matrix with non-zero leading principal minors, then

a = lu

(299)

where l is a unique unit lower triangular matrix and u is a unique upper
triangular matrix.

5.5.1 cholesky-decomposition

assume a is a symmetric positive de   nite square matrix, then

where u is a unique upper triangular matrix and l is a lower triangular matrix.

a = ut u = llt ,

(300)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 32

5.6 ldm decomposition

5 solutions and decompositions

5.6 ldm decomposition

assume a is a square matrix with non-zero leading principal minors1, then

a = ldmt

(301)

where l, m are unique unit lower triangular matrices and d is a unique diagonal
matrix.

5.7 ldl decompositions

the ldl decomposition are special cases of the ldm decomposition. assume
a is a non-singular symmetric de   nite square matrix, then

a = ldlt = lt dl

(302)

where l is a unit lower triangular matrix and d is a diagonal matrix. if a is
also positive de   nite, then d has strictly positive diagonal entries.

1if the matrix that corresponds to a principal minor is a quadratic upper-left part of the
larger matrix (i.e., it consists of matrix elements in rows and columns from 1 to k), then the
principal minor is called a leading principal minor. for an n times n square matrix, there are
n leading principal minors. [31]

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 33

6 statistics and id203

6 statistics and id203

6.1 de   nition of moments
assume x     rn  1 is a random variable

6.1.1 mean

the vector of means, m, is de   ned by

(m)i = (cid:104)xi(cid:105)

6.1.2 covariance

the matrix of covariance m is de   ned by

(m)ij = (cid:104)(xi     (cid:104)xi(cid:105))(xj     (cid:104)xj(cid:105))(cid:105)

or alternatively as

m = (cid:104)(x     m)(x     m)t(cid:105)

6.1.3 third moments

(303)

(304)

(305)

the matrix of third centralized moments     in some contexts referred to as
coskewness     is de   ned using the notation

ijk = (cid:104)(xi     (cid:104)xi(cid:105))(xj     (cid:104)xj(cid:105))(xk     (cid:104)xk(cid:105))(cid:105)
m(3)

(cid:104)

(cid:105)

as

m3 =

m(3)

::1 m(3)

::2 ...m(3)
::n

where    :    denotes all elements within the given index. m3 can alternatively be
expressed as

m3 = (cid:104)(x     m)(x     m)t     (x     m)t(cid:105)

6.1.4 fourth moments

the matrix of fourth centralized moments     in some contexts referred to as
cokurtosis     is de   ned using the notation

ijkl = (cid:104)(xi     (cid:104)xi(cid:105))(xj     (cid:104)xj(cid:105))(xk     (cid:104)xk(cid:105))(xl     (cid:104)xl(cid:105))(cid:105)
m(4)

(cid:104)

as

m4 =

m(4)

::11m(4)

::21...m(4)

::n1|m(4)

::12m(4)

::22...m(4)

::n2|...|m(4)

::1nm(4)

::2n...m(4)
::nn

or alternatively as

m4 = (cid:104)(x     m)(x     m)t     (x     m)t     (x     m)t(cid:105)

(306)

(307)

(308)

(cid:105)

(309)

(310)

(311)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 34

6.2 expectation of linear combinations6 statistics and id203

6.2 expectation of linear combinations

6.2.1 linear forms

assume x and x to be a matrix and a vector of random variables. then (see
see [26])

e[axb + c] = ae[x]b + c

var[ax] = avar[x]at

cov[ax, by] = acov[x, y]bt

assume x to be a stochastic vector with mean m, then (see [7])

e[ax + b] = am + b

e[ax] = am

e[x + b] = m + b

(312)

(313)

(314)

(315)

(316)

(317)

6.2.2 quadratic forms

assume a is symmetric, c = e[x] and    = var[x]. assume also that all
coordinates xi are independent, have the same central moments   1,   2,   3,   4
and denote a = diag(a). then (see [26])

e[xt ax] = tr(a  ) + ct ac

var[xt ax] = 2  2

2tr(a2) + 4  2ct a2c + 4  3ct aa + (  4     3  2

(318)
2)at a (319)

also, assume x to be a stochastic vector with mean m, and covariance m. then
(see [7])

e[(ax + a)(bx + b)t ] = ambt + (am + a)(bm + b)t

e[xxt ] = m + mmt
e[xat x] = (m + mmt )a

e[xt axt ] = at (m + mmt )

e[(ax)(ax)t ] = a(m + mmt )at

e[(x + a)(x + a)t ] = m + (m + a)(m + a)t

(320)

(321)
(322)

(323)

(324)

(325)

e[(ax + a)t (bx + b)] = tr(ambt ) + (am + a)t (bm + b) (326)
(327)

e[xt x] = tr(m) + mt m

e[xt ax] = tr(am) + mt am

e[(ax)t (ax)] = tr(amat ) + (am)t (am)
e[(x + a)t (x + a)] = tr(m) + (m + a)t (m + a)

(328)

(329)

(330)

see [7].

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 35

6.3 weighted scalar variable

6 statistics and id203

6.2.3 cubic forms

assume x to be a stochastic vector with independent coordinates, mean m,
covariance m and central moments v3 = e[(x     m)3]. then (see [7])

e[(ax + a)(bx + b)t (cx + c)] = adiag(bt c)v3

+tr(bmct )(am + a)
+amct (bm + b)
+(ambt + (am + a)(bm + b)t )(cm + c)

e[(ax + a)(ax + a)t (ax + a)] = adiag(at a)v3

e[xxt x] = v3 + 2mm + (tr(m) + mt m)m

e[(ax + a)bt (cx + c)(dx + d)t ] = (ax + a)bt (cmdt + (cm + c)(dm + d)t )

+[2amat + (ax + a)(ax + a)t ](am + a)
+tr(amat )(am + a)

+(amct + (am + a)(cm + c)t )b(dm + d)t
+bt (cm + c)(amdt     (am + a)(dm + d)t )

6.3 weighted scalar variable
assume x     rn  1 is a random variable, w     rn  1 is a vector of constants and
y is the linear combination y = wt x. assume further that m, m2, m3, m4
denotes the mean, covariance, and central third and fourth moment matrix of
the variable x. then it holds that

(cid:104)y(cid:105) = wt m

(cid:104)(y     (cid:104)y(cid:105))2(cid:105) = wt m2w
(cid:104)(y     (cid:104)y(cid:105))3(cid:105) = wt m3w     w
(cid:104)(y     (cid:104)y(cid:105))4(cid:105) = wt m4w     w     w

(331)

(332)

(333)

(334)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 36

7 multivariate distributions

7 multivariate distributions

7.1 cauchy
the density function for a cauchy distributed vector t     rp  1, is given by

p(t|  ,   ) =      p/2   ( 1+p
2 )
  (1/2)

(cid:2)1 + (t       )t     1(t       )(cid:3)(1+p )/2

det(  )   1/2

(335)

where    is the location,    is positive de   nite, and    denotes the gamma func-
tion. the cauchy distribution is a special case of the student-t distribution.

7.2 dirichlet

the dirichlet distribution is a kind of    inverse    distribution compared to the
multinomial distribution on the bounded continuous variate x = [x1, . . . , xp ]
[16, p. 44]

(cid:16)(cid:80)p
(cid:81)p

  

p   p

(cid:17)

p(cid:89)

p   (  p)

p

x  p   1

p

p(x|  ) =

7.3 normal

the normal distribution is also known as a gaussian distribution. see sec. 8.

7.4 normal-inverse gamma

7.5 gaussian

see sec. 8.

7.6 multinomial
if the vector n contains counts, i.e. (n)i     0, 1, 2, ..., then the discrete multino-
mial disitrbution for n is given by

p (n|a, n) =

where ai are probabilities, i.e. 0     ai     1 and(cid:80)

n1! . . . nd!

i

ani
i

,

n!

d(cid:89)

d(cid:88)

i

i ai = 1.

ni = n

(336)

7.7 student   s t
the density of a student-t distributed vector t     rp  1, is given by

p(t|  ,   ,   ) = (    )   p/2   (   +p
2 )
  (  /2)

(cid:2)1 +      1(t       )t     1(t       )(cid:3)(  +p )/2

det(  )   1/2

(337)

where    is the location, the scale matrix    is symmetric, positive de   nite,   
is the degrees of freedom, and    denotes the gamma function. for    = 1, the
student-t distribution becomes the cauchy distribution (see sec 7.1).

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 37

7.8 wishart

7 multivariate distributions

7.7.1 mean

7.7.2 variance

7.7.3 mode

e(t) =   ,

   > 1

cov(t) =

  
       2

  ,

   > 2

(338)

(339)

the notion mode meaning the position of the most probable value

mode(t) =   

(340)

7.7.4 full matrix version
if instead of a vector t     rp  1 one has a matrix t     rp  n , then the student-t
distribution for t is

   [(   + p     p + 1)/2]

p(cid:89)
det(cid:2)      1 + (t     m)     1(t     m)t(cid:3)   (  +p )/2

   [(       p + 1)/2]

   det(   )     /2 det(  )   n/2   

  

p=1

(341)

p(t|m,    ,   ,   ) =      n p/2

where m is the location,     is the rescaling matrix,    is positive de   nite,    is
the degrees of freedom, and    denotes the gamma function.

7.8 wishart
the central wishart distribution for m     rp  p , m is positive de   nite, where
m can be regarded as a degree of freedom parameter [16, equation 3.8.1] [8,
section 2.5],[11]

p(m|  , m) =

2mp/2  p (p   1)/4(cid:81)p

1
p   [ 1

2 (m + 1     p)]
(cid:21)
det(  )   m/2 det(m)(m   p   1)/2   

(cid:20)

exp

tr(     1m)

    1
2

  

(342)

(343)

7.8.1 mean

e(m) = m  

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 38

7.9 wishart, inverse

7 multivariate distributions

7.9 wishart, inverse
the (normal) inverse wishart distribution for m     rp  p , m is positive de   -
nite, where m can be regarded as a degree of freedom parameter [11]

p(m|  , m) =

2mp/2  p (p   1)/4(cid:81)p

1
p   [ 1

2 (m + 1     p)]
(cid:21)
det(  )m/2 det(m)   (m   p   1)/2   

(cid:20)

exp

tr(  m   1)

    1
2

  

(344)

(345)

7.9.1 mean

e(m) =   

1

m     p     1

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 39

8 gaussians

8.1 basics

8.1.1 density and id172
the density of x     n (m,   ) is

(cid:20)

1(cid:112)det(2    )

exp

    1
2

p(x) =

8 gaussians

(cid:21)

(x     m)t      1(x     m)

(346)

note that if x is d-dimensional, then det(2    ) = (2  )d det(  ).

integration and id172

(x     m)t      1(x     m)

xt      1x + mt      1x

exp

xt ax + ct x

(cid:20)

    1
2

(cid:90)

(cid:20)

(cid:90)

exp

exp

    1
2
    1
2

(cid:20)
(cid:90)

(cid:90)

(cid:20)

    1
2

if x = [x1x2...xn] and c = [c1c2...cn], then

exp

tr(xt ax) + tr(ct x)

(cid:21)
(cid:21)
(cid:21)

(cid:21)

dx = (cid:112)det(2    )
(cid:20) 1
dx = (cid:112)det(2    ) exp
(cid:20) 1
dx = (cid:112)det(2  a   1) exp
(cid:20) 1
dx =(cid:112)det(2  a   1)

exp

2

2

n

(cid:21)
(cid:21)

mt      1m

ct a   t c

(cid:21)

tr(ct a   1c)

2

the derivatives of the density are

   p(x)

=    p(x)     1(x     m)

(cid:16)

     1(x     m)(x     m)t      1          1(cid:17)

   x
   2p
   x   xt = p(x)

8.1.2 marginal distribution
assume x     nx(  ,   ) where

(cid:21)

(cid:20) xa

xb

(cid:21)

(cid:20)   a

  b

   =

(cid:20)   a   c

  t

c   b

   =

x =

then

p(xa) = nxa (  a,   a)
p(xb) = nxb (  b,   b)

8.1.3 conditional distribution
assume x     nx(  ,   ) where

(cid:21)

(cid:20) xa

xb

x =

   =

(cid:20)   a

  b

(cid:21)

   =

(cid:20)   a   c

  t

c   b

(cid:21)

(cid:21)

(347)

(348)

(349)

(350)

(351)

(352)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 40

8.1 basics

then

p(xa|xb) = nxa (    a,     a)

p(xb|xa) = nxb (    b,     b)

8 gaussians

(cid:110)     a =   a +   c     1
(cid:110)     b =   b +   t

    a =   a       c     1
c      1
c      1

    b =   b       t

b (xb       b)
b   t
c
a (xa       a)
a   c

(353)

(354)

note, that the covariance matrices are the schur complement of the block ma-
trix, see 9.1.5 for details.

8.1.4 linear combination
assume x     n (mx,   x) and y     n (my,   y) then

ax + by + c     n (amx + bmy + c, a  xat + b  ybt )

(355)

8.1.5 rearranging means

(cid:112)det(2  (at      1a)   1)

(cid:112)det(2    )

nax[m,   ] =

nx[a   1m, (at      1a)   1]

(356)

if a is square and invertible, it simpli   es to

nax[m,   ] =

1

| det(a)|nx[a   1m, (at      1a)   1]

(357)

8.1.6 rearranging into squared form

if a is symmetric, then

    1
2

xt ax + bt x =     1
2
tr(xt ax) + tr(bt x) =     1
2

    1
2

(x     a   1b)t a(x     a   1b) +
tr[(x     a   1b)t a(x     a   1b)] +

1
2

bt a   1b

8.1.7 sum of two squared forms

in vector formulation (assuming   1,   2 are symmetric)
1 (x     m1)
2 (x     m2)
c (x     mc) + c

(x     m1)t      1
(x     m2)t      1
(x     mc)t      1

    1
2
    1
2
=     1
2

c

2

1 +      1
=      1
     1
1 +      1
mc = (     1
(cid:16)
1      1
(mt
    1
2

c =

mt

1
2

2 )   1(     1
2      1
1 + mt
1      1

1 m1 +      1
2 m2)
(cid:17)
1 +      1
2 )(     1
2 )   1(     1
2      1

1 m1 + mt

2 m2

1 m1 +      1

2 m2)(363)

(364)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 41

tr(bt a   1b)

1
2

(358)

(359)

(360)

(361)

(362)

8.2 moments

8 gaussians

in a trace formulation (assuming   1,   2 are symmetric)
1 (x     m1))
2 (x     m2))
c (x     mc)] + c

tr((x     m1)t      1
tr((x     m2)t      1
tr[(x     mc)t      1

    1
2
    1
2
=     1
2

(365)

(366)

(367)

=      1
     1
mc = (     1

c

c =

1
2

2

1 +      1
(cid:104)
1 +      1
(     1
tr
    1
2

tr(mt

2 )   1(     1
1 m1 +      1

2 m2)
1 +      1

1 m1 +      1
2 m2)t (     1
2      1

1      1

1 m1 + mt

2 m2)

2 )   1(     1

1 m1 +      1

2 m2)

8.1.8 product of gaussian densities
let nx(m,   ) denote a density of x, then

nx(m1,   1)    nx(m2,   2) = ccnx(mc,   c)

(371)

(cid:20)

cc = nm1 (m2, (  1 +   2))

(cid:112)det(2  (  1 +   2))

=

1

mc = (     1
  c = (     1

1 +      1
1 +      1

2 )   1(     1
2 )   1

exp

    1
2
1 m1 +      1

2 m2)

(m1     m2)t (  1 +   2)   1(m1     m2)

(368)
(369)

(cid:105)

(370)

(cid:21)

but note that the product is not normalized as a density of x.

8.2 moments

8.2.1 mean and covariance of linear forms
first and second moments. assume x     n (m,   )

e(x) = m

(372)

cov(x, x) = var(x) =    = e(xxt )     e(x)e(xt ) = e(xxt )     mmt

(373)

as for any other distribution is holds for gaussians that

e[ax] = ae[x]

var[ax] = avar[x]at

cov[ax, by] = acov[x, y]bt

(374)

(375)

(376)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 42

8.2 moments

8 gaussians

8.2.2 mean and variance of square forms
mean and variance of square forms: assume x     n (m,   )

e(xxt ) =    + mmt

e[xt ax] = tr(a  ) + mt am

var(xt ax) = tr[a  (a + at )  ] + ...

e[(x     m(cid:48))t a(x     m(cid:48))] = (m     m(cid:48))t a(m     m(cid:48)) + tr(a  )

+mt (a + at )  (a + at )m

if    =   2i and a is symmetric, then

var(xt ax) = 2  4tr(a2) + 4  2mt a2m
assume x     n (0,   2i) and a and b to be symmetric, then

cov(xt ax, xt bx) = 2  4tr(ab)

(377)

(378)

(379)

(380)

(381)

(382)

8.2.3 cubic forms

assume x to be a stochastic vector with independent coordinates, mean m and
covariance m

e[xbt xxt ] = mbt (m + mmt ) + (m + mmt )bmt

+bt m(m     mmt )

(383)

8.2.4 mean of quartic forms

e[xxt xxt ] = 2(   + mmt )2 + mt m(       mmt )

+tr(  )(   + mmt )

e[xxt axxt ] = (   + mmt )(a + at )(   + mmt )

+mt am(       mmt ) + tr[a  ](   + mmt )

e[xt xxt x] = 2tr(  2) + 4mt   m + (tr(  ) + mt m)2

e[xt axxt bx] = tr[a  (b + bt )  ] + mt (a + at )  (b + bt )m

+(tr(a  ) + mt am)(tr(b  ) + mt bm)

e[at xbt xct xdt x]

= (at (   + mmt )b)(ct (   + mmt )d)

+(at (   + mmt )c)(bt (   + mmt )d)
+(at (   + mmt )d)(bt (   + mmt )c)     2at mbt mct mdt m

e[(ax + a)(bx + b)t (cx + c)(dx + d)t ]

= [a  bt + (am + a)(bm + b)t ][c  dt + (cm + c)(dm + d)t ]

+[a  ct + (am + a)(cm + c)t ][b  dt + (bm + b)(dm + d)t ]
+(bm + b)t (cm + c)[a  dt     (am + a)(dm + d)t ]
+tr(b  ct )[a  dt + (am + a)(dm + d)t ]

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 43

8.3 miscellaneous

8 gaussians

e[(ax + a)t (bx + b)(cx + c)t (dx + d)]

= tr[a  (ct d + dt c)  bt ]

+[(am + a)t b + (bm + b)t a]  [ct (dm + d) + dt (cm + c)]
+[tr(a  bt ) + (am + a)t (bm + b)][tr(c  dt ) + (cm + c)t (dm + d)]

see [7].

8.2.5 moments

e[x] =

cov(x) =

(cid:88)
(cid:88)

k

k

k(cid:48)

8.3 miscellaneous

8.3.1 whitening
assume x     n (m,   ) then

  kmk

(cid:88)

  k  k(cid:48)(  k + mkmt

k     mkmt
k(cid:48))

(384)

(385)

(386)
conversely having z     n (0, i) one can generate data x     n (m,   ) by setting

z =      1/2(x     m)     n (0, i)

x =   1/2z + m     n (m,   )

(387)

note that   1/2 means the matrix which ful   ls   1/2  1/2 =   , and that it exists
and is unique since    is positive de   nite.

8.3.2 the chi-square connection
assume x     n (m,   ) and x to be n dimensional, then
z = (x     m)t      1(x     m)       2

n

(388)

where   2

n denotes the chi square distribution with n degrees of freedom.

8.3.3 id178

id178 of a d-dimensional gaussian

(cid:90)

n (m,   ) lnn (m,   )dx = ln(cid:112)det(2    ) +

h(x) =    

d
2

(389)

8.4 mixture of gaussians

8.4.1 density

the variable x is distributed as a mixture of gaussians if it has the density

k(cid:88)

k=1

1(cid:112)det(2    k)

p(x) =

  k

(cid:20)

(cid:21)
k (x     mk)

exp

    1
2

(x     mk)t      1

(390)

where   k sum to 1 and the   k all are positive de   nite.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 44

8.4 mixture of gaussians

8 gaussians

(391)

(392)

(393)

(394)

(395)

(cid:3)(396)

=

=

     j

    ln p(s)

8.4.2 derivatives

de   ning p(s) =(cid:80)
k   kns(  k,   k) one get
(cid:80)
  jns(  j,   j)
k   kns(  k,   k)
(cid:80)
  jns(  j,   j)
k   kns(  k,   k)
(cid:80)
  jns(  j,   j)
k   kns(  k,   k)
(cid:80)
  jns(  j,   j)
k   kns(  k,   k)
(cid:80)
  jns(  j,   j)
k   kns(  k,   k)
(cid:80)
  jns(  j,   j)
k   kns(  k,   k)

   
     j
1
  j
   
     j

     j
1
2

    ln p(s)

    ln p(s)

     j

     j

=

=

=

=

ln[  jns(  j,   j)]

ln[  jns(  j,   j)]

(cid:2)     1
j (s       j)(cid:3)
(cid:2)        1

   

ln[  jns(  j,   j)]

j +      1

j (s       j)(s       j)t      1

j

but   k and   k needs to be constrained.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 45

9 special matrices

9 special matrices

9.1 block matrices

let aij denote the ijth block of a.

assuming the dimensions of the blocks matches we have

(cid:21)

=

(cid:20) a11b11 + a12b21 a11b12 + a12b22

(cid:21)

a21b11 + a22b21 a21b12 + a22b22

9.1.1 multiplication

(cid:20) a11 a12

(cid:21)(cid:20) b11 b12

a21 a22

b21 b22

9.1.2 the determinant

the determinant can be expressed as by the use of
c1 = a11     a12a   1
c2 = a22     a21a   1

22 a21
11 a12

as

det

(cid:18)(cid:20) a11 a12

a21 a22

(cid:21)(cid:19)

= det(a22)    det(c1) = det(a11)    det(c2)

(397)

(398)

9.1.3 the inverse

the inverse can be expressed as by the use of

c1 = a11     a12a   1
c2 = a22     a21a   1

22 a21
11 a12

(cid:21)   1

(cid:20)

(cid:20) a11 a12
(cid:20) a   1

a21 a22
11 + a   1
   a   1

as

=

   c   1
=
2 a21a   1
11 a12c   1
22 a21c   1

11

1

c   1
2 a21a   1

11

1

   a   1

11 a12c   1
c   1

2

2

   c   1
22 + a   1
a   1

1 a12a   1
22 a21c   1

22

1 a12a   1

22

(cid:21)

9.1.4 block diagonal

for block diagonal matrices we have

(cid:20) a11
(cid:18)(cid:20) a11

0
0 a22
0
0 a22

(cid:21)   1
(cid:21)(cid:19)

det

(cid:21)

(cid:20) (a11)   1

0

0

=

(a22)   1
= det(a11)    det(a22)

(399)

(400)

(cid:21)

(401)

(402)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 46

9.2 discrete fourier transform matrix, the

9 special matrices

9.1.5 schur complement

regard the matrix

(cid:20) a11 a12

a21 a22

(cid:21)

the schur complement of block a11 of the matrix above is the matrix (denoted
c2 in the text above)

a22     a21a   1

11 a12

the schur complement of block a22 of the matrix above is the matrix (denoted
c1 in the text above)

a11     a12a   1

22 a21

using the schur complement, one can rewrite the inverse of a block matrix

(cid:20) a11 a12
(cid:20)

a21 a22

i
   a   1
22 a21

(cid:21)   1

0
i

=

the schur complement is useful when solving linear systems of the form

(cid:21)(cid:20) i    a12a   1

22

(cid:21)

0

i

(cid:21)(cid:20) (a11     a12a   1
(cid:21)(cid:20) x1
(cid:20) a11 a12

0

22 a21)   1

0
a   1

22

(cid:21)

=

(cid:21)

(cid:20) b1

b2

a21 a22

x2

which has the following equation for x1

(a11     a12a   1

22 a21)x1 = b1     a12a   1

22 b2

when the appropriate inverses exists, this can be solved for x1 which can then
be inserted in the equation for x2 to solve for x2.

9.2 discrete fourier transform matrix, the
the dft matrix is an n    n symmetric matrix wn , where the k, nth element
is given by

thus the discrete fourier transform (dft) can be expressed as

(403)

(404)

likewise the inverse discrete fourier transform (idft) can be expressed as

x(n) =

1
n

x(k)w    kn
n .

(405)

the dft of the vector x = [x(0), x(1),       , x(n     1)]t can be written in matrix
form as

x = wn x,

(406)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 47

w kn

n = e

   j2  kn

n

x(k) =

x(n)w kn
n .

n   1(cid:88)

n=0

n   1(cid:88)

k=0

9.3 hermitian matrices and skew-hermitian

9 special matrices

where x = [x(0), x(1),       , x(n     1)]t . the idft is similarly given as

x = w   1

n x.

some properties of wn exist:

w   

n

n =

w   1
wn w   
w   

1
n
n = n i
n = wh
n

if wn = e

   j2  

n , then [23]

w m+n/2

n

=    w m

n

(407)

(408)

(409)

(410)

(411)

notice, the dft matrix is a vandermonde matrix.

the following important relation between the circulant matrix and the dis-

crete fourier transform (dft) exists
tc = w   1

n (i     (wn t))wn ,

where t = [t0, t1,       , tn   1]t is the    rst row of tc.

(412)

9.3 hermitian matrices and skew-hermitian
a matrix a     cm  n is called hermitian if

ah = a

for real valued matrices, hermitian and symmetric matrices are equivalent.

a is hermitian     xh ax     r,
a is hermitian     eig(a)     r

   x     cn  1

(413)

(414)

note that

a = b + ic

where b, c are hermitian, then

b =

a + ah

2

,

c =

a     ah

2i

9.3.1 skew-hermitian

a matrix a is called skew-hermitian if

a =    ah

for real valued matrices, skew-hermitian and skew-symmetric matrices are
equivalent.

a hermitian     ia is skew-hermitian
a skew-hermitian     xh ay =    xh ah y,
a skew-hermitian     eig(a) = i  ,
       r

   x, y

(415)

(416)

(417)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 48

9.4

idempotent matrices

9 special matrices

9.4

idempotent matrices

a matrix a is idempotent if

aa = a

idempotent matrices a and b, have the following properties

an = a,

forn = 1, 2, 3, ...

i     a
ah
i     ah

is idempotent

is idempotent

is idempotent

if ab = ba     ab is idempotent

rank(a) = tr(a)
a(i     a) = 0
(i     a)a = 0
a+ = a

f (si + ta) = (i     a)f (s) + af (s + t)

note that a     i is not necessarily idempotent.

9.4.1 nilpotent

a matrix a is nilpotent if

a nilpotent matrix has the following property:

a2 = 0

(418)

(419)

(420)

(421)

(422)

(423)

(424)

(425)

(426)

(427)

f (si + ta) = if (s) + taf(cid:48)(s)

(428)

9.4.2 unipotent

a matrix a is unipotent if

a unipotent matrix has the following property:

aa = i

f (si + ta) = [(i + a)f (s + t) + (i     a)f (s     t)]/2

(429)

9.5 orthogonal matrices

if a square matrix q is orthogonal, if and only if,

qt q = qqt = i

and then q has the following properties

    its eigenvalues are placed on the unit circle.
    its eigenvectors are unitary, i.e. have length one.
    the inverse of an orthogonal matrix is orthogonal too.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 49

9.6 positive de   nite and semi-de   nite matrices

9 special matrices

basic properties for the orthogonal matrix q

q   1 = qt
q   t = q
qqt = i
qt q = i
det(q) =   1

9.5.1 ortho-sym

a matrix q+ which simultaneously is orthogonal and symmetric is called an
ortho-sym matrix [20]. hereby

qt

+q+ = i

q+ = qt
+

the powers of an ortho-sym matrix are given by the following rule

qk

+ =

1 + (   1)k

i +

2

1 + (   1)k+1
1     cos(k  )

2

q+

q+

2

i +

=

1 + cos(k  )

2

9.5.2 ortho-skew

a matrix which simultaneously is orthogonal and antisymmetric is called an
ortho-skew matrix [20]. hereby

qh    q    = i

q    =    qh   

the powers of an ortho-skew matrix are given by the following rule

qk    =

ik + (   i)k

ik     (   i)k

i     i

q   

= cos(k

)i + sin(k

2
  
2

2
)q   

  
2

9.5.3 decomposition

a square matrix a can always be written as a sum of a symmetric a+ and an
antisymmetric matrix a   

a = a+ + a   

9.6 positive de   nite and semi-de   nite matrices

9.6.1 de   nitions

a matrix a is positive de   nite if and only if

   x (cid:54)= 0
a matrix a is positive semi-de   nite if and only if
   x

xt ax     0,

xt ax > 0,

note that if a is positive de   nite, then a is also positive semi-de   nite.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 50

(430)

(431)

(432)

(433)

(434)

(435)

(436)

(437)

(438)

(439)

(440)

9.6 positive de   nite and semi-de   nite matrices

9 special matrices

9.6.2 eigenvalues

the following holds with respect to the eigenvalues:
    eig( a+ah
a pos. semi-def.     eig( a+ah

a pos. def.

2

2

) > 0
)     0

9.6.3 trace

the following holds with respect to the trace:

a pos. def.

    tr(a) > 0
a pos. semi-def.     tr(a)     0

(441)

(442)

9.6.4 inverse
if a is positive de   nite, then a is invertible and a   1 is also positive de   nite.

9.6.5 diagonal
if a is positive de   nite, then aii > 0,   i

9.6.6 decomposition i
the matrix a is positive semi-de   nite of rank r     there exists a matrix b of
rank r such that a = bbt
the matrix a is positive de   nite     there exists an invertible matrix b such
that a = bbt

9.6.7 decomposition ii
assume a is an n    n positive semi-de   nite, then there exists an n    r matrix
b of rank r such that bt ab = i.

9.6.8 equation with zeros
assume a is positive semi-de   nite, then xt ax = 0     ax = 0

9.6.9 rank of product

assume a is positive de   nite, then rank(babt ) = rank(b)

9.6.10 positive de   nite property
if a is n    n positive de   nite and b is r    n of rank r, then babt is positive
de   nite.

9.6.11 outer product
if x is n    r, where n     r and rank(x) = n, then xxt is positive de   nite.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 51

9.7 singleentry matrix, the

9 special matrices

9.6.12 small pertubations
if a is positive de   nite and b is symmetric, then a    tb is positive de   nite for
su   ciently small t.

9.6.13 hadamard inequality

if a is a positive de   nite or semi-de   nite matrix, then

det(a)    (cid:89)

aii

see [15, pp.477]

i

9.6.14 hadamard product relation

assume that p = aat and q = bbt are semi positive de   nite matrices, it
then holds that

p     q = rrt

where the columns of r are constructed as follows: ri+(j   1)na = ai     bj, for
i = 1, 2, ..., na and j = 1, 2, ..., nb. the result is unpublished, but reported by
pavel sakov and craig bishop.

9.7 singleentry matrix, the

9.7.1 de   nition
the single-entry matrix jij     rn  n is de   ned as the matrix which is zero
everywhere except in the entry (i, j) in which it is 1. in a 4    4 example one
might have

             0

0
0
0

            

0
0
0
0

0
1
0
0

0
0
0
0

j23 =

(443)

the single-entry matrix is very useful when working with derivatives of expres-
sions involving matrices.

9.7.2 swap and zeros
assume a to be n    m and jij to be m    p

ajij =(cid:2) 0 0 . . . ai

. . . 0 (cid:3)

(444)
i.e. an n    p matrix of zeros with the i.th column of a in place of the j.th
column. assume a to be n    m and jij to be p    n

jija =

(445)

                                    

                                    

0
...
0
aj
0
...
0

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 52

9.7 singleentry matrix, the

9 special matrices

i.e. an p    m matrix of zeros with the j.th row of a in the placed of the i.th
row.

9.7.3 rewriting product of elements

akibjl = (aeiet
aikblj = (at eiet
aikbjl = (at eiet
akiblj = (aeiet

j b)kl = (ajijb)kl
j bt )kl = (at jijbt )kl
j b)kl = (at jijb)kl
j bt )kl = (ajijbt )kl

(446)

(447)

(448)

(449)

9.7.4 properties of the singleentry matrix

if i = j

if i (cid:54)= j

jijjij = jij

(jij)t (jij)t = jij

jij(jij)t = jij

(jij)t jij = jij

jijjij = 0

(jij)t (jij)t = 0

jij(jij)t = jii

(jij)t jij = jjj

9.7.5 the singleentry matrix in scalar expressions
assume a is n    m and j is m    n, then

tr(ajij) = tr(jija) = (at )ij
assume a is n    n, j is n    m and b is m    n, then

tr(ajijb) = (at bt )ij
tr(ajjib) = (ba)ij

tr(ajijjijb) = diag(at bt )ij

assume a is n    n, jij is n    m b is m    n, then

xt ajijbx = (at xxt bt )ij

xt ajijjijbx = diag(at xxt bt )ij

9.7.6 structure matrices

the structure matrix is de   ned by

if a has no special structure then

   a
   aij

= sij

sij = jij

if a is symmetric then

sij = jij + jji     jijjij

(450)

(451)

(452)
(453)

(454)

(455)

(456)

(457)

(458)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 53

9.8 symmetric, skew-symmetric/antisymmetric

9 special matrices

9.8 symmetric, skew-symmetric/antisymmetric

9.8.1 symmetric

the matrix a is said to be symmetric if

a = at

(459)

symmetric matrices have many important properties, e.g. that their eigenvalues
are real and eigenvectors orthogonal.

9.8.2 skew-symmetric/antisymmetric

the antisymmetric matrix is also known as the skew symmetric matrix. it has
the following property from which it is de   ned

a =    at

(460)

hereby, it can be seen that the antisymmetric matrices always have a zero
diagonal. the n    n antisymmetric matrices also have the following properties.

det(at ) = det(   a) = (   1)n det(a)
    det(a) = det(   a) = 0,
if n is odd

(461)

(462)

the eigenvalues of an antisymmetric matrix are placed on the imaginary axis
and the eigenvectors are unitary.

9.8.3 decomposition

a square matrix a can always be written as a sum of a symmetric a+ and an
antisymmetric matrix a   

a = a+ + a   

such a decomposition could e.g. be

a =

a + at

2

+

a     at

2

= a+ + a   

9.9 toeplitz matrices

a toeplitz matrix t is a matrix where the elements of each diagonal is the
same. in the n    n square case, it has the following structure:

                  

t =

                   =

                  

t11

t21
...
tn1

t12
. . .
. . .
      

      
. . .
. . .
t21

t1n
...
t12
t11

t0

t   1
...

t   (n   1)

t1
. . .
. . .
      

      
. . .
. . .
t   1

tn   1
...
t1
t0

                  

a toeplitz matrix is persymmetric. if a matrix is persymmetric (or orthosym-
metric), it means that the matrix is symmetric about its northeast-southwest
diagonal (anti-diagonal) [12]. persymmetric matrices is a larger class of matri-
ces, since a persymmetric matrix not necessarily has a toeplitz structure. there

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 54

(463)

(464)

(465)

9.10 transition matrices

9 special matrices

are some special cases of toeplitz matrices. the symmetric toeplitz matrix is
given by:

the circular toeplitz matrix:

the upper triangular toeplitz matrix:

and the lower triangular toeplitz matrix:

                  
                  

                  
                  

                  

                  

      
. . .
. . .
t1

tn   1
...
t1
t0

      
. . .
. . .
tn   1

tn   1
...
t1
t0

t0

t1
...
tn   1

t0

tn   1
...
t1

t1
. . .
. . .
      

t1
. . .
. . .
      

t =

tc =

tu =

t0

0
...
0

t1
. . .
. . .
      

      
. . .
. . .
0

tn   1
...
t1
t0

tl =

t0

t   1
...

t   (n   1)

0
. . .
. . .
      

      
. . .
. . .
t   1

                   ,
                  

0
...
0
t0

(466)

(467)

(468)

(469)

9.9.1 properties of toeplitz matrices

the toeplitz matrix has some computational advantages. the addition of two
toeplitz matrices can be done with o(n)    ops, multiplication of two toeplitz
matrices can be done in o(n ln n)    ops. toeplitz equation systems can be solved
in o(n2)    ops. the inverse of a positive de   nite toeplitz matrix can be found
in o(n2)    ops too. the inverse of a toeplitz matrix is persymmetric. the
product of two lower triangular toeplitz matrices is a toeplitz matrix. more
information on toeplitz matrices and circulant matrices can be found in [13, 7].

9.10 transition matrices

a square matrix p is a transition matrix, also known as stochastic matrix or
id203 matrix, if

(cid:88)

0     (p)ij     1,

(p)ij = 1

the transition matrix usually describes the id203 of moving from state i
to j in one step and is closely related to markov processes. transition matrices

j

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 55

9.11 units, permutation and shift

9 special matrices

have the following properties

(470)

(471)

(472)

(473)

(474)

i   i =

prob[i     j in 1 step] = (p)ij
prob[i     j in 2 steps] = (p2)ij
prob[i     j in k steps] = (pk)ij
if all rows are identical     pn = p

where    is a so-called stationary id203 vector, i.e., 0       i     1 and(cid:80)

   is called invariant

  p =   ,

1.

9.11 units, permutation and shift

9.11.1 unit vector
let ei     rn  1 be the ith unit vector, i.e. the vector which is zero in all entries
except the ith at which it is 1.

9.11.2 rows and columns

i.th row of a = et

i a
j.th column of a = aej

9.11.3 permutations

let p be some permutation matrix, e.g.

       0 1

1 0
0 0

0
0
1

       =(cid:2) e2 e1 e3

(cid:3) =

      

       et

2
et
1
et
3

p =

for permutation matrices it holds that

and that

ppt = i

ap =(cid:2) ae2 ae1 ae3

(cid:3)

       et

2 a
et
1 a
et
3 a

      

pa =

(475)

(476)

(477)

(478)

(479)

that is, the    rst is a matrix which has columns of a but in permuted sequence
and the second is a matrix which has the rows of a but in the permuted se-
quence.

9.11.4 translation, shift or lag operators
let l denote the lag (or    translation    or    shift   ) operator de   ned on a 4    4
example by

             0

1
0
0

l =

            

0
0
1
0

0
0
0
1

0
0
0
0

(480)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 56

9.12 vandermonde matrices

9 special matrices

i.e. a matrix of zeros with one on the sub-diagonal, (l)ij =   i,j+1. with some
signal xt for t = 1, ..., n , the n.th power of the lag operator shifts the indices,
i.e.

(lnx)t =

for
for

t = 1, .., n
t = n + 1, ..., n

a related but slightly di   erent matrix is the    recurrent shifted    operator de   ned
on a 4x4 example by

xt   n

(cid:110) 0
             0

  l =

1
0
0

            

0
0
1
0

0
0
0
1

1
0
0
0

(481)

(482)

i.e. a matrix de   ned by (  l)ij =   i,j+1 +   i,1  j,dim(l). on a signal x it has the
e   ect

(  lnx)t = xt(cid:48),

t(cid:48) = [(t     n) mod n ] + 1

(483)

that is,   l is like the shift operator l except that it    wraps    the signal as if it
was periodic and shifted (substituting the zeros with the rear end of the signal).
note that   l is invertible and orthogonal, i.e.
  l   1 =   lt

(484)

9.12 vandermonde matrices

a vandermonde matrix has the form [15]

                .

(485)

               

v =

1
1
...
1

v1
v2
...
vn

v2
1
v2
2
...
v2
n

      
      

      

2

1

vn   1
vn   1
...
vn   1

n

(cid:89)

det v =

(vi     vj)

the transpose of v is also said to a vandermonde matrix. the determinant is
given by [29]

(486)

i>j

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 57

10 functions and operators

10 functions and operators

10.1 functions and series

10.1.1 finite series

(xn     i)(x     i)   1 = i + x + x2 + ... + xn   1

(487)

10.1.2 taylor expansion of scalar function

consider some scalar function f (x) which takes the vector x as an argument.
this we can taylor expand around x0
f (x)    = f (x0) + g(x0)t (x     x0) +

(x     x0)t h(x0)(x     x0)

(488)

where

g(x0) =

   f (x)

   x

h(x0) =

   2f (x)
   x   xt

10.1.3 matrix functions by in   nite series

(cid:12)(cid:12)(cid:12)x0

as for analytical functions in one dimension, one can de   ne a matrix function
for square matrices x by an in   nite series

(cid:12)(cid:12)(cid:12)x0

1
2

   (cid:88)

(cid:88)

cnxn

n=0

f (x) =

assuming the limit exists and is    nite. if the coe   cients cn ful   ls(cid:80)

n cnxn <    ,
then one can prove that the above series exists and is    nite, see [1]. thus for
any analytical function f (x) there exists a corresponding matrix function f (x)
constructed by the taylor expansion. using this one can prove the following
results:
1) a matrix a is a zero of its own characteristic polynomium [1]:

(489)

p(  ) = det(i       a) =

cn  n

   

p(a) = 0

(490)

2) if a is square it holds that [1]

n

a = ubu   1     f (a) = uf (b)u   1

3) a useful fact when using power series is that

an     0forn        

if

|a| < 1

10.1.4 identity and commutations

it holds for an analytical matrix function f (x) that

(491)

(492)

f (ab)a = af (ba)

(493)

see b.1.2 for a proof.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 58

10.2 kronecker and vec operator

10 functions and operators

10.1.5 exponential matrix function

in analogy to the ordinary scalar exponential function, one can de   ne exponen-
tial and logarithmic matrix functions:

ea    

e   a    

eta    

ln(i + a)    

1
n!

1
n!

an = i + a +

1
2

a2 + ...

(   1)nan = i     a +

a2     ...

1
2

(ta)n = i + ta +

1
2

t2a2 + ...

n=0

   (cid:88)
   (cid:88)
   (cid:88)
   (cid:88)

n=0

n=0

1
n!
(   1)n   1

n

n=1

an = a     1
2

a2 +

a3     ...

1
3

some of the properties of the exponential function are [1]

if

ab = ba

t     r

eaeb = ea+b
(ea)   1 = e   a
d
dt

eta = aeta = etaa,

d
dt

tr(eta) = tr(aeta)

det(ea) = etr(a)

10.1.6 trigonometric functions

sin(a)    

cos(a)    

   (cid:88)
   (cid:88)

n=0

(   1)na2n+1
(2n + 1)!
(   1)na2n

(2n)!

n=0

= a     1
3!

a3 +

a5     ...

1
5!

= i     1
2!

a2 +

a4     ...

1
4!

10.2 kronecker and vec operator

10.2.1 the kronecker product
the kronecker product of an m    n matrix a and an r    q matrix b, is an
mr    nq matrix, a     b de   ned as

a11b a12b ... a1nb
a21b a22b ... a2nb

a     b =

...

               

...

               

am1b am2b ... amnb

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 59

(494)

(495)

(496)

(497)

(498)

(499)

(500)

(501)

(502)

(503)

(504)

(505)

10.2 kronecker and vec operator

10 functions and operators

the kronecker product has the following properties (see [19])

a     (b + c) = a     b + a     c

a     b (cid:54)= b     a

in general

a     (b     c) = (a     b)     c
(  aa       bb) =   a  b(a     b)

(a     b)t = at     bt
(a     b)(c     d) = ac     bd
(a     b)   1 = a   1     b   1
(a     b)+ = a+     b+

rank(a     b) = rank(a)rank(b)

tr(a     b) = tr(a)tr(b) = tr(  a       b)
det(a     b) = det(a)rank(b) det(b)rank(a)
{eig(a     b)} = {eig(b     a)}
{eig(a     b)} = {eig(a)eig(b)t}

if a, b are square

(506)

(507)

(508)

(509)

(510)

(511)

(512)

(513)

(514)

(515)

(516)

(517)

(518)

if a, b are symmetric and square

eig(a     b) = eig(a)     eig(b)

(519)
where {  i} denotes the set of values   i, that is, the values in no particular
order or structure, and   a denotes the diagonal matrix with the eigenvalues of
a.

10.2.2 the vec operator

the vec-operator applied on a matrix a stacks the columns into a vector, i.e.
for a 2    2 matrix

(cid:20) a11 a12

a21 a22

(cid:21)

a =

vec(a) =

             a11

a21
a12
a22

            

properties of the vec-operator include (see [19])

vec(axb) = (bt     a)vec(x)
tr(at b) = vec(a)t vec(b)

vec(a + b) = vec(a) + vec(b)

vec(  a) =       vec(a)

at xbxt c = vec(x)t (b     cat )vec(x)

(520)

(521)

(522)

(523)

(524)

see b.1.1 for a proof for eq. 524.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 60

10.3 vector norms

10 functions and operators

10.3 vector norms

10.3.1 examples

||x||1 =
||x||2

2 = xh x

|xi|

(cid:88)
(cid:34)(cid:88)

i

||x||p =
||x||    = max

i

|xi|p
|xi|

i

(cid:35)1/p

further reading in e.g. [12, p. 52]

10.4 matrix norms

10.4.1 de   nitions

a matrix norm is a mapping which ful   ls

||a||     0
||a|| = 0     a = 0
||ca|| = |c|||a||,

||a + b||     ||a|| + ||b||

c     r

(525)

(526)

(527)

(528)

(529)

(530)

(531)

(532)

10.4.2 induced norm or operator norm

an induced norm is a matrix norm induced by a vector norm by the following

||a|| = sup{||ax||

|

||x|| = 1}

(533)
where ||    || on the left side is the induced matrix norm, while ||    || on the right
side denotes the vector norm. for induced norms it holds that

||i|| = 1

||ax||     ||a||    ||x||,
||ab||     ||a||    ||b||,

for all a, x
for all a, b

10.4.3 examples

||a||1
||a||2
||a||p
||a||   

||a||f

(cid:88)

i

|aij|

= max

(cid:113)

j

=
= ( max
||x||p=1

max eig(ah a)
||ax||p)1/p
|aij|

= max

(cid:88)
(cid:115)(cid:88)

(cid:113)

j

i

|aij|2 =

=

tr(aah )

(frobenius)

(541)

ij

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 61

(534)
(535)
(536)

(537)

(538)
(539)

(540)

10.5 rank

10 functions and operators

||a||max = max
|aij|
||a||kf = ||sing(a)||1

ij

(ky fan)

(542)

(543)

where sing(a) is the vector of singular values of the matrix a.

10.4.4 inequalities

e. h. rasmussen has in yet unpublished material derived and collected the
following inequalities. they are collected in a table as below, assuming a is an
m    n, and d = rank(a)
||a||max

||a||    ||a||2

||a||1

||a||max
||a||1
||a||   
||a||2
||a||f
||a||kf

m
   
n
   
mn
   
mn
mnd

1

   
n
   
n
   
n
nd

1
m
   
   
   

m
m
md

   
1
   
m
n
   

d
d

||a||kf
   
1
   
m
n
1
1

||a||f
   
1
   
m
n
1
   

d

which are to be read as, e.g.

||a||2        

m    ||a||   

(544)

10.4.5 condition number

the 2-norm of a equals(cid:112)(max(eig(at a))) [12, p.57]. for a symmetric, pos-

itive de   nite matrix, this reduces to max(eig(a)) the condition number based
on the 2-norm thus reduces to

(cid:107)a(cid:107)2(cid:107)a   1(cid:107)2 = max(eig(a)) max(eig(a   1)) =

max(eig(a))
min(eig(a))

.

(545)

10.5 rank

10.5.1 sylvester   s inequality
if a is m    n and b is n    r, then

rank(a) + rank(b)     n     rank(ab)     min{rank(a), rank(b)}

(546)

10.6

integral involving dirac delta functions

assuming a to be square, then

(cid:90)

p(s)  (x     as)ds =

1

det(a)

p(a   1x)

(cid:90)

assuming a to be    underdetermined   , i.e.    tall   , then

p(s)  (x     as)ds =

1   
0

det(at a)

p(a+x)

if x = aa+x

elsewhere

(cid:40)

(cid:41)

(547)

(548)

see [9].

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 62

10.7 miscellaneous

10 functions and operators

10.7 miscellaneous

for any a it holds that

rank(a) = rank(at ) = rank(aat ) = rank(at a)

(549)

it holds that

a is positive de   nite        b invertible, such that a = bbt

(550)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 63

a one-dimensional results

a one-dimensional results

a.1 gaussian

a.1.1 density

p(x) =

a.1.2 id172(cid:90)

(cid:18)
    (x       )2

2  2

(cid:19)

1   
2    2

exp

(cid:90)
(cid:90)

    (s     )2

e

2  2 ds =

e   (ax2+bx+c)dx =

ec2x2+c1x+c0dx =

2    2

   

(cid:114)   
(cid:114)   

a

exp

exp

   c2

(cid:20) b2     4ac
(cid:20) c2

(cid:21)
4a
1     4c2c0
   4c2

a.1.3 derivatives

   p(x)

     

    ln p(x)

     
   p(x)

     

    ln p(x)

     

=

1
  

a.1.4 completing the squares

(x       )

= p(x)

  2
(x       )

=

= p(x)

(cid:20) (x       )2
(cid:20) (x       )2

  2
1
  

  2
    1

(cid:21)

    1

(cid:21)

  2

(cid:21)

(551)

(552)

(553)

(554)

(555)

(556)

(557)

(558)

c2x2 + c1x + c0 =    a(x     b)2 + w

   a = c2

b =

1
2

c1
c2

w =

1
4

c2
1
c2

+ c0

c2x2 + c1x + c0 =     1

   =

   c1
2c2

  2 =

   1
2c2

2  2 (x       )2 + d
d = c0     c2
1
4c2

or

a.1.5 moments

if the density is expressed by

p(x) =

1   
2    2

exp

2  2

(cid:20)
    (s       )2

(cid:21)

or p(x) = c exp(c2x2 + c1x)

(559)

then the    rst few basic moments are

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 64

2c2

1
2c2

(cid:17)2
(cid:105)
(cid:16) c1
(cid:104)    1
(cid:105)
(cid:105)2
(cid:104) 1
(cid:20) c2

2c2

2c2

exp

(cid:21)

a.2 one dimensional mixture of gaussiansa one-dimensional results

(cid:104)x(cid:105) =   
=    c1
(cid:104)x2(cid:105) =   2 +   2
=    1
(cid:104)x3(cid:105) = 3  2   +   3
=
(cid:104)x4(cid:105) =   4 + 6  2  2 + 3  4 =

(cid:16) c1

2c2
c1

2c2

(2c2)2

2c2

+

(cid:16)   c1
(cid:104)
(cid:17)4

2c2

+ 6

3     c2

(cid:17)2(cid:16)    1

2c2

(cid:17)

(cid:17)2

(cid:16) 1

2c2

+ 3

and the central moments are

= 0

(cid:104)(x       )(cid:105) = 0
(cid:104)(x       )2(cid:105) =   2
=
(cid:104)(x       )3(cid:105) = 0
= 0
(cid:104)(x       )4(cid:105) = 3  4 = 3

(cid:90)

a kind of pseudo-moments (un-normalized integrals) can easily be derived as

exp(c2x2 + c1x)xndx = z(cid:104)xn(cid:105) =

(cid:104)xn(cid:105)

(560)

1   4c2

(cid:114)   

   c2

  from the un-centralized moments one can derive other entities like

(cid:104)x2(cid:105)     (cid:104)x(cid:105)2
(cid:104)x3(cid:105)     (cid:104)x2(cid:105)(cid:104)x(cid:105) = 2  2  
(cid:104)x4(cid:105)     (cid:104)x2(cid:105)2

=    1
=
= 2  4 + 4  2  2 =

=   2

2c2

2

2c1

(2c2)2

(2c2)2

(cid:104)

1     4 c2

1
2c2

(cid:105)

a.2 one dimensional mixture of gaussians

a.2.1 density and id172

k(cid:88)

  k(cid:112)2    2

k

(cid:20)

    1
2

(s       k)2

  2
k

(cid:21)

p(s) =

exp

k

a.2.2 moments

a useful fact of mog, is that

(cid:88)

k

(cid:104)xn(cid:105) =

  k(cid:104)xn(cid:105)k

where (cid:104)  (cid:105)k denotes average with respect to the k.th component. we can calculate
the    rst four moments from the densities

(cid:20)

(cid:88)
(cid:88)

k

  k

1(cid:112)2    2
  kck exp(cid:2)ck2x2 + ck1x(cid:3)

    1
2

exp

k

  2
k

(x       k)2

(cid:21)

p(x) =

p(x) =

as

k

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 65

(561)

(562)

(563)

(564)

b proofs and details

(cid:17)2(cid:21)
(cid:16)   ck1
(cid:105)(cid:105)
(cid:104)
(cid:17)2(cid:20)(cid:16) ck1
(cid:17)2     6 c2

3     c2

k1
2ck2

2ck2

2ck2

k1
2ck2

(cid:21)(cid:21)

+ 3

if all the gaussians are centered, i.e.   k = 0 for all k, then

k   k

k   k

k   k

k   k

= (cid:80)
= (cid:80)
= (cid:80)
k) = (cid:80)
= (cid:80)
k = (cid:80)
k       k  k(cid:48)(cid:3)

= 0

= 0

k   k

k   k3

+

2ck2

2ck2

2ck2

(cid:105)

(2ck2)2

(cid:104)   ck1
(cid:20)    1
(cid:104) ck1
(cid:20)(cid:16) 1
(cid:105)
(cid:104)    1
(cid:105)2
(cid:104)    1
k)  k(cid:48)(cid:3)

2ck2

2ck2

(cid:104)x(cid:105) = (cid:80)
(cid:104)x2(cid:105) = (cid:80)
(cid:104)x3(cid:105) = (cid:80)
(cid:104)x4(cid:105) = (cid:80)

k   k  k

k   k(  2

k +   2
k)

k   k(3  2

k  k +   3
k)

k   k(  4

k + 6  2

k  2

k + 3  4

k   k  2
k

(cid:104)x(cid:105) = 0

(cid:104)x3(cid:105) = 0

(cid:104)x2(cid:105) = (cid:80)
(cid:104)x4(cid:105) = (cid:80)
= (cid:80)
(cid:104)x3(cid:105)     (cid:104)x2(cid:105)(cid:104)x(cid:105) = (cid:80)
= (cid:80)
de   ning p(s) =(cid:80)

a.2.3 derivatives

k   k3  4

k,k(cid:48)   k  k(cid:48)(cid:2)  2
k,k(cid:48)   k  k(cid:48)(cid:2)3  2
k,k(cid:48)   k  k(cid:48)(cid:2)  4

  from the un-centralized moments one can derive other entities like
(cid:104)x2(cid:105)     (cid:104)x(cid:105)2
(cid:104)x4(cid:105)     (cid:104)x2(cid:105)2

k +   2
k  k +   3
k + 6  2
k  2

k     (  2
k + 3  4

k +   2
k     (  2

k +   2

k)(  2

k(cid:48))(cid:3)

k(cid:48) +   2

    ln p(s)

     j

=

     j

(565)

    ln(  jns(  j,   2
j ))

k   kns(  k,   2
k) we get for a parameter   j of the j.th compo-
(cid:80)
  jns(  j,   2
j )
k   kns(  k,   2
k)
(cid:80)
  jns(  j,   2
j )
k   kns(  k,   2
(cid:80)
k)
  jns(  j,   2
j )
k   kns(  k,   2
k)
(cid:80)
  jns(  j,   2
j )
k   kns(  k,   2
k)

  2
j
(s       j)2

1
  j
(s       j)

    1

(566)

(567)

(568)

1
  j

(cid:34)

(cid:35)

  2
j

=

=

=

     j

     j

     j

    ln p(s)

    ln p(s)

    ln p(s)

nent

that is,

note that   k must be constrained to be proper ratios. de   ning the ratios by

  j = erj /(cid:80)

k erk , we obtain
    ln p(s)

(cid:88)

=

   rj

    ln p(s)

     l

l

     l
   rj

where

=   l(  lj       j)

     l
   rj

(569)

b proofs and details

b.1 misc proofs

b.1.1 proof of equation 524

the following proof is work of florian roemer. note the the vectors and ma-
trices below can be complex and the notation xh is used for transpose and
conjugated, while xt is only transpose of the complex matrix.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 66

b.1 misc proofs

b proofs and details

de   ne the row vector y = ah xb and the column vector z = xh c. then

at xbxt c = yz = zt yt

note that y can be rewritten as vec(y)t which is the same as

vec(conj(y))h = vec(at conj(x)conj(b))h

where    conj    means complex conjugated. applying the vec rule for linear forms
eq 520, we get

y = (bh     at vec(conj(x))h = vec(x)t (b     conj(a))

where we have also used the rule for transpose of kronecker products. for yt
this yields (bt     ah )vec(x). similarly we can rewrite z which is the same as
vec(zt ) = vec(ct conj(x)). applying again eq 520, we get

z = (i     ct )vec(conj(x))

where i is the identity matrix. for zt we obtain vec(x)(i     c). finally, the
original expression is zt yt which now takes the form

vec(x)h (i     c)(bt     ah )vec(x)

the    nal step is to apply the rule for products of kronecker products and by
that combine the kronecker products. this gives

vec(x)h (bt     cah )vec(x)

which is the desired result.

b.1.2 proof of equation 493

for any analytical function f (x) of a matrix argument x, it holds that

f (ab)a =

=

=

(cid:33)

cn(ab)n

a

cn(ab)na

cna(ba)n

n=0

(cid:32)    (cid:88)
   (cid:88)
   (cid:88)
   (cid:88)

n=0

n=0

= a

cn(ba)n

n=0

= af (ba)

b.1.3 proof of equation 91

essentially we need to calculate

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 67

b.1 misc proofs

b proofs and details

   (xn)kl

   xij

=

   

   xij

(cid:88)

u1,...,un   1

xk,u1 xu1,u2 ...xun   1,l

=   k,i  u1,jxu1,u2 ...xun   1,l

+xk,u1  u1,i  u2,j...xun   1,l

...

n   1(cid:88)
n   1(cid:88)

r=0

=

=

+xk,u1xu1,u2...  un   1,i  l,j
(xr)ki(xn   1   r)jl

(xrjijxn   1   r)kl

using the properties of the single entry matrix found in sec. 9.7.4, the result
follows easily.

r=0

b.1.4 details on eq. 571
    det(xh ax) = det(xh ax)tr[(xh ax)   1   (xh ax)]

= det(xh ax)tr[(xh ax)   1(   (xh )ax + xh    (ax))]

+tr[(xh ax)   1xh    (ax)](cid:1)
+tr[(xh ax)   1xh a   (x)](cid:1)

= det(xh ax)(cid:0)tr[(xh ax)   1   (xh )ax]
= det(xh ax)(cid:0)tr[ax(xh ax)   1   (xh )]
(cid:16) tr[ax(xh ax)   1   (xh )]

= det(xh ax)

   (cid:60)x

first, the derivative is found with respect to the real part of x

(cid:17)

(cid:17)

    det(xh ax)

   (cid:60)x

tr[(xh ax)   1xh a   (x)]

= det(xh ax)(cid:0)ax(xh ax)   1 + ((xh ax)   1xh a)t(cid:1)

   (cid:60)x

+

through the calculations, (100) and (240) were used.
(241), the derivative is found with respect to the imaginary part of x

in addition, by use of

(cid:16) tr[ax(xh ax)   1   (xh )]

    det(xh ax)

   (cid:61)x

i

= i det(xh ax)

   (cid:61)x
tr[(xh ax)   1xh a   (x)]

= det(xh ax)(cid:0)ax(xh ax)   1     ((xh ax)   1xh a)t(cid:1)

   (cid:61)x

+

hence, derivative yields

    det(xh ax)

   x

(cid:16)     det(xh ax)

=

1
2

= det(xh ax)(cid:0)(xh ax)   1xh a(cid:1)t

   (cid:60)x

   (cid:61)x

    det(xh ax)

    i

(cid:17)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 68

b.1 misc proofs

b proofs and details

and the complex conjugate derivative yields

(cid:16)     det(xh ax)

    det(xh ax)

   x   

=
= det(xh ax)ax(xh ax)   1

   (cid:60)x

+ i

   (cid:61)x

    det(xh ax)

notice, for real x, a, the sum of (249) and (250) is reduced to (54).
similar calculations yield

    det(xaxh )

   x

    det(xaxh )

   x   

and

(cid:16)     det(xaxh )

=

1
2

= det(xaxh )(cid:0)axh (xaxh )   1(cid:1)t

   (cid:60)x

   (cid:61)x

    det(xaxh )

    i

(cid:16)     det(xaxh )

=
= det(xaxh )(xaxh )   1xa

   (cid:60)x

+ i

   (cid:61)x

    det(xaxh )

(cid:17)

(570)

(571)

1
2

1
2

(cid:17)

(cid:17)

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 69

references

references

references

[1] karl gustav andersson and lars-christer boiers. ordinaera di   erentialek-

vationer. studenterlitteratur, 1992.

[2] j  orn anem  uller, terrence j. sejnowski, and scott makeig. complex inde-
pendent component analysis of frequency-domain electroencephalographic
data. neural networks, 16(9):1311   1323, november 2003.

[3] s. barnet. matrices. methods and applications. oxford applied mathe-

matics and computin science series. clarendon press, 1990.

[4] christopher bishop. neural networks for pattern recognition. oxford

university press, 1995.

[5] robert j. boik. lecture notes: statistics 550. online, april 22 2002. notes.

[6] d. h. brandwood. a complex gradient operator and its application in
adaptive array theory. iee proceedings, 130(1):11   16, february 1983. pts.
f and h.

[7] m. brookes. matrix reference manual, 2004. website may 20, 2004.

[8] contradsen k., en introduktion til statistik, imm lecture notes, 1984.

[9] mads dyrholm. some matrix results, 2004. website august 23, 2004.

[10] nielsen f. a., formula, neuro research unit and technical university of

denmark, 2002.

[11] gelman a. b., j. s. carlin, h. s. stern, d. b. rubin, bayesian data

analysis, chapman and hall / crc, 1995.

[12] gene h. golub and charles f. van loan. matrix computations. the johns

hopkins university press, baltimore, 3rd edition, 1996.

[13] robert m. gray. toeplitz and circulant matrices: a review. technical
report, information systems laboratory, department of electrical engi-
neering,stanford university, stanford, california 94305, august 2002.

[14] simon haykin. adaptive filter theory. prentice hall, upper saddle river,

nj, 4th edition, 2002.

[15] roger a. horn and charles r. johnson. matrix analysis. cambridge

university press, 1985.

[16] mardia k. v., j.t. kent and j.m. bibby, multivariate analysis, academic

press ltd., 1979.

[17] mathpages on    eigenvalue problems and matrix invariants   ,

http://www.mathpages.com/home/kmath128.htm

[18] carl d. meyer. generalized inversion of modi   ed matrices. siam journal

of applied mathematics, 24(3):315   323, may 1973.

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 70

references

references

[19] thomas p. minka. old and new matrix algebra useful for statistics, de-

cember 2000. notes.

[20] daniele mortari ortho   skew and ortho   sym matrix trigonometry john
lee junkins astrodynamics symposium, aas 03   265, may 2003. texas
a&m university, college station, tx

[21] l. parra and c. spence. convolutive blind separation of non-stationary
sources. in ieee transactions speech and audio processing, pages 320   
327, may 2000.

[22] kaare brandt petersen, jiucang hao, and te-won lee. generative and
   ltering approaches for overcomplete representations. neural information
processing - letters and reviews, vol. 8(1), 2005.

[23] john g. proakis and dimitris g. manolakis. digital signal processing.

prentice-hall, 1996.

[24] laurent schwartz. cours d   analyse, volume ii. hermann, paris, 1967. as

referenced in [14].

[25] shayle r. searle. matrix algebra useful for statistics. john wiley and

sons, 1982.

[26] g. seber and a. lee. id75 analysis. john wiley and sons,

2002.

[27] s. m. selby. standard mathematical tables. crc press, 1974.

[28] inna stainvas. matrix algebra in di   erential calculus. neural computing
research group, information engeneering, aston university, uk, august
2002. notes.

[29] p. p. vaidyanathan. multirate systems and filter banks. prentice hall,

1993.

[30] max welling. the kalman filter. lecture note.

[31] wikipedia on minors:    minor (id202)   ,

http://en.wikipedia.org/wiki/minor_(linear_algebra)

[32] zhaoshui he, shengli xie, et al,    convolutive blind source separation in
frequency domain based on sparse representation   , ieee transactions on
audio, speech and language processing, vol.15(5):1551-1563, july 2007.

[33] karim t. abou-moustafa on derivatives of eigenvalues and eigenvectors
of the generalized eigenvalue problem. mcgill technical report, october
2010.

[34] mohammad emtiyaz khan updating inverse of a matrix when a column

is added/removed. emt cs,ubc february 27, 2008

petersen & pedersen, the matrix cookbook, version: november 15, 2012, page 71

normal-inverse gamma distribution, 37
normal-inverse wishart distribution, 39

orthogonal, 49

power series of matrices, 58
id203 matrix, 55
pseudo-inverse, 21

schur complement, 41, 47
single entry matrix, 52
singular valued decomposition (svd),

31

skew-hermitian, 48
skew-symmetric, 54
stochastic matrix, 55
student-t, 37
sylvester   s inequality, 62
symmetric, 54

taylor expansion, 58
toeplitz matrix, 54
transition matrix, 55
trigonometric functions, 59

unipotent, 49

vandermonde matrix, 57
vec operator, 59, 60

wishart distribution, 38
woodbury identity, 18

index

anti-symmetric, 54

block matrix, 46

chain rule, 15
cholesky-decomposition, 32
co-kurtosis, 34
co-skewness, 34
condition number, 62
cramers rule, 29

derivative of a complex matrix, 24
derivative of a determinant, 8
derivative of a trace, 12
derivative of an inverse, 9
derivative of symmetric matrix, 15
derivatives of toeplitz matrix, 16
dirichlet distribution, 37

eigenvalues, 30
eigenvectors, 30
exponential matrix function, 59

gaussian, conditional, 40
gaussian, id178, 44
gaussian, linear combination, 41
gaussian, marginal, 40
gaussian, product of densities, 42
generalized inverse, 21

hadamard inequality, 52
hermitian, 48

idempotent, 49

kronecker product, 59

ldl decomposition, 33
ldm-decomposition, 33
id75, 28
lu decomposition, 32
lyapunov equation, 30

moore-penrose inverse, 21
multinomial distribution, 37

nilpotent, 49
norm of a matrix, 61
norm of a vector, 61

72

