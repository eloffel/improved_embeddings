   #[1]the clever machine    feed [2]the clever machine    comments feed
   [3]the clever machine    sampling from the normal distribution using the
   box-muller transform comments feed [4]rejection sampling [5]monte carlo
   approximations [6]alternate [7]alternate [8]the clever machine
   [9]wordpress.com

     * [10]skip to navigation
     * [11]skip to main content
     * [12]skip to primary sidebar
     * [13]skip to secondary sidebar
     * [14]skip to footer

   [15]

the clever machine

topics in computational neuroscience & machine learning

     * [16]home
     * [17]about the author
     * [18]about the clever machine
     * [19]blog interface

   [20]    rejection sampling
   [21]monte carlo approximations    

sampling from the normal distribution using the box-muller transform

   [22]sep 11

   posted by [23]dustinstansbury

   the normal distribution is the workhorse of many common statistical
   analyses and being able to draw samples from this distribution lies at
   the heart of many statistical/machine learning algorithms. there have
   been a number of methods developed to sample from the normal
   distribution including [24]inverse transform sampling, the[25] ziggurat
   algorithm, and the ratio method (a rejection sampling technique). in
   this post we will focus on an elegant method called the box-muller
   transform.

a quick review of cartesian and polar coordinates.

   before we can talk about using the box-muller transform, let   s refresh
   our understanding of the relationship between cartesian and polar
   coordinates. you may remember from geometry that if x and y are two
   points in the cartesian plane they can be represented in polar
   coordinates with a radius r and an angle \theta using the following
   relationships:

   r^2 = x^2 + y^2

   \tan(\theta) = \frac{y}{x} , and therefore

   x = r\cos(\theta)

   y = r\sin(\theta)

   notice that if r \leq 1 and \theta \in [0 , 2\pi] , then we map out
   values contained in the unit circle, as shown in the figure below. also
   note that random variables in such a circle can be generated by
   transforming values sampled from the uniform distribution.
   specifically, radii can be sampled from r \sim unif(0,1) and angle can
   be sampled from \theta \sim 2\pi \times unif(0,1) . a similar mechanism
   (i.e. drawing points in a circle using uniform variables) is at the
   heart of the box-muller transform for sampling normal random variables.

   example of the relationship between cartesian and polar coordinates

drawing normally-distributed samples with the box-muller transform

   ok, now that we   ve discussed how cartesian coordinates are represented
   in polar coordinates, let   s move on to how we can use this relationship
   to generate random variables. box-muller sampling is based on
   representing the joint distribution of two independent standard normal
   random cartesian variables x and y

   x \sim n(0,1)

   y \sim n(0,1)

   in polar coordinates. the joint distribution p(x,y) (which is
   circular-symmetric) is:

   p(x,y) = p(x)p(y) =
   \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\frac{1}{\sqrt{2\pi}}e^{-\frac{y
   ^2}{2}}

   = \frac{1}{2\pi}e^{-\frac{x^2 + y^2}{2}}

   if we notice that the x^2 + y^2 term in the numerator of the exponent
   is equal to r^2 (as above) we can make the connection between the the
   cartesian representation of the joint normal distribution and its polar
   representation:

   p(x,y) = \left ( \frac{1}{2\pi} \right ) \left ( e^{\frac{-r^2}{2}}
   \right )

   which is the product of two density functions, an exponential
   distribution over squared radii:

   r^2 \sim exp(\frac{1}{2})

   and a uniform distribution over angles:

   \theta \sim unif(0,2\pi)

   just like those mentioned above when generating points on the unit
   circle. now, if we make another [26]connection between the exponential
   distribution and the uniform distribution, namely that:

   exp(\lambda) = \frac{-\log (unif(0,1))}{\lambda}

   then r \sim \sqrt{-2\log (unif(0,1))}

   this gives us a way to generate points from the joint gaussian
   distribution by sampling from two independent uniform distributions,
   one for r and another for \theta , and transforming them into cartesian
   coordinates via the relationships above. in detail, the procedure goes
   as follows:
    1. draw, u_1,u_2 \sim unif(0,1)
    2. transform the variables into radius and angle representation r =
       \sqrt{-2\log(u_1)} , and \theta = 2\pi u_2
    3. transform radius and angle into cartesian coordinates: x = r
       \cos(\theta), y = r \sin(\theta)

   what results are two independent normal random variables, x and y . a
   matlab implementation of the box-muller algorithm is shown below:
% normal samples using box-mueller method
% draw samples from proposal distribution
u = rand(2,100000);
r = sqrt(-2*log(u(1,:)));
theta = 2*pi*u(2,:);
x = r.*cos(theta);
y = r.*sin(theta);

% display box-muller samples
figure
% x samples
subplot(121);
hist(x,100);
colormap hot;axis square
title(sprintf('box-muller samples y\n mean = %1.2f\n variance = %1.2f\n kurtosis
 = %1.2f',mean(x),var(x),3-kurtosis(x)))
xlim([-6 6])

% y samples
subplot(122);
hist(y,100);
colormap hot;axis square
title(sprintf('box-muller samples x\n mean = %1.2f\n variance = %1.2f\n kurtosis
 = %1.2f',mean(y),var(y),3-kurtosis(y)))
xlim([-6 6])

   box-muller samples for normal distribution

wrapping up

   the output of the matlab code is shown above. notice the first, second,
   and fourth central moments (mean, variance, and kurtosis)  of the
   generated samples are consistent with the standard normal. the
   box-muller transform is another example of of how uniform variables on
   the interval (0,1) and can be  transformed in order to sample from a
   more complicated distribution.
   advertisements

share this:

     * [27]twitter
     * [28]facebook
     *

like this:

   like loading...

related

about dustinstansbury

   i recently received my phd from uc berkeley where i studied
   computational neuroscience and machine learning.
   [29]view all posts by dustinstansbury   

   posted on september 11, 2012, in [30]sampling methods, [31]simulations,
   [32]statistics and tagged [33]box-muller transform, [34]normal
   distribution, [35]polar coordinates. bookmark the [36]permalink. [37]6
   comments.
   [38]    rejection sampling
   [39]monte carlo approximations    
     * [40]leave a comment
     * [41]trackbacks 1
     * [42]comments 5

    1. nirmal | [43]november 8, 2013 at 1:00 am
       thanks! great article!     
       [44]reply
    2. [45]matthew davis | [46]april 5, 2014 at 11:21 am
       thank you. very clear and concise.
       just one typo i noticed: p(x,y) = p(x)p(y) =
       \frac{1}{2\pi}e^{-\frac{x^2}{2}}\frac{1}{2\pi}e^{-\frac{y^2}{2}}
       should be p(x,y) = p(x)p(y) =
       \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}\frac{1}{\sqrt{2\pi}}e^{-\fr
       ac{y^2}{2}}
       the normal distributions should have radicals over the 2pi terms.
       [47]reply
          + [48]dustinstansbury | [49]september 19, 2014 at 4:16 pm
            thanks for the typo detection matthew! the marginals
            id203 definitions have been corrected.
            [50]reply
    3. [51]selvaraj p | [52]december 31, 2014 at 10:41 pm
       thanks. this helps me understand better.
       [53]reply
    4. sheetal pawar | [54]march 2, 2016 at 8:36 pm
       thanks. very easy to understand..
       [55]reply

    1. pingback: [56]how to generate gaussian distributed numbers - alan
       zucconi

leave a reply [57]cancel reply

   enter your comment here...

   ____________________________________________________________
   ____________________________________________________________
   ____________________________________________________________
   ____________________________________________________________

   fill in your details below or click an icon to log in:
     *
     *
     *

       iframe: [58]googleplus-sign-in

     *
     *

   [59]gravatar
   email (required) (address never made public)
   ____________________
   name (required)
   ____________________
   website
   ____________________
   wordpress.com logo

   you are commenting using your wordpress.com account. ( [60]log out /
   [61]change )
   google photo

   you are commenting using your google account. ( [62]log out /
   [63]change )
   twitter picture

   you are commenting using your twitter account. ( [64]log out /
   [65]change )
   facebook photo

   you are commenting using your facebook account. ( [66]log out /
   [67]change )
   [68]cancel

   connecting to %s

   [ ] notify me of new comments via email.

   post comment

     * search for: ____________________ go
     * follow theclevermachine
       to receive update notifications, enter your email here
       ____________________
       (button) follow
     * categories
       [69]algorithms [70]classification [71]id174
       [72]density estimation [73]derivations [74]id171
       [75]fmri [76]id119 [77]latex [78]machine learning
       [79]matlab [80]maximum likelihood [81]mcmc [82]neural networks
       [83]neuroscience [84]optimization [85]proofs [86]regression
       [87]sampling [88]sampling methods [89]simulations [90]statistics
       [91]theory [92]tips & tricks [93]uncategorized
     * recent posts
          + [94]derivation: maximum likelihood for id82s
          + [95]a gentle introduction to id158s
          + [96]derivation: derivatives for common neural network
            id180
          + [97]derivation: error id26 & id119 for
            neural networks
          + [98]model selection: underfitting, overfitting, and the
            id160
          + [99]supplemental proof 1
          + [100]the statistical whitening transform
          + [101]covariance matrices and data distributions
          + [102]fmri in neuroscience: efficiency of event-related
            experiment designs
          + [103]derivation: the covariance matrix of an ols estimator
            (and applications to gls)
     * archives
          + [104]september 2014
          + [105]april 2013
          + [106]march 2013
          + [107]january 2013
          + [108]december 2012
          + [109]november 2012
          + [110]october 2012
          + [111]september 2012
          + [112]march 2012
          + [113]february 2012
          + [114]january 2012
     * meta
          + [115]register
          + [116]log in
          + [117]entries rss
          + [118]comments rss
          + [119]wordpress.com
       advertisements

   [120]create a free website or blog at wordpress.com.


   ____________________________________________________________
   ____________________________________________________________
   ____________________________________________________________
   ____________________________________________________________
   post to
   [121]cancel reblog post

   close and accept privacy & cookies: this site uses cookies. by
   continuing to use this website, you agree to their use.
   to find out more, including how to control cookies, see here:
   [122]cookie policy

   iframe: [123]likes-master

   %d bloggers like this:

references

   visible links
   1. https://theclevermachine.wordpress.com/feed/
   2. https://theclevermachine.wordpress.com/comments/feed/
   3. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/feed/
   4. https://theclevermachine.wordpress.com/2012/09/10/rejection-sampling/
   5. https://theclevermachine.wordpress.com/2012/09/22/monte-carlo-approximations/
   6. https://public-api.wordpress.com/oembed/?format=json&url=https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/&for=wpcom-auto-discovery
   7. https://public-api.wordpress.com/oembed/?format=xml&url=https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/&for=wpcom-auto-discovery
   8. https://theclevermachine.wordpress.com/osd.xml
   9. https://s1.wp.com/opensearch.xml
  10. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#access
  11. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#main
  12. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#sidebar
  13. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#sidebar2
  14. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#footer
  15. https://theclevermachine.wordpress.com/
  16. https://theclevermachine.wordpress.com/
  17. https://theclevermachine.wordpress.com/about-me/
  18. https://theclevermachine.wordpress.com/about-theclevermachine/
  19. https://theclevermachine.wordpress.com/interact/
  20. https://theclevermachine.wordpress.com/2012/09/10/rejection-sampling/
  21. https://theclevermachine.wordpress.com/2012/09/22/monte-carlo-approximations/
  22. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
  23. https://theclevermachine.wordpress.com/author/dustinstansbury/
  24. https://theclevermachine.wordpress.com/2012/09/09/inverse-transform-sampling/
  25. http://en.wikipedia.org/wiki/ziggurat_algorithm
  26. http://en.wikipedia.org/wiki/exponential_distribution
  27. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?share=twitter
  28. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?share=facebook
  29. https://theclevermachine.wordpress.com/author/dustinstansbury/
  30. https://theclevermachine.wordpress.com/category/sampling-methods/
  31. https://theclevermachine.wordpress.com/category/simulations/
  32. https://theclevermachine.wordpress.com/category/statistics/
  33. https://theclevermachine.wordpress.com/tag/box-muller-transform/
  34. https://theclevermachine.wordpress.com/tag/normal-distribution/
  35. https://theclevermachine.wordpress.com/tag/polar-coordinates/
  36. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
  37. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comments
  38. https://theclevermachine.wordpress.com/2012/09/10/rejection-sampling/
  39. https://theclevermachine.wordpress.com/2012/09/22/monte-carlo-approximations/
  40. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#respond
  41. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#trackbacks
  42. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comments
  43. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-99
  44. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?replytocom=99#respond
  45. https://plus.google.com/116582885383978989891
  46. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-135
  47. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?replytocom=135#respond
  48. http://machinelearnings.wordpress.com/
  49. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-197
  50. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?replytocom=197#respond
  51. https://plus.google.com/110687322569299871663
  52. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-255
  53. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?replytocom=255#respond
  54. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-599
  55. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/?replytocom=599#respond
  56. http://www.alanzucconi.com/2015/09/16/how-to-sample-from-a-gaussian-distribution/
  57. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#respond
  58. https://public-api.wordpress.com/connect/?googleplus-sign-in=https://theclevermachine.wordpress.com&color_scheme=light
  59. https://gravatar.com/site/signup/
  60. javascript:highlandercomments.doexternallogout( 'wordpress' );
  61. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
  62. javascript:highlandercomments.doexternallogout( 'googleplus' );
  63. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
  64. javascript:highlandercomments.doexternallogout( 'twitter' );
  65. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
  66. javascript:highlandercomments.doexternallogout( 'facebook' );
  67. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
  68. javascript:highlandercomments.cancelexternalwindow();
  69. https://theclevermachine.wordpress.com/category/algorithms/
  70. https://theclevermachine.wordpress.com/category/algorithms/classification/
  71. https://theclevermachine.wordpress.com/category/data-preprocessing/
  72. https://theclevermachine.wordpress.com/category/algorithms/density-estimation/
  73. https://theclevermachine.wordpress.com/category/derivations/
  74. https://theclevermachine.wordpress.com/category/algorithms/feature-learning/
  75. https://theclevermachine.wordpress.com/category/fmri/
  76. https://theclevermachine.wordpress.com/category/algorithms/gradient-descent/
  77. https://theclevermachine.wordpress.com/category/tips-tricks/latex/
  78. https://theclevermachine.wordpress.com/category/algorithms/machine-learning/
  79. https://theclevermachine.wordpress.com/category/tips-tricks/matlab/
  80. https://theclevermachine.wordpress.com/category/maximum-likelihood/
  81. https://theclevermachine.wordpress.com/category/mcmc/
  82. https://theclevermachine.wordpress.com/category/neural-networks/
  83. https://theclevermachine.wordpress.com/category/neuroscience/
  84. https://theclevermachine.wordpress.com/category/optimization/
  85. https://theclevermachine.wordpress.com/category/proofs/
  86. https://theclevermachine.wordpress.com/category/algorithms/regression/
  87. https://theclevermachine.wordpress.com/category/algorithms/sampling/
  88. https://theclevermachine.wordpress.com/category/sampling-methods/
  89. https://theclevermachine.wordpress.com/category/simulations/
  90. https://theclevermachine.wordpress.com/category/statistics/
  91. https://theclevermachine.wordpress.com/category/theory/
  92. https://theclevermachine.wordpress.com/category/tips-tricks/
  93. https://theclevermachine.wordpress.com/category/uncategorized/
  94. https://theclevermachine.wordpress.com/2014/09/23/derivation-maximum-likelihood-for-boltzmann-machines/
  95. https://theclevermachine.wordpress.com/2014/09/11/a-gentle-introduction-to-artificial-neural-networks/
  96. https://theclevermachine.wordpress.com/2014/09/08/derivation-derivatives-for-common-neural-network-activation-functions/
  97. https://theclevermachine.wordpress.com/2014/09/06/derivation-error-id26-gradient-descent-for-neural-networks/
  98. https://theclevermachine.wordpress.com/2013/04/21/model-selection-underfitting-overfitting-and-the-bias-variance-tradeoff/
  99. https://theclevermachine.wordpress.com/2013/04/21/supplemental-proof-1/
 100. https://theclevermachine.wordpress.com/2013/03/30/the-statistical-whitening-transform/
 101. https://theclevermachine.wordpress.com/2013/03/29/covariance-matrices-and-data-distributions/
 102. https://theclevermachine.wordpress.com/2013/01/14/fmri-in-neuroscience-efficiency-of-event-related-experiment-designs/
 103. https://theclevermachine.wordpress.com/2013/01/14/derivation-the-covariance-matrix-of-an-ols-estimator-and-applications-to-gls/
 104. https://theclevermachine.wordpress.com/2014/09/
 105. https://theclevermachine.wordpress.com/2013/04/
 106. https://theclevermachine.wordpress.com/2013/03/
 107. https://theclevermachine.wordpress.com/2013/01/
 108. https://theclevermachine.wordpress.com/2012/12/
 109. https://theclevermachine.wordpress.com/2012/11/
 110. https://theclevermachine.wordpress.com/2012/10/
 111. https://theclevermachine.wordpress.com/2012/09/
 112. https://theclevermachine.wordpress.com/2012/03/
 113. https://theclevermachine.wordpress.com/2012/02/
 114. https://theclevermachine.wordpress.com/2012/01/
 115. https://wordpress.com/start?ref=wplogin
 116. https://theclevermachine.wordpress.com/wp-login.php
 117. https://theclevermachine.wordpress.com/feed/
 118. https://theclevermachine.wordpress.com/comments/feed/
 119. https://wordpress.com/
 120. https://wordpress.com/?ref=footer_website
 121. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/
 122. https://automattic.com/cookies
 123. https://widgets.wp.com/likes/master.html?ver=20190321#ver=20190321

   hidden links:
 125. https://theclevermachine.files.wordpress.com/2012/09/cartesiantopolar.png
 126. https://theclevermachine.files.wordpress.com/2012/09/boxmullersamples.png
 127. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-form-guest
 128. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-form-load-service:wordpress.com
 129. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-form-load-service:twitter
 130. https://theclevermachine.wordpress.com/2012/09/11/sampling-from-the-normal-distribution-using-the-box-muller-transform/#comment-form-load-service:facebook
