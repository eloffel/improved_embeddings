sequence alignment

gerhard j  ger

esslli 2016

gerhard j  ger

sequence alignment

esslli 2016

1 / 62

sequence alignment: motivation

sequence alignment: motivation

gerhard j  ger

sequence alignment

esslli 2016

2 / 62

sequence alignment: motivation

motivation

suppose we have no information except
word lists
goals:

estimate distances between languages
estimate cognate classes
track individual sound changes

example
meaning
few
rub
dull
hunt
year
this
   sh
rotten
right
when
drink
heavy
heavy
egg
earth
dust
laugh
grass
sharp
wash

italian
   p  ko
fre   gare
ot   tuzo
kat   t  are
   anno
   kwesto
   pe    e
   mart  o
   d  usto
   kwando
   bere
pe   sante
   gr  ve
   w  vo
   t  rra
   polvere
   ridere
     rba
ta         nte
la   vare

english cognate
fju:
r  b
d  l
h  nt
j    
    s
f    
   r  t  n
ra  t
w  n
dr    k
   h  v  
   h  v  
  g
  :  
d  st
l  :f
gr  :s
    :p
w    

1
0
0
0
0
0
1
0
0
1
0
0
0
1
0
0
0
0
0
0

gerhard j  ger

sequence alignment

esslli 2016

3 / 62

sequence alignment: motivation

motivation

suppose we have no information except
word lists
goals:

estimate distances between languages
estimate cognate classes
track individual sound changes

example
meaning
few
rub
dull
hunt
year
this
   sh
rotten
right
when
drink
heavy
heavy
egg
earth
dust
laugh
grass
sharp
wash

italian
   p  ko
fre   gare
ot   tuzo
kat   t  are
   anno
   kwesto
   pe    e
   mart  o
   d  usto
   kwando
   bere
pe   sante
   gr  ve
   w  vo
   t  rra
   polvere
   ridere
     rba
ta         nte
la   vare

english cognate
fju:
r  b
d  l
h  nt
j    
    s
f    
   r  t  n
ra  t
w  n
dr    k
   h  v  
   h  v  
  g
  :  
d  st
l  :f
gr  :s
    :p
w    

gerhard j  ger

sequence alignment

esslli 2016

3 / 62

sequence alignment: motivation

preprocessing

ipa is open-ended     107
letters, 52 diacritics, 4 prosodic
marks     200,000 combinations
good practice: map ipa strings
to a uniform representation with
fewer symbols
common choices:

10 dolgopolsky sound classes
(dolgopolsky 1986; used i.a.
in list 2014)
41 asjp sound classes

this course: asjp

gerhard j  ger

sequence alignment

esslli 2016

4 / 62

sequence alignment: motivation

preprocessing

ipa is open-ended     107
letters, 52 diacritics, 4 prosodic
marks     200,000 combinations
good practice: map ipa strings
to a uniform representation with
fewer symbols
common choices:

10 dolgopolsky sound classes
(dolgopolsky 1986; used i.a.
in list 2014)
41 asjp sound classes

this course: asjp

meaning
few
rub
dull
hunt
year
this
   sh
rotten
right
when
drink
heavy
heavy
egg
earth
dust
laugh
grass
sharp
wash

italian
poko
fregare
ottuzo
kattsare
anno
kwesto
pesse
martso
dzusto
kwando
bere
pesante
greve
wovo
terra
polvere
ridere
erba
tallente
lavare

english
fyu
rob
dol
hunt
yi3
8is
   s
rot3n
rait
wen
drink
hevi
hevi
eg
38
dost
lof
gros
sop
wos

gerhard j  ger

sequence alignment

esslli 2016

4 / 62

pairwise alignment

pairwise alignment

gerhard j  ger

sequence alignment

esslli 2016

5 / 62

pairwise alignment

levenshtein alignment

related to as id153
de   nes the distance between two strings as the minimal number of
edit operations to transform one string into the other
edit operations:

deletion
insertion
replacemant

example: grm. mens vs. cimbrian menes

1 mens     mens (replace)
2 mens     menes (insert)
3 menes     menes (insert)

dl(mens, menes) = 3

gerhard j  ger

sequence alignment

esslli 2016

6 / 62

pairwise alignment

levenshtein alignment

alternative presentation: alignment

m e n     s
|
|
m e n e s

|

|

|

distance for a particular alignment is the number of non-identities
levenshtein distance is the number of mismatches for the optimal
alignment

gerhard j  ger

sequence alignment

esslli 2016

7 / 62

pairwise alignment

computing the levenshtein distance

recursive de   nition:

1 dl( ,   ) = dl(  ,  ) = l(  )
2

dl(  x,   y) = min

          dl(  ,   ) +   (x, y)

dl(  x,   ) + 1
dl(  ,   y) + 1

apparently requires exponentially growing number of comparisons    
computationally not feasible
but:

if l(  ) = n and l(  ) = m, there are n + 1 substrings of    and m + 1
substrings of   
hence there are only (n + 1)(m + 1) many di   erent comparisons to be
performed
computational complexity is polynomial (quadratic in l(  ) + l(  ))

gerhard j  ger

sequence alignment

esslli 2016

8 / 62

pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m1e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m1e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m101e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m1012e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e2n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e211n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e2112n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n3e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n322e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n3221e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e4s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e432s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e4322s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s5pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s543pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s5433pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333pairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

dynamicprogramming   mens   01234m10123e21123n32212e43222s54333men   smenespairwise alignment

computing the levenshtein distance

gerhard j  ger

sequence alignment

esslli 2016

9 / 62

   mens   01234m10123e21123n32212e43222s54333men   smenes   mens   01234m10123e21123n32212e43222s54333mens   menespairwise alignment

id172 for length

grm. mens (mensch,    person   ) and hindi manusya are (partially)
cognate
grm. ze3n (sehen,    see   ) and hindi deg are not cognate
still

dl(mens, manusya) = 4
dl(ze3n, deg) = 3

id172: dividing levenshtein distance by length of longer string:

dld(mens, manusya) = 4/7     0.57
dld(ze3n, deg) = 3/4 = 0.75

gerhard j  ger

sequence alignment

esslli 2016

10 / 62

pairwise alignment

how well does normalized levenshtein distance
predict cognacy?

gerhard j  ger

sequence alignment

esslli 2016

11 / 62

ldnempirical id203 of cognacy0.20.40.60.80.00.20.40.60.81.00.000.250.500.751.00noyescognateldncognatenoyespairwise alignment

problems

binary distinction: match vs. non-match
frequently genuin sound correspondences in cognates are missed:

c
-

v
-

a
t

i
u

n
n

a
-

z
o

3
s

-
p

-
i

-
s

f
k

i s
i
s

corresponding sounds count as mismatches even if they are aligend
correctly

a

h
n
h e n

t
d

h
a
m a

n
n

t
o

substantial amount of chance similarities

gerhard j  ger

sequence alignment

esslli 2016

12 / 62

pairwise alignment

background: id203 theory

given two sequences: how likely is it that they are aligned?
more general question: given some data, and two competing
hypotheses, how likely is it that the    rst hypothesis is correct?

bayesian id136!!!

given:

wanted:

data: d
hypotheses: h1, h0
model: p (d|h1), p (d|h0)

p (h1|d) : p (h0|d)

gerhard j  ger

sequence alignment

esslli 2016

13 / 62

pairwise alignment

bayesian id136

id47:

p (h|d) =

(cid:80)
p (d|h)p (h)
h(cid:48) p (d|h(cid:48))p (h(cid:48))

ergo:

p (h1|d) : p (h0|d) = p (d|h1)p (h1) : p (d|h0)p (h0)
p (h1|d) : p (h0|d) =

p (d|h1)
p (d|h0)

p (h1)
p (h0)

log(p (h1|d) : p (h0|d)) = log

p (d|h1)
p (d|h0)

+ log

p (h1)
p (h0)

gerhard j  ger

sequence alignment

esslli 2016

14 / 62

pairwise alignment

bayesian id136

suppose we have many independent data: (cid:126)d = d1, . . . , dn

p ( (cid:126)d|h) =

log p ( (cid:126)d|h) =

p ((cid:126)d|h1)
p ((cid:126)d|h0)

log

=

log(p (h1|(cid:126)d) : p (h0|(cid:126)d)) =

i=1

n(cid:89)
n(cid:88)
n(cid:88)
n(cid:88)

i=1

i=1

i=1

p (di|h)

log p (di|h)
p (di|h1)
p (di|h0)
p (di|h1)
p (di|h0)

log

log

+ log

p (h1)
p (h0)

gerhard j  ger

sequence alignment

esslli 2016

15 / 62

pairwise alignment

bayesian id136

mein argument against using bayes    rule: the prior probabilities
p (h1), p (h0) are not known
there are various heuristics, but no generally accepted way to obtain
them
if n is large though, log p (h1)/p (h0) doesn   t matter very much:1

log(p (h1|(cid:126)d) : p (h0| (cid:126)d))     n(cid:88)

p (di|h1)
p (di|h0)

log

= log(p ( (cid:126)d|h1) : p ((cid:126)d|h0))

i=1

the quantity log(p ((cid:126)d|h1) : p ((cid:126)d|h0)) is called log-odds

1also, if we choose an uninformative prior with p (h1) = p (h0), we have

log p (h1)/p (h0) = 0 anyway.

gerhard j  ger

sequence alignment

esslli 2016

16 / 62

pairwise alignment

log-odds

log-odds can take any real value
a positive value indicates evidence for h1 and a negative value
evidence for h0
the higher the absolute value, the stronger is the evidence

gerhard j  ger

sequence alignment

esslli 2016

17 / 62

pairwise alignment

weighted alignment

suppose our data are two aligned sequences (cid:126)x, (cid:126)y
for the time being, we assume there are no gaps in the alignment

h1: they developed from a common ancestor via substitions
h0: they are unrelated

additional assumptions (rough approximation in biology, pretty much
o    the mark in linguistics): substitions in di   erent positions occur
independently

gerhard j  ger

sequence alignment

esslli 2016

18 / 62

pairwise alignment

the null model

if (cid:126)x and (cid:126)y are unrelated, their joint id203 equals the product of
their individual probabilities
as a start (quite wrong both in biology and in linguistics): let us
assume the strings have no    grammar   ; each position is independent
from all other positions
then

p ((cid:126)x, (cid:126)y|h0) = p ((cid:126)x|h0)p ((cid:126)y|h0)

=

log p ((cid:126)x, (cid:126)y|h0) =

p (xi|h0)p (yi|h0)
log(p (xi|h0) + log p (yi|h0))

(cid:89)
(cid:88)

i

i

gerhard j  ger

sequence alignment

esslli 2016

19 / 62

pairwise alignment

the null model

suppose (cid:126)x and (cid:126)y are generated by the same process (reasonable for
dna and protein comparison, false for cross-linguistic word
comparison)
then p (xi|h), p (yi|h) are simply the probabilities of occurrence
qa: id203 that symbol a occurs in a sequence

(cid:88)

(cid:88)

log p ((cid:126)x, (cid:126)y|h0) =

log qxi +

log qyj

i

j

q can be estimated from relative frequencies

gerhard j  ger

sequence alignment

esslli 2016

20 / 62

pairwise alignment

the alignment model

suppose (cid:126)x and (cid:126)y evolved from a common ancestor via independent
substitution mutations
independence between positions:
p ((cid:126)x, (cid:126)y|h1) =

p (xi, yi|h2)

(cid:89)

i

pa,b: id203 that a position in the latest common ancestor of x
and y evolved into an a in sequence (cid:126)x and into a b in sequence (cid:126)y

p ((cid:126)x, (cid:126)y|h1) =
log p ((cid:126)x, (cid:126)y|h1) =

(cid:89)
(cid:88)

i

pxi,yi

log pxi,yi

gerhard j  ger

sequence alignment

esslli 2016

21 / 62

i

pairwise alignment

the log-odds score

taking things together, we have

log(p ((cid:126)x, (cid:126)y|h1) : p ((cid:126)x, (cid:126)y|h0)) =

(cid:88)

i

log

pxi,yi
qxiqyi

: score of the alignment of a with b

log pab
qaqb
also goes by the name of pointwise mutual information (pmi)
assembled in a pmi substitution matrix

gerhard j  ger

sequence alignment

esslli 2016

22 / 62

pairwise alignment

substitution matrices

in bioinformatics, several commonly used substitution matrices for
nucleotids and proteins
based on explicit models of evolution and careful empirical testing
for nucleotids:

a g t
c
2    5    7    7
2    7    7
2    5
2

a
g    5
t    7    7
c    7    7    5

gerhard j  ger

sequence alignment

esslli 2016

23 / 62

pairwise alignment

substitution matrices

for proteins: di   erent matrices for di   erent evolutionary distances
for instance: blosum50

gerhard j  ger

sequence alignment

esslli 2016

24 / 62

pairwise alignment

substitution matrix for the asjp data

1. identify large sample of pairs of closely related languages (using expert

information or heuristics based on aggregated levenshtein distance)

an.northern_philippines.central_bontoc
an.meso-philippine.northern_sorsogon

wf.western_fly.iamega
wf.western_fly.gamaewe

pan.panoan.kashibo_bajo_aguaytia
pan.panoan.kashibo_san_alejandro

aa.eastern_cushitic.kambaata_2
aa.eastern_cushitic.hadiyya_2

st.bai.qiliqiao_bai_2
st.bai.yunlong_bai

an.sulawesi.mandar
an.oceanic.raga

an.southern_philippines.kagayanen
an.northern_philippines.limos_kalinga

an.meso-philippine.canipaan_palawan
an.northwest_malayo-polynesian.lahanan

nc.bantoid.lifonga
nc.bantoid.bomboma_2

ie.indic.wad_pagga
ie.indic.talagang_hindko

nc.bantoid.lingala
nc.bantoid.lifonga

an.central_malayo-polynesian.baliledo
an.central_malayo-polynesian.palue

an.sulawesi.tanete
an.sama-bajaw.boepinang_bajau

aua.munda.ho
aua.munda.korku

ua.aztecan.nahuatl_hueyapan_tetela_del_volcan
ua.aztecan.nahuatl_cuentepec_temixco

mge.ge-kaingang.kayapo
mge.ge-kaingang.apinaye

gerhard j  ger

sequence alignment

esslli 2016

25 / 62

pairwise alignment

substitution matrix for the asjp data

2. pick a concept and a pair of related languages at random

languages: pen.maiduan.maidu_konkau, pen.maiduan.ne_maidu
concept: one

3.    nd corresponding words from the two languages:

nisam, nisem

4. do levenshtein alignment

n
n

i
s
i s

a m
e m

5. for each sound pair, count number of correspondences

nn: 1; ii: 1; ss; 1; ae: 1; mm: 1

gerhard j  ger

sequence alignment

esslli 2016

26 / 62

pairwise alignment

substitution matrix for the asjp data

steps 2-5 are repeated 100,000 times

klem
klom

s3--v
s37on

gerhard j  ger

a
i
u
n
o

ligini
ji---p
56,047
a
33,955
i
23,731
u
21,363
n
o
19,619
m m 18,263
t
16,975
t
k
k
16,773
e
12,745
e
r
11,601
r
l
11,377
l
b
8,965
b
s
8,245
s
d
d
6,829
6,681
p
p
6,613
w w
6,275
n n
5,331
h
h
5,321
y
y
3
3
5,255
...
...
...
sequence alignment

kulox
gulox
...
...
...
2
8
4
2
a
4
2
t
g
2
i
!
2
g y
d
2
!
s g 2
2
5
z
2
g
s
2
x z
2
k
!
2
8
q
a
!
2
2
!
a
!
y
2
! e 2
j g 2
2
g
i
!
e
2
v
s 2

naltir---i    
naltirtiri    

esslli 2016

27 / 62

pairwise alignment

substitution matrix for the asjp data

6. determine relative frequency of occurrence of each sound within the

entire database

a
i
u
o
n
e
k
m
t
r
l
b
s
w
3
y
d
h
p
n
g

0.1479
0.0969
0.0696
0.0626
0.0614
0.0478
0.0478
0.0465
0.0449
0.0346
0.0331
0.0248
0.0243
0.0232
0.0228
0.0222
0.0214
0.0213
0.0202
0.0201
0.0178

e
7
c
s
x
c
f
5
v
q
z
j
t
l
x
8
z
!
4
g

0.0134
0.0124
0.0073
0.0064
0.0062
0.0056
0.0052
0.0049
0.0045
0.0041
0.0035
0.0035
0.0029
0.0027
0.0022
0.0014
0.0011
0.0009
0.0002
0.0001

gerhard j  ger

sequence alignment

esslli 2016

28 / 62

pairwise alignment

substitution matrix for the asjp data

7. estimate pab as relative frequency of co-occurrence of a with b, qa, qb
pab
qaqb

as individual relative frequencies, and determine pmi scores log2

g g 11.2348
!
10.0202
!
4
4
9.1480
8.0650
8
8
7.9575
z z
7.9375
x x
7.6276
l
l
7.2624
z
z
7.2542
q
q
6.9117
f
f
6.8418
v
v
5
5
6.7731
6.7587
j
j
6.6580
t t
6.6054
s
s
6.5989
c
c
c c
6.2439
4 g 6.1943
x
6.1210
g x 5.3342
g q
5.3017
5.2111
7
7
5.0693
p
p
n n
4.9821

x

j 4.9386
z
4.9263
d
d
g
4.8958
g
4.8906
b
b
s
4.8277
s
5 4.7508
4
4.7143
e
e
4.6512
w w
h
h
4.5819
g x 4.5573
z 4.4943
z
y
y
4.4637
l
4.4037
l
! g 4.3760
4.3692
3
r
4.3061
x q 4.1200
m m 4.1087
t
4.1021
g z 4.0429
k
3.9046
x x 3.8116
t z 3.7380
8 g 3.6993

3
r

k

t

      

v

q
a
o

u
q
o
k
z
s
q

o
-3.2842
c
-3.2893
j
-3.2914
a m -3.2915
e
-3.3035
! w -3.3079
-3.3087
!
-3.3116
5
-3.3158
t
-3.3526
!
-3.3763
e
!
-3.3788
f
-3.3942
n s -3.3954
-3.4077
!
-3.4558
l
-3.4690
t
-3.5529
4
5
-3.8294
c n -3.8451
!
-4.2625
-4.3534
!
-4.3712
!
!
-4.9817

b
b
u
i
a

t
e
i
a

gerhard j  ger

sequence alignment

esslli 2016

29 / 62

pairwise alignment

evaluation

gerhard j  ger

sequence alignment

esslli 2016

30 / 62

jzzl8yldrctcsst!45xxgh7qkgfvwpbnnmiee3ouaauo3eeimnnbpwvfgkq7hgxx54!tssctcrdly8lzzj   10   50510pmijzzl8yldrctcsst!45xxgh7qkgfvwpbnnmiee3ouaauo3eeimnnbpwvfgkq7hgxx54!tssctcrdly8lzzjpairwise alignment

evaluation

gerhard j  ger

sequence alignment

esslli 2016

31 / 62

         q                                                                     s                  r         t                                                                                                               pairwise alignment

gap penalties

gaps in an alignment correspond either to an insertion or a deletion
simpli   ed assumption: insertions and deletions are equally likely at all
positions; symbols are inserted according to their general frequency of
occurrence
suppose an item xi is aligned to a gap. let    be the id203 that
an insertion occured since the latest common ancestor, and    the
id203 of a deletion

p (xi,   |h1) =   qxi +   qxi
p (xi,   |h0) = qxi

log(p (xi,   |h1) : p (xi,   |h0)) = log(   +   )

=    d

i.e., there is a constant term for each gap
as    +    < 1, this term is negative, i.e. there a constant penalty for
each gap

gerhard j  ger

sequence alignment

esslli 2016

32 / 62

pairwise alignment

a   ne gap penalties

deletions/insertions frequently apply to entire blocks of symbols (both
in biology and linguistics)
id203 of a gap of length n are higher than the product of
probabilities of n individual gaps
penalty e for extending a gap is lower than penalty d for opening a
gap
g: length of a gap

  (g) =    d     (g     1)e

no principled way to derive the values of d and e; have to be    xed via
trial and error
d = 2.5 and e = 1.6 work quite well for the asjp data

gerhard j  ger

sequence alignment

esslli 2016

33 / 62

pairwise alignment

weighted alignment

so far, we assumed that the alignment between (cid:126)x and (cid:126)y is known
to assess strength of evidence for h1 given (cid:126)x, (cid:126)y, we need to consider
all alignments between (cid:126)x and (cid:126)y
enumeration is infeasible, because the number of alignments between

two sequences of length n is(cid:18) 2n

(cid:19)

=

(2n)!

(n!)2     22n   

  n

n

computation is nonetheless possible using pair id48
simpler task:    nd the most likely alignment and determine its
log-odds!

gerhard j  ger

sequence alignment

esslli 2016

34 / 62

pairwise alignment

the needleman-wunsch algorithm

almost identical to levenshtein algorithm, except:

matches/mismatches are counted not as 1 and 0, but as log-odds scores
of the corresponding symbol pair
insertions/deletions are counted as gap penalties
by convention, the similarity rather than the distance is counted, i.e. we
try to    nd the alignment that maximizes the score

let (cid:126)x have length n, (cid:126)y lenth m, sab be the log-odds score of a and b,
and d/e the gap penalties

gerhard j  ger

sequence alignment

esslli 2016

35 / 62

pairwise alignment

the needleman-wunsch algorithm

f (0, 0) = 0

g(0, 0) = 0

0 < i     n

   i :

   j :

f (i, 0) = f (i     1, 0) + g(i     1, 0)e + (1     g(i     1, 0))d
g(i, 0) = 1

0 < j     m :

f (0, j) = f (0, j     1) + g(0, j     1)e + (1     g(0, j     1))d
g(0, j) = 1
   i, j :

0 < i     n, 0 < j     m

          f (i     1, j) + g(i     1, j)e + (1     g(i     1, j))d

f (i, j     1) + g(i, j     1) + (1     g(i, j     1))d
f (i     1, j     1) + sxiyj

          f (i     1, j) + g(i     1, j)e + (1     g(i     1, j))d

f (i, j     1) + g(i, j     1)e + (1     g(i, j     1))d
f (i     1, j     1) + sxiyj

          = 3

f (i, j) = max

g(i, j) = 0 if arg max

1 else

gerhard j  ger

sequence alignment

esslli 2016

36 / 62

pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.5e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.5e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.5e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.13e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.13e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.13e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.53e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.1n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.53n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.65n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.05n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.7e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.03e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.05e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.2e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.47s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.75s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.6s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.97pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.15pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.1pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.18.84pairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.18.84memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.18.84memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.18.84memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.18.84memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

finding the best alignment

gerhard j  ger

sequence alignment

esslli 2016

37 / 62

dynamicprogramming   mens   0   2.5   4.1   5.7   7.3m   2.54.131.530.03   1.47e   4.11.535.653.051.55n   5.70.033.059.26.6e   7.3   1.474.756.67.62s   8.9   2.972.155.18.84memorizingineachstepwhichofthethreecellstotheleftandabovegaverisetothecurrententryletsusrecoverthecorresponingoptimalalignmentpairwise alignment

evaluation
left: levenshtein alignment; right: needleman-wunsch alignment

-ix
ego

du
tu

vir
nos

ains
unus

cvai
-duo

---mens
persona

---fis
piskis

hun-t
kanis

ix-
ego

du
tu

vir
nos

ain-s
-unus

cvai
duo-

mens---
persona

fis---
piskis

hun-t
kanis

-----laus
pedikulus

------laus
pedikul-us

-blat
folyu

haut--
-kutis

---blut
sangwis

knox3n
--o--s

horn-
kornu

-au-g3
okulus

na-z3
nasus

chan
dens

-chun3
lingwe

b-lat
folyu

haut--
k-utis

---blut
sangwis

knox3n
--os--

horn-
kornu

a-ug3-
okulus

naz3-
nasus

chan-
d-ens

chun--3
-lingwe

han-t
manus

--brust
pektus-

leb3r
yekur

trink3n
-bibere

--ze3n
widere

-her3n
audire

sterb3n
-mor--i

khom3n
wenire

zon3
so-l

han-t
manus

b--rust
pektus-

leb3r
yekur

trink3n-
-bi-bere

--ze3n
widere

--her3n
audire-

sterb3n
-mor-i-

khom3n---
w---enire

zon3
sol-

gerhard j  ger

sequence alignment

esslli 2016

38 / 62

pairwise alignment

evaluation

vas3r
-akwa

stain
lapis

-foia
innis

pfat
viya

berk
mons

n-at
noks

---fol
plenus

no--i
nowus

nam-3
nomen

--vas3r
akwa---

sta-in
-lapis

fo-ia
innis

p-fat
viya-

berk
mons

na-t
noks

fol----
p-lenus

no-i-
nowus

nam3-
nomen

gerhard j  ger

sequence alignment

esslli 2016

39 / 62

pairwise alignment

german     swabian

0.3

8.26

-1.09

4.63

16.0

'i':
ix
i

'you':
du
du

'we':
vir
mia

'one':
ains
ois

'two':
cvai
cvoi

'person': 12.61
mens
menze

16.35

'fish':
fis
fis

'louse': 15.01
laus
laus

6.57

11.92

14.42

'tree':
baum
bom

'leaf':
blat
blad

'skin':
haut
haut

'blood': 12.88
blut
blud

16.88

8.75

'bone':
knox3n
knoxe

'horn':
horn
hoan

'tongue': 9.8
chun3
cun

7.77

8.6

'knee':
kni
knui

'hand':
hant
hend

'breast': 14.81
brust
bxust

10.01

4.99

0.63

'liver':
leb3r
leba

'drink':
trink3n
dxing

'see':
ze3n
se

10.16

11.84

8.79

16.16

7.8

10.36

12.43

'die':
sterb3n
steab

'come':
khom3n
khom

'sun':
zon3
sone

'star':
stern
stean

'water':
vas3r
vaza

'stone':
stain
stoi

'fire':
foia
fuia

gerhard j  ger

sequence alignment

esslli 2016

40 / 62

pairwise alignment

german     english

-2.3

2.34

2.21

-2.3

-5.25

16.35

-7.46

'i':
ix
ei

'you':
du
yu

'we':
vir
wi

'one':
ains
w3n

'two':
cvai
tu

'fish':
fis
fis

'dog':
hunt
dag

'tree': -7.83
baum
tri

'leaf': -0.47
blat
lif

'blood': 9.46
blut
bl3d

'bone': -1.36
knox3n
bon

15.73

-4.1

1.63

'horn':
horn
horn

'eye':
aug3
ei

'nose':
naz3
nos

'tongue':-0.63
chun3
t3n

3.86

8.6

'knee':
kni
ni

'hand':
hant
hend

'breast': 16.93
brust
brest

14.65

7.48

-3.04

'liver':
leb3r
liv3r

'drink':
trink3n
drink

'see':
ze3n
si

-7.7

1.22

1.95

8.2

12.06

6.75

6.79

'die':
sterb3n
dei

'come':
khom3n
k3m

'sun':
zon3
s3n

'star':
stern
star

'water':
vas3r
wat3r

'stone':
stain
ston

'fire':
foia
feir

gerhard j  ger

sequence alignment

esslli 2016

41 / 62

pairwise alignment

german     latin

-3.87

3.62

-5.06

2.39

-5.51

'i':
ix
ego

'you':
du
tu

'we':
vir
nos

'one':
ains
unus

'two':
cvai
duo

'person':-4.66
mens
persona

0.29

'fish':
fis
piskis

'louse': -0.08
laus
pedikulus

'tree': -3.85
baum
arbor

'leaf': -3.57
blat
folyu

'skin': -0.25
haut
kutis

'blood': -9.18
blut
sangwis

'bone': -5.72
knox3n
os

7.55

'horn':
horn
kornu

4.49

'nose':
naz3
nasus

'tooth': -2.78
chan
dens

'tongue':-3.4
chun3
lingwe

0.8

0.73

'knee':
kni
genu

'hand':
hant
manus

'breast': 1.39
brust
pektus

5.37

'liver':
leb3r
yekur

-4.15

-4.24

-6.12

-9.25

0.97

5.72

'see':
ze3n
widere

'hear':
her3n
audire

'die':
sterb3n
mori

'come':
khom3n
wenire

'sun':
zon3
sol

'star':
stern
stela

'water': -5.4
vas3r
akwa

gerhard j  ger

sequence alignment

esslli 2016

42 / 62

pairwise alignment

how well does pmi similarity predict cognacy?
expert cognacy judgments used as gold standard

gerhard j  ger

sequence alignment

esslli 2016

43 / 62

ldnempirical id203 of cognacy0.20.40.60.80.00.20.40.60.81.0pmiempirical id203 of cognacy   20   10010200.00.20.40.60.81.00.000.250.500.751.00noyescognateldncognatenoyes   20   1001020noyescognatepmicognatenoyespairwise alignment

how well does pmi similarity predict cognacy?

average precision

ldn: 0.847
pmi: 0.864

gerhard j  ger

sequence alignment

esslli 2016

44 / 62

0.00.20.40.60.81.00.40.50.60.70.80.91.0precision   recall curverecallprecisionldnpmiestimating distances from pairwise alignments

estimating distances from pairwise alignments

gerhard j  ger

sequence alignment

esslli 2016

45 / 62

estimating distances from pairwise alignments

id203 of cognacy

predicted prob.

expert judgment

id28 to predict id203 of cognacy from pmi similarity
expert judgment
italian
concept
tallente
sharp
galleddzare
   oat
ammattsare
kill
bark
skordza
husband marito
walk
eat
bark
know
come
swim
back
burn
think
dust
wife
swell
sing
knee
dry
   ve
skin
hand
blood
   ow
wipe
turn

english predicted prob.
fo83
wen
nait
end
neim
w3m
raund
meni
wind
tu
mo83
8au
tsaild
lon
   s
kaunt
sto
beli
son
   ai
8ri
   3u
hevi
p3s3n
enim3l
vomit
frut

0
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
sequence alignment

english
sop
   3ut
kil
bok
hozb3nd
kamminare
wok
mandzare
it
kortettsa
bok
sapere
n3u
venire
kom
nwotare
swim
dosso
bek
ardere
b3n
pensare
8ink
polvere
dost
molle
waif
gonfyare
swel
kantare
sin
rotella
ni
assutto
drai
tsinkwe
faiv
pelle
skin
mano
hend
sangwe
blod
skorrere
   3u
assugare
waip
dzirare
t3n
gerhard j  ger

italian
padre
kwando
notte
eed
nome
verme
tondo
molti
vento
due
madre
tu
fantsullo
lungo
pesse
kontare
stella
ventre
sole
volare
tre
   uire
greve
persona
animale
vomitare
frutto

concept
father
when
night
and
name
worm
round
many
wind
two
mother
thou
child
long
   sh
count
star
belly
sun
   y
three
   ow
heavy
person
animal
vomit
fruit

0.480
0.483
0.508
0.518
0.519
0.521
0.526
0.569
0.573
0.600
0.624
0.629
0.638
0.651
0.659
0.660
0.664
0.679
0.692
0.742
0.744
0.759
0.769
0.799
0.947
0.960
0.966

0.004
0.004
0.007
0.009
0.010
0.011
0.011
0.013
0.015
0.016
0.016
0.018
0.018
0.019
0.019
0.020
0.021
0.022
0.022
0.022
0.023
0.024
0.025
0.025
0.026
0.026
0.026

1
1
1
0
1
1
1
0
1
1
1
1
0
1
1
1
1
0
1
0
1
0
0
1
1
1
1

esslli 2016

46 / 62

estimating distances from pairwise alignments

estimating distances

average or maximal predicted
id203 of cognacy per
concept = expected relative
frequency of cognate pairs
expected relative frequency of
cognate pairs = e   t

    distance estimation from raw

    applicable across language

data

families

gerhard j  ger

sequence alignment

esslli 2016

47 / 62

0.00.51.01.52.02.50.00.51.01.52.02.5expertpredictiongreek   bulgariangreek   russiangreek   polishgreek   ukrainiangreek   czechgreek   icelandicgreek   swedishgreek   danishgreek   englishgreek   dutchgreek   germangreek   catalangreek   portuguesegreek   spanishgreek   frenchgreek   italiangreek   bretongreek   romaniangreek   lithuaniangreek   irishgreek   hindigreek   bengaligreek   welshgreek   nepalibulgarian   russianbulgarian   polishbulgarian   ukrainianbulgarian   czechbulgarian   icelandicbulgarian   swedishbulgarian   danishbulgarian   englishbulgarian   dutchbulgarian   germanbulgarian   catalanbulgarian   portuguesebulgarian   spanishbulgarian   frenchbulgarian   italianbulgarian   bretonbulgarian   romanianbulgarian   lithuanianbulgarian   irishbulgarian   hindibulgarian   bengalibulgarian   welshbulgarian   nepalirussian   polishrussian   ukrainianrussian   czechrussian   icelandicrussian   swedishrussian   danishrussian   englishrussian   dutchrussian   germanrussian   catalanrussian   portugueserussian   spanishrussian   frenchrussian   italianrussian   bretonrussian   romanianrussian   lithuanianrussian   irishrussian   hindirussian   bengalirussian   welshrussian   nepalipolish   ukrainianpolish   czechpolish   icelandicpolish   swedishpolish   danishpolish   englishpolish   dutchpolish   germanpolish   catalanpolish   portuguesepolish   spanishpolish   frenchpolish   italianpolish   bretonpolish   romanianpolish   lithuanianpolish   irishpolish   hindipolish   bengalipolish   welshpolish   nepaliukrainian   czechukrainian   icelandicukrainian   swedishukrainian   danishukrainian   englishukrainian   dutchukrainian   germanukrainian   catalanukrainian   portugueseukrainian   spanishukrainian   frenchukrainian   italianukrainian   bretonukrainian   romanianukrainian   lithuanianukrainian   irishukrainian   hindiukrainian   bengaliukrainian   welshukrainian   nepaliczech   icelandicczech   swedishczech   danishczech   englishczech   dutchczech   germanczech   catalanczech   portugueseczech   spanishczech   frenchczech   italianczech   bretonczech   romanianczech   lithuanianczech   irishczech   hindiczech   bengaliczech   welshczech   nepaliicelandic   swedishicelandic   danishicelandic   englishicelandic   dutchicelandic   germanicelandic   catalanicelandic   portugueseicelandic   spanishicelandic   frenchicelandic   italianicelandic   bretonicelandic   romanianicelandic   lithuanianicelandic   irishicelandic   hindiicelandic   bengaliicelandic   welshicelandic   nepaliswedish   danishswedish   englishswedish   dutchswedish   germanswedish   catalanswedish   portugueseswedish   spanishswedish   frenchswedish   italianswedish   bretonswedish   romanianswedish   lithuanianswedish   irishswedish   hindiswedish   bengaliswedish   welshswedish   nepalidanish   englishdanish   dutchdanish   germandanish   catalandanish   portuguesedanish   spanishdanish   frenchdanish   italiandanish   bretondanish   romaniandanish   lithuaniandanish   irishdanish   hindidanish   bengalidanish   welshdanish   nepalienglish   dutchenglish   germanenglish   catalanenglish   portugueseenglish   spanishenglish   frenchenglish   italianenglish   bretonenglish   romanianenglish   lithuanianenglish   irishenglish   hindienglish   bengalienglish   welshenglish   nepalidutch   germandutch   catalandutch   portuguesedutch   spanishdutch   frenchdutch   italiandutch   bretondutch   romaniandutch   lithuaniandutch   irishdutch   hindidutch   bengalidutch   welshdutch   nepaligerman   catalangerman   portuguesegerman   spanishgerman   frenchgerman   italiangerman   bretongerman   romaniangerman   lithuaniangerman   irishgerman   hindigerman   bengaligerman   welshgerman   nepalicatalan   portuguesecatalan   spanishcatalan   frenchcatalan   italiancatalan   bretoncatalan   romaniancatalan   lithuaniancatalan   irishcatalan   hindicatalan   bengalicatalan   welshcatalan   nepaliportuguese   spanishportuguese   frenchportuguese   italianportuguese   bretonportuguese   romanianportuguese   lithuanianportuguese   irishportuguese   hindiportuguese   bengaliportuguese   welshportuguese   nepalispanish   frenchspanish   italianspanish   bretonspanish   romanianspanish   lithuanianspanish   irishspanish   hindispanish   bengalispanish   welshspanish   nepalifrench   italianfrench   bretonfrench   romanianfrench   lithuanianfrench   irishfrench   hindifrench   bengalifrench   welshfrench   nepaliitalian   bretonitalian   romanianitalian   lithuanianitalian   irishitalian   hindiitalian   bengaliitalian   welshitalian   nepalibreton   romanianbreton   lithuanianbreton   irishbreton   hindibreton   bengalibreton   welshbreton   nepaliromanian   lithuanianromanian   irishromanian   hindiromanian   bengaliromanian   welshromanian   nepalilithuanian   irishlithuanian   hindilithuanian   bengalilithuanian   welshlithuanian   nepaliirish   hindiirish   bengaliirish   welshirish   nepalihindi   bengalihindi   welshhindi   nepalibengali   welshbengali   nepaliwelsh   nepaliestimating distances from pairwise alignments

estimating distances

average or maximal predicted
id203 of cognacy per
concept = expected relative
frequency of cognate pairs
expected relative frequency of
cognate pairs = e   t

    distance estimation from raw

    applicable across language

data

families

gerhard j  ger

sequence alignment

esslli 2016

47 / 62

neighbor joining treegreekbulgarianrussianpolishukrainianczechicelandicswedishdanishenglishdutchgermancatalanportuguesespanishfrenchitalianbretonromanianlithuanianirishhindibengaliwelshnepaliestimating distances from pairwise alignments

languages of eurasia/ asjp data
cf. j  ger (2015); full tree can be inspected here

gerhard j  ger

sequence alignment

esslli 2016

48 / 62

uralichmong-mienchukotko-kamchatkanjaponicdravidianaustronesiannakh-daghestaniantai-kadaitungusicsino-tibetanmongolicyeniseianainuaustroasiaticnivkhindo-europeanturkic99.4%100%96.8%99.9%100%96.9%100%yukaghirestimating distances from pairwise alignments

languages of the world/ asjp data
cf. j  ger and wichmann (2016); full tree can be inspected here.

gerhard j  ger

sequence alignment

esslli 2016

49 / 62

austronesianniger-congotai-kadaiaustro-asiaticsino-tibetanuto-aztecanmayanquechuanaltaicafricaeurasiapapunesiaaustraliaamericasubsaharanafricanw eurasiaaustralia/papuase asiaamericapapuakhoisannilo-saharankaduglinilo-saharanniger-congodravidiantimor-alor-pantarindo-europeanuralicafro-asiaticafro-asiaticaustralianmultiple sequence alignment

multiple sequence alignment

gerhard j  ger

sequence alignment

esslli 2016

50 / 62

multiple sequence alignment

multiple sequence alignment

needleman-wunsch only does pairwise alignment
desirable: aligning all sequences of a taxon into one matrix

necessary for character-based phylogenetic id136
improves the quality of the alignment

gerhard j  ger

sequence alignment

esslli 2016

51 / 62

multiple sequence alignment

multiple sequence alignment

example:    one   
pie: oinos
bosian: yedan
kashubian: yeden
optimal pairwise alignments:
i
e

n
d

s
n

o
y

o
a

i

n

o
s
y e d e n

o

e

d

y
n
y e d e n

a

optimal multiple alignment (maximizing sum of pairwise similarities
per column):

-
s
-
alignment of all    n   s is etymologically correct

y e d e n
n
-
y
n

-
o
-

-
d

o
e

i
a

gerhard j  ger

sequence alignment

esslli 2016

52 / 62

multiple sequence alignment

multiple sequence alignment

in principle, the needleman-wunsch algorithm can be generalized to
aligning k sequences
however, aligning k sequences of length n has complexity o(nk2)    
computationally intractable
two strategies

heuristic search
progressive alignment

gerhard j  ger

sequence alignment

esslli 2016

53 / 62

multiple sequence alignment

progressive sequence alignment

start with a guide tree (using
some heuristics like pairwise
alignment + neighbor joining)
working bottom-up, at each
internal node, do pairwise
alignment of the block
alignments at the daugher node
complexity is o(n2k3)    
computationally feasible

gerhard j  ger

sequence alignment

esslli 2016

54 / 62

multiple sequence alignment

t-co   ee

progressive alignment only uses (phylogenetically) local information
erroneous decisions cannot be corrected later

gerhard j  ger

sequence alignment

esslli 2016

55 / 62

dendron8enrodendron8en-ro-tridrudendron8en-ro-d---ru-dendron8en-ro-d---ru----tri-multiple sequence alignment

t-co   ee

tree-based consistency objective
function for alignment evaluation
(notredame et al., 2000)
(slightly adapted for linguistic
application)

1 pairwise alignment for all word

pairs, using pmi scores

gerhard j  ger

sequence alignment

esslli 2016

56 / 62

dendron8en-ro-dendron8---ru-dendron---dru-dendront---ri-dendron---tri-8enrod--ru8enrot--ridrutrimultiple sequence alignment

t-co   ee

tree-based consistency objective
function for alignment evaluation
(notredame et al., 2000)
(slightly adapted for linguistic
application)

1 pairwise alignment for all word

pairs, using pmi scores
ternary alignments via relation
composition

2

gerhard j  ger

sequence alignment

esslli 2016

56 / 62

dendron8en-ro-dendron8---ru-dendron---dru-dendront---ri-dendron---tri-8enrod--ru8enrot--ridrutrit---ri-dendron---dru-t--ri8enrod--rut---ri-dendrond---ru----tri-dendron---dru----tri-dendront---ru-.........multiple sequence alignment

t-co   ee

tree-based consistency objective
function for alignment evaluation
(notredame et al., 2000)
(slightly adapted for linguistic
application)

1 pairwise alignment for all word

pairs, using pmi scores
ternary alignments via relation
composition
indirect alignment scores
between sound occurrences

2

3

gerhard j  ger

sequence alignment

esslli 2016

56 / 62

dendron8en-ro-dendron8---ru-dendron---dru-dendront---ri-dendron---tri-8enrod--ru8enrot--ridrutrit---ri-dendron---dru-t--ri8enrod--rut---ri-dendrond---ru----tri-dendron---dru----tri-dendront---ru-.........multiple sequence alignment

t-co   ee

tree-based consistency objective
function for alignment evaluation
(notredame et al., 2000)
(slightly adapted for linguistic
application)

2

1 pairwise alignment for all word

pairs, using pmi scores
ternary alignments via relation
composition
indirect alignment scores
between sound occurrences
4 progressive alignment using

3

those scores

gerhard j  ger

sequence alignment

esslli 2016

56 / 62

dendron8en-ro-dendron8---ru-dendron---dru-dendront---ri-dendron---tri-8enrod--ru8enrot--ridrutrit---ri-dendron---dru-t--ri8enrod--rut---ri-dendrond---ru----tri-dendron---dru----tri-dendront---ru-.........dendron8enrodendron8en-ro-tridrudendron8en-ro-d---ru-dendron8en-ro-d---ru-t---ri-multiple sequence alignment

examples

cognate class
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a
one:a

language
german
dutch
english
danish
swedish
icelandic
irish
breton
french
catalan
spanish
portuguese
italian
romanian
bengali
nepali
czech
polish
ukrainian
russian
bulgarian

word
-a-i--n-
---e--n-
-w-o--n-
---e--n-
---e--n-
---eidn-
---e--n-
---i--n-
---e----
---u--n-
---u--no
---u----
---u--no
---u--nu
---e--k-
---e--k-
yede--n-
yede--n-
-odi--n-
-adi--n-
-3di--n-

cognate class
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j
heart:j

language
german
dutch
english
danish
swedish
icelandic
french
catalan
spanish
portuguese
italian
hindi
lithuanian
czech
polish
ukrainian
russian
bulgarian
greek

word
h-er-t--s-
h-or-t----
h-o--t----
y-ea-d--3-
y-e--t--a-
s-ar-t--a-
k-er------
k-or------
k-ora8--on
k-uras--aw
kwor----e-
h--r-d--ai
s-ir-dis--
s--r-t-se-
s-er-t-se-
s-er-t-se-
s-erdt-se-
s-3r-t-se-
k-ar-8-sa-

gerhard j  ger

sequence alignment

esslli 2016

57 / 62

multiple sequence alignment

examples

cognate class
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a
two:a

language
german
dutch
english
danish
swedish
icelandic
french
catalan
spanish
portuguese
italian
romanian
nepali
czech
polish
ukrainian
russian
bulgarian
greek

word
tsvai-
t-we--
t--u--
d--o--
t-vo--
t-veir
d--e--
d--o-s
d--o-s
d--ois
d--ue-
d--o-y
d--ui-
d-va--
d-va--
d-wa--
d-va--
d-va--
8-io--

cognate class
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a
mother:a

language
german
dutch
english
danish
swedish
icelandic
french
catalan
spanish
portuguese
italian
czech
polish
ukrainian
russian
bulgarian
greek

word
mu-t--a-
mu-d--3r
mo-8--3-
mo----a-
mu-d--3r
mou8--ir
me---r--
ma---r3-
ma-8-re-
ma----i-
ma-d-re-
ma-t-ka-
ma-t-ka-
ma-t--i-
ma-t----
ma-y-k3-
mi-tera-

gerhard j  ger

sequence alignment

esslli 2016

58 / 62

multiple sequence alignment

examples

cognate class
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w
tongue:w

language
german
dutch
english
danish
swedish
icelandic
french
catalan
spanish
portuguese
italian
romanian
hindi
czech
polish
ukrainian
russian
bulgarian

word
---tsun--3
---t-on---
---t-on---
---d-on--3
---t-3n--a
---t-ung-a
---l-o-g--
---l-engw3
---l-engwa
---l-i-gua
---l-ingwa
---l-im-b3
---dzi--b-
ya-z-ik---
yewz-3k---
ya-z-ik---
yi-z-3k---
-3-z-ik---

cognate class
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b
tooth:b

language
greek
german
dutch
english
danish
swedish
icelandic
french
catalan
spanish
portuguese
italian
romanian
bengali
hindi

word
8-ondi
tsan--
t-ont-
t-u-8-
d-an--
t-and-
t-en--
d-o---
d-en--
dyente
d-e-t3
d-ente
d-inte
d-o-t-
d-a-t-

gerhard j  ger

sequence alignment

esslli 2016

59 / 62

multiple sequence alignment

examples

cognate class
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a
dog:a

language
lithuanian
ukrainian
russian
danish
swedish
icelandic
german
dutch
welsh
breton
irish
french
italian
portuguese
romanian
greek

word
s-u---o-
s-obaka-
s-abaka-
h-u-n---
h-3-nd--
h-i-ndir
h-u-nt--
h-o-nt--
k-----i-
k-----i-
k-----u-
s-i---e-
k-a-n-e-
k-a---u-
k-3yn-e-
tio-n---

cognate class
tree:c
tree:c
tree:c
tree:c
tree:c
tree:c
tree:c
tree:c
tree:c

language word
danish
swedish
icelandic
english
ukrainian
russian
polish
bulgarian
greek

d---g-e--
t---r-ed-
t---rye--
t---r-i--
de--r-ewo
de--r-evo
d---z-evo
d3--r--vo
8endr---o

gerhard j  ger

sequence alignment

esslli 2016

60 / 62

wrapping up

wrapping up

gerhard j  ger

sequence alignment

esslli 2016

61 / 62

wrapping up

important topics not covered

bayesian tree estimation     no good introductory texts so far (that i
would be aware of); best starting point might be chen et al. (2014),
esp. chapters 1 and 7
estimation of time depths in years (rather than in    expected number of
mutations   )     chang et al. (2015)
automatic cognate detection        rst part of the j  ger/list-manuscript
on the course homepage

hot research topics

automatic discovery of regular sound correspondences and sound laws
automatic reconstruction of proto-forms
factoring vertical descent from language contact
integrated probabilistic id136 of sequence alignment and
phylogenies

gerhard j  ger

sequence alignment

esslli 2016

62 / 62

references

chang, w., c. cathcart, d. hall, and a. garrett (2015).

ancestry-constrained phylogenetic analysis supports the indo-european
steppe hypothesis. language, 91(1):194   244.

chen, m.-h., l. kuo, and p. o. lewis (2014). bayesian phylogenetics.

methods, algorithms and applications. crc press, abingdon.

dolgopolsky, a. b. (1986). a probabilistic hypothesis concerning the oldest

relationships among the language families of northern eurasia. in v. v.
shevoroshkin, ed., typology, relationship and time: a collection of
papers on language change and relationship by soviet linguists, pp.
27   50. karoma publisher, ann arbor.

j  ger, g. (2015). support for linguistic macrofamilies from weighted

sequence alignment. proceedings of the national academy of sciences,
112(41):12752   12757. doi: 10.1073/pnas.1500331112.

j  ger, g. and s. wichmann (2016). inferring the world tree of languages

from word lists. in s. g. roberts, c. cuskley, l. mccrohon,
l. barcel  -coblijn, o. feher, and t. verhoef, eds., the evolution of
language: proceedings of the 11th international conference

gerhard j  ger

sequence alignment

esslli 2016

62 / 62

wrapping up
(evolang11). available online:
http://evolang.org/neworleans/papers/147.html.

list, j.-m. (2014). sequence comparison in historical linguistics.

d  sseldorf university press, d  sseldorf.

gerhard j  ger

sequence alignment

esslli 2016

62 / 62

