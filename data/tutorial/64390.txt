optimisation pour les r  eseaux profonds

  ecole d   hiver du mila

nicolas le roux

google brain team

6/3/18

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

1 / 39

1 optimisation simple

2 trois dif   cult  es

3 trouver un bon optimiseur

4 commentaires additionnels

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

2 / 39

optimisation ?

un mod`ele est une fonction param  etrique

on d  e   nit `a la main la fonction d   erreur

on cherche les param`etres qui minimisent l   erreur moyenne

entra    ner un mod`ele = trouver les meilleurs param`etres = optimisation

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

3 / 39

descente de gradient du premier ordre

expression `a minimiser: f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

4 / 39

descente de gradient du premier ordre

expression `a minimiser: f (  )

exemple: f (  ) = 1
n

i (xi        yi )2

(cid:80)

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

4 / 39

descente de gradient du premier ordre

expression `a minimiser: f (  )

(cid:80)

i (xi        yi )2

exemple: f (  ) = 1
n

initialisation:   0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

4 / 39

descente de gradient du premier ordre

expression `a minimiser: f (  )

(cid:80)

i (xi        yi )2

exemple: f (  ) = 1
n

initialisation:   0

it  erer:

(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

4 / 39

descente de gradient du premier ordre

expression `a minimiser: f (  )

(cid:80)

i (xi        yi )2

exemple: f (  ) = 1
n

initialisation:   0

it  erer:

(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )
(cid:73) mise `a jour:   t+1 =   t       g(  t )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

4 / 39

descente de gradient du premier ordre

expression `a minimiser: f (  )

(cid:80)

i (xi        yi )2

exemple: f (  ) = 1
n

initialisation:   0

it  erer:

(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )
(cid:73) mise `a jour:   t+1 =   t       g(  t )

cet algorithme converge pour un    bon       [cau47].

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

4 / 39

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

5 / 39

  

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

f (  )

f (  0)

  t+1 =   t     3
2

df (  )
d  

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

f (  )

f (  0)

  t+1 =   t     3
2

df (  )
d  

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3
  4

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

f (  )

f (  0)

  t+1 =   t     3
2

df (  )
d  

f1

f2

f3
f4

nicolas le roux (google brain team)

  0

  1

  2

  3
  4

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

f (  )

f (  0)

  t+1 =   t     3
2

df (  )
d  

f1

f2

f3
f4

nicolas le roux (google brain team)

  0

  1

  2

  3
  4
  5

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - bon pas de gradient

f (  )

f (  0)

  t+1 =   t     3
2

df (  )
d  

f1

f2

f3
f4
f5

nicolas le roux (google brain team)

  0

  1

  2

  3
  4
  5

optimisation pour les r  eseaux profonds

  

6/3/18

5 / 39

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

6 / 39

  

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

6 / 39

  

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

6 / 39

  

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

6 / 39

  

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

  1

6/3/18

6 / 39

  

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

f1

  1

  

6/3/18

6 / 39

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

f1

  1

  

6/3/18

6 / 39

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  2

  0

optimisation pour les r  eseaux profonds

f1

  1

  

6/3/18

6 / 39

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f2

  2

f (  0)

  0

optimisation pour les r  eseaux profonds

f1

  1

  

6/3/18

6 / 39

nicolas le roux (google brain team)

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f2

  2

f (  0)

  0

optimisation pour les r  eseaux profonds

f1

  1

  

  3

6/3/18

6 / 39

nicolas le roux (google brain team)

1d - grand pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f2

  2

f (  0)

  0

optimisation pour les r  eseaux profonds

f3

  

  3

f1

  1

6/3/18

6 / 39

nicolas le roux (google brain team)

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

6/3/18

7 / 39

  

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

7 / 39

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

7 / 39

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3

  4

optimisation pour les r  eseaux profonds

  

6/3/18

7 / 39

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

f4

nicolas le roux (google brain team)

  0

  1

  2

  3

  4

optimisation pour les r  eseaux profonds

  

6/3/18

7 / 39

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

f4

nicolas le roux (google brain team)

  0

  1

  2

  3

  4

  5

optimisation pour les r  eseaux profonds

  

6/3/18

7 / 39

1d - petit pas de gradient

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

f4

f5

nicolas le roux (google brain team)

  0

  1

  2

  3

  4

  5

optimisation pour les r  eseaux profonds

  

6/3/18

7 / 39

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

  3
optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3
optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  4
  3
optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

f4

nicolas le roux (google brain team)

  0

  1

  2

  4
  3
optimisation pour les r  eseaux profonds

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

f4

nicolas le roux (google brain team)

  0

  1

  2

  4
  3
optimisation pour les r  eseaux profonds

  5

6/3/18

8 / 39

  

1d -    bon    pas de gradient

  t+1 =   t     3
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

f4

f5

nicolas le roux (google brain team)

  0

  1

  2

  4
  3
optimisation pour les r  eseaux profonds

  5

6/3/18

8 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

  1

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

  1

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

  1

optimisation pour les r  eseaux profonds

6/3/18

9 / 39

  

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

  1

  2

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

  1

  2

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

f3

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

f3

  1

  2

  3
  4

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

f3
f4

  1

  2

  3
  4

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

f3
f4

  1

  2

  3
  4
  5

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

1d -    grand    pas de gradient

  t+1 =   t     6

df (  )
d  

f (  )

f (  0)

  0

nicolas le roux (google brain team)

f1

f2

f3
f4
f5

  1

  2

  3
  4
  5

optimisation pour les r  eseaux profonds

  

6/3/18

9 / 39

fonction convexe en 1d

le pas de gradient in   ue sur la convergence

il d  epend de la fonction `a optimiser

s   il y a convergence, c   est forc  ement au minimum

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

10 / 39

1 optimisation simple

2 trois dif   cult  es

3 trouver un bon optimiseur

4 commentaires additionnels

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

11 / 39

dif   cult  e 1: la haute dimension

en pratique,    n   est pas un nombre

c   est un vecteur qui peut contenir des millions de param`etres

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

12 / 39

dif   cult  e 1: la haute dimension

en pratique,    n   est pas un nombre

c   est un vecteur qui peut contenir des millions de param`etres

la descente de gradient marche-t-elle toujours?

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

12 / 39

dif   cult  e 1: la haute dimension

en pratique,    n   est pas un nombre

c   est un vecteur qui peut contenir des millions de param`etres

la descente de gradient marche-t-elle toujours?

oui mais...

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

12 / 39

   haute    dimension - bon pas de gradient

     

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  2

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  4

  3

  2

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  4   5

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  6
  4   5

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     

  6  7

  4   5

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - bon pas de gradient

     
  8
  6  7

  4   5

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

13 / 39

   haute    dimension - grand pas de gradient

     

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

     

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

     

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

     

  2

  1

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

     

  3

  2

  1

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

  4

  2

  1

     

  3

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

  4

  2

  1

     

  3

  5

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

   haute    dimension - grand pas de gradient

  6

  4

  2

  1

     

  3

  5

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

14 / 39

le conditionnement

   doit   etre petit pour les directions    courb  ees   

progr`es tr`es faible dans les directions    plates   

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

15 / 39

le conditionnement

   doit   etre petit pour les directions    courb  ees   

progr`es tr`es faible dans les directions    plates   

le rapport de courbure s   appelle conditionnement

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

15 / 39

le conditionnement

   doit   etre petit pour les directions    courb  ees   

progr`es tr`es faible dans les directions    plates   

le rapport de courbure s   appelle conditionnement

certaines m  ethodes cherchent `a reconditionner

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

15 / 39

un reconditionnement simple

exemple x     rd

mod`ele lin  eaire: f (  , x) =(cid:80)

j   (j)x(j)

la courbure est proportionnelle `a l   amplitude de xi

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

16 / 39

un reconditionnement simple

exemple x     rd

mod`ele lin  eaire: f (  , x) =(cid:80)

j   (j)x(j)

la courbure est proportionnelle `a l   amplitude de xi

solution: normaliser les donn  ees.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

16 / 39

dif   cult  e 2: stochasticit  e

calculer le gradient exact co  ute cher

peut-on s   en sortir avec gradient approch  e ?

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

17 / 39

dif   cult  e 2: stochasticit  e

calculer le gradient exact co  ute cher

peut-on s   en sortir avec gradient approch  e ?

(cid:73) oui ! [rm51]

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

17 / 39

dif   cult  e 2: stochasticit  e

calculer le gradient exact co  ute cher

peut-on s   en sortir avec gradient approch  e ?

(cid:73) oui ! [rm51]

on a souvent f (  ) = 1
n

(cid:80)

i fi (  )

on ne va calculer le gradient que pour une seule fi

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

17 / 39

propri  et  es du gradient stochastique

l   algorithme    n  ecessite    un pas d  ecroissant.

en th  eorie, 1/t . en pratique, souvent moins vite.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

18 / 39

propri  et  es du gradient stochastique

l   algorithme    n  ecessite    un pas d  ecroissant.

en th  eorie, 1/t . en pratique, souvent moins vite.

la convergence est plus lente que le gradient batch.

cela n   est vrai que pour l   erreur d   entra    nement.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

18 / 39

propri  et  es du gradient stochastique

l   algorithme    n  ecessite    un pas d  ecroissant.

en th  eorie, 1/t . en pratique, souvent moins vite.

la convergence est plus lente que le gradient batch.

cela n   est vrai que pour l   erreur d   entra    nement.

m  eme convergence sur l   erreur de test [bb08].

(cid:73) convergence en nombre de mises `a jour.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

18 / 39

gradient stochastique - pas constant

     

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  0

  2

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  4   5

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

     

  6

  4   5

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

  7
     

  4   5

  6

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

  7
     

  4   5

  8
  6

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

  7
     

  9

  4   5

  8
  6

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

  7
     

  9

  10

  4   5

  8
  6

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas constant

  7
  11
     

  9

  10

  4   5

  8
  6

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

19 / 39

gradient stochastique - pas d  ecroissant

     

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  2

  1

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  5
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  5  6
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  5  6  7
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  5  6  7  8
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  9
  5  6  7  8
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     

  9  10
  5  6  7  8
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas d  ecroissant

     
  11
  9  10
  5  6  7  8
  4

  2

  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

20 / 39

gradient stochastique - pas tr`es d  ecroissant

     

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  0

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  0

  2

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4
  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5  6

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5  6  7

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5  6  7  8

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5  6  7  8  9

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5  6  7  8  9  10

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

gradient stochastique - pas tr`es d  ecroissant

     

  4  5  6  7  8  9  10  11

  2  3

  0

  1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

21 / 39

dif   cult  e 3: non-convexit  e

preuves de convergence valides dans le cas convexe

les r  eseaux profonds sont non-convexes

th  eorie encore balbutiante mais des r  esultats empiriques

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

22 / 39

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

optimisation pour les r  eseaux profonds

6/3/18

23 / 39

  

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

nicolas le roux (google brain team)

  0

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

23 / 39

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3

optimisation pour les r  eseaux profonds

  

6/3/18

23 / 39

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3

nicolas le roux (google brain team)

  0

  1

  2

  3
  4

optimisation pour les r  eseaux profonds

  

6/3/18

23 / 39

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3
f4

nicolas le roux (google brain team)

  0

  1

  2

  3
  4

optimisation pour les r  eseaux profonds

  

6/3/18

23 / 39

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3
f4

nicolas le roux (google brain team)

  0

  1

  2

  3
  4
  5

optimisation pour les r  eseaux profonds

  

6/3/18

23 / 39

fonction non-convexe - petit pas

  0 = 0

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

f1

f2

f3
f5
f4

nicolas le roux (google brain team)

  0

  1

  2

  3
  4
  5

optimisation pour les r  eseaux profonds

  

6/3/18

23 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

24 / 39

  

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  0

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  0

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  0

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  2

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1

f2

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

  

  2

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1

f2

  

nicolas le roux (google brain team)

  3
optimisation pour les r  eseaux profonds

  2

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1
f3

f2

  

nicolas le roux (google brain team)

  3
optimisation pour les r  eseaux profonds

  2

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1
f3

f2

  

nicolas le roux (google brain team)

  4
  3
optimisation pour les r  eseaux profonds

  2

  0
  1

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1
f3
f4

f2

nicolas le roux (google brain team)

  4
  3
optimisation pour les r  eseaux profonds

  2

  0
  1

  

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1
f3
f4

f2

nicolas le roux (google brain team)

  4
  5
  3
optimisation pour les r  eseaux profonds

  2

  0
  1

  

6/3/18

24 / 39

fonction non-convexe - petit pas (2)

  0 = 5

  t+1 =   t     1
2

df (  )
d  

f (  )

f (  0)
f1
f3
f4
f5

f2

nicolas le roux (google brain team)

  4
  5
  3
optimisation pour les r  eseaux profonds

  2

  0
  1

  

6/3/18

24 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  1

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f1

nicolas le roux (google brain team)

  0

  2

  1

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f1

nicolas le roux (google brain team)

  0

  2

  1

optimisation pour les r  eseaux profonds

6/3/18

25 / 39

  

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f1

nicolas le roux (google brain team)

  0

  2

  1

  3

optimisation pour les r  eseaux profonds

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f3
f1

f2

nicolas le roux (google brain team)

  0

  2

  1

  3

optimisation pour les r  eseaux profonds

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f3
f1

f2

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

optimisation pour les r  eseaux profonds

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

optimisation pour les r  eseaux profonds

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

optimisation pour les r  eseaux profonds

  

  5

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f6

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f6

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  7

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f6

f7

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  7

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f6

f7

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  7
  8

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f8
f7

f6

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  7
  8

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f8
f7

f6

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  7
  8
  9

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

fonction non-convexe - grand pas

  0 = 0

  t+1 =   t     2

df (  )
d  

f (  )

f (  0)

f2

f3
f1

f4

f8
f9
f7

f6

nicolas le roux (google brain team)

  0

  2

  1

  3

  4

  7
  8
  9

  6

optimisation pour les r  eseaux profonds

f5

  5

  

6/3/18

25 / 39

non-convexit  e - `a retenir

la solution d  epend de l   initialisation [ben+07]

la solution d  epend de l   optimiseur [wil+17]

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

26 / 39

non-convexit  e - `a retenir

la solution d  epend de l   initialisation [ben+07]

la solution d  epend de l   optimiseur [wil+17]

hormis ces deux points, intuition en 1d compl`etement fausse

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

26 / 39

non-convexit  e en haute dimension

plateaux

points-selle [dau+14; ahv17]

peu de mauvais minima locaux, beaucoup se ressemblent [cho+15]

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

27 / 39

1 optimisation simple

2 trois dif   cult  es

3 trouver un bon optimiseur

4 commentaires additionnels

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

28 / 39

qualit  es d   un bon optimiseur

rapide (en temps de calcul)

facile `a r  egler

g`ere bien le conditionnement

g`ere les plateaux et points-selle

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

29 / 39

qualit  es d   un bon optimiseur

rapide (en temps de calcul)

facile `a r  egler

g`ere bien le conditionnement

g`ere les plateaux et points-selle

aucun algorithme ne fait tout c  a aujourd   hui

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

29 / 39

id  ee 1: utiliser plusieurs pas de gradient

id  ee: identi   er la courbure dans chaque direction et utiliser un pas de gradient diff  erent pour

chacune

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

30 / 39

id  ee 1: utiliser plusieurs pas de gradient

id  ee: identi   er la courbure dans chaque direction et utiliser un pas de gradient diff  erent pour

chacune

plusieurs m  ethodes mais gauss-newton est la plus populaire [lec+98]

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

30 / 39

id  ee 1: utiliser plusieurs pas de gradient

id  ee: identi   er la courbure dans chaque direction et utiliser un pas de gradient diff  erent pour

chacune

plusieurs m  ethodes mais gauss-newton est la plus populaire [lec+98]

de nombreuses variantes existent [dhs11; kb14]

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

30 / 39

id  ee 2: blanchir les donn  ees

blanchir les donn  ees aide pour un mod`ele lin  eaire

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

31 / 39

id  ee 2: blanchir les donn  ees

blanchir les donn  ees aide pour un mod`ele lin  eaire

les activations des couches cach  ees ne sont plus blanchies

les blanchir `a leur tour aide le conditionnement

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

31 / 39

id  ee 2: blanchir les donn  ees

blanchir les donn  ees aide pour un mod`ele lin  eaire

les activations des couches cach  ees ne sont plus blanchies

les blanchir `a leur tour aide le conditionnement

cette m  ethode s   appelle batch-norm [is15]

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

31 / 39

id  ee 3: utiliser la m  emoire

r  esoudre le mauvais conditionnement

(cid:73) on veut r  eduire    dans les directions courb  ees

(cid:73) on veut augmenter    dans les directions plates

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

32 / 39

id  ee 3: utiliser la m  emoire

r  esoudre le mauvais conditionnement

(cid:73) on veut r  eduire    dans les directions courb  ees

(cid:73) on veut augmenter    dans les directions plates

limiter le bruit de la stochasticit  e

(cid:73) on veut aller vite quand tous les gradients sont d   accord

(cid:73) on veut aller lentement quand les gradients sont en d  esaccord

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

32 / 39

id  ee 3: utiliser la m  emoire

r  esoudre le mauvais conditionnement

(cid:73) on veut r  eduire    dans les directions courb  ees

(cid:73) on veut augmenter    dans les directions plates

limiter le bruit de la stochasticit  e

(cid:73) on veut aller vite quand tous les gradients sont d   accord

(cid:73) on veut aller lentement quand les gradients sont en d  esaccord

ces deux propri  et  es demandent de la m  emoire.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

32 / 39

momentum [nes83]

momentum garde une m  emoire des gradients pass  es

ajout d   un terme de v  elocit  e vt

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

33 / 39

momentum [nes83]

momentum garde une m  emoire des gradients pass  es

ajout d   un terme de v  elocit  e vt

(cid:73) initialisation: v0 = 0,   0.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

33 / 39

momentum [nes83]

momentum garde une m  emoire des gradients pass  es

ajout d   un terme de v  elocit  e vt

(cid:73) initialisation: v0 = 0,   0.
(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

33 / 39

momentum [nes83]

momentum garde une m  emoire des gradients pass  es

ajout d   un terme de v  elocit  e vt

(cid:73) initialisation: v0 = 0,   0.
(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )

(cid:73) mise `a jour de la v  elocit  e: vt =   vt   1 + g(  t )

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

33 / 39

momentum [nes83]

momentum garde une m  emoire des gradients pass  es

ajout d   un terme de v  elocit  e vt

(cid:73) initialisation: v0 = 0,   0.
(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )

(cid:73) mise `a jour de la v  elocit  e: vt =   vt   1 + g(  t )
(cid:73) mise `a jour:   t+1 =   t       vt

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

33 / 39

momentum [nes83]

momentum garde une m  emoire des gradients pass  es

ajout d   un terme de v  elocit  e vt

(cid:73) initialisation: v0 = 0,   0.
(cid:73) calcul du gradient: g(  t ) = f (cid:48)(  t )

(cid:73) mise `a jour de la v  elocit  e: vt =   vt   1 + g(  t )
(cid:73) mise `a jour:   t+1 =   t       vt

ajout d   un deuxi`eme hyperparam`etre.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

33 / 39

1 optimisation simple

2 trois dif   cult  es

3 trouver un bon optimiseur

4 commentaires additionnels

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

34 / 39

g  en  eralisation

but de l   apprentissage est de bien g  en  eraliser

aucune diff  erence dans le monde convexe

optimiseur a un impact sur la g  en  eralisation dans les r  eseaux profonds

raison encore peu claire

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

35 / 39

robustesse: un point essentiel

pas les m  emes qualit  es n  ecessaires pour un entra    nement unique et pour un entra    nement

r  egulier

la dif   cult  e de r  eglage est un point critique qui n   appara    t pas dans les courbes

attention aux modi   cations du pas de gradient pendant l   optimisation [th12]

l   erreur qui vous importe est l   erreur de g  en  eralisation, pas d   entra    nement

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

36 / 39

merci !

nlr@google.com

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

37 / 39

r  ef  erences i

sanjeev arora, moritz hardt, and nisheeth vishnoi.    off the convex path   .

in: (2017). url: http://www.offconvex.org.

yoshua bengio et al.    greedy layer-wise training of deep networks   .

in: advances in neural information processing systems. 2007, pp. 153   160.

olivier bousquet and l  eon bottou.    the tradeoffs of large scale learning   .

in: advances in neural information processing systems. 2008, pp. 161   168.

augustin louis cauchy.    m  ethode g  en  erale pour la r  esolution des syst`emes d     equations simultan  ees   . in: comptes rendus des s  eances de l   acad  emie des sciences de paris 25 (1847),

pp. 536   538.

anna choromanska et al.    the loss surfaces of multilayer networks   .

in: arti   cial intelligence and statistics. 2015, pp. 192   204.

yann n dauphin et al.    identifying and attacking the saddle point problem in high-dimensional non-id76   . in: advances in neural information processing systems. 2014,

pp. 2933   2941.

john duchi, elad hazan, and yoram singer.    adaptive subgradient methods for online learning and stochastic optimization   . in: journal of machine learning research 12.jul (2011),

pp. 2121   2159.

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

38 / 39

r  ef  erences ii

sergey ioffe and christian szegedy.    batch id172: accelerating deep network training by reducing internal covariate shift   . in: international conference on machine learning.

2015, pp. 448   456.

diederik kingma and jimmy ba.    adam: a method for stochastic optimization   .

in: arxiv preprint arxiv:1412.6980 (2014).

yann a lecun et al.    ef   cient backprop   . in: neural networks: tricks of the trade. springer, 1998.

yurii nesterov.    a method of solving a convex programming problem with convergence rate o(1/k2)   .

in: soviet mathematics doklady. vol. 27. 2. 1983, pp. 372   376.

herbert robbins and sutton monro.    a stochastic approximation method   .

in: annals of mathematical statistics 22.3 (1951), pp. 400   407.

tijmen tieleman and geoffrey hinton.    lecture 6: neural networks for machine learning   .

in: coursera (2012). url:

http://www.cs.toronto.edu/  tijmen/csc321/slides/lecture_slides_lec6.pdf.

ashia c wilson et al.    the marginal value of adaptive gradient methods in machine learning   .

in: arxiv preprint arxiv:1705.08292 (2017).

nicolas le roux (google brain team)

optimisation pour les r  eseaux profonds

6/3/18

39 / 39

