structuredbayesiannonparametricmodelswithvariationalid136acltutorialprague,czechrepublicjune24,2007percylianganddankleinprobabilisticmodelingofnlp   documentid91   topicmodeling   languagemodeling   part-of-speechinduction   parsingandgrammarinduction   wordsegmentation   wordalignment   documentsummarization   coreferenceresolution   etc.2probabilisticmodelingofnlp   documentid91   topicmodeling   languagemodeling   part-of-speechinduction   parsingandgrammarinduction   wordsegmentation   wordalignment   documentsummarization   coreferenceresolution   etc.recentinterestinbayesiannonparametricmethods2amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood3amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood11-364-3643amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-36422-204-2043amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-3642-20444-82-823amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-3642-2044-82121221213amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-3642-2044-821221202086863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-3642-2044-82122120863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-3642-2044-82122120863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood11-364-368-3682-2044-82122120863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-364-36822-204-206-2064-82122120863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-364-3682-204-20644-82-128-128122120863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-364-3682-204-2064-82-128121221-147-14720863amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-364-3682-204-2064-82-1281221-147202086-173-1733amotivatingexamplehowmanyclusters?ktraininglog-likelihoodtestlog-likelihood1-364-3682-204-2064-82-1281221-1472086-1733modelselection:traditionalsolutionsde   neansequenceofmodelsofincreasingcomplexity  14modelselection:traditionalsolutionsde   neansequenceofmodelsofincreasingcomplexity  1  24modelselection:traditionalsolutionsde   neansequenceofmodelsofincreasingcomplexity  1  2  3  4...4modelselection:traditionalsolutionsde   neansequenceofmodelsofincreasingcomplexity  1  2  3  4...   cross-validation:selectamodelbasedonlikelihoodonheldoutset4modelselection:traditionalsolutionsde   neansequenceofmodelsofincreasingcomplexity  1  2  3  4...   cross-validation:selectamodelbasedonlikelihoodonheldoutset   bayesianmodelselection:usemarginallikelihoodorminimumdescriptionlength4modelselection:traditionalsolutionsde   neansequenceofmodelsofincreasingcomplexity  1  2  3  4...   cross-validation:selectamodelbasedonlikelihoodonheldoutset   bayesianmodelselection:usemarginallikelihoodorminimumdescriptionlengthdiscreteoptimization:combinatorialsearchovermodels4anonparametricbayesianapproachde   neonemodelwithanin   nitenumberofclustersbutpenalizetheuseofmoreclusters.  5anonparametricbayesianapproachde   neonemodelwithanin   nitenumberofclustersbutpenalizetheuseofmoreclusters.  thispenaltyisaccomplishedwiththedirichletprocess.5anonparametricbayesianapproachde   neonemodelwithanin   nitenumberofclustersbutpenalizetheuseofmoreclusters.  thispenaltyisaccomplishedwiththedirichletprocess.continuousoptimization:modelcomplexitygovernedbymagnitudeofparameters5anonparametricbayesianapproachde   neonemodelwithanin   nitenumberofclustersbutpenalizetheuseofmoreclusters.  thispenaltyisaccomplishedwiththedirichletprocess.continuousoptimization:modelcomplexitygovernedbymagnitudeofparametersadvantages:   worksonstructuredmodels   allowsem-liketools5trueorfalse?1.beingbayesianisjustabouthavingpriors.2.bayesianmethodsareslow.3.nonparametricmeansnoparameters.4.variationalid136iscomplicatedandforeign.6trueorfalse?1.beingbayesianisjustabouthavingpriors.beingbayesianisaboutmanaginguncertainty.2.bayesianmethodsareslow.3.nonparametricmeansnoparameters.4.variationalid136iscomplicatedandforeign.6trueorfalse?1.beingbayesianisjustabouthavingpriors.beingbayesianisaboutmanaginguncertainty.2.bayesianmethodsareslow.bayesianmethodscanbejustasfastasem.3.nonparametricmeansnoparameters.4.variationalid136iscomplicatedandforeign.6trueorfalse?1.beingbayesianisjustabouthavingpriors.beingbayesianisaboutmanaginguncertainty.2.bayesianmethodsareslow.bayesianmethodscanbejustasfastasem.3.nonparametricmeansnoparameters.nonparametricmeansthenumberofe   ectiveparametersgrowsadaptivelywiththedata.4.variationalid136iscomplicatedandforeign.6trueorfalse?1.beingbayesianisjustabouthavingpriors.beingbayesianisaboutmanaginguncertainty.2.bayesianmethodsareslow.bayesianmethodscanbejustasfastasem.3.nonparametricmeansnoparameters.nonparametricmeansthenumberofe   ectiveparametersgrowsadaptivelywiththedata.4.variationalid136iscomplicatedandforeign.variationalid136isanaturalextensionofem.6tutorialoutline   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplications7roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationsparti8roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationsparti/distributionsandbayesianprinciples9twoparadigmstraditional(frequentist)approachdataxmaximumlikelihood       parti/distributionsandbayesianprinciples10twoparadigmstraditional(frequentist)approachdataxmaximumlikelihood       bayesianapproachdataxbayesianid136q(  )  parti/distributionsandbayesianprinciples10twoparadigmstraditional(frequentist)approachdataxmaximumlikelihood       bayesianapproachdataxbayesianid136q(  )  anexample:coin   ips(data):x=hthhid203ofh(parameter):  =34?46?parti/distributionsandbayesianprinciples10twoparadigmstraditional(frequentist)approachdataxmaximumlikelihood       bayesianapproachdataxbayesianid136q(  )  anexample:coin   ips(data):x=hthhid203ofh(parameter):  =34?46?weneedanotionofdistributionsoverparameters...parti/distributionsandbayesianprinciples10multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:0101  1  2parti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      1230101  1  2parti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      123  =      0.20.50.3      1230101  1  2parti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      123  =      0.20.50.3      1230101  1  2p(z)parti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      123  =      0.20.50.3      1230101  1  2p(z)   p(z|  )parti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      123  =      0.20.50.3      1230101  1  2p(z)   p(z|  )     zparti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      123  =      0.20.50.3      1230101  1  2p(z)   p(z|  )     zarandomdrawzfromamultinomialdistributioniswritten:z   multinomial(  ).parti/distributionsandbayesianprinciples11multinomialdistributionmostparametersinnlparedistributionsp(z)overdiscreteobjectsz   {1,...,k}.possiblep(z)sarethepoints  sonthesimplex.fork=3:  =      010      123  =      0.20.50.3      1230101  1  2p(z)   p(z|  )     zarandomdrawzfromamultinomialdistributioniswritten:z   multinomial(  ).ifwedrawsomenumberofindependentsamplesfrommultinomial(  ),theid203ofobservingczcountsofobservationzisproportionalto:  1c1        kckparti/distributionsandbayesianprinciples11distributionsovermultinomialparametersadirichletdistributionisadistributionovermultinomialparameters  inthesimplex.parti/distributionsandbayesianprinciples12distributionsovermultinomialparametersadirichletdistributionisadistributionovermultinomialparameters  inthesimplex.likeagaussian,there   sanotionofmeanandvariance.di   erentmeans:0101  1  20101  1  20101  1  20101  1  20101  1  2parti/distributionsandbayesianprinciples12distributionsovermultinomialparametersadirichletdistributionisadistributionovermultinomialparameters  inthesimplex.likeagaussian,there   sanotionofmeanandvariance.di   erentmeans:0101  1  20101  1  20101  1  20101  1  20101  1  2di   erentvariances:0101  1  20101  1  20101  1  20101  1  20101  1  2parti/distributionsandbayesianprinciples12dirichletdistributionadirichletisspeci   edbyconcentrationparameters:  =(  1,...,  k),  z   0parti/distributionsandbayesianprinciples13dirichletdistributionadirichletisspeci   edbyconcentrationparameters:  =(  1,...,  k),  z   0mean:(cid:16)  1pz  z,...,  npz  z(cid:17)variance:larger  s   smallervarianceparti/distributionsandbayesianprinciples13dirichletdistributionadirichletisspeci   edbyconcentrationparameters:  =(  1,...,  k),  z   0mean:(cid:16)  1pz  z,...,  npz  z(cid:17)variance:larger  s   smallervarianceadirichletdraw  iswritten     dirichlet(  ),whichmeansp(  |  )     1  1   1        k  k   1parti/distributionsandbayesianprinciples13dirichletdistributionadirichletisspeci   edbyconcentrationparameters:  =(  1,...,  k),  z   0mean:(cid:16)  1pz  z,...,  npz  z(cid:17)variance:larger  s   smallervarianceadirichletdraw  iswritten     dirichlet(  ),whichmeansp(  |  )     1  1   1        k  k   1thedirichletdistributionassignsid203masstomultinomialsthatarelikelytoyieldpseudocounts(  1   1,...,  k   1).parti/distributionsandbayesianprinciples13dirichletdistributionadirichletisspeci   edbyconcentrationparameters:  =(  1,...,  k),  z   0mean:(cid:16)  1pz  z,...,  npz  z(cid:17)variance:larger  s   smallervarianceadirichletdraw  iswritten     dirichlet(  ),whichmeansp(  |  )     1  1   1        k  k   1thedirichletdistributionassignsid203masstomultinomialsthatarelikelytoyieldpseudocounts(  1   1,...,  k   1).mode:(cid:16)  1   1pz(  z   1),...,  n   1pz(  z   1)(cid:17)parti/distributionsandbayesianprinciples13drawsfromdirichletdistributionsdirichlet(1,1,1)0101  1  2parti/distributionsandbayesianprinciples14drawsfromdirichletdistributionsdirichlet(1,1,1)0101  1  2dirichlet(5,10,8)0101  1  2parti/distributionsandbayesianprinciples14drawsfromdirichletdistributionsdirichlet(.5,.5,.5)0101  1  2dirichlet(1,1,1)0101  1  2dirichlet(5,10,8)0101  1  2parti/distributionsandbayesianprinciples14thebayesianparadigmdataxbayesianid136q(  )whatisq(  )?parti/distributionsandbayesianprinciples15thebayesianparadigmdataxbayesianid136q(  )whatisq(  )?q(  )def=p(  |x)|{z}posterior=1p(x)p(  )|{z}priorp(x|  )|{z}likelihoodparti/distributionsandbayesianprinciples15posteriorupdatingfordirichletdistributionsmodel:     dirichlet3(0.5,0.5,0.5|{z}  )x   multinomial73(  )parti/distributionsandbayesianprinciples16posteriorupdatingfordirichletdistributionsmodel:     dirichlet3(0.5,0.5,0.5|{z}  )x   multinomial73(  )prior:p(  )     a0.5   1  b0.5   1  c0.5   10101  a  bparti/distributionsandbayesianprinciples16posteriorupdatingfordirichletdistributionsmodel:     dirichlet3(0.5,0.5,0.5|{z}  )x   multinomial73(  )prior:p(  )     a0.5   1  b0.5   1  c0.5   10101  a  blikelihood:p(x|  )=  a2  b4  c1abbcabbparti/distributionsandbayesianprinciples16posteriorupdatingfordirichletdistributionsmodel:     dirichlet3(0.5,0.5,0.5|{z}  )x   multinomial73(  )prior:p(  )     a0.5   1  b0.5   1  c0.5   10101  a  blikelihood:p(x|  )=  a2  b4  c1abbcabbposterior:p(  |x)     a2.5   1  b4.5   1  c1.5   10101  a  bresult:p(  |x)=dirichlet(2.5,4.5,1.5)parti/distributionsandbayesianprinciples16atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abparti/distributionsandbayesianprinciples17atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abzi   multinomial(12,12)2parti/distributionsandbayesianprinciples17atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abzi   multinomial(12,12)2xi   multinomial5(  zi)aabbaparti/distributionsandbayesianprinciples17atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abzi   multinomial(12,12)2xi   multinomial5(  zi)aabbaobserveddata:x1=abbbbx2=abbbbx3=baaaaparti/distributionsandbayesianprinciples17atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abzi   multinomial(12,12)2xi   multinomial5(  zi)aabbaobserveddata:x1=abbbbx2=abbbbx3=baaaaunknownparameters:  =(  1,  2)parti/distributionsandbayesianprinciples17atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abzi   multinomial(12,12)2xi   multinomial5(  zi)aabbaobserveddata:x1=abbbbx2=abbbbx3=baaaaunknownparameters:  =(  1,  2)0.00.20.40.60.81.00.00.20.40.60.81.0  1  2p(  |x)parti/distributionsandbayesianprinciples17atwo-componentmixturemodel  1   dirichlet(1,1)ab  2   dirichlet(1,1)abzi   multinomial(12,12)2xi   multinomial5(  zi)aabbaobserveddata:x1=abbbbx2=abbbbx3=baaaaunknownparameters:  =(  1,  2)0.00.20.40.60.81.00.00.20.40.60.81.0  1  2p(  |x)   trueposteriorp(  |x)hassymmetries     1explainsx1,x2and  2explainsx3inuppermode(orvice-versainlowermode)   thecomponentexplainingx3hashigheruncertaintyparti/distributionsandbayesianprinciples17usingtheposteriorforpredictionsetup:assumeajointprobabilisticmodelp(  )p(x,y|  )overinputx,outputy,parameters  .trainingexamples:(x1,y1),...,(xn,yn)testinput:xnewparti/distributionsandbayesianprinciples18usingtheposteriorforpredictionsetup:assumeajointprobabilisticmodelp(  )p(x,y|  )overinputx,outputy,parameters  .trainingexamples:(x1,y1),...,(xn,yn)testinput:xnewtraditional:ynew   =argmaxynewp(ynew|xnew,  )parti/distributionsandbayesianprinciples18usingtheposteriorforpredictionsetup:assumeajointprobabilisticmodelp(  )p(x,y|  )overinputx,outputy,parameters  .trainingexamples:(x1,y1),...,(xn,yn)testinput:xnewtraditional:ynew   =argmaxynewp(ynew|xnew,  )bayes-optimalprediction:ynew   =argmaxynewp(ynew|xnew,{(xi,yi)})parti/distributionsandbayesianprinciples18usingtheposteriorforpredictionsetup:assumeajointprobabilisticmodelp(  )p(x,y|  )overinputx,outputy,parameters  .trainingexamples:(x1,y1),...,(xn,yn)testinput:xnewtraditional:ynew   =argmaxynewp(ynew|xnew,  )bayes-optimalprediction:ynew   =argmaxynewp(ynew|xnew,{(xi,yi)})explicitlywriteouttheintegratedparameters:p(ynew|xnew,{(xi,yi)})=rp(ynew|xnew,  )p(  |{(xi,yi)})|{z}posteriord  parti/distributionsandbayesianprinciples18usingtheposteriorforpredictionsetup:assumeajointprobabilisticmodelp(  )p(x,y|  )overinputx,outputy,parameters  .trainingexamples:(x1,y1),...,(xn,yn)testinput:xnewtraditional:ynew   =argmaxynewp(ynew|xnew,  )bayes-optimalprediction:ynew   =argmaxynewp(ynew|xnew,{(xi,yi)})explicitlywriteouttheintegratedparameters:p(ynew|xnew,{(xi,yi)})=rp(ynew|xnew,  )p(  |{(xi,yi)})|{z}posteriord  wecanpluginanapproximateposterior:p(ynew|xnew,{(xi,yi)})=rp(ynew|xnew,  )qapprox(  )d  parti/distributionsandbayesianprinciples18roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationsparti/variationalbayesianid13619variationalbayesianid136goalofbayesianid136:computeposteriorp(  ,z|x)parti/variationalbayesianid13620variationalbayesianid136goalofbayesianid136:computeposteriorp(  ,z|x)variationalid136isaframeworkforapproximatingthe:trueposteriorwiththebestfromasetofdistributionsq:parti/variationalbayesianid13620variationalbayesianid136goalofbayesianid136:computeposteriorp(  ,z|x)variationalid136isaframeworkforapproximatingthe:trueposteriorwiththebestfromasetofdistributionsq:q   =argminq   qkl(q(  ,z)||p(  ,z|x))qp(  ,z|x)q   (  ,z)parti/variationalbayesianid13620typesofvariationalapproximationsq   =argminq   qkl(q(  ,z)||p(  ,z|x))whattypesofqcanweconsider?q(  ,z)=q(  )q(z)parti/variationalbayesianid13621typesofvariationalapproximationsq   =argminq   qkl(q(  ,z)||p(  ,z|x))whattypesofqcanweconsider?q(  ,z)=q(  )q(z)hardemparti/variationalbayesianid13621typesofvariationalapproximationsq   =argminq   qkl(q(  ,z)||p(  ,z|x))whattypesofqcanweconsider?q(  ,z)=q(  )q(z)hardememparti/variationalbayesianid13621typesofvariationalapproximationsq   =argminq   qkl(q(  ,z)||p(  ,z|x))whattypesofqcanweconsider?q(  ,z)=q(  )q(z)hardememmean-   eldparti/variationalbayesianid13621heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepparti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzz   =argmaxzp(z|     ,x)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)findbestdistrib.overzq(z)      p(z|  ,x)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)findbestdistrib.overztakedistrib.intoaccountq(z)      p(z|  ,x)     =argmax  pzq(z)p(  |z,x)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)findbestdistrib.overztakedistrib.intoaccountq(z)      p(z|  ,x)     =argmax  pzq(z)p(  |z,x)     =argmax  qzp(  |z,x)q(z)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)findbestdistrib.overztakedistrib.intoaccountq(z)      p(z|  ,x)     =argmax  pzq(z)p(  |z,x)     =argmax  qzp(  |z,x)q(z)findbestdistrib.over  q(  )      qzp(  |z,x)q(z)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)findbestdistrib.overztakedistrib.intoaccountq(z)      p(z|  ,x)     =argmax  pzq(z)p(  |z,x)     =argmax  qzp(  |z,x)q(z)takedistrib.intoaccountfindbestdistrib.over  q(z)      q  p(z|  ,x)q(  )q(  )      qzp(  |z,x)q(z)parti/variationalbayesianid13622heuristicderivationofmean-   eldalgorithmtemplate:iteratebetweenthee-stepandm-step.letus   rstheuristicallyderivethemean-   eldalgorithm.e-stepm-stepfindbestzfindbest  z   =argmaxzp(z|     ,x)     =argmax  p(  |z   ,x)findbestdistrib.overztakedistrib.intoaccountq(z)      p(z|  ,x)     =argmax  pzq(z)p(  |z,x)     =argmax  qzp(  |z,x)q(z)takedistrib.intoaccountfindbestdistrib.over  q(z)      q  p(z|  ,x)q(  )q(  )      qzp(  |z,x)q(z)in   niteproductover  hasclosedformifq(  )isadirichlet.parti/variationalbayesianid13622formalderivationofmean-   eldq   =argminq   qkl(q(  ,z)||p(  ,z|x))steps:1.formulateasanoptimizationproblem(variationalprinciple)2.relaxtheoptimizationproblem(e.g.,mean-   eld)3.solveusingcoordinate-wisedescentparti/variationalbayesianid13623kullback-leiblerdivergenceklmeasureshowdi   erenttwodistributionspandqare.de   nition:kl(q||p)def=eqlogq(  )p(  )parti/variationalbayesianid13624kullback-leiblerdivergenceklmeasureshowdi   erenttwodistributionspandqare.de   nition:kl(q||p)def=eqlogq(  )p(  )animportantproperty:kl(q||p)   0kl(q||p)=0ifandonlyifq=pparti/variationalbayesianid13624kullback-leiblerdivergenceklmeasureshowdi   erenttwodistributionspandqare.de   nition:kl(q||p)def=eqlogq(  )p(  )animportantproperty:kl(q||p)   0kl(q||p)=0ifandonlyifq=pklisasymmetric:assumingkl(q||p)<   ,p(  )=0   q(  )=0[q         p]parti/variationalbayesianid13624minimizingwithrespecttoklsincekl=0exactlywhentwoargumentsareequal,wehave:p=argminq   qallkl(q||p)andp=argminq   qallkl(p||q)whereqallisallpossibledistributions.parti/variationalbayesianid13625minimizingwithrespecttoklsincekl=0exactlywhentwoargumentsareequal,wehave:p=argminq   qallkl(q||p)andp=argminq   qallkl(p||q)whereqallisallpossibledistributions.asymmetryrevealedwhenwereplaceqallwithq(qall.parti/variationalbayesianid13625minimizingwithrespecttoklsincekl=0exactlywhentwoargumentsareequal,wehave:p=argminq   qallkl(q||p)andp=argminq   qallkl(p||q)whereqallisallpossibledistributions.asymmetryrevealedwhenwereplaceqallwithq(qall.letp=9.819.60.10.3pandq=allpossiblegaussiansparti/variationalbayesianid13625minimizingwithrespecttoklsincekl=0exactlywhentwoargumentsareequal,wehave:p=argminq   qallkl(q||p)andp=argminq   qallkl(p||q)whereqallisallpossibledistributions.asymmetryrevealedwhenwereplaceqallwithq(qall.letp=9.819.60.10.3pandq=allpossiblegaussiansq1=argminq   qkl(q||p)(mode-   nding):9.819.60.20.4pq1parti/variationalbayesianid13625minimizingwithrespecttoklsincekl=0exactlywhentwoargumentsareequal,wehave:p=argminq   qallkl(q||p)andp=argminq   qallkl(p||q)whereqallisallpossibledistributions.asymmetryrevealedwhenwereplaceqallwithq(qall.letp=9.819.60.10.3pandq=allpossiblegaussiansq1=argminq   qkl(q||p)(mode-   nding):9.819.60.20.4pq1q2=argminq   qkl(p||q)(mean-   nding):9.819.60.10.3pq2parti/variationalbayesianid13625step1:formulateasoptimizationproblemvariationalprinciple:writethequantitywewishtocomputeasthesolutionofanoptimizationproblem:q   def=argminq   qallkl(q(  )||p(  |x)),whereqallissetofalldistributionsoverparameters.parti/variationalbayesianid13626step1:formulateasoptimizationproblemvariationalprinciple:writethequantitywewishtocomputeasthesolutionofanoptimizationproblem:q   def=argminq   qallkl(q(  )||p(  |x)),whereqallissetofalldistributionsoverparameters.solution:q   (  )=p(  |x),whichachieveskl=0.thisisnotveryusefulyetbecauseq   isjustashardtocompute...parti/variationalbayesianid13626step1:formulateasoptimizationproblemvariationalprinciple:writethequantitywewishtocomputeasthesolutionofanoptimizationproblem:q   def=argminq   qallkl(q(  )||p(  |x)),whereqallissetofalldistributionsoverparameters.solution:q   (  )=p(  |x),whichachieveskl=0.thisisnotveryusefulyetbecauseq   isjustashardtocompute...id172ofpnotneeded:argminqkl(q(  )||p(  |x))=argminqkl(q(  )||p(  ,x))parti/variationalbayesianid13626step2:relaxtheoptimizationproblemq   def=argminq   qallkl(q(  )||p(  |x))qallpqall=alldistributions0.00.20.40.60.81.00.00.20.40.60.81.0  1  2p(  |x)0.00.20.40.60.81.00.00.20.40.60.81.0  1  2optimalq   (  )parti/variationalbayesianid13627step2:relaxtheoptimizationproblemq   def=argminq   qdegkl(q(  )||p(  |x))qallpqdegq   qdeg=nq:q(  )=       (  )o0.00.20.40.60.81.00.00.20.40.60.81.0  1  2p(  |x)0.00.20.40.60.81.00.00.20.40.60.81.0  1  2degenerateq   (  )parti/variationalbayesianid13627step2:relaxtheoptimizationproblemq   def=argminq   qmfkl(q(  )||p(  |x))qallpqdegqmfq   qmf=nq:q(  )=nyi=1qi(  i)o0.00.20.40.60.81.00.00.20.40.60.81.0  1  2p(  |x)0.00.20.40.60.81.00.00.20.40.60.81.0  1  2mean-   eldq   (  )parti/variationalbayesianid13627step3:coordinate-wisedescentgoal:minimizekl(q(  )||p(  |x))subjecttoq   qassume:q(  )=qiqi(  i)parti/variationalbayesianid13628step3:coordinate-wisedescentgoal:minimizekl(q(  )||p(  |x))subjecttoq   qassume:q(  )=qiqi(  i)algorithm:foreachi,optimizeqi(  i)holdingallothercoordinatesq   i(     i)   xed.parti/variationalbayesianid13628step3:coordinate-wisedescentgoal:minimizekl(q(  )||p(  |x))subjecttoq   qassume:q(  )=qiqi(  i)algorithm:foreachi,optimizeqi(  i)holdingallothercoordinatesq   i(     i)   xed.ifqisdegenerate(qi(  i)=       i(  i)):     i=argmax  ip(  i|        i,x)parti/variationalbayesianid13628step3:coordinate-wisedescentgoal:minimizekl(q(  )||p(  |x))subjecttoq   qassume:q(  )=qiqi(  i)algorithm:foreachi,optimizeqi(  i)holdingallothercoordinatesq   i(     i)   xed.ifqisdegenerate(qi(  i)=       i(  i)):     i=argmax  ip(  i|        i,x)ifqisnon-degenerate:qi(  i)   exp{eq   ilogp(  i|     i,x)}parti/variationalbayesianid13628mean-   eldrecipeqi(  i)   exp{eq   ilogp(  i|     i,x)}   exp{eq   ilogp(  ,x)}parti/variationalbayesianid13629mean-   eldrecipeqi(  i)   exp{eq   ilogp(  i|     i,x)}   exp{eq   ilogp(  ,x)}recipeforupdatingqi:1.writedownalltheunobservedvariablesinthemodel(includingparametersandlatentvariables)2.foreachvariable  i:a.writedownonlythefactorsofthejointdistributionthatcontain  ib.setqi   exp{eq   ilog(thosefactors)}parti/variationalbayesianid13629non-bayesianvariationalid136               thee-step(computingp(z|x))issometimesintractablewhentherearelong-rangedependenciesparti/variationalbayesianid13630non-bayesianvariationalid136               thee-step(computingp(z|x))issometimesintractablewhentherearelong-rangedependencies   variationalem:approximatee-stepusingargminqkl(q(z)||p(z|x))parti/variationalbayesianid13630non-bayesianvariationalid136               thee-step(computingp(z|x))issometimesintractablewhentherearelong-rangedependencies   variationalem:approximatee-stepusingargminqkl(q(z)||p(z|x))   variationalem   tsintothegeneralvariationalframework:onetrueposterior,variousapproximatingfamiliesparti/variationalbayesianid13630roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationsparti/mean-   eldformixturemodels31bayesian   nitemixturemodel  zixiin  zzkparameters:  =(  ,  )=(  1,...,  k,  1,...,  k)hiddenvariables:z=(z1,...,zn)observeddata:x=(x1,...,xn)p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)parti/mean-   eldformixturemodels32bayesian   nitemixturemodel  zixiin  zzkparameters:  =(  ,  )=(  1,...,  k,  1,...,  k)hiddenvariables:z=(z1,...,zn)observeddata:x=(x1,...,xn)p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)     dirichletk(  0,...,  0)foreachcomponentz   {1,...,k}:  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)priorovercomponentparameters:g0(e.g.,dirichletv(  0,...,  0))datamodel:f(e.g.,multinomial)parti/mean-   eldformixturemodels32bayesian   nitemixturemodelrunningexample:documentid91parti/mean-   eldformixturemodels33bayesian   nitemixturemodelrunningexample:documentid91     dirichletk(  0,...,  0)[drawcomponentprobabilities]parti/mean-   eldformixturemodels33bayesian   nitemixturemodelrunningexample:documentid91     dirichletk(  0,...,  0)[drawcomponentprobabilities]k=2clusters  :12parti/mean-   eldformixturemodels33bayesian   nitemixturemodelrunningexample:documentid91     dirichletk(  0,...,  0)[drawcomponentprobabilities]k=2clusters  :12foreachcomponent(cluster)z   {1,...,k}:  z   dirichletv(  0,...,  0)[drawcomponentparameter]parti/mean-   eldformixturemodels33bayesian   nitemixturemodelrunningexample:documentid91     dirichletk(  0,...,  0)[drawcomponentprobabilities]k=2clusters  :12foreachcomponent(cluster)z   {1,...,k}:  z   dirichletv(  0,...,  0)[drawcomponentparameter]v=3wordtypes  1:abc  2:abcparti/mean-   eldformixturemodels33bayesian   nitemixturemodelrunningexample:documentid91     dirichletk(  0,...,  0)[drawcomponentprobabilities]k=2clusters  :12foreachcomponent(cluster)z   {1,...,k}:  z   dirichletv(  0,...,  0)[drawcomponentparameter]v=3wordtypes  1:abc  2:abcforeachdatapoint(document)i   {1,...,n}:zi   multinomialk(  )[choosecomponent]xi   multinomialmv(  zi)[generatedata]parti/mean-   eldformixturemodels33bayesian   nitemixturemodelrunningexample:documentid91     dirichletk(  0,...,  0)[drawcomponentprobabilities]k=2clusters  :12foreachcomponent(cluster)z   {1,...,k}:  z   dirichletv(  0,...,  0)[drawcomponentparameter]v=3wordtypes  1:abc  2:abcforeachdatapoint(document)i   {1,...,n}:zi   multinomialk(  )[choosecomponent]xi   multinomialmv(  zi)[generatedata]n=5documentsm=4words/docz1:2x1:ccacz2:2x2:ccacz3:1x3:aabbz4:2x4:caccz5:1x5:acbbparti/mean-   eldformixturemodels33hardemforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)parti/mean-   eldformixturemodels34hardemforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)approximation:q(  ,z)=q(  )|{z}       (  )qkz=1q(  z)|{z}       z(  z)qni=1q(zi)|{z}  z   i(zi)parti/mean-   eldformixturemodels34hardemforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)approximation:q(  ,z)=q(  )|{z}       (  )qkz=1q(  z)|{z}       z(  z)qni=1q(zi)|{z}  z   i(zi)e-step:foreachdatapointi   {1,...,n}:zi   =argmaxzip(zi|     ,x)=argmaxzip(zi|     )p(xi|  zi)parti/mean-   eldformixturemodels34hardemforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)approximation:q(  ,z)=q(  )|{z}       (  )qkz=1q(  z)|{z}       z(  z)qni=1q(zi)|{z}  z   i(zi)e-step:foreachdatapointi   {1,...,n}:zi   =argmaxzip(zi|     ,x)=argmaxzip(zi|     )p(xi|  zi)m-step:     =argmax  p(  |z   ,x)=argmax  p(  )qni=1p(z   i|  )parti/mean-   eldformixturemodels34hardemforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)approximation:q(  ,z)=q(  )|{z}       (  )qkz=1q(  z)|{z}       z(  z)qni=1q(zi)|{z}  z   i(zi)e-step:foreachdatapointi   {1,...,n}:zi   =argmaxzip(zi|     ,x)=argmaxzip(zi|     )p(xi|  zi)m-step:     =argmax  p(  |z   ,x)=argmax  p(  )qni=1p(z   i|  )foreachcomponentz   {1,...,k}:     z=argmax  p(  )qni=1p(xi|  )1[z   i=z]parti/mean-   eldformixturemodels34mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)=p(  )kyzi=1  zipni=1q(zi)parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)=p(  )kyzi=1  zipni=1q(zi)de   neexpectedcountsofcomponentz:cz=pni=1qzi(z)recalltheprior:p(  )=dirichlet(  ;  )   qkz=1  z     1parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)=p(  )kyzi=1  zipni=1q(zi)de   neexpectedcountsofcomponentz:cz=pni=1qzi(z)recalltheprior:p(  )=dirichlet(  ;  )   qkz=1  z     1prior:qkz=1  z     1parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)=p(  )kyzi=1  zipni=1q(zi)de   neexpectedcountsofcomponentz:cz=pni=1qzi(z)recalltheprior:p(  )=dirichlet(  ;  )   qkz=1  z     1prior:qkz=1  z     1   likelihood   :qkz=1  zczparti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)=p(  )kyzi=1  zipni=1q(zi)de   neexpectedcountsofcomponentz:cz=pni=1qzi(z)recalltheprior:p(  )=dirichlet(  ;  )   qkz=1  z     1prior:qkz=1  z     1   likelihood   :qkz=1  zcz   posterior   :qkz=1  z     1+czparti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)m-step:optimizeq(  z)andq(  )q(  )   yzp(  |z,x)q(z)   p(  )nyi=1kyzi=1p(zi|  )q(zi)=p(  )kyzi=1  zipni=1q(zi)de   neexpectedcountsofcomponentz:cz=pni=1qzi(z)recalltheprior:p(  )=dirichlet(  ;  )   qkz=1  z     1prior:qkz=1  z     1   likelihood   :qkz=1  zcz   posterior   :qkz=1  z     1+czconclusion:q(  )=dirichlet(  ;  +c)parti/mean-   eldformixturemodels35mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)e-step:optimizeq(zi)q(zi)   y  p(zi|  ,x)q(  )parti/mean-   eldformixturemodels36mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)e-step:optimizeq(zi)q(zi)   y  p(zi|  ,x)q(  )   y  p(zi|  )q(  )|{z}w(zi)y  zip(xi|  zi)q(  zi)|{z}w(xi|zi)parti/mean-   eldformixturemodels36mean-   eldforthe   nitemixturemodelmodel:p(  ,z,x)=p(  )kyz=1p(  z)nyi=1p(zi|  )p(xi|  zi)e-step:optimizeq(zi)q(zi)   y  p(zi|  ,x)q(  )   y  p(zi|  )q(  )|{z}w(zi)y  zip(xi|  zi)q(  zi)|{z}w(xi|zi)w(zi)w(xi|zi)islikep(zi)p(xi|zi),butmultinomialweightswtakesintoaccountuncertaintyin  .parti/mean-   eldformixturemodels36mean-   eld:computingmultinomialweightsw(z)=q  p(z|  )q(  )=exp{eq(  )logp(z|  )}parti/mean-   eldformixturemodels37mean-   eld:computingmultinomialweightsw(z)=q  p(z|  )q(  )=exp{eq(  )logp(z|  )}what   sq(  )?e-step:expectedcounts:cz=pni=1qzi(z)m-step:q(  )=dirichlet(  ;  +c|{z}  0)parti/mean-   eldformixturemodels37mean-   eld:computingmultinomialweightsw(z)=q  p(z|  )q(  )=exp{eq(  )logp(z|  )}what   sq(  )?e-step:expectedcounts:cz=pni=1qzi(z)m-step:q(  )=dirichlet(  ;  +c|{z}  0)mean-   eldmultinomialweight:w(z)=exp(  (  0z))exp(  (pkz0=1  0z))comparewithem(q(  )=       (  )isdegenerate):w(z)=     z=  0z   1pkz0=1(  0z0   1)parti/mean-   eldformixturemodels37mean-   eld:computingmultinomialweightsw(z)=q  p(z|  )q(  )=exp{eq(  )logp(z|  )}what   sq(  )?e-step:expectedcounts:cz=pni=1qzi(z)m-step:q(  )=dirichlet(  ;  +c|{z}  0)mean-   eldmultinomialweight:w(z)=exp(  (  0z))exp(  (pkz0=1  0z))comparewithem(q(  )=       (  )isdegenerate):w(z)=     z=  0z   1pkz0=1(  0z0   1)  (  )isthedigammafunctionandiseasytocompute.parti/mean-   eldformixturemodels37mean-   eldoverviewe-step:q(zi)   w(zi)w(xi|zi),w(z)=exp  (  z+cz)exp  (pkz0=1  z0+cz0)m-step:q(  )=dirichlet(  ;  +c),cz=pni=1qzi(z)parti/mean-   eldformixturemodels38mean-   eldoverviewe-step:q(zi)   w(zi)w(xi|zi),w(z)=exp  (  z+cz)exp  (pkz0=1  z0+cz0)m-step:q(  )=dirichlet(  ;  +c),cz=pni=1qzi(z)eme-stepq(zi)c     m-stepparti/mean-   eldformixturemodels38mean-   eldoverviewe-step:q(zi)   w(zi)w(xi|zi),w(z)=exp  (  z+cz)exp  (pkz0=1  z0+cz0)m-step:q(  )=dirichlet(  ;  +c),cz=pni=1qzi(z)emmean-   elde-stepq(zi)c     m-stepe-stepq(zi)cwq(  )m-stepparti/mean-   eldformixturemodels38roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartii39roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartii/emulatingdp-likequalitieswith   nitemixtures40interpretingmean-   eldthroughexp(  (  ))emwith  =1(maximumlikelihood):w(z)=czpkz0=1cz0partii/emulatingdp-likequalitieswith   nitemixtures41interpretingmean-   eldthroughexp(  (  ))emwith  =1(maximumlikelihood):w(z)=czpkz0=1cz00.40.81.21.62.0x0.40.81.21.62.0xexp(  (  ))exp(  (x))ux   0.5(forx>1)partii/emulatingdp-likequalitieswith   nitemixtures41interpretingmean-   eldthroughexp(  (  ))emwith  =1(maximumlikelihood):w(z)=czpkz0=1cz0mean-   eldwith  =1:w(z)=exp(  (1+cz))exp(  (1+pkz0=1cz0))(uadding0.5)0.40.81.21.62.0x0.40.81.21.62.0xexp(  (  ))exp(  (x))ux   0.5(forx>1)partii/emulatingdp-likequalitieswith   nitemixtures41interpretingmean-   eldthroughexp(  (  ))emwith  =1(maximumlikelihood):w(z)=czpkz0=1cz0mean-   eldwith  =1:w(z)=exp(  (1+cz))exp(  (1+pkz0=1cz0))(uadding0.5)mean-   eldwith  =0:w(z)=exp(  (cz))exp(  (pkz0=1cz0))(usubtracting0.5)0.40.81.21.62.0x0.40.81.21.62.0xexp(  (  ))exp(  (x))ux   0.5(forx>1)partii/emulatingdp-likequalitieswith   nitemixtures41therichgetricherwhathappenswhen  =0?e-step:q(zi)   w(zi)w(xi|zi)cz=pni=1q(zi)m-step:w(z)=exp(  (cz))exp(  (pkz0=1cz0))ucz   0.5(pkz0=1cz0)   0.5partii/emulatingdp-likequalitieswith   nitemixtures42therichgetricherwhathappenswhen  =0?e-step:q(zi)   w(zi)w(xi|zi)cz=pni=1q(zi)m-step:w(z)=exp(  (cz))exp(  (pkz0=1cz0))ucz   0.5(pkz0=1cz0)   0.5e   ectofmean-   eldwith  =0oncomponentprobabilities  ?thoughtexperiment:ignorew(xi|zi).partii/emulatingdp-likequalitieswith   nitemixtures42therichgetricherwhathappenswhen  =0?e-step:q(zi)   w(zi)w(xi|zi)cz=pni=1q(zi)m-step:w(z)=exp(  (cz))exp(  (pkz0=1cz0))ucz   0.5(pkz0=1cz0)   0.5e   ectofmean-   eldwith  =0oncomponentprobabilities  ?thoughtexperiment:ignorew(xi|zi).102030iteration246810countsczz=1z=2z=3z=4whensubtract0.5,smallcountsarehurtmorethanlargeones(likearegressivetax)partii/emulatingdp-likequalitieswith   nitemixtures42therichgetricherwhathappenswhen  =0?e-step:q(zi)   w(zi)w(xi|zi)cz=pni=1q(zi)m-step:w(z)=exp(  (cz))exp(  (pkz0=1cz0))ucz   0.5(pkz0=1cz0)   0.5e   ectofmean-   eldwith  =0oncomponentprobabilities  ?thoughtexperiment:ignorew(xi|zi).102030iteration246810countsczz=1z=2z=3z=4whensubtract0.5,smallcountsarehurtmorethanlargeones(likearegressivetax)thealgorithmachievessparsitybychoosingonecomponent.ingeneral,dataterm   ghtsthesparsityprior.partii/emulatingdp-likequalitieswith   nitemixtures42therichgetevenrichere-step:q(zi)   w(zi)w(xi|zi)czj=pni=1qzi(z)xijm-step:w(j|z)=exp(  (czj))exp(  (pvj0=1czj0))uczj   0.5(pvj0=1czj0)   0.5partii/emulatingdp-likequalitieswith   nitemixtures43therichgetevenrichere-step:q(zi)   w(zi)w(xi|zi)czj=pni=1qzi(z)xijm-step:w(j|z)=exp(  (czj))exp(  (pvj0=1czj0))uczj   0.5(pvj0=1czj0)   0.5thoughtexperiment:ignorew(zi),focusonw(xi|zi).supposec1a=20,c1b=20,c2a=0.5,c2b=0.2partii/emulatingdp-likequalitieswith   nitemixtures43therichgetevenrichere-step:q(zi)   w(zi)w(xi|zi)czj=pni=1qzi(z)xijm-step:w(j|z)=exp(  (czj))exp(  (pvj0=1czj0))uczj   0.5(pvj0=1czj0)   0.5thoughtexperiment:ignorew(zi),focusonw(xi|zi).supposec1a=20,c1b=20,c2a=0.5,c2b=0.2w(a|1)w(a|2)em:2020+20=0.50.50.5+0.2=0.71mean-   eld:e  (20+1)e  (20+20+1)=0.494e  (0.5+1)e  (0.5+0.2+1)=0.468partii/emulatingdp-likequalitieswith   nitemixtures43therichgetevenrichere-step:q(zi)   w(zi)w(xi|zi)czj=pni=1qzi(z)xijm-step:w(j|z)=exp(  (czj))exp(  (pvj0=1czj0))uczj   0.5(pvj0=1czj0)   0.5thoughtexperiment:ignorew(zi),focusonw(xi|zi).supposec1a=20,c1b=20,c2a=0.5,c2b=0.2w(a|1)w(a|2)em:2020+20=0.50.50.5+0.2=0.71mean-   eld:e  (20+1)e  (20+20+1)=0.494e  (0.5+1)e  (0.5+0.2+1)=0.468forobservationa:empreferscomponent2mean-   eldprefers1partii/emulatingdp-likequalitieswith   nitemixtures43therichgetevenrichere-step:q(zi)   w(zi)w(xi|zi)czj=pni=1qzi(z)xijm-step:w(j|z)=exp(  (czj))exp(  (pvj0=1czj0))uczj   0.5(pvj0=1czj0)   0.5thoughtexperiment:ignorew(zi),focusonw(xi|zi).supposec1a=20,c1b=20,c2a=0.5,c2b=0.2w(a|1)w(a|2)em:2020+20=0.50.50.5+0.2=0.71mean-   eld:e  (20+1)e  (20+20+1)=0.494e  (0.5+1)e  (0.5+0.2+1)=0.468forobservationa:empreferscomponent2mean-   eldprefers1keyproperty:multinomialweightsarenotnormalized,allowingglobaltradeo   sbetweencomponents.partii/emulatingdp-likequalitieswith   nitemixtures43example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.p(x,z;  )=nyi=1p(zi)p(xi|ezi;  )partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.p(x,z;  )=nyi=1p(zi)p(xi|ezi;  )e-step:qzi(j)   p(xi|ej)ce,x=pi,j:ej=e,xi=xqzi(j)partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.p(x,z;  )=nyi=1p(zi)p(xi|ezi;  )e-step:qzi(j)   p(xi|ej)ce,x=pi,j:ej=e,xi=xqzi(j)m-step:w(x|e)=ce,xpx0ce,x0partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.p(x,z;  )=nyi=1p(zi)p(xi|ezi;  )e-step:qzi(j)   p(xi|ej)ce,x=pi,j:ej=e,xi=xqzi(j)m-step:w(x|e)=ce,xpx0ce,x0garbagecollectorsproblem:raresourcewordshavelargeprobabilitiesfortargetwordsinthetranslation.partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.p(x,z;  )=nyi=1p(zi)p(xi|ezi;  )e-step:qzi(j)   p(xi|ej)ce,x=pi,j:ej=e,xi=xqzi(j)m-step:w(x|e)=ce,xpx0ce,x0exp(  (ce,x))exp(  (px0ce,x0))garbagecollectorsproblem:raresourcewordshavelargeprobabilitiesfortargetwordsinthetranslation.partii/emulatingdp-likequalitieswith   nitemixtures44example:ibmmodel1forwordalignmentwedeemeditinadvisabletoattendthemeetingandsoinformedcojo.nousneavonspascrubondeassister`alar  eunionetenavonsinform  elecojoencons  equence.p(x,z;  )=nyi=1p(zi)p(xi|ezi;  )e-step:qzi(j)   p(xi|ej)ce,x=pi,j:ej=e,xi=xqzi(j)m-step:w(x|e)=ce,xpx0ce,x0exp(  (ce,x))exp(  (px0ce,x0))garbagecollectorsproblem:raresourcewordshavelargeprobabilitiesfortargetwordsinthetranslation.quickexperiment:em:20.3aer,mean-   eld:19.0aerpartii/emulatingdp-likequalitieswith   nitemixtures44anapproximatedirichletprocess(dp)mixturemodeltake   nitemixturemodel,de   nep(  )=dirichlet(  0k,...,  0k)partii/emulatingdp-likequalitieswith   nitemixtures45anapproximatedirichletprocess(dp)mixturemodeltake   nitemixturemodel,de   nep(  )=dirichlet(  0k,...,  0k)theorem:ask      ,   nitemixturemodel   dpmixturemodel.partii/emulatingdp-likequalitieswith   nitemixtures45anapproximatedirichletprocess(dp)mixturemodeltake   nitemixturemodel,de   nep(  )=dirichlet(  0k,...,  0k)theorem:ask      ,   nitemixturemodel   dpmixturemodel.as  0k   0,mean-   eldentersrich-gets-richerregime.partii/emulatingdp-likequalitieswith   nitemixtures45anapproximatedirichletprocess(dp)mixturemodeltake   nitemixturemodel,de   nep(  )=dirichlet(  0k,...,  0k)theorem:ask      ,   nitemixturemodel   dpmixturemodel.as  0k   0,mean-   eldentersrich-gets-richerregime.howtobayesianify/dpifyyouremalgorithminthem-stepofemcodewherecountsarenormalized,replaceczpz0cz0withexp  (cz)exp  (pz0cz0).partii/emulatingdp-likequalitieswith   nitemixtures45roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartii/dpmixturemodel46thelimitof   nitemixtures?theoreticalgoal:de   neanonparametric(in   nite)mixturemodel.partii/dpmixturemodel47thelimitof   nitemixtures?theoreticalgoal:de   neanonparametric(in   nite)mixturemodel.firstattempt:lookat     dirichlet(  0k,...,  0k)with  0=1:k=2k=3k=4k=5k=6k=7k=8k            ?partii/dpmixturemodel47thelimitof   nitemixtures?theoreticalgoal:de   neanonparametric(in   nite)mixturemodel.firstattempt:lookat     dirichlet(  0k,...,  0k)with  0=1:k=2k=3k=4k=5k=6k=7k=8k            ?problem:foreachcomponentz,e  z=1k   0.partii/dpmixturemodel47thelimitof   nitemixtures?theoreticalgoal:de   neanonparametric(in   nite)mixturemodel.firstattempt:lookat     dirichlet(  0k,...,  0k)with  0=1:k=2k=3k=4k=5k=6k=7k=8k            ?problem:foreachcomponentz,e  z=1k   0.theissueisthatthedirichletissymmetric.weneedanasymmetricapproach,wherethelargecomponentsare   rstonaverage.partii/dpmixturemodel47size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:partii/dpmixturemodel48size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:   generate  0   dirichlet(  0k,...,  0k):  01  02  03  04  05  06  07  08partii/dpmixturemodel48size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:   generate  0   dirichlet(  0k,...,  0k):   s         forz=1,...,k:   choosej   multinomial(  0)conditionedonj6   s     z     0j   s   s   {j}  01  02  03  04  05  06  07  08  1partii/dpmixturemodel48size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:   generate  0   dirichlet(  0k,...,  0k):   s         forz=1,...,k:   choosej   multinomial(  0)conditionedonj6   s     z     0j   s   s   {j}  01  02  03  04  05  06  07  08  1  2partii/dpmixturemodel48size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:   generate  0   dirichlet(  0k,...,  0k):   s         forz=1,...,k:   choosej   multinomial(  0)conditionedonj6   s     z     0j   s   s   {j}  01  02  03  04  05  06  07  08  1  2  3partii/dpmixturemodel48size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:   generate  0   dirichlet(  0k,...,  0k):   s         forz=1,...,k:   choosej   multinomial(  0)conditionedonj6   s     z     0j   s   s   {j}  01  02  03  04  05  06  07  08  1  2  3  4  5  6  7  8partii/dpmixturemodel48size-biasedpermutationsolution:takeasize-biasedpermutationofthecomponents:   generate  0   dirichlet(  0k,...,  0k):   s         forz=1,...,k:   choosej   multinomial(  0)conditionedonj6   s     z     0j   s   s   {j}  01  02  03  04  05  06  07  08  1  2  3  4  5  6  7  8stick-breakingcharacterizationofdistributionof  :de   nevz=  zpkz0=z  z0asthefractionofthetail-endofthestickfact:vz   beta(1+  0k,  0   z  0k).partii/dpmixturemodel48thestick-breaking(gem)distributionnowwecantakethelimit:vz   beta(1+  0k,  0   z  0k)k      vz   beta(1,  0)partii/dpmixturemodel49thestick-breaking(gem)distributionnowwecantakethelimit:vz   beta(1+  0k,  0   z  0k)k      vz   beta(1,  0)1:1relationshipbetweenstick-breakingproportionsv=(v1,v2,...)andstick-breakingprobabilities  =(  1,  2,...)partii/dpmixturemodel49thestick-breaking(gem)distributionnowwecantakethelimit:vz   beta(1+  0k,  0   z  0k)k      vz   beta(1,  0)1:1relationshipbetweenstick-breakingproportionsv=(v1,v2,...)andstick-breakingprobabilities  =(  1,  2,...)v11   v11partii/dpmixturemodel49thestick-breaking(gem)distributionnowwecantakethelimit:vz   beta(1+  0k,  0   z  0k)k      vz   beta(1,  0)1:1relationshipbetweenstick-breakingproportionsv=(v1,v2,...)andstick-breakingprobabilities  =(  1,  2,...)v11   v11v21   v2(1   v1)partii/dpmixturemodel49thestick-breaking(gem)distributionnowwecantakethelimit:vz   beta(1+  0k,  0   z  0k)k      vz   beta(1,  0)1:1relationshipbetweenstick-breakingproportionsv=(v1,v2,...)andstick-breakingprobabilities  =(  1,  2,...)v11   v11v21   v2(1   v1)v31   v3(1   v1)(1   v2)...partii/dpmixturemodel49thestick-breaking(gem)distributionnowwecantakethelimit:vz   beta(1+  0k,  0   z  0k)k      vz   beta(1,  0)1:1relationshipbetweenstick-breakingproportionsv=(v1,v2,...)andstick-breakingprobabilities  =(  1,  2,...)v11   v11v21   v2(1   v1)v31   v3(1   v1)(1   v2)...vz=  z  z+  z+1+        z=(1   v1)      (1   vz   1)vzwrite     gem(  0)todenotethestick-breakingdistribution.partii/dpmixturemodel49examplesofthegemdistributionvz   beta(1,  0)as  0increases,sticksdecayslower   moreclustersgem(0.3)0101  1  2partii/dpmixturemodel50examplesofthegemdistributionvz   beta(1,  0)as  0increases,sticksdecayslower   moreclustersgem(0.3)0101  1  2gem(1)0101  1  2partii/dpmixturemodel50examplesofthegemdistributionvz   beta(1,  0)as  0increases,sticksdecayslower   moreclustersgem(0.3)0101  1  2gem(1)0101  1  2gem(3)0101  1  2partii/dpmixturemodel50acautionarytaleaboutpointestimatesquestion:whatisthemostlikelyvalueof     gem(1.2)?partii/dpmixturemodel51acautionarytaleaboutpointestimatesquestion:whatisthemostlikelyvalueof     gem(1.2)?p(v)=qkz=1beta(vz;1,1.2)foreachz,bestvz=0,sobest  z=0.0.20.40.60.81.0x0.60.70.80.91.0beta(x;1,1.2)partii/dpmixturemodel51acautionarytaleaboutpointestimatesquestion:whatisthemostlikelyvalueof     gem(1.2)?p(v)=qkz=1beta(vz;1,1.2)foreachz,bestvz=0,sobest  z=0.0.20.40.60.81.0x0.60.70.80.91.0beta(x;1,1.2)butintypicaldraws,componentsdecay...acontradiction?partii/dpmixturemodel51acautionarytaleaboutpointestimatesquestion:whatisthemostlikelyvalueof     gem(1.2)?p(v)=qkz=1beta(vz;1,1.2)foreachz,bestvz=0,sobest  z=0.0.20.40.60.81.0x0.60.70.80.91.0beta(x;1,1.2)butintypicaldraws,componentsdecay...acontradiction?no!   problem:modenotrepresentativeofentiredistribution   solution:needid136algorithmsthatworkwithentiredistributionpartii/dpmixturemodel51dpmixturemodelfinitemixturemodel     dirichletk(  ,...,  )foreachcomponentz   {1,...,k}  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)partii/dpmixturemodel52dpmixturemodelfinitedpmixturemodel     dirichletk(  ,...,  )gem(  )foreachcomponentz   {1,...,k}{1,2,...}:  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)partii/dpmixturemodel52dpmixturemodelfinitedpmixturemodel     dirichletk(  ,...,  )gem(  )foreachcomponentz   {1,...,k}{1,2,...}:  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)mean-   eldid136[blei,jordan,2005]:approximationintermsofstick-breakingproportionsv:q(  )=q   z=1q(vz)partii/dpmixturemodel52dpmixturemodelfinitedpmixturemodel     dirichletk(  ,...,  )gem(  )foreachcomponentz   {1,...,k}{1,2,...}:  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)mean-   eldid136[blei,jordan,2005]:approximationintermsofstick-breakingproportionsv:q(  )=q   z=1q(vz)howtodealwithanin   nitenumberofparameters?chooseatruncationlevelkandforceq(vk)=1.nowq(vz)andq(  z)forz>kareirrelevant.partii/dpmixturemodel52roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartii/otherviewsofthedp53threeviewsofthedirichletprocesspartii/otherviewsofthedp54threeviewsofthedirichletprocessstick-breakingprocess[sethuraman,1994]partii/otherviewsofthedp54threeviewsofthedirichletprocesschineserestaurantprocess[pitman,2002]...stick-breakingprocess[sethuraman,1994]partii/otherviewsofthedp54threeviewsofthedirichletprocessstochasticprocess[ferguson,1973]a1a2a3a4chineserestaurantprocess[pitman,2002]...stick-breakingprocess[sethuraman,1994]partii/otherviewsofthedp54de   nitionofthedirichletprocessdpmixturemodel     gem(  )foreachcomponentz   {1,2,...}:  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)partii/otherviewsofthedp55de   nitionofthedirichletprocessdpmixturemodel     gem(  )foreachcomponentz   {1,2,...}:  z   g0foreachdatapointi   {1,...,n}:zi   multinomial(  )xi   f(  zi)g=p   z=1  z    zfullyspeci   estheparameters.partii/otherviewsofthedp55de   nitionofthedirichletprocessdpmixturemodel     gem(  )foreachcomponentz   {1,2,...}:  z   g0}g   dp(  ,g0)foreachdatapointi   {1,...,n}:zi   multinomial(  )}  i   gxi   f(  zi)}xi   f(  i)g=p   z=1  z    zfullyspeci   estheparameters.writeg   dp(  ,g0)tomeanghasadirichletprocessprior.partii/otherviewsofthedp55de   nitionofthedirichletprocessdpmixturemodel     gem(  )foreachcomponentz   {1,2,...}:  z   g0}g   dp(  ,g0)foreachdatapointi   {1,...,n}:zi   multinomial(  )}  i   gxi   f(  zi)}xi   f(  i)g=p   z=1  z    zfullyspeci   estheparameters.writeg   dp(  ,g0)tomeanghasadirichletprocessprior.0101  a  b0101  a  bg0gpartii/otherviewsofthedp55stochasticprocessde   nitiong   dp(  ,g0)   finitepartitionproperty:(g(a1),...,g(am))   dirichlet(  g0(a1),...,  g0(am))forallpartitions(a1,...,am)of   ,where   isthesetofallpossibleparameters.a1a2a3a4   example:   =0101  a  b(thesetofmultinomialparameters)partii/otherviewsofthedp56stochasticprocessde   nitiong   dp(  ,g0)   finitepartitionproperty:(g(a1),...,g(am))   dirichlet(  g0(a1),...,  g0(am))forallpartitions(a1,...,am)of   ,where   isthesetofallpossibleparameters.a1a2a3a4   example:   =0101  a  b(thesetofmultinomialparameters)when   is   nite,dirichletprocess=dirichletdistribution.partii/otherviewsofthedp56stochasticprocessde   nitiong   dp(  ,g0)   finitepartitionproperty:(g(a1),...,g(am))   dirichlet(  g0(a1),...,  g0(am))forallpartitions(a1,...,am)of   ,where   isthesetofallpossibleparameters.a1a2a3a4   example:   =0101  a  b(thesetofmultinomialparameters)when   is   nite,dirichletprocess=dirichletdistribution.signi   cance:theoreticalproperties,compactnotation,de   ninghdpspartii/otherviewsofthedp56chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterpartii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...1id203:  00+  0partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...12id203:  00+  0  01+  0partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...123id203:  00+  0  01+  012+  0partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...1234id203:  00+  0  01+  012+  0  03+  0partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...12345id203:  00+  0  01+  012+  0  03+  024+  0partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...12345id203:  00+  0  01+  012+  0  03+  024+  0insymbols:  i|  1,...,  i   1   1  +i   1(cid:16)pi   1j=1    j+  g0(cid:17)partii/otherviewsofthedp57chineserestaurantprocesswhatisthedistributionof  i|  1,...,  i   1marginalizingoutg?metaphor:customer=datapoint,dish=parameter,table=clusterachineserestauranthasanin   nitenumberoftables.customeri:   joinsthetableofapreviouscustomerjandsharesthedish,or   startsanewtableandrandomlypicksanewdishfromg0...12345id203:  00+  0  01+  012+  0  03+  024+  0insymbols:  i|  1,...,  i   1   1  +i   1(cid:16)pi   1j=1    j+  g0(cid:17)rich-gets-richerproperty:tableswithmorecustomersgetmore.signi   cance:leadstoe   cientsamplingalgorithms.partii/otherviewsofthedp57roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartiii58roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartiii/structuredmodels59buildingdp-basedstructuredmodelsdpsinglemixturemodelpartiii/structuredmodels60buildingdp-basedstructuredmodelsdpsinglemixturemodelhdpseveralmixturemodelssharingsamecomponentspartiii/structuredmodels60buildingdp-basedstructuredmodelsdpsinglemixturemodelhdpseveralmixturemodelssharingsamecomponentshdp-id48eachstatehasamixturemodelovernextstateshdp-pid18eachstatehasamixturemodeloverpairsofstatespartiii/structuredmodels60hierarchicaldpmixturemodelssupposewehaveacollectionofjmixturemodels.goal:sharecommoninventoryofmixturecomponentspartiii/structuredmodels[teh,etal.,2006]61hierarchicaldpmixturemodelssupposewehaveacollectionofjmixturemodels.goal:sharecommoninventoryofmixturecomponents    1z1ix1iin...  zz   ...  jzjixjiin   componentparameters{  z}aresharedglobally   eachmixturemodelhasindividualcomponentprobabilities  jtiedvia  partiii/structuredmodels[teh,etal.,2006]61hierarchicaldpmixturemodels    jzjixjiinjj  zz        gem(  )foreachcomponentz   {1,2,...}:  z   g0foreachgroupj   {1,...,j}:  j   dp(  0,  )foreachdatapointi   {1,...,n}:zji   multinomial(  j)xji   f(  zji)partiii/structuredmodels62hierarchicaldpmixturemodels    jzjixjiinjj  zz        gem(  )foreachcomponentz   {1,2,...}:  z   g0foreachgroupj   {1,...,j}:  j   dp(  0,  )foreachdatapointi   {1,...,n}:zji   multinomial(  j)xji   f(  zji)  determinestheroughcomponentprobabilities  j   dp(  0,  )makes  jcloseto  partiii/structuredmodels62sharingcomponentprobabilitiesdrawtop-levelcomponentprobabilities     gem(  ):  =2partiii/structuredmodels63sharingcomponentprobabilitiesdrawtop-levelcomponentprobabilities     gem(  ):  =2drawgroup-levelcomponentprobabilities     dp(  0,  ):  0=1partiii/structuredmodels63sharingcomponentprobabilitiesdrawtop-levelcomponentprobabilities     gem(  ):  =2drawgroup-levelcomponentprobabilities     dp(  0,  ):  0=1  0=5partiii/structuredmodels63sharingcomponentprobabilitiesdrawtop-levelcomponentprobabilities     gem(  ):  =2drawgroup-levelcomponentprobabilities     dp(  0,  ):  0=1  0=5  0=20partiii/structuredmodels63sharingcomponentprobabilitiesdrawtop-levelcomponentprobabilities     gem(  ):  =2drawgroup-levelcomponentprobabilities     dp(  0,  ):  0=1  0=5  0=20  0=100as  0increases,themore  resembles  .partiii/structuredmodels63mean-   eldid136forthehdp    jzjixjiinjj  zz        gem(  )foreachcomponentz   {1,2,...}:  z   g0foreachgroupj   {1,...,j}:  j   dp(  0,  )foreachdatapointi   {1,...,n}:zji   multinomial(  j)xji   f(  zji)mean-   eldapproximation:q(  )q   z=1q(  z)qjj=1q(  j)qni=1q(zi)partiii/structuredmodels64mean-   eldid136forthehdp    jzjixjiinjj  zz        gem(  )foreachcomponentz   {1,2,...}:  z   g0foreachgroupj   {1,...,j}:  j   dp(  0,  )foreachdatapointi   {1,...,n}:zji   multinomial(  j)xji   f(  zji)mean-   eldapproximation:q(  )q   z=1q(  z)qjj=1q(  j)qni=1q(zi)   asinvariationaldp,truncate  atlevelk     j   dp(  0,  )reducesto   nitek-dimensionaldirichlet  j   dirichlet(  0,  ),sowecanuse   nitevariationaltechniquesforupdatingq(  ).   letq(  )=       (  )fortractability,optimizewithgradientdescentpartiii/structuredmodels64hdphiddenmarkovmodels    z  zz   z1z2z3      x1x2x3           gem(  )foreachstatez   {1,2,...}:  z   g0  z   dp(  0,  )foreachtimestepi   {1,...,n}:zi+1   multinomial(  zi)xi   f(  zi)eachstatezisacomponentandhasthefollowing:     z:transitionparameters     z:emissionparameterspartiii/structuredmodels[beal,etal.,2002;teh,etal.,2006]65hdphiddenmarkovmodels    z  zz   z1z2z3      x1x2x3           gem(  )foreachstatez   {1,2,...}:  z   g0  z   dp(  0,  )foreachtimestepi   {1,...,n}:zi+1   multinomial(  zi)xi   f(  zi)eachstatezisacomponentandhasthefollowing:     z:transitionparameters     z:emissionparameterskey:     gem(  )speci   eswhichstateswillbeused(global)  z   dp(  0,  )speci   esdistributionovernextstates(perstate)partiii/structuredmodels[beal,etal.,2002;teh,etal.,2006]65mean-   eldid136forthehdp-id48    z  zz   z1z2z3      x1x2x3           gem(  )foreachstatez   {1,2,...}:  z   g0  z   dp(  0,  )foreachtimestepi   {1,...,n}:zi+1   multinomial(  zi)xi   f(  zi)structuredmean-   eldapproximation:q(  )(cid:16)q   z=1q(  z)q(  z)(cid:17)q(z)partiii/structuredmodels66mean-   eldid136forthehdp-id48    z  zz   z1z2z3      x1x2x3           gem(  )foreachstatez   {1,2,...}:  z   g0  z   dp(  0,  )foreachtimestepi   {1,...,n}:zi+1   multinomial(  zi)xi   f(  zi)structuredmean-   eldapproximation:q(  )(cid:16)q   z=1q(  z)q(  z)(cid:17)q(z)em:e-step:runforward-backwardusingp(z0|z,  )=  zz0m-step:normalizetransitioncounts:  zz0   c(z   z0)partiii/structuredmodels66mean-   eldid136forthehdp-id48    z  zz   z1z2z3      x1x2x3           gem(  )foreachstatez   {1,2,...}:  z   g0  z   dp(  0,  )foreachtimestepi   {1,...,n}:zi+1   multinomial(  zi)xi   f(  zi)structuredmean-   eldapproximation:q(  )(cid:16)q   z=1q(  z)q(  z)(cid:17)q(z)em:e-step:runforward-backwardusingp(z0|z,  )=  zz0m-step:normalizetransitioncounts:  zz0   c(z   z0)mean-   eld:e-step:runforward-backwardusingmultinomialweightsw(z,z0)m-step:computemultinomialweightsgiventransitioncounts:w(z,z0)=exp  (  0  z0+c(z   z0))exp  (  0+c(z      ))top-level:optimizeq(  )=       (  )usinggradientdescentpartiii/structuredmodels66hdpprobabilisticcontext-freegrammars     gem(  )foreachsymbolz   {1,2,...}:  tz   dirichlet  ez   g0  bz   dp(  0,    t)foreachnodeiintheparsetree:ti   multinomial(  tzi)[ruletype]ifti=binary-production:(zl(i),zr(i))   multinomial(  bzi)[childrensymbols]ifti=emission:xi   multinomial(  ezi)[terminalsymbol]    bz  tz  ezz   z1z2x2z3x3partiii/structuredmodels[liang,etal.,2007]67hdpprobabilisticcontext-freegrammars     gem(  )foreachsymbolz   {1,2,...}:  tz   dirichlet  ez   g0  bz   dp(  0,    t)foreachnodeiintheparsetree:ti   multinomial(  tzi)[ruletype]ifti=binary-production:(zl(i),zr(i))   multinomial(  bzi)[childrensymbols]ifti=emission:xi   multinomial(  ezi)[terminalsymbol]    bz  tz  ezz   z1z2x2z3x3hdp-id48hdp-pid18ateachi...transitionandemitproduceoremitpartiii/structuredmodels[liang,etal.,2007]67hdpprobabilisticcontext-freegrammars     gem(  )foreachsymbolz   {1,2,...}:  tz   dirichlet  ez   g0  bz   dp(  0,    t)foreachnodeiintheparsetree:ti   multinomial(  tzi)[ruletype]ifti=binary-production:(zl(i),zr(i))   multinomial(  bzi)[childrensymbols]ifti=emission:xi   multinomial(  ezi)[terminalsymbol]    bz  tz  ezz   z1z2x2z3x3hdp-id48hdp-pid18ateachi...transitionandemitproduceoremitdpisover...1nextstate2childrensymbolspartiii/structuredmodels[liang,etal.,2007]67hdpprobabilisticcontext-freegrammars     gem(  )foreachsymbolz   {1,2,...}:  tz   dirichlet  ez   g0  bz   dp(  0,    t)foreachnodeiintheparsetree:ti   multinomial(  tzi)[ruletype]ifti=binary-production:(zl(i),zr(i))   multinomial(  bzi)[childrensymbols]ifti=emission:xi   multinomial(  ezi)[terminalsymbol]    bz  tz  ezz   z1z2x2z3x3hdp-id48hdp-pid18ateachi...transitionandemitproduceoremitdpisover...1nextstate2childrensymbolsvariationalid136:modi   edinside-outsidepartiii/structuredmodels[liang,etal.,2007]67predictionrevisitedtrainonx;nowgettestxnew,wantto   ndbestznew.p(znew|xnew)partiii/structuredmodels68predictionrevisitedtrainonx;nowgettestxnew,wantto   ndbestznew.p(znew|xnew)=ep(  |x)p(znew|xnew,  )partiii/structuredmodels68predictionrevisitedtrainonx;nowgettestxnew,wantto   ndbestznew.p(znew|xnew)=ep(  |x)p(znew|xnew,  )ueq(  )p(znew|xnew,  )partiii/structuredmodels68predictionrevisitedtrainonx;nowgettestxnew,wantto   ndbestznew.p(znew|xnew)=ep(  |x)p(znew|xnew,  )ueq(  )p(znew|xnew,  )contrastwithtraining(haslog):q(znew)   expeq(  )logp(znew|xnew,  )partiii/structuredmodels68predictionrevisitedtrainonx;nowgettestxnew,wantto   ndbestznew.p(znew|xnew)=ep(  |x)p(znew|xnew,  )ueq(  )p(znew|xnew,  )contrastwithtraining(haslog):q(znew)   expeq(  )logp(znew|xnew,  )to   ndargmaxzneweq(  )p(znew|xnew,  ),considerallznew:intractablewhenznewisaparsetreebecausecannotusedynamicprogramming(unliketraining)partiii/structuredmodels68predictionrevisitedtrainonx;nowgettestxnew,wantto   ndbestznew.p(znew|xnew)=ep(  |x)p(znew|xnew,  )ueq(  )p(znew|xnew,  )contrastwithtraining(haslog):q(znew)   expeq(  )logp(znew|xnew,  )to   ndargmaxzneweq(  )p(znew|xnew,  ),considerallznew:intractablewhenznewisaparsetreebecausecannotusedynamicprogramming(unliketraining)approximations:   usemodeofq(  )   maximizeexpectedlog-likelihoodasintraining   reranking:getann-bestlistusingproxy;choosebestonepartiii/structuredmodels68roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartiii/surveyofrelatedmethods69top-downandbottom-upmodeldpmixturemodels,id48s,pid18sid136algorithmem,mean-   eld,samplingdatawords,sentences,parsetreespriorssmoothing,discountingpartiii/surveyofrelatedmethods70whydoesn   tmyvariationaldpwork?modelingissues   settingconcentrationparametersisstillanart.   isthedpeventherightpriortouse?partiii/surveyofrelatedmethods71whydoesn   tmyvariationaldpwork?modelingissues   settingconcentrationparametersisstillanart.   isthedpeventherightpriortouse?id136issues   mean-   eldisanapproximationofthetrueposterior.   thecoordinate-wisedescentalgorithmforoptimizingthemean-   eldobjectiveissusceptibletolocalminimaproblems,justasisem.partiii/surveyofrelatedmethods71otherid136methodswefocusedonvariationalid136usingthestick-breakingconstruction.partiii/surveyofrelatedmethods72otherid136methodswefocusedonvariationalid136usingthestick-breakingconstruction.algorithm:   variational(mean-   eld,expectationpropagation,etc.):deterministic,fast,convergetolocaloptima   sampling(gibbs,split-merge,etc.):convergestotrueposterior(butdon   tknowwhen),couldbestuckinlocaloptimaforalongtimepartiii/surveyofrelatedmethods72otherid136methodswefocusedonvariationalid136usingthestick-breakingconstruction.algorithm:   variational(mean-   eld,expectationpropagation,etc.):deterministic,fast,convergetolocaloptima   sampling(gibbs,split-merge,etc.):convergestotrueposterior(butdon   tknowwhen),couldbestuckinlocaloptimaforalongtimerepresentation:   stick-breakingconstruction:simple,concrete   chineserestaurantprocess:workswellforsimplemixturemodelspartiii/surveyofrelatedmethods72thebayesianelephantevenjusttheelephantposteriorisintractable.mean-   eldguy:   feelslikesmoothing/discounting   samplingguy:   feelslikestochastichill-climbing   acommonproperty:richgetsricherpartiii/surveyofrelatedmethods73othernonparametricpriors   pitman-yorprocess:componentprobabilitieslesssparsecomparedtothedp;yieldspower-lawdistributionsusefulforlanguagemodeling.[pitman,yor,1997;teh,2006]   betaprocess/indianbu   etprocess:allowsdatapointstobelongtomorethanonecluster;in   nitenumberoflatentfeatures,eachdatapointgeneratedusinga   nitesubset.[gri   ths,ghahramani,2007;thibaux,jordan,2007]   etc.manyofthesepriorsalsohavestochasticprocess,chineserestaurant,stick-breakingcounterparts.partiii/surveyofrelatedmethods74othertypesofproblemsid91(unsupervised)non-bayesianbayesianparametricid116,embayesianmixturemodelsnonparametricagglomerativeid91dirichletprocessespartiii/surveyofrelatedmethods75othertypesofproblemsid91(unsupervised)non-bayesianbayesianparametricid116,embayesianmixturemodelsnonparametricagglomerativeid91dirichletprocessesclassi   cation(supervised)non-bayesianbayesianparametriclogisticregression,id166sbayesianlogisticregressionnonparametricnearestneighbors,kernelmethodsgaussianprocessespartiii/surveyofrelatedmethods75roadmap   parti   distributionsandbayesianprinciples   variationalbayesianid136   mean-   eldformixturemodels   partii   emulatingdp-likequalitieswith   nitemixtures   dpmixturemodel   otherviewsofthedp   partiii   structuredmodels   surveyofrelatedmethods   surveyofapplicationspartiii/surveyofapplications76bayesiantrendsinnlp9091929394959697989900010203040506year1224364860numberofhits   bayesian   partiii/surveyofapplications77bayesiantrendsinnlp9091929394959697989900010203040506year1224364860numberofhits   bayesian   9091929394959697989900010203040506year1224364860numberofhits   dirichlet   partiii/surveyofapplications77bayesiantrendsinnlp9091929394959697989900010203040506year1224364860numberofhits   bayesian   9091929394959697989900010203040506year1224364860numberofhits   dirichlet   9091929394959697989900010203040506year1224364860numberofhits   prior   partiii/surveyofapplications77bayesiantrendsinnlp9091929394959697989900010203040506year1224364860numberofhits   bayesian   9091929394959697989900010203040506year1224364860numberofhits   dirichlet   9091929394959697989900010203040506year1224364860numberofhits   prior   9091929394959697989900010203040506year1224364860numberofhits   posterior   partiii/surveyofapplications77applications   topicmodeling      nitebayesianmodel;variational[blei,etal.,2003]   hdp-basedmodel;sampling[teh,etal.,2006]   languagemodeling   pitman-yor   power-law;sampling[goldwater,etal.,2005]   kneser-ney   pitman-yor;sampling[teh,2006]   posinductionusinga   nitebayesianid48   collapsedsampling[goldwater,gri   ths,2007]   variational[johnson,2007]   parsingusingnonparametricgrammars   collapsedsampling[johnson,etal.,2006]   collapsedsampling[finkel,etal.,2007]   variationalstick-breakingrepresentation[liang,etal.,2007]   coreferenceresolution   supervisedid91;collapsedsampling[daume,marcu,2005]   hdp-basedmodel;sampling[haghighi,klein,2007]partiii/surveyofapplications78conclusions   bayesianmethodsareaboutkeepinguncertaintyinparameters79conclusions   bayesianmethodsareaboutkeepinguncertaintyinparameters   variationalid136:hardem   em   mean-   eld   representadistributionoverparameters79conclusions   bayesianmethodsareaboutkeepinguncertaintyinparameters   variationalid136:hardem   em   mean-   eld   representadistributionoverparameters   thenonparametricdirichletprocesspriorpenalizesuseofextraclusters   id136algorithmshaverich-gets-richerproperty79conclusions   bayesianmethodsareaboutkeepinguncertaintyinparameters   variationalid136:hardem   em   mean-   eld   representadistributionoverparameters   thenonparametricdirichletprocesspriorpenalizesuseofextraclusters   id136algorithmshaverich-gets-richerproperty   structuredmodelscanbebuiltfromnonparametricbayesianparts79resources   references   derivations   glossaryandnotationresources/references80references(dptheory)1.t.s.ferguson.abayesiananalysisofsomenonparametricproblems.annalsofstatistics,1973.de   nesthedirichletprocessusingstochasticprocesses.2.d.blackwellandj.b.macqueen.fergusondistributionsviap  olyaurnschemes.annalsofstatistics,1973.connectionbetweendpandthep  olyaurn.3.j.pitman.combinatorialstochasticprocesses.ucberkeley,2002.acomprehensivesetoftutorialnotes.4.c.e.antoniak.mixturesofdirichletprocesseswithapplicationstobayesiannonparametricproblems.annalsofstatistics,1974.5.m.bealandz.ghahramaniandc.rasmussen.thein   nitehiddenmarkovmodel.nips,2002.introducesthe(in   nite)hdp-id48s.6.y.w.tehandm.i.jordanandm.bealandd.blei.hierarchicaldirichletprocesses.jasa,2006.setsupthehdp,amechanismoftyingdi   erentdpstogether(givesanothertreatmentofhdp-id48s).resources/references81references(variationalid136)1.d.bleianda.ngandm.i.jordan.latentdirichletallocation.jmlr,2003.usesvariationalid136forlda.2.d.bleiandm.i.jordan.variationalid136fordirichletprocessmixtures.bayesiananalysis,2005.firstmean-   eldalgorithmfordpmixtures(stick-breakingrepresentation).3.k.kuriharaandm.wellingandn.vlassis.acceleratedvariationaldirichletmixturemodels.nips,2007.usekd-treestospeedupid136fordpmixtures(stick-breakingrepresentation).4.y.w.tehandd.newmanandm.welling.acollapsedvariationalbayesianid136algorithmforlatentdirichletallocation.nips,2007.variationalid136inthecollapsedcrprepresentationforlda.5.k.kuriharaandm.wellingandy.w.teh.collapsedvariationaldirichletprocessmixturemodels.ijcai,2007.comparesseveralvariationalid136algorithms.resources/references82references(bayesianapplications)1.s.goldwaterandt.gri   ths.afullybayesianapproachtounsupervisedpart-of-speechtagging.acl,2007.2.m.johnson.whydoesn   tem   ndgoodid48pos-taggers?.emnlp/conll,2007.3.k.kuriharaandt.sato.anapplicationofthevariationalbayesianapproachtoprobabilisticcontext-freegrammars.internationaljointconferenceonnaturallanguageprocessingworkshopbeyondshallowanalyses,2004.4.k.kuriharaandt.sato.variationalbayesiangrammarinductionfornaturallanguage.internationalcolloquiumongrammaticalid136,2006.5.m.johnsonandt.gri   thsands.goldwater.adaptorgrammars:aframeworkforspecifyingcompositionalnonparametricbayesianmodels.nips,2006.6.h.daumeandd.marcu.bayesianquery-focusedsummarization.coling/acl,2006.resources/references83references(nonparametricapplications)1.m.johnsonandt.gri   thsands.goldwater.adaptorgrammars:aframeworkforspecifyingcompositionalnonparametricbayesianmodels.nips,2006.2.j.r.finkelandt.grenagerandc.manning.thein   nitetree.acl,2007.3.p.liangands.petrovandm.i.jordanandd.klein.thein   nitepid18usinghierarchicaldirichletprocesses.emnlp/conll,2007.4.s.goldwaterandt.gri   thsandm.johnson.interpolatingbetweentypesandtokensbyestimatingpower-lawgenerators.nips,2005.5.y.w.teh.ahierarchicalbayesianlanguagemodelbasedonpitman-yorprocesses.coling/acl,2006.6.h.daumeandd.marcu.abayesianmodelforsupervisedid91withthedirichletprocessprior.jmlr,2005.7.s.goldwaterandt.gri   thsandm.johnson.contextualdependenciesinunsupervisedwordsegmentation.coling/acl,2006.8.a.haghighiandd.klein.unsupervisedcoreferenceresolutioninanonparametricbayesianmodel.acl,2007.resources/references84resources   references   derivations   glossaryandnotationresources/derivations85kl-divergenceandid172kl(q||p)def=eqlogq(  )p(  )usually,weonlyknowpuptoid172:example:p=p(  |x),  p=p(  ,x),z=p(x)p=  pz(unnormalizeddistribution:tractable)(id172constant:intractable)resources/derivations86kl-divergenceandid172kl(q||p)def=eqlogq(  )p(  )usually,weonlyknowpuptoid172:example:p=p(  |x),  p=p(  ,x),z=p(x)p=  pz(unnormalizeddistribution:tractable)(id172constant:intractable)noproblem,duetothefollowingidentity:kl(q||p)=kl(q||  p)+logzresources/derivations86kl-divergenceandid172kl(q||p)def=eqlogq(  )p(  )usually,weonlyknowpuptoid172:example:p=p(  |x),  p=p(  ,x),z=p(x)p=  pz(unnormalizeddistribution:tractable)(id172constant:intractable)noproblem,duetothefollowingidentity:kl(q||p)=kl(q||  p)+logz   argminqkl(q||p)=argminqkl(q||  p)   sincekl   0,wegetalowerboundonlogzasabonus:logz|{z}intractable      kl(q||  p)|{z}tractableresources/derivations86kl-divergenceandid172kl(q||p)(1)1.thisisthequantitywewanttominimize.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)2.expandthede   nitionofkl.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)3.logturnsdivisionintosubtraction.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)=eq[logq(  )]   eq[logp(  )](4)4.uselinearityofexpectation.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)=eq[logq(  )]   eq[logp(  )](4)=   h(q)   eq[logp(  )](5)5.substitutede   nitionofid178(seenextslide).resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)=eq[logq(  )]   eq[logp(  )](4)=   h(q)   eq[logp(  )](5)=   h(q)   eq[log  p(  )z](6)6.expandpintothetractable  p(  )andintractablez.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)=eq[logq(  )]   eq[logp(  )](4)=   h(q)   eq[logp(  )](5)=   h(q)   eq[log  p(  )z](6)=   h(q)   eq[log  p(  )]|{z}freeenergy+logz(7)7.usepropertyoflog,linearityofexpectation.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)=eq[logq(  )]   eq[logp(  )](4)=   h(q)   eq[logp(  )](5)=   h(q)   eq[log  p(  )z](6)=   h(q)   eq[log  p(  )]|{z}freeenergy+logz(7)=kl(q||  p)+logz(8)8.reversethederivationwithoutlogz.resources/derivations87kl-divergenceandid172kl(q||p)(1)=eq[logq(  )p(  )](2)=eq[logq(  )   logp(  )](3)=eq[logq(  )]   eq[logp(  )](4)=   h(q)   eq[logp(  )](5)=   h(q)   eq[log  p(  )z](6)=   h(q)   eq[log  p(  )]|{z}freeenergy+logz(7)=kl(q||  p)+logz(8)resources/derivations87id178id178measurestheamountofuncertaintyinadistribution.de   nition:h(q)def=   eqlogq(  )=   rq(  )logq(  )d  property:h(q)   0supposeqisfully-factorized(asinmean-   eld):q(  )=qni=1qi(  i)thentheid178decomposes:h(q)(1)1.theid178oftheentiredistribution.resources/derivations88id178id178measurestheamountofuncertaintyinadistribution.de   nition:h(q)def=   eqlogq(  )=   rq(  )logq(  )d  property:h(q)   0supposeqisfully-factorized(asinmean-   eld):q(  )=qni=1qi(  i)thentheid178decomposes:h(q)(1)=   eq[logqni=1qi(  i)](2)2.expandde   nitionofid178andmean-   elddistribution.resources/derivations88id178id178measurestheamountofuncertaintyinadistribution.de   nition:h(q)def=   eqlogq(  )=   rq(  )logq(  )d  property:h(q)   0supposeqisfully-factorized(asinmean-   eld):q(  )=qni=1qi(  i)thentheid178decomposes:h(q)(1)=   eq[logqni=1qi(  i)](2)=pni=1   eq[logqi(  i)](3)3.logturnsproductsintosum;linearityofexpectation.resources/derivations88id178id178measurestheamountofuncertaintyinadistribution.de   nition:h(q)def=   eqlogq(  )=   rq(  )logq(  )d  property:h(q)   0supposeqisfully-factorized(asinmean-   eld):q(  )=qni=1qi(  i)thentheid178decomposes:h(q)(1)=   eq[logqni=1qi(  i)](2)=pni=1   eq[logqi(  i)](3)=pni=1   eqi[logqi(  i)](4)4.theexpectationonlyinvolves  i.resources/derivations88id178id178measurestheamountofuncertaintyinadistribution.de   nition:h(q)def=   eqlogq(  )=   rq(  )logq(  )d  property:h(q)   0supposeqisfully-factorized(asinmean-   eld):q(  )=qni=1qi(  i)thentheid178decomposes:h(q)(1)=   eq[logqni=1qi(  i)](2)=pni=1   eq[logqi(  i)](3)=pni=1   eqi[logqi(  i)](4)=pni=1h(qi)(5)5.de   nitionofid178.resources/derivations88id178id178measurestheamountofuncertaintyinadistribution.de   nition:h(q)def=   eqlogq(  )=   rq(  )logq(  )d  property:h(q)   0supposeqisfully-factorized(asinmean-   eld):q(  )=qni=1qi(  i)thentheid178decomposes:h(q)(1)=   eq[logqni=1qi(  i)](2)=pni=1   eq[logqi(  i)](3)=pni=1   eqi[logqi(  i)](4)=pni=1h(qi)(5)resources/derivations88formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)1.thisisthequantitywewanttominimize.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)2.expandklusingapreviousderivation.writep(  |x)asp(  )tosimplifynotation.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)=(cid:16)xj   h(qj)(cid:17)   eq[logp(  )](3)3.theid178termdecouplesbecauseqisfully-factorized.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)=(cid:16)xj   h(qj)(cid:17)   eq[logp(  )](3)=   h(qi)   eq[logp(  )]+c(4)4.onlytheid178ofqimatters;theconstantcabsorbstheotherterms.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)=(cid:16)xj   h(qj)(cid:17)   eq[logp(  )](3)=   h(qi)   eq[logp(  )]+c(4)=   h(qi)   eqi[eq   ilogp(  )]+c(5)5.expandtheexpectationasaniteratedconditionalexpectation.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)=(cid:16)xj   h(qj)(cid:17)   eq[logp(  )](3)=   h(qi)   eq[logp(  )]+c(4)=   h(qi)   eqi[eq   ilogp(  )]+c(5)=   h(qi)   eqi[log(expeq   ilogp(  ))]+c(6)6.applyinglogexphasnoe   ect,butputstheexpressioninaconvenientform.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)=(cid:16)xj   h(qj)(cid:17)   eq[logp(  )](3)=   h(qi)   eq[logp(  )]+c(4)=   h(qi)   eqi[eq   ilogp(  )]+c(5)=   h(qi)   eqi[log(expeq   ilogp(  ))]+c(6)=kl(qi||expeq   ilogp(  ))+c(7)7.recognizetheexpressionasakldivergence.resources/derivations89formalderivationofmean-   eldupdatesgoal:optimizeeachqiholdingq   i   xed.strategy:manipulatekl(q||p),throwingawaytermsthatdonotdependonqi.kl(q||p)(1)=   h(q)   eq[logp(  )](2)=(cid:16)xj   h(qj)(cid:17)   eq[logp(  )](3)=   h(qi)   eq[logp(  )]+c(4)=   h(qi)   eqi[eq   ilogp(  )]+c(5)=   h(qi)   eqi[log(expeq   ilogp(  ))]+c(6)=kl(qi||expeq   ilogp(  ))+c(7)recallthatklisminimizedwhenthetwoargumentsareequal.conclusion:argminqikl(q||p)   exp{eq   ilogp(  )}.resources/derivations89derivationofexp  goal:showw(z)def=exp{edirichlet(  ;  )log  z}=exp{  (  z)}exp{  (pz0  z0}writethedirichletdistributioninexponentialfamilyform:p(  |  )=expnxz  zlog  z   hxzlog  (  z)   log  (cid:16)xz  z(cid:17)iosu   cientstatistics:log  zlog-partitionfunction:pzlog  (  z)   log  (cid:16)pz  z(cid:17)fact:meanofsu   cientstatistics=derivativeoflog-partitionfunctionde   nition:thedigammafunctionis  (x)=   log  (x)   xelog  z=   a(  )     z=  (  z)   xz0  (  z0)exponentiatingbothsides:exp{elog  z}=exp{  (  z)}exp{  (pz0  z0}resources/derivations90resources   references   derivations   glossaryandnotationresources/glossaryandnotation91glossarybayesianid136:amethodologywherebyaprioroverparametersiscombinedwiththelikelihoodofobserveddatatoproduceaposteriorusingthelawsofid203.chineserestaurantprocess:thedistributionoftheid91inducedbydrawsfromthedirichletprocess(marginalizingoutcomponentprobabilitiesandparameters).conjugacy:twodistributionsareconjugate(e.g.,dirichletandmultinomial).dirichletdistribution:adistributionover(parametersof)   niteid203distributions.dirichletprocess:adistributionoverarbitrarydistributions(generalizesthedirichletdistribution).resources/glossaryandnotation92glossarylikelihood:theid203ofobservingthedata.marginalization:integratingorsummingoutunobservedquantitiesinamodel.marginallikelihood:theid203oftheobserveddata,marginalizingoutunknownparameters.thisquantityislowerboundedinvariationalid136.markovchainmontecarlo:arandomizedapproximateid136algorithmwithniceasymptoticproperties.mean-   eld:afully-factorizedapproximationforvariationalid136.resources/glossaryandnotation93glossarynonparametric:referstomodelswherethenumberofe   ectiveparameterscangrowwiththeamountofdata.thedirichletprocessisanexampleofanonparametricprior.posterior:thedistributionoverunknownquantitiesinamodel(parameters)conditionedontheobserveddata.prior:adistributionoverunknownquantitiesinthemodel(parameters)beforeobservingdata.stick-breakingrepresentation:aconstructivede   nitionofthedirichletprocessprior.variationalbayes:variationalid136forcomputingtheposteriorinbayesianmodels.resources/glossaryandnotation94notation  allparameters(  ,  )zallhiddenvariables  zid203ofcomponentzvzstick-breakingproportionofcomponentz  zparametersofcomponentzzicomponentthatpointiisassignedtoxidatapointi  0concentrationparameterofthedirichletprocesspriorg0basedistributionparameterofthedirichletprocesspriorgadrawfromthedirichletprocess  icomponentparametersusedtogeneratepointiresources/glossaryandnotation95